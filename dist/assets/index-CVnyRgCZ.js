var sF=Object.defineProperty;var bb=n=>{throw TypeError(n)};var oF=(n,t,r)=>t in n?sF(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var Nt=(n,t,r)=>oF(n,typeof t!="symbol"?t+"":t,r),dm=(n,t,r)=>t.has(n)||bb("Cannot "+r);var Ve=(n,t,r)=>(dm(n,t,"read from private field"),r?r.call(n):t.get(n)),Zt=(n,t,r)=>t.has(n)?bb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,r),Zr=(n,t,r,i)=>(dm(n,t,"write to private field"),i?i.call(n,r):t.set(n,r),r),Cr=(n,t,r)=>(dm(n,t,"access private method"),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function cv(n){const t=Object.create(null);for(const r of n.split(","))t[r]=1;return r=>r in t}const tr={},bu=[],Mi=()=>{},aF=()=>!1,Gp=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),hv=n=>n.startsWith("onUpdate:"),un=Object.assign,fv=(n,t)=>{const r=n.indexOf(t);r>-1&&n.splice(r,1)},uF=Object.prototype.hasOwnProperty,qt=(n,t)=>uF.call(n,t),ut=Array.isArray,xu=n=>Bh(n)==="[object Map]",zp=n=>Bh(n)==="[object Set]",xb=n=>Bh(n)==="[object Date]",bt=n=>typeof n=="function",kr=n=>typeof n=="string",Ui=n=>typeof n=="symbol",sr=n=>n!==null&&typeof n=="object",ZC=n=>(sr(n)||bt(n))&&bt(n.then)&&bt(n.catch),QC=Object.prototype.toString,Bh=n=>QC.call(n),lF=n=>Bh(n).slice(8,-1),JC=n=>Bh(n)==="[object Object]",dv=n=>kr(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,dc=cv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qp=n=>{const t=Object.create(null);return r=>t[r]||(t[r]=n(r))},cF=/-(\w)/g,ii=qp(n=>n.replace(cF,(t,r)=>r?r.toUpperCase():"")),hF=/\B([A-Z])/g,Fo=qp(n=>n.replace(hF,"-$1").toLowerCase()),Hp=qp(n=>n.charAt(0).toUpperCase()+n.slice(1)),pm=qp(n=>n?`on${Hp(n)}`:""),uo=(n,t)=>!Object.is(n,t),Zf=(n,...t)=>{for(let r=0;r<n.length;r++)n[r](...t)},T0=(n,t,r,i=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:i,value:r})},Sd=n=>{const t=parseFloat(n);return isNaN(t)?n:t};let wb;const Wp=()=>wb||(wb=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Uh(n){if(ut(n)){const t={};for(let r=0;r<n.length;r++){const i=n[r],s=kr(i)?gF(i):Uh(i);if(s)for(const o in s)t[o]=s[o]}return t}else if(kr(n)||sr(n))return n}const fF=/;(?![^(]*\))/g,dF=/:([^]+)/,pF=/\/\*[^]*?\*\//g;function gF(n){const t={};return n.replace(pF,"").split(fF).forEach(r=>{if(r){const i=r.split(dF);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function $h(n){let t="";if(kr(n))t=n;else if(ut(n))for(let r=0;r<n.length;r++){const i=$h(n[r]);i&&(t+=i+" ")}else if(sr(n))for(const r in n)n[r]&&(t+=r+" ");return t.trim()}const mF="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",yF=cv(mF);function e2(n){return!!n||n===""}function vF(n,t){if(n.length!==t.length)return!1;let r=!0;for(let i=0;r&&i<n.length;i++)r=Kp(n[i],t[i]);return r}function Kp(n,t){if(n===t)return!0;let r=xb(n),i=xb(t);if(r||i)return r&&i?n.getTime()===t.getTime():!1;if(r=Ui(n),i=Ui(t),r||i)return n===t;if(r=ut(n),i=ut(t),r||i)return r&&i?vF(n,t):!1;if(r=sr(n),i=sr(t),r||i){if(!r||!i)return!1;const s=Object.keys(n).length,o=Object.keys(t).length;if(s!==o)return!1;for(const a in n){const u=n.hasOwnProperty(a),l=t.hasOwnProperty(a);if(u&&!l||!u&&l||!Kp(n[a],t[a]))return!1}}return String(n)===String(t)}function _F(n,t){return n.findIndex(r=>Kp(r,t))}const t2=n=>!!(n&&n.__v_isRef===!0),At=n=>kr(n)?n:n==null?"":ut(n)||sr(n)&&(n.toString===QC||!bt(n.toString))?t2(n)?At(n.value):JSON.stringify(n,r2,2):String(n),r2=(n,t)=>t2(t)?r2(n,t.value):xu(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,s],o)=>(r[gm(i,o)+" =>"]=s,r),{})}:zp(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>gm(r))}:Ui(t)?gm(t):sr(t)&&!ut(t)&&!JC(t)?String(t):t,gm=(n,t="")=>{var r;return Ui(n)?`Symbol(${(r=n.description)!=null?r:t})`:n};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Jr;class n2{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Jr,!t&&Jr&&(this.index=(Jr.scopes||(Jr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Jr;try{return Jr=this,t()}finally{Jr=r}}}on(){++this._on===1&&(this.prevScope=Jr,Jr=this)}off(){this._on>0&&--this._on===0&&(Jr=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(this.effects.length=0,r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function i2(n){return new n2(n)}function s2(){return Jr}function bF(n,t=!1){Jr&&Jr.cleanups.push(n)}let rr;const mm=new WeakSet;class o2{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Jr&&Jr.active&&Jr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,mm.has(this)&&(mm.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u2(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Eb(this),l2(this);const t=rr,r=mi;rr=this,mi=!0;try{return this.fn()}finally{c2(this),rr=t,mi=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)mv(t);this.deps=this.depsTail=void 0,Eb(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?mm.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){I0(this)&&this.run()}get dirty(){return I0(this)}}let a2=0,pc,gc;function u2(n,t=!1){if(n.flags|=8,t){n.next=gc,gc=n;return}n.next=pc,pc=n}function pv(){a2++}function gv(){if(--a2>0)return;if(gc){let t=gc;for(gc=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let n;for(;pc;){let t=pc;for(pc=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){n||(n=i)}t=r}}if(n)throw n}function l2(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function c2(n){let t,r=n.depsTail,i=r;for(;i;){const s=i.prevDep;i.version===-1?(i===r&&(r=s),mv(i),xF(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}n.deps=t,n.depsTail=r}function I0(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(h2(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function h2(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===$c)||(n.globalVersion=$c,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!I0(n))))return;n.flags|=2;const t=n.dep,r=rr,i=mi;rr=n,mi=!0;try{l2(n);const s=n.fn(n._value);(t.version===0||uo(s,n._value))&&(n.flags|=128,n._value=s,t.version++)}catch(s){throw t.version++,s}finally{rr=r,mi=i,c2(n),n.flags&=-3}}function mv(n,t=!1){const{dep:r,prevSub:i,nextSub:s}=n;if(i&&(i.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=i,n.nextSub=void 0),r.subs===n&&(r.subs=i,!i&&r.computed)){r.computed.flags&=-5;for(let o=r.computed.deps;o;o=o.nextDep)mv(o,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function xF(n){const{prevDep:t,nextDep:r}=n;t&&(t.nextDep=r,n.prevDep=void 0),r&&(r.prevDep=t,n.nextDep=void 0)}let mi=!0;const f2=[];function vs(){f2.push(mi),mi=!1}function _s(){const n=f2.pop();mi=n===void 0?!0:n}function Eb(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const r=rr;rr=void 0;try{t()}finally{rr=r}}}let $c=0;class wF{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class yv{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!rr||!mi||rr===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==rr)r=this.activeLink=new wF(rr,this),rr.deps?(r.prevDep=rr.depsTail,rr.depsTail.nextDep=r,rr.depsTail=r):rr.deps=rr.depsTail=r,d2(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const i=r.nextDep;i.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=i),r.prevDep=rr.depsTail,r.nextDep=void 0,rr.depsTail.nextDep=r,rr.depsTail=r,rr.deps===r&&(rr.deps=i)}return r}trigger(t){this.version++,$c++,this.notify(t)}notify(t){pv();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{gv()}}}function d2(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)d2(i)}const r=n.dep.subs;r!==n&&(n.prevSub=r,r&&(r.nextSub=n)),n.dep.subs=n}}const Cd=new WeakMap,ha=Symbol(""),D0=Symbol(""),jc=Symbol("");function tn(n,t,r){if(mi&&rr){let i=Cd.get(n);i||Cd.set(n,i=new Map);let s=i.get(r);s||(i.set(r,s=new yv),s.map=i,s.key=r),s.track()}}function as(n,t,r,i,s,o){const a=Cd.get(n);if(!a){$c++;return}const u=l=>{l&&l.trigger()};if(pv(),t==="clear")a.forEach(u);else{const l=ut(n),c=l&&dv(r);if(l&&r==="length"){const h=Number(i);a.forEach((f,d)=>{(d==="length"||d===jc||!Ui(d)&&d>=h)&&u(f)})}else switch((r!==void 0||a.has(void 0))&&u(a.get(r)),c&&u(a.get(jc)),t){case"add":l?c&&u(a.get("length")):(u(a.get(ha)),xu(n)&&u(a.get(D0)));break;case"delete":l||(u(a.get(ha)),xu(n)&&u(a.get(D0)));break;case"set":xu(n)&&u(a.get(ha));break}}gv()}function EF(n,t){const r=Cd.get(n);return r&&r.get(t)}function Ya(n){const t=Ot(n);return t===n?t:(tn(t,"iterate",jc),Jn(n)?t:t.map(Yr))}function Yp(n){return tn(n=Ot(n),"iterate",jc),n}const SF={__proto__:null,[Symbol.iterator](){return ym(this,Symbol.iterator,Yr)},concat(...n){return Ya(this).concat(...n.map(t=>ut(t)?Ya(t):t))},entries(){return ym(this,"entries",n=>(n[1]=Yr(n[1]),n))},every(n,t){return es(this,"every",n,t,void 0,arguments)},filter(n,t){return es(this,"filter",n,t,r=>r.map(Yr),arguments)},find(n,t){return es(this,"find",n,t,Yr,arguments)},findIndex(n,t){return es(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return es(this,"findLast",n,t,Yr,arguments)},findLastIndex(n,t){return es(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return es(this,"forEach",n,t,void 0,arguments)},includes(...n){return vm(this,"includes",n)},indexOf(...n){return vm(this,"indexOf",n)},join(n){return Ya(this).join(n)},lastIndexOf(...n){return vm(this,"lastIndexOf",n)},map(n,t){return es(this,"map",n,t,void 0,arguments)},pop(){return Hl(this,"pop")},push(...n){return Hl(this,"push",n)},reduce(n,...t){return Sb(this,"reduce",n,t)},reduceRight(n,...t){return Sb(this,"reduceRight",n,t)},shift(){return Hl(this,"shift")},some(n,t){return es(this,"some",n,t,void 0,arguments)},splice(...n){return Hl(this,"splice",n)},toReversed(){return Ya(this).toReversed()},toSorted(n){return Ya(this).toSorted(n)},toSpliced(...n){return Ya(this).toSpliced(...n)},unshift(...n){return Hl(this,"unshift",n)},values(){return ym(this,"values",Yr)}};function ym(n,t,r){const i=Yp(n),s=i[t]();return i!==n&&!Jn(n)&&(s._next=s.next,s.next=()=>{const o=s._next();return o.value&&(o.value=r(o.value)),o}),s}const CF=Array.prototype;function es(n,t,r,i,s,o){const a=Yp(n),u=a!==n&&!Jn(n),l=a[t];if(l!==CF[t]){const f=l.apply(n,o);return u?Yr(f):f}let c=r;a!==n&&(u?c=function(f,d){return r.call(this,Yr(f),d,n)}:r.length>2&&(c=function(f,d){return r.call(this,f,d,n)}));const h=l.call(a,c,i);return u&&s?s(h):h}function Sb(n,t,r,i){const s=Yp(n);let o=r;return s!==n&&(Jn(n)?r.length>3&&(o=function(a,u,l){return r.call(this,a,u,l,n)}):o=function(a,u,l){return r.call(this,a,Yr(u),l,n)}),s[t](o,...i)}function vm(n,t,r){const i=Ot(n);tn(i,"iterate",jc);const s=i[t](...r);return(s===-1||s===!1)&&bv(r[0])?(r[0]=Ot(r[0]),i[t](...r)):s}function Hl(n,t,r=[]){vs(),pv();const i=Ot(n)[t].apply(n,r);return gv(),_s(),i}const AF=cv("__proto__,__v_isRef,__isVue"),p2=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ui));function TF(n){Ui(n)||(n=String(n));const t=Ot(this);return tn(t,"has",n),t.hasOwnProperty(n)}class g2{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,i){if(r==="__v_skip")return t.__v_skip;const s=this._isReadonly,o=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return o;if(r==="__v_raw")return i===(s?o?OF:_2:o?v2:y2).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const a=ut(t);if(!s){let l;if(a&&(l=SF[r]))return l;if(r==="hasOwnProperty")return TF}const u=Reflect.get(t,r,Sr(t)?t:i);return(Ui(r)?p2.has(r):AF(r))||(s||tn(t,"get",r),o)?u:Sr(u)?a&&dv(r)?u:u.value:sr(u)?s?x2(u):jh(u):u}}class m2 extends g2{constructor(t=!1){super(!1,t)}set(t,r,i,s){let o=t[r];if(!this._isShallow){const l=bo(o);if(!Jn(i)&&!bo(i)&&(o=Ot(o),i=Ot(i)),!ut(t)&&Sr(o)&&!Sr(i))return l?!1:(o.value=i,!0)}const a=ut(t)&&dv(r)?Number(r)<t.length:qt(t,r),u=Reflect.set(t,r,i,Sr(t)?t:s);return t===Ot(s)&&(a?uo(i,o)&&as(t,"set",r,i):as(t,"add",r,i)),u}deleteProperty(t,r){const i=qt(t,r);t[r];const s=Reflect.deleteProperty(t,r);return s&&i&&as(t,"delete",r,void 0),s}has(t,r){const i=Reflect.has(t,r);return(!Ui(r)||!p2.has(r))&&tn(t,"has",r),i}ownKeys(t){return tn(t,"iterate",ut(t)?"length":ha),Reflect.ownKeys(t)}}class IF extends g2{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const DF=new m2,kF=new IF,NF=new m2(!0);const k0=n=>n,xf=n=>Reflect.getPrototypeOf(n);function RF(n,t,r){return function(...i){const s=this.__v_raw,o=Ot(s),a=xu(o),u=n==="entries"||n===Symbol.iterator&&a,l=n==="keys"&&a,c=s[n](...i),h=r?k0:t?Ad:Yr;return!t&&tn(o,"iterate",l?D0:ha),{next(){const{value:f,done:d}=c.next();return d?{value:f,done:d}:{value:u?[h(f[0]),h(f[1])]:h(f),done:d}},[Symbol.iterator](){return this}}}}function wf(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function FF(n,t){const r={get(s){const o=this.__v_raw,a=Ot(o),u=Ot(s);n||(uo(s,u)&&tn(a,"get",s),tn(a,"get",u));const{has:l}=xf(a),c=t?k0:n?Ad:Yr;if(l.call(a,s))return c(o.get(s));if(l.call(a,u))return c(o.get(u));o!==a&&o.get(s)},get size(){const s=this.__v_raw;return!n&&tn(Ot(s),"iterate",ha),Reflect.get(s,"size",s)},has(s){const o=this.__v_raw,a=Ot(o),u=Ot(s);return n||(uo(s,u)&&tn(a,"has",s),tn(a,"has",u)),s===u?o.has(s):o.has(s)||o.has(u)},forEach(s,o){const a=this,u=a.__v_raw,l=Ot(u),c=t?k0:n?Ad:Yr;return!n&&tn(l,"iterate",ha),u.forEach((h,f)=>s.call(o,c(h),c(f),a))}};return un(r,n?{add:wf("add"),set:wf("set"),delete:wf("delete"),clear:wf("clear")}:{add(s){!t&&!Jn(s)&&!bo(s)&&(s=Ot(s));const o=Ot(this);return xf(o).has.call(o,s)||(o.add(s),as(o,"add",s,s)),this},set(s,o){!t&&!Jn(o)&&!bo(o)&&(o=Ot(o));const a=Ot(this),{has:u,get:l}=xf(a);let c=u.call(a,s);c||(s=Ot(s),c=u.call(a,s));const h=l.call(a,s);return a.set(s,o),c?uo(o,h)&&as(a,"set",s,o):as(a,"add",s,o),this},delete(s){const o=Ot(this),{has:a,get:u}=xf(o);let l=a.call(o,s);l||(s=Ot(s),l=a.call(o,s)),u&&u.call(o,s);const c=o.delete(s);return l&&as(o,"delete",s,void 0),c},clear(){const s=Ot(this),o=s.size!==0,a=s.clear();return o&&as(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=RF(s,n,t)}),r}function vv(n,t){const r=FF(n,t);return(i,s,o)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?i:Reflect.get(qt(r,s)&&s in i?r:i,s,o)}const PF={get:vv(!1,!1)},MF={get:vv(!1,!0)},LF={get:vv(!0,!1)};const y2=new WeakMap,v2=new WeakMap,_2=new WeakMap,OF=new WeakMap;function VF(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function BF(n){return n.__v_skip||!Object.isExtensible(n)?0:VF(lF(n))}function jh(n){return bo(n)?n:_v(n,!1,DF,PF,y2)}function b2(n){return _v(n,!1,NF,MF,v2)}function x2(n){return _v(n,!0,kF,LF,_2)}function _v(n,t,r,i,s){if(!sr(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const o=BF(n);if(o===0)return n;const a=s.get(n);if(a)return a;const u=new Proxy(n,o===2?i:r);return s.set(n,u),u}function lo(n){return bo(n)?lo(n.__v_raw):!!(n&&n.__v_isReactive)}function bo(n){return!!(n&&n.__v_isReadonly)}function Jn(n){return!!(n&&n.__v_isShallow)}function bv(n){return n?!!n.__v_raw:!1}function Ot(n){const t=n&&n.__v_raw;return t?Ot(t):n}function xv(n){return!qt(n,"__v_skip")&&Object.isExtensible(n)&&T0(n,"__v_skip",!0),n}const Yr=n=>sr(n)?jh(n):n,Ad=n=>sr(n)?x2(n):n;function Sr(n){return n?n.__v_isRef===!0:!1}function Ht(n){return w2(n,!1)}function UF(n){return w2(n,!0)}function w2(n,t){return Sr(n)?n:new $F(n,t)}class $F{constructor(t,r){this.dep=new yv,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:Ot(t),this._value=r?t:Yr(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,i=this.__v_isShallow||Jn(t)||bo(t);t=i?t:Ot(t),uo(t,r)&&(this._rawValue=t,this._value=i?t:Yr(t),this.dep.trigger())}}function Er(n){return Sr(n)?n.value:n}const jF={get:(n,t,r)=>t==="__v_raw"?n:Er(Reflect.get(n,t,r)),set:(n,t,r,i)=>{const s=n[t];return Sr(s)&&!Sr(r)?(s.value=r,!0):Reflect.set(n,t,r,i)}};function E2(n){return lo(n)?n:new Proxy(n,jF)}function GF(n){const t=ut(n)?new Array(n.length):{};for(const r in n)t[r]=qF(n,r);return t}class zF{constructor(t,r,i){this._object=t,this._key=r,this._defaultValue=i,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return EF(Ot(this._object),this._key)}}function qF(n,t,r){const i=n[t];return Sr(i)?i:new zF(n,t,r)}class HF{constructor(t,r,i){this.fn=t,this.setter=r,this._value=void 0,this.dep=new yv(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$c-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&rr!==this)return u2(this,!0),!0}get value(){const t=this.dep.track();return h2(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function WF(n,t,r=!1){let i,s;return bt(n)?i=n:(i=n.get,s=n.set),new HF(i,s,r)}const Ef={},Td=new WeakMap;let qo;function KF(n,t=!1,r=qo){if(r){let i=Td.get(r);i||Td.set(r,i=[]),i.push(n)}}function YF(n,t,r=tr){const{immediate:i,deep:s,once:o,scheduler:a,augmentJob:u,call:l}=r,c=E=>s?E:Jn(E)||s===!1||s===0?us(E,1):us(E);let h,f,d,p,g=!1,y=!1;if(Sr(n)?(f=()=>n.value,g=Jn(n)):lo(n)?(f=()=>c(n),g=!0):ut(n)?(y=!0,g=n.some(E=>lo(E)||Jn(E)),f=()=>n.map(E=>{if(Sr(E))return E.value;if(lo(E))return c(E);if(bt(E))return l?l(E,2):E()})):bt(n)?t?f=l?()=>l(n,2):n:f=()=>{if(d){vs();try{d()}finally{_s()}}const E=qo;qo=h;try{return l?l(n,3,[p]):n(p)}finally{qo=E}}:f=Mi,t&&s){const E=f,S=s===!0?1/0:s;f=()=>us(E(),S)}const v=s2(),T=()=>{h.stop(),v&&v.active&&fv(v.effects,h)};if(o&&t){const E=t;t=(...S)=>{E(...S),T()}}let _=y?new Array(n.length).fill(Ef):Ef;const C=E=>{if(!(!(h.flags&1)||!h.dirty&&!E))if(t){const S=h.run();if(s||g||(y?S.some((R,w)=>uo(R,_[w])):uo(S,_))){d&&d();const R=qo;qo=h;try{const w=[S,_===Ef?void 0:y&&_[0]===Ef?[]:_,p];_=S,l?l(t,3,w):t(...w)}finally{qo=R}}}else h.run()};return u&&u(C),h=new o2(f),h.scheduler=a?()=>a(C,!1):C,p=E=>KF(E,!1,h),d=h.onStop=()=>{const E=Td.get(h);if(E){if(l)l(E,4);else for(const S of E)S();Td.delete(h)}},t?i?C(!0):_=h.run():a?a(C.bind(null,!0),!0):h.run(),T.pause=h.pause.bind(h),T.resume=h.resume.bind(h),T.stop=T,T}function us(n,t=1/0,r){if(t<=0||!sr(n)||n.__v_skip||(r=r||new Set,r.has(n)))return n;if(r.add(n),t--,Sr(n))us(n.value,t,r);else if(ut(n))for(let i=0;i<n.length;i++)us(n[i],t,r);else if(zp(n)||xu(n))n.forEach(i=>{us(i,t,r)});else if(JC(n)){for(const i in n)us(n[i],t,r);for(const i of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,i)&&us(n[i],t,r)}return n}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Gh(n,t,r,i){try{return i?n(...i):n()}catch(s){Xp(s,t,r)}}function $i(n,t,r,i){if(bt(n)){const s=Gh(n,t,r,i);return s&&ZC(s)&&s.catch(o=>{Xp(o,t,r)}),s}if(ut(n)){const s=[];for(let o=0;o<n.length;o++)s.push($i(n[o],t,r,i));return s}}function Xp(n,t,r,i=!0){const s=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||tr;if(t){let u=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;u;){const h=u.ec;if(h){for(let f=0;f<h.length;f++)if(h[f](n,l,c)===!1)return}u=u.parent}if(o){vs(),Gh(o,null,10,[n,l,c]),_s();return}}XF(n,r,s,i,a)}function XF(n,t,r,i=!0,s=!1){if(s)throw n;console.error(n)}const gn=[];let Ii=-1;const wu=[];let zs=null,au=0;const S2=Promise.resolve();let Id=null;function eo(n){const t=Id||S2;return n?t.then(this?n.bind(this):n):t}function ZF(n){let t=Ii+1,r=gn.length;for(;t<r;){const i=t+r>>>1,s=gn[i],o=Gc(s);o<n||o===n&&s.flags&2?t=i+1:r=i}return t}function wv(n){if(!(n.flags&1)){const t=Gc(n),r=gn[gn.length-1];!r||!(n.flags&2)&&t>=Gc(r)?gn.push(n):gn.splice(ZF(t),0,n),n.flags|=1,C2()}}function C2(){Id||(Id=S2.then(T2))}function QF(n){ut(n)?wu.push(...n):zs&&n.id===-1?zs.splice(au+1,0,n):n.flags&1||(wu.push(n),n.flags|=1),C2()}function Cb(n,t,r=Ii+1){for(;r<gn.length;r++){const i=gn[r];if(i&&i.flags&2){if(n&&i.id!==n.uid)continue;gn.splice(r,1),r--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function A2(n){if(wu.length){const t=[...new Set(wu)].sort((r,i)=>Gc(r)-Gc(i));if(wu.length=0,zs){zs.push(...t);return}for(zs=t,au=0;au<zs.length;au++){const r=zs[au];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}zs=null,au=0}}const Gc=n=>n.id==null?n.flags&2?-1:1/0:n.id;function T2(n){try{for(Ii=0;Ii<gn.length;Ii++){const t=gn[Ii];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Gh(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ii<gn.length;Ii++){const t=gn[Ii];t&&(t.flags&=-2)}Ii=-1,gn.length=0,A2(),Id=null,(gn.length||wu.length)&&T2()}}let Un=null,I2=null;function Dd(n){const t=Un;return Un=n,I2=n&&n.type.__scopeId||null,t}function JF(n,t=Un,r){if(!t||n._n)return n;const i=(...s)=>{i._d&&Mb(-1);const o=Dd(t);let a;try{a=n(...s)}finally{Dd(o),i._d&&Mb(1)}return a};return i._n=!0,i._c=!0,i._d=!0,i}function cr(n,t){if(Un===null)return n;const r=eg(Un),i=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[o,a,u,l=tr]=t[s];o&&(bt(o)&&(o={mounted:o,updated:o}),o.deep&&us(a),i.push({dir:o,instance:r,value:a,oldValue:void 0,arg:u,modifiers:l}))}return n}function $o(n,t,r,i){const s=n.dirs,o=t&&t.dirs;for(let a=0;a<s.length;a++){const u=s[a];o&&(u.oldValue=o[a].value);let l=u.dir[i];l&&(vs(),$i(l,r,8,[n.el,u,n,t]),_s())}}const eP=Symbol("_vte"),tP=n=>n.__isTeleport;function Ev(n,t){n.shapeFlag&6&&n.component?(n.transition=t,Ev(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}/*! #__NO_SIDE_EFFECTS__ */function D2(n,t){return bt(n)?un({name:n.name},t,{setup:n}):n}function k2(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function mc(n,t,r,i,s=!1){if(ut(n)){n.forEach((g,y)=>mc(g,t&&(ut(t)?t[y]:t),r,i,s));return}if(yc(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&mc(n,t,r,i.component.subTree);return}const o=i.shapeFlag&4?eg(i.component):i.el,a=s?null:o,{i:u,r:l}=n,c=t&&t.r,h=u.refs===tr?u.refs={}:u.refs,f=u.setupState,d=Ot(f),p=f===tr?()=>!1:g=>qt(d,g);if(c!=null&&c!==l&&(kr(c)?(h[c]=null,p(c)&&(f[c]=null)):Sr(c)&&(c.value=null)),bt(l))Gh(l,u,12,[a,h]);else{const g=kr(l),y=Sr(l);if(g||y){const v=()=>{if(n.f){const T=g?p(l)?f[l]:h[l]:l.value;s?ut(T)&&fv(T,o):ut(T)?T.includes(o)||T.push(o):g?(h[l]=[o],p(l)&&(f[l]=h[l])):(l.value=[o],n.k&&(h[n.k]=l.value))}else g?(h[l]=a,p(l)&&(f[l]=a)):y&&(l.value=a,n.k&&(h[n.k]=a))};a?(v.id=-1,On(v,r)):v()}}}Wp().requestIdleCallback;Wp().cancelIdleCallback;const yc=n=>!!n.type.__asyncLoader,N2=n=>n.type.__isKeepAlive;function rP(n,t){R2(n,"a",t)}function nP(n,t){R2(n,"da",t)}function R2(n,t,r=sn){const i=n.__wdc||(n.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Zp(t,i,r),r){let s=r.parent;for(;s&&s.parent;)N2(s.parent.vnode)&&iP(i,t,r,s),s=s.parent}}function iP(n,t,r,i){const s=Zp(t,n,i,!0);Sv(()=>{fv(i[t],s)},r)}function Zp(n,t,r=sn,i=!1){if(r){const s=r[n]||(r[n]=[]),o=t.__weh||(t.__weh=(...a)=>{vs();const u=zh(r),l=$i(t,r,n,a);return u(),_s(),l});return i?s.unshift(o):s.push(o),o}}const Ts=n=>(t,r=sn)=>{(!qc||n==="sp")&&Zp(n,(...i)=>t(...i),r)},sP=Ts("bm"),Ki=Ts("m"),oP=Ts("bu"),aP=Ts("u"),uP=Ts("bum"),Sv=Ts("um"),lP=Ts("sp"),cP=Ts("rtg"),hP=Ts("rtc");function fP(n,t=sn){Zp("ec",n,t)}const dP="components";function pP(n,t){return mP(dP,n,!0,t)||n}const gP=Symbol.for("v-ndc");function mP(n,t,r=!0,i=!1){const s=Un||sn;if(s){const o=s.type;{const u=nM(o,!1);if(u&&(u===t||u===ii(t)||u===Hp(ii(t))))return o}const a=Ab(s[n]||o[n],t)||Ab(s.appContext[n],t);return!a&&i?o:a}}function Ab(n,t){return n&&(n[t]||n[ii(t)]||n[Hp(ii(t))])}function ji(n,t,r,i){let s;const o=r,a=ut(n);if(a||kr(n)){const u=a&&lo(n);let l=!1,c=!1;u&&(l=!Jn(n),c=bo(n),n=Yp(n)),s=new Array(n.length);for(let h=0,f=n.length;h<f;h++)s[h]=t(l?c?Ad(Yr(n[h])):Yr(n[h]):n[h],h,void 0,o)}else if(typeof n=="number"){s=new Array(n);for(let u=0;u<n;u++)s[u]=t(u+1,u,void 0,o)}else if(sr(n))if(n[Symbol.iterator])s=Array.from(n,(u,l)=>t(u,l,void 0,o));else{const u=Object.keys(n);s=new Array(u.length);for(let l=0,c=u.length;l<c;l++){const h=u[l];s[l]=t(n[h],h,l,o)}}else s=[];return s}const N0=n=>n?J2(n)?eg(n):N0(n.parent):null,vc=un(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>N0(n.parent),$root:n=>N0(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>P2(n),$forceUpdate:n=>n.f||(n.f=()=>{wv(n.update)}),$nextTick:n=>n.n||(n.n=eo.bind(n.proxy)),$watch:n=>VP.bind(n)}),_m=(n,t)=>n!==tr&&!n.__isScriptSetup&&qt(n,t),yP={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:i,data:s,props:o,accessCache:a,type:u,appContext:l}=n;let c;if(t[0]!=="$"){const p=a[t];if(p!==void 0)switch(p){case 1:return i[t];case 2:return s[t];case 4:return r[t];case 3:return o[t]}else{if(_m(i,t))return a[t]=1,i[t];if(s!==tr&&qt(s,t))return a[t]=2,s[t];if((c=n.propsOptions[0])&&qt(c,t))return a[t]=3,o[t];if(r!==tr&&qt(r,t))return a[t]=4,r[t];R0&&(a[t]=0)}}const h=vc[t];let f,d;if(h)return t==="$attrs"&&tn(n.attrs,"get",""),h(n);if((f=u.__cssModules)&&(f=f[t]))return f;if(r!==tr&&qt(r,t))return a[t]=4,r[t];if(d=l.config.globalProperties,qt(d,t))return d[t]},set({_:n},t,r){const{data:i,setupState:s,ctx:o}=n;return _m(s,t)?(s[t]=r,!0):i!==tr&&qt(i,t)?(i[t]=r,!0):qt(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(o[t]=r,!0)},has({_:{data:n,setupState:t,accessCache:r,ctx:i,appContext:s,propsOptions:o}},a){let u;return!!r[a]||n!==tr&&qt(n,a)||_m(t,a)||(u=o[0])&&qt(u,a)||qt(i,a)||qt(vc,a)||qt(s.config.globalProperties,a)},defineProperty(n,t,r){return r.get!=null?n._.accessCache[t]=0:qt(r,"value")&&this.set(n,t,r.value,null),Reflect.defineProperty(n,t,r)}};function Tb(n){return ut(n)?n.reduce((t,r)=>(t[r]=null,t),{}):n}let R0=!0;function vP(n){const t=P2(n),r=n.proxy,i=n.ctx;R0=!1,t.beforeCreate&&Ib(t.beforeCreate,n,"bc");const{data:s,computed:o,methods:a,watch:u,provide:l,inject:c,created:h,beforeMount:f,mounted:d,beforeUpdate:p,updated:g,activated:y,deactivated:v,beforeDestroy:T,beforeUnmount:_,destroyed:C,unmounted:E,render:S,renderTracked:R,renderTriggered:w,errorCaptured:x,serverPrefetch:b,expose:A,inheritAttrs:k,components:N,directives:I,filters:j}=t;if(c&&_P(c,i,null),a)for(const fe in a){const ne=a[fe];bt(ne)&&(i[fe]=ne.bind(r))}if(s){const fe=s.call(r,r);sr(fe)&&(n.data=jh(fe))}if(R0=!0,o)for(const fe in o){const ne=o[fe],oe=bt(ne)?ne.bind(r,r):bt(ne.get)?ne.get.bind(r,r):Mi,ie=!bt(ne)&&bt(ne.set)?ne.set.bind(r):Mi,ue=gr({get:oe,set:ie});Object.defineProperty(i,fe,{enumerable:!0,configurable:!0,get:()=>ue.value,set:ee=>ue.value=ee})}if(u)for(const fe in u)F2(u[fe],i,r,fe);if(l){const fe=bt(l)?l.call(r):l;Reflect.ownKeys(fe).forEach(ne=>{Qf(ne,fe[ne])})}h&&Ib(h,n,"c");function le(fe,ne){ut(ne)?ne.forEach(oe=>fe(oe.bind(r))):ne&&fe(ne.bind(r))}if(le(sP,f),le(Ki,d),le(oP,p),le(aP,g),le(rP,y),le(nP,v),le(fP,x),le(hP,R),le(cP,w),le(uP,_),le(Sv,E),le(lP,b),ut(A))if(A.length){const fe=n.exposed||(n.exposed={});A.forEach(ne=>{Object.defineProperty(fe,ne,{get:()=>r[ne],set:oe=>r[ne]=oe,enumerable:!0})})}else n.exposed||(n.exposed={});S&&n.render===Mi&&(n.render=S),k!=null&&(n.inheritAttrs=k),N&&(n.components=N),I&&(n.directives=I),b&&k2(n)}function _P(n,t,r=Mi){ut(n)&&(n=F0(n));for(const i in n){const s=n[i];let o;sr(s)?"default"in s?o=ei(s.from||i,s.default,!0):o=ei(s.from||i):o=ei(s),Sr(o)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):t[i]=o}}function Ib(n,t,r){$i(ut(n)?n.map(i=>i.bind(t.proxy)):n.bind(t.proxy),t,r)}function F2(n,t,r,i){let s=i.includes(".")?W2(r,i):()=>r[i];if(kr(n)){const o=t[n];bt(o)&&co(s,o)}else if(bt(n))co(s,n.bind(r));else if(sr(n))if(ut(n))n.forEach(o=>F2(o,t,r,i));else{const o=bt(n.handler)?n.handler.bind(r):t[n.handler];bt(o)&&co(s,o,n)}}function P2(n){const t=n.type,{mixins:r,extends:i}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:a}}=n.appContext,u=o.get(t);let l;return u?l=u:!s.length&&!r&&!i?l=t:(l={},s.length&&s.forEach(c=>kd(l,c,a,!0)),kd(l,t,a)),sr(t)&&o.set(t,l),l}function kd(n,t,r,i=!1){const{mixins:s,extends:o}=t;o&&kd(n,o,r,!0),s&&s.forEach(a=>kd(n,a,r,!0));for(const a in t)if(!(i&&a==="expose")){const u=bP[a]||r&&r[a];n[a]=u?u(n[a],t[a]):t[a]}return n}const bP={data:Db,props:kb,emits:kb,methods:sc,computed:sc,beforeCreate:cn,created:cn,beforeMount:cn,mounted:cn,beforeUpdate:cn,updated:cn,beforeDestroy:cn,beforeUnmount:cn,destroyed:cn,unmounted:cn,activated:cn,deactivated:cn,errorCaptured:cn,serverPrefetch:cn,components:sc,directives:sc,watch:wP,provide:Db,inject:xP};function Db(n,t){return t?n?function(){return un(bt(n)?n.call(this,this):n,bt(t)?t.call(this,this):t)}:t:n}function xP(n,t){return sc(F0(n),F0(t))}function F0(n){if(ut(n)){const t={};for(let r=0;r<n.length;r++)t[n[r]]=n[r];return t}return n}function cn(n,t){return n?[...new Set([].concat(n,t))]:t}function sc(n,t){return n?un(Object.create(null),n,t):t}function kb(n,t){return n?ut(n)&&ut(t)?[...new Set([...n,...t])]:un(Object.create(null),Tb(n),Tb(t??{})):t}function wP(n,t){if(!n)return t;if(!t)return n;const r=un(Object.create(null),n);for(const i in t)r[i]=cn(n[i],t[i]);return r}function M2(){return{app:null,config:{isNativeTag:aF,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let EP=0;function SP(n,t){return function(i,s=null){bt(i)||(i=un({},i)),s!=null&&!sr(s)&&(s=null);const o=M2(),a=new WeakSet,u=[];let l=!1;const c=o.app={_uid:EP++,_component:i,_props:s,_container:null,_context:o,_instance:null,version:sM,get config(){return o.config},set config(h){},use(h,...f){return a.has(h)||(h&&bt(h.install)?(a.add(h),h.install(c,...f)):bt(h)&&(a.add(h),h(c,...f))),c},mixin(h){return o.mixins.includes(h)||o.mixins.push(h),c},component(h,f){return f?(o.components[h]=f,c):o.components[h]},directive(h,f){return f?(o.directives[h]=f,c):o.directives[h]},mount(h,f,d){if(!l){const p=c._ceVNode||Xr(i,s);return p.appContext=o,d===!0?d="svg":d===!1&&(d=void 0),n(p,h,d),l=!0,c._container=h,h.__vue_app__=c,eg(p.component)}},onUnmount(h){u.push(h)},unmount(){l&&($i(u,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(h,f){return o.provides[h]=f,c},runWithContext(h){const f=fa;fa=c;try{return h()}finally{fa=f}}};return c}}let fa=null;function Qf(n,t){if(sn){let r=sn.provides;const i=sn.parent&&sn.parent.provides;i===r&&(r=sn.provides=Object.create(i)),r[n]=t}}function ei(n,t,r=!1){const i=Q2();if(i||fa){let s=fa?fa._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return r&&bt(t)?t.call(i&&i.proxy):t}}function CP(){return!!(Q2()||fa)}const L2={},O2=()=>Object.create(L2),V2=n=>Object.getPrototypeOf(n)===L2;function AP(n,t,r,i=!1){const s={},o=O2();n.propsDefaults=Object.create(null),B2(n,t,s,o);for(const a in n.propsOptions[0])a in s||(s[a]=void 0);r?n.props=i?s:b2(s):n.type.props?n.props=s:n.props=o,n.attrs=o}function TP(n,t,r,i){const{props:s,attrs:o,vnode:{patchFlag:a}}=n,u=Ot(s),[l]=n.propsOptions;let c=!1;if((i||a>0)&&!(a&16)){if(a&8){const h=n.vnode.dynamicProps;for(let f=0;f<h.length;f++){let d=h[f];if(Qp(n.emitsOptions,d))continue;const p=t[d];if(l)if(qt(o,d))p!==o[d]&&(o[d]=p,c=!0);else{const g=ii(d);s[g]=P0(l,u,g,p,n,!1)}else p!==o[d]&&(o[d]=p,c=!0)}}}else{B2(n,t,s,o)&&(c=!0);let h;for(const f in u)(!t||!qt(t,f)&&((h=Fo(f))===f||!qt(t,h)))&&(l?r&&(r[f]!==void 0||r[h]!==void 0)&&(s[f]=P0(l,u,f,void 0,n,!0)):delete s[f]);if(o!==u)for(const f in o)(!t||!qt(t,f))&&(delete o[f],c=!0)}c&&as(n.attrs,"set","")}function B2(n,t,r,i){const[s,o]=n.propsOptions;let a=!1,u;if(t)for(let l in t){if(dc(l))continue;const c=t[l];let h;s&&qt(s,h=ii(l))?!o||!o.includes(h)?r[h]=c:(u||(u={}))[h]=c:Qp(n.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,a=!0)}if(o){const l=Ot(r),c=u||tr;for(let h=0;h<o.length;h++){const f=o[h];r[f]=P0(s,l,f,c[f],n,!qt(c,f))}}return a}function P0(n,t,r,i,s,o){const a=n[r];if(a!=null){const u=qt(a,"default");if(u&&i===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&bt(l)){const{propsDefaults:c}=s;if(r in c)i=c[r];else{const h=zh(s);i=c[r]=l.call(null,t),h()}}else i=l;s.ce&&s.ce._setProp(r,i)}a[0]&&(o&&!u?i=!1:a[1]&&(i===""||i===Fo(r))&&(i=!0))}return i}const IP=new WeakMap;function U2(n,t,r=!1){const i=r?IP:t.propsCache,s=i.get(n);if(s)return s;const o=n.props,a={},u=[];let l=!1;if(!bt(n)){const h=f=>{l=!0;const[d,p]=U2(f,t,!0);un(a,d),p&&u.push(...p)};!r&&t.mixins.length&&t.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!o&&!l)return sr(n)&&i.set(n,bu),bu;if(ut(o))for(let h=0;h<o.length;h++){const f=ii(o[h]);Nb(f)&&(a[f]=tr)}else if(o)for(const h in o){const f=ii(h);if(Nb(f)){const d=o[h],p=a[f]=ut(d)||bt(d)?{type:d}:un({},d),g=p.type;let y=!1,v=!0;if(ut(g))for(let T=0;T<g.length;++T){const _=g[T],C=bt(_)&&_.name;if(C==="Boolean"){y=!0;break}else C==="String"&&(v=!1)}else y=bt(g)&&g.name==="Boolean";p[0]=y,p[1]=v,(y||qt(p,"default"))&&u.push(f)}}const c=[a,u];return sr(n)&&i.set(n,c),c}function Nb(n){return n[0]!=="$"&&!dc(n)}const Cv=n=>n==="_"||n==="__"||n==="_ctx"||n==="$stable",Av=n=>ut(n)?n.map(Ni):[Ni(n)],DP=(n,t,r)=>{if(t._n)return t;const i=JF((...s)=>Av(t(...s)),r);return i._c=!1,i},$2=(n,t,r)=>{const i=n._ctx;for(const s in n){if(Cv(s))continue;const o=n[s];if(bt(o))t[s]=DP(s,o,i);else if(o!=null){const a=Av(o);t[s]=()=>a}}},j2=(n,t)=>{const r=Av(t);n.slots.default=()=>r},G2=(n,t,r)=>{for(const i in t)(r||!Cv(i))&&(n[i]=t[i])},kP=(n,t,r)=>{const i=n.slots=O2();if(n.vnode.shapeFlag&32){const s=t.__;s&&T0(i,"__",s,!0);const o=t._;o?(G2(i,t,r),r&&T0(i,"_",o,!0)):$2(t,i)}else t&&j2(n,t)},NP=(n,t,r)=>{const{vnode:i,slots:s}=n;let o=!0,a=tr;if(i.shapeFlag&32){const u=t._;u?r&&u===1?o=!1:G2(s,t,r):(o=!t.$stable,$2(t,s)),a=t}else t&&(j2(n,t),a={default:1});if(o)for(const u in s)!Cv(u)&&a[u]==null&&delete s[u]},On=qP;function RP(n){return FP(n)}function FP(n,t){const r=Wp();r.__VUE__=!0;const{insert:i,remove:s,patchProp:o,createElement:a,createText:u,createComment:l,setText:c,setElementText:h,parentNode:f,nextSibling:d,setScopeId:p=Mi,insertStaticContent:g}=n,y=(G,W,X,V=null,L=null,z=null,J=void 0,re=null,te=!!W.dynamicChildren)=>{if(G===W)return;G&&!Wl(G,W)&&(V=ae(G),ee(G,L,z,!0),G=null),W.patchFlag===-2&&(te=!1,W.dynamicChildren=null);const{type:me,ref:Ee,shapeFlag:Ce}=W;switch(me){case Jp:v(G,W,X,V);break;case xo:T(G,W,X,V);break;case xm:G==null&&_(W,X,V,J);break;case Or:N(G,W,X,V,L,z,J,re,te);break;default:Ce&1?S(G,W,X,V,L,z,J,re,te):Ce&6?I(G,W,X,V,L,z,J,re,te):(Ce&64||Ce&128)&&me.process(G,W,X,V,L,z,J,re,te,he)}Ee!=null&&L?mc(Ee,G&&G.ref,z,W||G,!W):Ee==null&&G&&G.ref!=null&&mc(G.ref,null,z,G,!0)},v=(G,W,X,V)=>{if(G==null)i(W.el=u(W.children),X,V);else{const L=W.el=G.el;W.children!==G.children&&c(L,W.children)}},T=(G,W,X,V)=>{G==null?i(W.el=l(W.children||""),X,V):W.el=G.el},_=(G,W,X,V)=>{[G.el,G.anchor]=g(G.children,W,X,V,G.el,G.anchor)},C=({el:G,anchor:W},X,V)=>{let L;for(;G&&G!==W;)L=d(G),i(G,X,V),G=L;i(W,X,V)},E=({el:G,anchor:W})=>{let X;for(;G&&G!==W;)X=d(G),s(G),G=X;s(W)},S=(G,W,X,V,L,z,J,re,te)=>{W.type==="svg"?J="svg":W.type==="math"&&(J="mathml"),G==null?R(W,X,V,L,z,J,re,te):b(G,W,L,z,J,re,te)},R=(G,W,X,V,L,z,J,re)=>{let te,me;const{props:Ee,shapeFlag:Ce,transition:Fe,dirs:De}=G;if(te=G.el=a(G.type,z,Ee&&Ee.is,Ee),Ce&8?h(te,G.children):Ce&16&&x(G.children,te,null,V,L,bm(G,z),J,re),De&&$o(G,null,V,"created"),w(te,G,G.scopeId,J,V),Ee){for(const Me in Ee)Me!=="value"&&!dc(Me)&&o(te,Me,null,Ee[Me],z,V);"value"in Ee&&o(te,"value",null,Ee.value,z),(me=Ee.onVnodeBeforeMount)&&Ci(me,V,G)}De&&$o(G,null,V,"beforeMount");const ze=PP(L,Fe);ze&&Fe.beforeEnter(te),i(te,W,X),((me=Ee&&Ee.onVnodeMounted)||ze||De)&&On(()=>{me&&Ci(me,V,G),ze&&Fe.enter(te),De&&$o(G,null,V,"mounted")},L)},w=(G,W,X,V,L)=>{if(X&&p(G,X),V)for(let z=0;z<V.length;z++)p(G,V[z]);if(L){let z=L.subTree;if(W===z||Y2(z.type)&&(z.ssContent===W||z.ssFallback===W)){const J=L.vnode;w(G,J,J.scopeId,J.slotScopeIds,L.parent)}}},x=(G,W,X,V,L,z,J,re,te=0)=>{for(let me=te;me<G.length;me++){const Ee=G[me]=re?qs(G[me]):Ni(G[me]);y(null,Ee,W,X,V,L,z,J,re)}},b=(G,W,X,V,L,z,J)=>{const re=W.el=G.el;let{patchFlag:te,dynamicChildren:me,dirs:Ee}=W;te|=G.patchFlag&16;const Ce=G.props||tr,Fe=W.props||tr;let De;if(X&&jo(X,!1),(De=Fe.onVnodeBeforeUpdate)&&Ci(De,X,W,G),Ee&&$o(W,G,X,"beforeUpdate"),X&&jo(X,!0),(Ce.innerHTML&&Fe.innerHTML==null||Ce.textContent&&Fe.textContent==null)&&h(re,""),me?A(G.dynamicChildren,me,re,X,V,bm(W,L),z):J||ne(G,W,re,null,X,V,bm(W,L),z,!1),te>0){if(te&16)k(re,Ce,Fe,X,L);else if(te&2&&Ce.class!==Fe.class&&o(re,"class",null,Fe.class,L),te&4&&o(re,"style",Ce.style,Fe.style,L),te&8){const ze=W.dynamicProps;for(let Me=0;Me<ze.length;Me++){const Ue=ze[Me],Qe=Ce[Ue],kt=Fe[Ue];(kt!==Qe||Ue==="value")&&o(re,Ue,Qe,kt,L,X)}}te&1&&G.children!==W.children&&h(re,W.children)}else!J&&me==null&&k(re,Ce,Fe,X,L);((De=Fe.onVnodeUpdated)||Ee)&&On(()=>{De&&Ci(De,X,W,G),Ee&&$o(W,G,X,"updated")},V)},A=(G,W,X,V,L,z,J)=>{for(let re=0;re<W.length;re++){const te=G[re],me=W[re],Ee=te.el&&(te.type===Or||!Wl(te,me)||te.shapeFlag&198)?f(te.el):X;y(te,me,Ee,null,V,L,z,J,!0)}},k=(G,W,X,V,L)=>{if(W!==X){if(W!==tr)for(const z in W)!dc(z)&&!(z in X)&&o(G,z,W[z],null,L,V);for(const z in X){if(dc(z))continue;const J=X[z],re=W[z];J!==re&&z!=="value"&&o(G,z,re,J,L,V)}"value"in X&&o(G,"value",W.value,X.value,L)}},N=(G,W,X,V,L,z,J,re,te)=>{const me=W.el=G?G.el:u(""),Ee=W.anchor=G?G.anchor:u("");let{patchFlag:Ce,dynamicChildren:Fe,slotScopeIds:De}=W;De&&(re=re?re.concat(De):De),G==null?(i(me,X,V),i(Ee,X,V),x(W.children||[],X,Ee,L,z,J,re,te)):Ce>0&&Ce&64&&Fe&&G.dynamicChildren?(A(G.dynamicChildren,Fe,X,L,z,J,re),(W.key!=null||L&&W===L.subTree)&&z2(G,W,!0)):ne(G,W,X,Ee,L,z,J,re,te)},I=(G,W,X,V,L,z,J,re,te)=>{W.slotScopeIds=re,G==null?W.shapeFlag&512?L.ctx.activate(W,X,V,J,te):j(W,X,V,L,z,J,te):Q(G,W,te)},j=(G,W,X,V,L,z,J)=>{const re=G.component=QP(G,V,L);if(N2(G)&&(re.ctx.renderer=he),JP(re,!1,J),re.asyncDep){if(L&&L.registerDep(re,le,J),!G.el){const te=re.subTree=Xr(xo);T(null,te,W,X),G.placeholder=te.el}}else le(re,G,W,X,L,z,J)},Q=(G,W,X)=>{const V=W.component=G.component;if(GP(G,W,X))if(V.asyncDep&&!V.asyncResolved){fe(V,W,X);return}else V.next=W,V.update();else W.el=G.el,V.vnode=W},le=(G,W,X,V,L,z,J)=>{const re=()=>{if(G.isMounted){let{next:Ce,bu:Fe,u:De,parent:ze,vnode:Me}=G;{const lt=q2(G);if(lt){Ce&&(Ce.el=Me.el,fe(G,Ce,J)),lt.asyncDep.then(()=>{G.isUnmounted||re()});return}}let Ue=Ce,Qe;jo(G,!1),Ce?(Ce.el=Me.el,fe(G,Ce,J)):Ce=Me,Fe&&Zf(Fe),(Qe=Ce.props&&Ce.props.onVnodeBeforeUpdate)&&Ci(Qe,ze,Ce,Me),jo(G,!0);const kt=Fb(G),Lt=G.subTree;G.subTree=kt,y(Lt,kt,f(Lt.el),ae(Lt),G,L,z),Ce.el=kt.el,Ue===null&&zP(G,kt.el),De&&On(De,L),(Qe=Ce.props&&Ce.props.onVnodeUpdated)&&On(()=>Ci(Qe,ze,Ce,Me),L)}else{let Ce;const{el:Fe,props:De}=W,{bm:ze,m:Me,parent:Ue,root:Qe,type:kt}=G,Lt=yc(W);jo(G,!1),ze&&Zf(ze),!Lt&&(Ce=De&&De.onVnodeBeforeMount)&&Ci(Ce,Ue,W),jo(G,!0);{Qe.ce&&Qe.ce._def.shadowRoot!==!1&&Qe.ce._injectChildStyle(kt);const lt=G.subTree=Fb(G);y(null,lt,X,V,G,L,z),W.el=lt.el}if(Me&&On(Me,L),!Lt&&(Ce=De&&De.onVnodeMounted)){const lt=W;On(()=>Ci(Ce,Ue,lt),L)}(W.shapeFlag&256||Ue&&yc(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&G.a&&On(G.a,L),G.isMounted=!0,W=X=V=null}};G.scope.on();const te=G.effect=new o2(re);G.scope.off();const me=G.update=te.run.bind(te),Ee=G.job=te.runIfDirty.bind(te);Ee.i=G,Ee.id=G.uid,te.scheduler=()=>wv(Ee),jo(G,!0),me()},fe=(G,W,X)=>{W.component=G;const V=G.vnode.props;G.vnode=W,G.next=null,TP(G,W.props,V,X),NP(G,W.children,X),vs(),Cb(G),_s()},ne=(G,W,X,V,L,z,J,re,te=!1)=>{const me=G&&G.children,Ee=G?G.shapeFlag:0,Ce=W.children,{patchFlag:Fe,shapeFlag:De}=W;if(Fe>0){if(Fe&128){ie(me,Ce,X,V,L,z,J,re,te);return}else if(Fe&256){oe(me,Ce,X,V,L,z,J,re,te);return}}De&8?(Ee&16&&Se(me,L,z),Ce!==me&&h(X,Ce)):Ee&16?De&16?ie(me,Ce,X,V,L,z,J,re,te):Se(me,L,z,!0):(Ee&8&&h(X,""),De&16&&x(Ce,X,V,L,z,J,re,te))},oe=(G,W,X,V,L,z,J,re,te)=>{G=G||bu,W=W||bu;const me=G.length,Ee=W.length,Ce=Math.min(me,Ee);let Fe;for(Fe=0;Fe<Ce;Fe++){const De=W[Fe]=te?qs(W[Fe]):Ni(W[Fe]);y(G[Fe],De,X,null,L,z,J,re,te)}me>Ee?Se(G,L,z,!0,!1,Ce):x(W,X,V,L,z,J,re,te,Ce)},ie=(G,W,X,V,L,z,J,re,te)=>{let me=0;const Ee=W.length;let Ce=G.length-1,Fe=Ee-1;for(;me<=Ce&&me<=Fe;){const De=G[me],ze=W[me]=te?qs(W[me]):Ni(W[me]);if(Wl(De,ze))y(De,ze,X,null,L,z,J,re,te);else break;me++}for(;me<=Ce&&me<=Fe;){const De=G[Ce],ze=W[Fe]=te?qs(W[Fe]):Ni(W[Fe]);if(Wl(De,ze))y(De,ze,X,null,L,z,J,re,te);else break;Ce--,Fe--}if(me>Ce){if(me<=Fe){const De=Fe+1,ze=De<Ee?W[De].el:V;for(;me<=Fe;)y(null,W[me]=te?qs(W[me]):Ni(W[me]),X,ze,L,z,J,re,te),me++}}else if(me>Fe)for(;me<=Ce;)ee(G[me],L,z,!0),me++;else{const De=me,ze=me,Me=new Map;for(me=ze;me<=Fe;me++){const U=W[me]=te?qs(W[me]):Ni(W[me]);U.key!=null&&Me.set(U.key,me)}let Ue,Qe=0;const kt=Fe-ze+1;let Lt=!1,lt=0;const Xt=new Array(kt);for(me=0;me<kt;me++)Xt[me]=0;for(me=De;me<=Ce;me++){const U=G[me];if(Qe>=kt){ee(U,L,z,!0);continue}let H;if(U.key!=null)H=Me.get(U.key);else for(Ue=ze;Ue<=Fe;Ue++)if(Xt[Ue-ze]===0&&Wl(U,W[Ue])){H=Ue;break}H===void 0?ee(U,L,z,!0):(Xt[H-ze]=me+1,H>=lt?lt=H:Lt=!0,y(U,W[H],X,null,L,z,J,re,te),Qe++)}const P=Lt?MP(Xt):bu;for(Ue=P.length-1,me=kt-1;me>=0;me--){const U=ze+me,H=W[U],Z=W[U+1],se=U+1<Ee?Z.el||Z.placeholder:V;Xt[me]===0?y(null,H,X,se,L,z,J,re,te):Lt&&(Ue<0||me!==P[Ue]?ue(H,X,se,2):Ue--)}}},ue=(G,W,X,V,L=null)=>{const{el:z,type:J,transition:re,children:te,shapeFlag:me}=G;if(me&6){ue(G.component.subTree,W,X,V);return}if(me&128){G.suspense.move(W,X,V);return}if(me&64){J.move(G,W,X,he);return}if(J===Or){i(z,W,X);for(let Ce=0;Ce<te.length;Ce++)ue(te[Ce],W,X,V);i(G.anchor,W,X);return}if(J===xm){C(G,W,X);return}if(V!==2&&me&1&&re)if(V===0)re.beforeEnter(z),i(z,W,X),On(()=>re.enter(z),L);else{const{leave:Ce,delayLeave:Fe,afterLeave:De}=re,ze=()=>{G.ctx.isUnmounted?s(z):i(z,W,X)},Me=()=>{Ce(z,()=>{ze(),De&&De()})};Fe?Fe(z,ze,Me):Me()}else i(z,W,X)},ee=(G,W,X,V=!1,L=!1)=>{const{type:z,props:J,ref:re,children:te,dynamicChildren:me,shapeFlag:Ee,patchFlag:Ce,dirs:Fe,cacheIndex:De}=G;if(Ce===-2&&(L=!1),re!=null&&(vs(),mc(re,null,X,G,!0),_s()),De!=null&&(W.renderCache[De]=void 0),Ee&256){W.ctx.deactivate(G);return}const ze=Ee&1&&Fe,Me=!yc(G);let Ue;if(Me&&(Ue=J&&J.onVnodeBeforeUnmount)&&Ci(Ue,W,G),Ee&6)we(G.component,X,V);else{if(Ee&128){G.suspense.unmount(X,V);return}ze&&$o(G,null,W,"beforeUnmount"),Ee&64?G.type.remove(G,W,X,he,V):me&&!me.hasOnce&&(z!==Or||Ce>0&&Ce&64)?Se(me,W,X,!1,!0):(z===Or&&Ce&384||!L&&Ee&16)&&Se(te,W,X),V&&ve(G)}(Me&&(Ue=J&&J.onVnodeUnmounted)||ze)&&On(()=>{Ue&&Ci(Ue,W,G),ze&&$o(G,null,W,"unmounted")},X)},ve=G=>{const{type:W,el:X,anchor:V,transition:L}=G;if(W===Or){ge(X,V);return}if(W===xm){E(G);return}const z=()=>{s(X),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(G.shapeFlag&1&&L&&!L.persisted){const{leave:J,delayLeave:re}=L,te=()=>J(X,z);re?re(G.el,z,te):te()}else z()},ge=(G,W)=>{let X;for(;G!==W;)X=d(G),s(G),G=X;s(W)},we=(G,W,X)=>{const{bum:V,scope:L,job:z,subTree:J,um:re,m:te,a:me,parent:Ee,slots:{__:Ce}}=G;Rb(te),Rb(me),V&&Zf(V),Ee&&ut(Ce)&&Ce.forEach(Fe=>{Ee.renderCache[Fe]=void 0}),L.stop(),z&&(z.flags|=8,ee(J,G,W,X)),re&&On(re,W),On(()=>{G.isUnmounted=!0},W),W&&W.pendingBranch&&!W.isUnmounted&&G.asyncDep&&!G.asyncResolved&&G.suspenseId===W.pendingId&&(W.deps--,W.deps===0&&W.resolve())},Se=(G,W,X,V=!1,L=!1,z=0)=>{for(let J=z;J<G.length;J++)ee(G[J],W,X,V,L)},ae=G=>{if(G.shapeFlag&6)return ae(G.component.subTree);if(G.shapeFlag&128)return G.suspense.next();const W=d(G.anchor||G.el),X=W&&W[eP];return X?d(X):W};let xe=!1;const ce=(G,W,X)=>{G==null?W._vnode&&ee(W._vnode,null,null,!0):y(W._vnode||null,G,W,null,null,null,X),W._vnode=G,xe||(xe=!0,Cb(),A2(),xe=!1)},he={p:y,um:ee,m:ue,r:ve,mt:j,mc:x,pc:ne,pbc:A,n:ae,o:n};return{render:ce,hydrate:void 0,createApp:SP(ce)}}function bm({type:n,props:t},r){return r==="svg"&&n==="foreignObject"||r==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function jo({effect:n,job:t},r){r?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function PP(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function z2(n,t,r=!1){const i=n.children,s=t.children;if(ut(i)&&ut(s))for(let o=0;o<i.length;o++){const a=i[o];let u=s[o];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=s[o]=qs(s[o]),u.el=a.el),!r&&u.patchFlag!==-2&&z2(a,u)),u.type===Jp&&(u.el=a.el),u.type===xo&&!u.el&&(u.el=a.el)}}function MP(n){const t=n.slice(),r=[0];let i,s,o,a,u;const l=n.length;for(i=0;i<l;i++){const c=n[i];if(c!==0){if(s=r[r.length-1],n[s]<c){t[i]=s,r.push(i);continue}for(o=0,a=r.length-1;o<a;)u=o+a>>1,n[r[u]]<c?o=u+1:a=u;c<n[r[o]]&&(o>0&&(t[i]=r[o-1]),r[o]=i)}}for(o=r.length,a=r[o-1];o-- >0;)r[o]=a,a=t[a];return r}function q2(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:q2(t)}function Rb(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const LP=Symbol.for("v-scx"),OP=()=>ei(LP);function co(n,t,r){return H2(n,t,r)}function H2(n,t,r=tr){const{immediate:i,deep:s,flush:o,once:a}=r,u=un({},r),l=t&&i||!t&&o!=="post";let c;if(qc){if(o==="sync"){const p=OP();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Mi,p.resume=Mi,p.pause=Mi,p}}const h=sn;u.call=(p,g,y)=>$i(p,h,g,y);let f=!1;o==="post"?u.scheduler=p=>{On(p,h&&h.suspense)}:o!=="sync"&&(f=!0,u.scheduler=(p,g)=>{g?p():wv(p)}),u.augmentJob=p=>{t&&(p.flags|=4),f&&(p.flags|=2,h&&(p.id=h.uid,p.i=h))};const d=YF(n,t,u);return qc&&(c?c.push(d):l&&d()),d}function VP(n,t,r){const i=this.proxy,s=kr(n)?n.includes(".")?W2(i,n):()=>i[n]:n.bind(i,i);let o;bt(t)?o=t:(o=t.handler,r=t);const a=zh(this),u=H2(s,o.bind(i),r);return a(),u}function W2(n,t){const r=t.split(".");return()=>{let i=n;for(let s=0;s<r.length&&i;s++)i=i[r[s]];return i}}const BP=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${ii(t)}Modifiers`]||n[`${Fo(t)}Modifiers`];function UP(n,t,...r){if(n.isUnmounted)return;const i=n.vnode.props||tr;let s=r;const o=t.startsWith("update:"),a=o&&BP(i,t.slice(7));a&&(a.trim&&(s=r.map(h=>kr(h)?h.trim():h)),a.number&&(s=r.map(Sd)));let u,l=i[u=pm(t)]||i[u=pm(ii(t))];!l&&o&&(l=i[u=pm(Fo(t))]),l&&$i(l,n,6,s);const c=i[u+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[u])return;n.emitted[u]=!0,$i(c,n,6,s)}}function K2(n,t,r=!1){const i=t.emitsCache,s=i.get(n);if(s!==void 0)return s;const o=n.emits;let a={},u=!1;if(!bt(n)){const l=c=>{const h=K2(c,t,!0);h&&(u=!0,un(a,h))};!r&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!o&&!u?(sr(n)&&i.set(n,null),null):(ut(o)?o.forEach(l=>a[l]=null):un(a,o),sr(n)&&i.set(n,a),a)}function Qp(n,t){return!n||!Gp(t)?!1:(t=t.slice(2).replace(/Once$/,""),qt(n,t[0].toLowerCase()+t.slice(1))||qt(n,Fo(t))||qt(n,t))}function Fb(n){const{type:t,vnode:r,proxy:i,withProxy:s,propsOptions:[o],slots:a,attrs:u,emit:l,render:c,renderCache:h,props:f,data:d,setupState:p,ctx:g,inheritAttrs:y}=n,v=Dd(n);let T,_;try{if(r.shapeFlag&4){const E=s||i,S=E;T=Ni(c.call(S,E,h,f,p,d,g)),_=u}else{const E=t;T=Ni(E.length>1?E(f,{attrs:u,slots:a,emit:l}):E(f,null)),_=t.props?u:$P(u)}}catch(E){_c.length=0,Xp(E,n,1),T=Xr(xo)}let C=T;if(_&&y!==!1){const E=Object.keys(_),{shapeFlag:S}=C;E.length&&S&7&&(o&&E.some(hv)&&(_=jP(_,o)),C=Gu(C,_,!1,!0))}return r.dirs&&(C=Gu(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(r.dirs):r.dirs),r.transition&&Ev(C,r.transition),T=C,Dd(v),T}const $P=n=>{let t;for(const r in n)(r==="class"||r==="style"||Gp(r))&&((t||(t={}))[r]=n[r]);return t},jP=(n,t)=>{const r={};for(const i in n)(!hv(i)||!(i.slice(9)in t))&&(r[i]=n[i]);return r};function GP(n,t,r){const{props:i,children:s,component:o}=n,{props:a,children:u,patchFlag:l}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return i?Pb(i,a,c):!!a;if(l&8){const h=t.dynamicProps;for(let f=0;f<h.length;f++){const d=h[f];if(a[d]!==i[d]&&!Qp(c,d))return!0}}}else return(s||u)&&(!u||!u.$stable)?!0:i===a?!1:i?a?Pb(i,a,c):!0:!!a;return!1}function Pb(n,t,r){const i=Object.keys(t);if(i.length!==Object.keys(n).length)return!0;for(let s=0;s<i.length;s++){const o=i[s];if(t[o]!==n[o]&&!Qp(r,o))return!0}return!1}function zP({vnode:n,parent:t},r){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===n&&(i.el=n.el),i===n)(n=t.vnode).el=r,t=t.parent;else break}}const Y2=n=>n.__isSuspense;function qP(n,t){t&&t.pendingBranch?ut(n)?t.effects.push(...n):t.effects.push(n):QF(n)}const Or=Symbol.for("v-fgt"),Jp=Symbol.for("v-txt"),xo=Symbol.for("v-cmt"),xm=Symbol.for("v-stc"),_c=[];let $n=null;function Ge(n=!1){_c.push($n=n?null:[])}function HP(){_c.pop(),$n=_c[_c.length-1]||null}let zc=1;function Mb(n,t=!1){zc+=n,n<0&&$n&&t&&($n.hasOnce=!0)}function X2(n){return n.dynamicChildren=zc>0?$n||bu:null,HP(),zc>0&&$n&&$n.push(n),n}function We(n,t,r,i,s,o){return X2(pe(n,t,r,i,s,o,!0))}function Tv(n,t,r,i,s){return X2(Xr(n,t,r,i,s,!0))}function Nd(n){return n?n.__v_isVNode===!0:!1}function Wl(n,t){return n.type===t.type&&n.key===t.key}const Z2=({key:n})=>n??null,Jf=({ref:n,ref_key:t,ref_for:r})=>(typeof n=="number"&&(n=""+n),n!=null?kr(n)||Sr(n)||bt(n)?{i:Un,r:n,k:t,f:!!r}:n:null);function pe(n,t=null,r=null,i=0,s=null,o=n===Or?0:1,a=!1,u=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&Z2(t),ref:t&&Jf(t),scopeId:I2,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Un};return u?(Iv(l,r),o&128&&n.normalize(l)):r&&(l.shapeFlag|=kr(r)?8:16),zc>0&&!a&&$n&&(l.patchFlag>0||o&6)&&l.patchFlag!==32&&$n.push(l),l}const Xr=WP;function WP(n,t=null,r=null,i=0,s=null,o=!1){if((!n||n===gP)&&(n=xo),Nd(n)){const u=Gu(n,t,!0);return r&&Iv(u,r),zc>0&&!o&&$n&&(u.shapeFlag&6?$n[$n.indexOf(n)]=u:$n.push(u)),u.patchFlag=-2,u}if(iM(n)&&(n=n.__vccOpts),t){t=KP(t);let{class:u,style:l}=t;u&&!kr(u)&&(t.class=$h(u)),sr(l)&&(bv(l)&&!ut(l)&&(l=un({},l)),t.style=Uh(l))}const a=kr(n)?1:Y2(n)?128:tP(n)?64:sr(n)?4:bt(n)?2:0;return pe(n,t,r,i,s,a,o,!0)}function KP(n){return n?bv(n)||V2(n)?un({},n):n:null}function Gu(n,t,r=!1,i=!1){const{props:s,ref:o,patchFlag:a,children:u,transition:l}=n,c=t?YP(s||{},t):s,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&Z2(c),ref:t&&t.ref?r&&o?ut(o)?o.concat(Jf(t)):[o,Jf(t)]:Jf(t):o,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:u,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==Or?a===-1?16:a|16:a,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Gu(n.ssContent),ssFallback:n.ssFallback&&Gu(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&i&&Ev(h,l.clone(h)),h}function Eu(n=" ",t=0){return Xr(Jp,null,n,t)}function pr(n="",t=!1){return t?(Ge(),Tv(xo,null,n)):Xr(xo,null,n)}function Ni(n){return n==null||typeof n=="boolean"?Xr(xo):ut(n)?Xr(Or,null,n.slice()):Nd(n)?qs(n):Xr(Jp,null,String(n))}function qs(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Gu(n)}function Iv(n,t){let r=0;const{shapeFlag:i}=n;if(t==null)t=null;else if(ut(t))r=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Iv(n,s()),s._c&&(s._d=!0));return}else{r=32;const s=t._;!s&&!V2(t)?t._ctx=Un:s===3&&Un&&(Un.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else bt(t)?(t={default:t,_ctx:Un},r=32):(t=String(t),i&64?(r=16,t=[Eu(t)]):r=8);n.children=t,n.shapeFlag|=r}function YP(...n){const t={};for(let r=0;r<n.length;r++){const i=n[r];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=$h([t.class,i.class]));else if(s==="style")t.style=Uh([t.style,i.style]);else if(Gp(s)){const o=t[s],a=i[s];a&&o!==a&&!(ut(o)&&o.includes(a))&&(t[s]=o?[].concat(o,a):a)}else s!==""&&(t[s]=i[s])}return t}function Ci(n,t,r,i=null){$i(n,t,7,[r,i])}const XP=M2();let ZP=0;function QP(n,t,r){const i=n.type,s=(t?t.appContext:n.appContext)||XP,o={uid:ZP++,vnode:n,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new n2(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:U2(i,s),emitsOptions:K2(i,s),emit:null,emitted:null,propsDefaults:tr,inheritAttrs:i.inheritAttrs,ctx:tr,data:tr,props:tr,attrs:tr,slots:tr,refs:tr,setupState:tr,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=UP.bind(null,o),n.ce&&n.ce(o),o}let sn=null;const Q2=()=>sn||Un;let Rd,M0;{const n=Wp(),t=(r,i)=>{let s;return(s=n[r])||(s=n[r]=[]),s.push(i),o=>{s.length>1?s.forEach(a=>a(o)):s[0](o)}};Rd=t("__VUE_INSTANCE_SETTERS__",r=>sn=r),M0=t("__VUE_SSR_SETTERS__",r=>qc=r)}const zh=n=>{const t=sn;return Rd(n),n.scope.on(),()=>{n.scope.off(),Rd(t)}},Lb=()=>{sn&&sn.scope.off(),Rd(null)};function J2(n){return n.vnode.shapeFlag&4}let qc=!1;function JP(n,t=!1,r=!1){t&&M0(t);const{props:i,children:s}=n.vnode,o=J2(n);AP(n,i,o,t),kP(n,s,r||t);const a=o?eM(n,t):void 0;return t&&M0(!1),a}function eM(n,t){const r=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,yP);const{setup:i}=r;if(i){vs();const s=n.setupContext=i.length>1?rM(n):null,o=zh(n),a=Gh(i,n,0,[n.props,s]),u=ZC(a);if(_s(),o(),(u||n.sp)&&!yc(n)&&k2(n),u){if(a.then(Lb,Lb),t)return a.then(l=>{Ob(n,l)}).catch(l=>{Xp(l,n,0)});n.asyncDep=a}else Ob(n,a)}else eA(n)}function Ob(n,t,r){bt(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:sr(t)&&(n.setupState=E2(t)),eA(n)}function eA(n,t,r){const i=n.type;n.render||(n.render=i.render||Mi);{const s=zh(n);vs();try{vP(n)}finally{_s(),s()}}}const tM={get(n,t){return tn(n,"get",""),n[t]}};function rM(n){const t=r=>{n.exposed=r||{}};return{attrs:new Proxy(n.attrs,tM),slots:n.slots,emit:n.emit,expose:t}}function eg(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(E2(xv(n.exposed)),{get(t,r){if(r in t)return t[r];if(r in vc)return vc[r](n)},has(t,r){return r in t||r in vc}})):n.proxy}function nM(n,t=!0){return bt(n)?n.displayName||n.name:n.name||t&&n.__name}function iM(n){return bt(n)&&"__vccOpts"in n}const gr=(n,t)=>WF(n,t,qc);function tA(n,t,r){const i=arguments.length;return i===2?sr(t)&&!ut(t)?Nd(t)?Xr(n,null,[t]):Xr(n,t):Xr(n,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&Nd(r)&&(r=[r]),Xr(n,t,r))}const sM="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let L0;const Vb=typeof window<"u"&&window.trustedTypes;if(Vb)try{L0=Vb.createPolicy("vue",{createHTML:n=>n})}catch{}const rA=L0?n=>L0.createHTML(n):n=>n,oM="http://www.w3.org/2000/svg",aM="http://www.w3.org/1998/Math/MathML",ss=typeof document<"u"?document:null,Bb=ss&&ss.createElement("template"),uM={insert:(n,t,r)=>{t.insertBefore(n,r||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,r,i)=>{const s=t==="svg"?ss.createElementNS(oM,n):t==="mathml"?ss.createElementNS(aM,n):r?ss.createElement(n,{is:r}):ss.createElement(n);return n==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:n=>ss.createTextNode(n),createComment:n=>ss.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ss.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,r,i,s,o){const a=r?r.previousSibling:t.lastChild;if(s&&(s===o||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),r),!(s===o||!(s=s.nextSibling)););else{Bb.innerHTML=rA(i==="svg"?`<svg>${n}</svg>`:i==="mathml"?`<math>${n}</math>`:n);const u=Bb.content;if(i==="svg"||i==="mathml"){const l=u.firstChild;for(;l.firstChild;)u.appendChild(l.firstChild);u.removeChild(l)}t.insertBefore(u,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},lM=Symbol("_vtc");function cM(n,t,r){const i=n[lM];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?n.removeAttribute("class"):r?n.setAttribute("class",t):n.className=t}const Ub=Symbol("_vod"),hM=Symbol("_vsh"),fM=Symbol(""),dM=/(^|;)\s*display\s*:/;function pM(n,t,r){const i=n.style,s=kr(r);let o=!1;if(r&&!s){if(t)if(kr(t))for(const a of t.split(";")){const u=a.slice(0,a.indexOf(":")).trim();r[u]==null&&ed(i,u,"")}else for(const a in t)r[a]==null&&ed(i,a,"");for(const a in r)a==="display"&&(o=!0),ed(i,a,r[a])}else if(s){if(t!==r){const a=i[fM];a&&(r+=";"+a),i.cssText=r,o=dM.test(r)}}else t&&n.removeAttribute("style");Ub in n&&(n[Ub]=o?i.display:"",n[hM]&&(i.display="none"))}const $b=/\s*!important$/;function ed(n,t,r){if(ut(r))r.forEach(i=>ed(n,t,i));else if(r==null&&(r=""),t.startsWith("--"))n.setProperty(t,r);else{const i=gM(n,t);$b.test(r)?n.setProperty(Fo(i),r.replace($b,""),"important"):n[i]=r}}const jb=["Webkit","Moz","ms"],wm={};function gM(n,t){const r=wm[t];if(r)return r;let i=ii(t);if(i!=="filter"&&i in n)return wm[t]=i;i=Hp(i);for(let s=0;s<jb.length;s++){const o=jb[s]+i;if(o in n)return wm[t]=o}return t}const Gb="http://www.w3.org/1999/xlink";function zb(n,t,r,i,s,o=yF(t)){i&&t.startsWith("xlink:")?r==null?n.removeAttributeNS(Gb,t.slice(6,t.length)):n.setAttributeNS(Gb,t,r):r==null||o&&!e2(r)?n.removeAttribute(t):n.setAttribute(t,o?"":Ui(r)?String(r):r)}function qb(n,t,r,i,s){if(t==="innerHTML"||t==="textContent"){r!=null&&(n[t]=t==="innerHTML"?rA(r):r);return}const o=n.tagName;if(t==="value"&&o!=="PROGRESS"&&!o.includes("-")){const u=o==="OPTION"?n.getAttribute("value")||"":n.value,l=r==null?n.type==="checkbox"?"on":"":String(r);(u!==l||!("_value"in n))&&(n.value=l),r==null&&n.removeAttribute(t),n._value=r;return}let a=!1;if(r===""||r==null){const u=typeof n[t];u==="boolean"?r=e2(r):r==null&&u==="string"?(r="",a=!0):u==="number"&&(r=0,a=!0)}try{n[t]=r}catch{}a&&n.removeAttribute(s||t)}function Jo(n,t,r,i){n.addEventListener(t,r,i)}function mM(n,t,r,i){n.removeEventListener(t,r,i)}const Hb=Symbol("_vei");function yM(n,t,r,i,s=null){const o=n[Hb]||(n[Hb]={}),a=o[t];if(i&&a)a.value=i;else{const[u,l]=vM(t);if(i){const c=o[t]=xM(i,s);Jo(n,u,c,l)}else a&&(mM(n,u,a,l),o[t]=void 0)}}const Wb=/(?:Once|Passive|Capture)$/;function vM(n){let t;if(Wb.test(n)){t={};let i;for(;i=n.match(Wb);)n=n.slice(0,n.length-i[0].length),t[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Fo(n.slice(2)),t]}let Em=0;const _M=Promise.resolve(),bM=()=>Em||(_M.then(()=>Em=0),Em=Date.now());function xM(n,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;$i(wM(i,r.value),t,5,[i])};return r.value=n,r.attached=bM(),r}function wM(n,t){if(ut(t)){const r=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{r.call(n),n._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const Kb=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,EM=(n,t,r,i,s,o)=>{const a=s==="svg";t==="class"?cM(n,i,a):t==="style"?pM(n,r,i):Gp(t)?hv(t)||yM(n,t,r,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):SM(n,t,i,a))?(qb(n,t,i),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&zb(n,t,i,a,o,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!kr(i))?qb(n,ii(t),i,o,t):(t==="true-value"?n._trueValue=i:t==="false-value"&&(n._falseValue=i),zb(n,t,i,a))};function SM(n,t,r,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in n&&Kb(t)&&bt(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Kb(t)&&kr(r)?!1:t in n}const Fd=n=>{const t=n.props["onUpdate:modelValue"]||!1;return ut(t)?r=>Zf(t,r):t};function CM(n){n.target.composing=!0}function Yb(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Su=Symbol("_assign"),xr={created(n,{modifiers:{lazy:t,trim:r,number:i}},s){n[Su]=Fd(s);const o=i||s.props&&s.props.type==="number";Jo(n,t?"change":"input",a=>{if(a.target.composing)return;let u=n.value;r&&(u=u.trim()),o&&(u=Sd(u)),n[Su](u)}),r&&Jo(n,"change",()=>{n.value=n.value.trim()}),t||(Jo(n,"compositionstart",CM),Jo(n,"compositionend",Yb),Jo(n,"change",Yb))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:r,modifiers:{lazy:i,trim:s,number:o}},a){if(n[Su]=Fd(a),n.composing)return;const u=(o||n.type==="number")&&!/^0\d/.test(n.value)?Sd(n.value):n.value,l=t??"";u!==l&&(document.activeElement===n&&n.type!=="range"&&(i&&t===r||s&&n.value.trim()===l)||(n.value=l))}},O0={deep:!0,created(n,{value:t,modifiers:{number:r}},i){const s=zp(t);Jo(n,"change",()=>{const o=Array.prototype.filter.call(n.options,a=>a.selected).map(a=>r?Sd(Pd(a)):Pd(a));n[Su](n.multiple?s?new Set(o):o:o[0]),n._assigning=!0,eo(()=>{n._assigning=!1})}),n[Su]=Fd(i)},mounted(n,{value:t}){Xb(n,t)},beforeUpdate(n,t,r){n[Su]=Fd(r)},updated(n,{value:t}){n._assigning||Xb(n,t)}};function Xb(n,t){const r=n.multiple,i=ut(t);if(!(r&&!i&&!zp(t))){for(let s=0,o=n.options.length;s<o;s++){const a=n.options[s],u=Pd(a);if(r)if(i){const l=typeof u;l==="string"||l==="number"?a.selected=t.some(c=>String(c)===String(u)):a.selected=_F(t,u)>-1}else a.selected=t.has(u);else if(Kp(Pd(a),t)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!r&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function Pd(n){return"_value"in n?n._value:n.value}const AM=["ctrl","shift","alt","meta"],TM={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>AM.some(r=>n[`${r}Key`]&&!t.includes(r))},qh=(n,t)=>{const r=n._withMods||(n._withMods={}),i=t.join(".");return r[i]||(r[i]=(s,...o)=>{for(let a=0;a<t.length;a++){const u=TM[t[a]];if(u&&u(s,t))return}return n(s,...o)})},IM={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},DM=(n,t)=>{const r=n._withKeys||(n._withKeys={}),i=t.join(".");return r[i]||(r[i]=s=>{if(!("key"in s))return;const o=Fo(s.key);if(t.some(a=>a===o||IM[a]===o))return n(s)})},kM=un({patchProp:EM},uM);let Zb;function NM(){return Zb||(Zb=RP(kM))}const RM=(...n)=>{const t=NM().createApp(...n),{mount:r}=t;return t.mount=i=>{const s=PM(i);if(!s)return;const o=t._component;!bt(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,FM(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t};function FM(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function PM(n){return kr(n)?document.querySelector(n):n}/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let nA;const tg=n=>nA=n,iA=Symbol();function V0(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var bc;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(bc||(bc={}));function MM(){const n=i2(!0),t=n.run(()=>Ht({}));let r=[],i=[];const s=xv({install(o){tg(s),s._a=o,o.provide(iA,s),o.config.globalProperties.$pinia=s,i.forEach(a=>r.push(a)),i=[]},use(o){return this._a?r.push(o):i.push(o),this},_p:r,_a:null,_e:n,_s:new Map,state:t});return s}const sA=()=>{};function Qb(n,t,r,i=sA){n.push(t);const s=()=>{const o=n.indexOf(t);o>-1&&(n.splice(o,1),i())};return!r&&s2()&&bF(s),s}function Xa(n,...t){n.slice().forEach(r=>{r(...t)})}const LM=n=>n(),Jb=Symbol(),Sm=Symbol();function B0(n,t){n instanceof Map&&t instanceof Map?t.forEach((r,i)=>n.set(i,r)):n instanceof Set&&t instanceof Set&&t.forEach(n.add,n);for(const r in t){if(!t.hasOwnProperty(r))continue;const i=t[r],s=n[r];V0(s)&&V0(i)&&n.hasOwnProperty(r)&&!Sr(i)&&!lo(i)?n[r]=B0(s,i):n[r]=i}return n}const OM=Symbol();function VM(n){return!V0(n)||!Object.prototype.hasOwnProperty.call(n,OM)}const{assign:Gs}=Object;function BM(n){return!!(Sr(n)&&n.effect)}function UM(n,t,r,i){const{state:s,actions:o,getters:a}=t,u=r.state.value[n];let l;function c(){u||(r.state.value[n]=s?s():{});const h=GF(r.state.value[n]);return Gs(h,o,Object.keys(a||{}).reduce((f,d)=>(f[d]=xv(gr(()=>{tg(r);const p=r._s.get(n);return a[d].call(p,p)})),f),{}))}return l=oA(n,c,t,r,i,!0),l}function oA(n,t,r={},i,s,o){let a;const u=Gs({actions:{}},r),l={deep:!0};let c,h,f=[],d=[],p;const g=i.state.value[n];!o&&!g&&(i.state.value[n]={}),Ht({});let y;function v(x){let b;c=h=!1,typeof x=="function"?(x(i.state.value[n]),b={type:bc.patchFunction,storeId:n,events:p}):(B0(i.state.value[n],x),b={type:bc.patchObject,payload:x,storeId:n,events:p});const A=y=Symbol();eo().then(()=>{y===A&&(c=!0)}),h=!0,Xa(f,b,i.state.value[n])}const T=o?function(){const{state:b}=r,A=b?b():{};this.$patch(k=>{Gs(k,A)})}:sA;function _(){a.stop(),f=[],d=[],i._s.delete(n)}const C=(x,b="")=>{if(Jb in x)return x[Sm]=b,x;const A=function(){tg(i);const k=Array.from(arguments),N=[],I=[];function j(fe){N.push(fe)}function Q(fe){I.push(fe)}Xa(d,{args:k,name:A[Sm],store:S,after:j,onError:Q});let le;try{le=x.apply(this&&this.$id===n?this:S,k)}catch(fe){throw Xa(I,fe),fe}return le instanceof Promise?le.then(fe=>(Xa(N,fe),fe)).catch(fe=>(Xa(I,fe),Promise.reject(fe))):(Xa(N,le),le)};return A[Jb]=!0,A[Sm]=b,A},E={_p:i,$id:n,$onAction:Qb.bind(null,d),$patch:v,$reset:T,$subscribe(x,b={}){const A=Qb(f,x,b.detached,()=>k()),k=a.run(()=>co(()=>i.state.value[n],N=>{(b.flush==="sync"?h:c)&&x({storeId:n,type:bc.direct,events:p},N)},Gs({},l,b)));return A},$dispose:_},S=jh(E);i._s.set(n,S);const w=(i._a&&i._a.runWithContext||LM)(()=>i._e.run(()=>(a=i2()).run(()=>t({action:C}))));for(const x in w){const b=w[x];if(Sr(b)&&!BM(b)||lo(b))o||(g&&VM(b)&&(Sr(b)?b.value=g[x]:B0(b,g[x])),i.state.value[n][x]=b);else if(typeof b=="function"){const A=C(b,x);w[x]=A,u.actions[x]=b}}return Gs(S,w),Gs(Ot(S),w),Object.defineProperty(S,"$state",{get:()=>i.state.value[n],set:x=>{v(b=>{Gs(b,x)})}}),i._p.forEach(x=>{Gs(S,a.run(()=>x({store:S,app:i._a,pinia:i,options:u})))}),g&&o&&r.hydrate&&r.hydrate(S.$state,g),c=!0,h=!0,S}/*! #__NO_SIDE_EFFECTS__ */function aA(n,t,r){let i;const s=typeof t=="function";i=s?r:t;function o(a,u){const l=CP();return a=a||(l?ei(iA,null):null),a&&tg(a),a=nA,a._s.has(n)||(s?oA(n,t,i,a):UM(n,i,a)),a._s.get(n)}return o.$id=n,o}const $M=()=>{};var ex={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=function(n){const t=[];let r=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},jM=function(n){const t=[];let r=0,i=0;for(;r<n.length;){const s=n[r++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[r++];t[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[r++],a=n[r++],u=n[r++],l=((s&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const o=n[r++],a=n[r++];t[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|a&63)}}return t.join("")},lA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],a=s+1<n.length,u=a?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,h=o>>2,f=(o&3)<<4|u>>4;let d=(u&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),i.push(r[h],r[f],r[d],r[p])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(uA(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):jM(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=r[n.charAt(s++)],u=s<n.length?r[n.charAt(s)]:0;++s;const c=s<n.length?r[n.charAt(s)]:64;++s;const f=s<n.length?r[n.charAt(s)]:64;if(++s,o==null||u==null||c==null||f==null)throw new GM;const d=o<<2|u>>4;if(i.push(d),c!==64){const p=u<<4&240|c>>2;if(i.push(p),f!==64){const g=c<<6&192|f;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class GM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zM=function(n){const t=uA(n);return lA.encodeByteArray(t,!0)},cA=function(n){return zM(n).replace(/\./g,"")},hA=function(n){try{return lA.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qM=()=>fA().__FIREBASE_DEFAULTS__,HM=()=>{if(typeof process>"u"||typeof ex>"u")return;const n=ex.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},WM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&hA(n[1]);return t&&JSON.parse(t)},rg=()=>{try{return $M()||qM()||HM()||WM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},KM=n=>{var t,r;return(r=(t=rg())==null?void 0:t.emulatorHosts)==null?void 0:r[n]},dA=()=>{var n;return(n=rg())==null?void 0:n.config},pA=n=>{var t;return(t=rg())==null?void 0:t[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,i)=>{r?this.reject(r):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function gA(n){return(await fetch(n,{credentials:"include"})).ok}const xc={};function XM(){const n={prod:[],emulator:[]};for(const t of Object.keys(xc))xc[t]?n.emulator.push(t):n.prod.push(t);return n}function ZM(n){let t=document.getElementById(n),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),r=!0),{created:r,element:t}}let tx=!1;function QM(n,t){if(typeof window>"u"||typeof document>"u"||!xl(window.location.host)||xc[n]===t||xc[n]||tx)return;xc[n]=t;function r(d){return`__firebase__banner__${d}`}const i="__firebase__banner",o=XM().prod.length>0;function a(){const d=document.getElementById(i);d&&d.remove()}function u(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{tx=!0,a()},d}function h(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function f(){const d=ZM(i),p=r("text"),g=document.getElementById(p)||document.createElement("span"),y=r("learnmore"),v=document.getElementById(y)||document.createElement("a"),T=r("preprendIcon"),_=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const C=d.element;u(C),h(v,y);const E=c();l(_,T),C.append(_,g,v,E),document.body.appendChild(C)}o?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ur())}function mA(){var t;const n=(t=rg())==null?void 0:t.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function e3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function t3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function r3(){const n=Ur();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vA(){return!mA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _A(){return!mA()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Dv(){try{return typeof indexedDB=="object"}catch{return!1}}function bA(){return new Promise((n,t)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var o;t(((o=s.error)==null?void 0:o.message)||"")}}catch(r){t(r)}})}function n3(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3="FirebaseError";class wi extends Error{constructor(t,r,i){super(r),this.code=t,this.customData=i,this.name=i3,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ba.prototype.create)}}class Ba{constructor(t,r,i){this.service=t,this.serviceName=r,this.errors=i}create(t,...r){const i=r[0]||{},s=`${this.service}/${t}`,o=this.errors[t],a=o?s3(o,i):"Error",u=`${this.serviceName}: ${a} (${s}).`;return new wi(s,u,i)}}function s3(n,t){return n.replace(o3,(r,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const o3=/\{\$([^}]+)}/g;function a3(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function wo(n,t){if(n===t)return!0;const r=Object.keys(n),i=Object.keys(t);for(const s of r){if(!i.includes(s))return!1;const o=n[s],a=t[s];if(rx(o)&&rx(a)){if(!wo(o,a))return!1}else if(o!==a)return!1}for(const s of i)if(!r.includes(s))return!1;return!0}function rx(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(n){const t=[];for(const[r,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function u3(n,t){const r=new l3(n,t);return r.subscribe.bind(r)}class l3{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,i){let s;if(t===void 0&&r===void 0&&i===void 0)throw new Error("Missing Observer.");c3(t,["next","error","complete"])?s=t:s={next:t,error:r,complete:i},s.next===void 0&&(s.next=Cm),s.error===void 0&&(s.error=Cm),s.complete===void 0&&(s.complete=Cm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function c3(n,t){if(typeof n!="object"||n===null)return!1;for(const r of t)if(r in n&&typeof n[r]=="function")return!0;return!1}function Cm(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=1e3,f3=2,d3=14400*1e3,p3=.5;function nx(n,t=h3,r=f3){const i=t*Math.pow(r,n),s=Math.round(p3*i*(Math.random()-.5)*2);return Math.min(d3,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(n){return n&&n._delegate?n._delegate:n}class bi{constructor(t,r,i){this.name=t,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const i=new YM;if(this.instancesDeferred.set(r,i),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(t==null?void 0:t.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(y3(t))try{this.getOrInitializeService({instanceIdentifier:Ho})}catch{}for(const[r,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(t=Ho){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ho){return this.instances.has(t)}getOptions(t=Ho){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:r});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);i===u&&a.resolve(s)}return s}onInit(t,r){const i=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(i)??new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const i=this.onInitCallbacks.get(r);if(i)for(const s of i)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:m3(t),options:r}),this.instances.set(t,i),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Ho){return this.component?this.component.multipleInstances?t:Ho:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function m3(n){return n===Ho?void 0:n}function y3(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new g3(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Tt||(Tt={}));const _3={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},b3=Tt.INFO,x3={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},w3=(n,t,...r)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=x3[t];if(s)console[s](`[${i}]  ${n.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};let ng=class{constructor(t){this.name=t,this._logLevel=b3,this._logHandler=w3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Tt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?_3[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...t),this._logHandler(this,Tt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...t),this._logHandler(this,Tt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...t),this._logHandler(this,Tt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...t),this._logHandler(this,Tt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...t),this._logHandler(this,Tt.ERROR,...t)}};const E3=(n,t)=>t.some(r=>n instanceof r);let ix,sx;function S3(){return ix||(ix=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C3(){return sx||(sx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xA=new WeakMap,U0=new WeakMap,wA=new WeakMap,Am=new WeakMap,kv=new WeakMap;function A3(n){const t=new Promise((r,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{r(ho(n.result)),s()},a=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&xA.set(r,n)}).catch(()=>{}),kv.set(t,n),t}function T3(n){if(U0.has(n))return;const t=new Promise((r,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{r(),s()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});U0.set(n,t)}let $0={get(n,t,r){if(n instanceof IDBTransaction){if(t==="done")return U0.get(n);if(t==="objectStoreNames")return n.objectStoreNames||wA.get(n);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ho(n[t])},set(n,t,r){return n[t]=r,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function I3(n){$0=n($0)}function D3(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const i=n.call(Tm(this),t,...r);return wA.set(i,t.sort?t.sort():[t]),ho(i)}:C3().includes(n)?function(...t){return n.apply(Tm(this),t),ho(xA.get(this))}:function(...t){return ho(n.apply(Tm(this),t))}}function k3(n){return typeof n=="function"?D3(n):(n instanceof IDBTransaction&&T3(n),E3(n,S3())?new Proxy(n,$0):n)}function ho(n){if(n instanceof IDBRequest)return A3(n);if(Am.has(n))return Am.get(n);const t=k3(n);return t!==n&&(Am.set(n,t),kv.set(t,n)),t}const Tm=n=>kv.get(n);function EA(n,t,{blocked:r,upgrade:i,blocking:s,terminated:o}={}){const a=indexedDB.open(n,t),u=ho(a);return i&&a.addEventListener("upgradeneeded",l=>{i(ho(a.result),l.oldVersion,l.newVersion,ho(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),u.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),u}const N3=["get","getKey","getAll","getAllKeys","count"],R3=["put","add","delete","clear"],Im=new Map;function ox(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Im.get(t))return Im.get(t);const r=t.replace(/FromIndex$/,""),i=t!==r,s=R3.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(s||N3.includes(r)))return;const o=async function(a,...u){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(u.shift())),(await Promise.all([c[r](...u),s&&l.done]))[0]};return Im.set(t,o),o}I3(n=>({...n,get:(t,r,i)=>ox(t,r)||n.get(t,r,i),has:(t,r)=>!!ox(t,r)||n.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(P3(r)){const i=r.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(r=>r).join(" ")}}function P3(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const j0="@firebase/app",ax="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs=new ng("@firebase/app"),M3="@firebase/app-compat",L3="@firebase/analytics-compat",O3="@firebase/analytics",V3="@firebase/app-check-compat",B3="@firebase/app-check",U3="@firebase/auth",$3="@firebase/auth-compat",j3="@firebase/database",G3="@firebase/data-connect",z3="@firebase/database-compat",q3="@firebase/functions",H3="@firebase/functions-compat",W3="@firebase/installations",K3="@firebase/installations-compat",Y3="@firebase/messaging",X3="@firebase/messaging-compat",Z3="@firebase/performance",Q3="@firebase/performance-compat",J3="@firebase/remote-config",eL="@firebase/remote-config-compat",tL="@firebase/storage",rL="@firebase/storage-compat",nL="@firebase/firestore",iL="@firebase/ai",sL="@firebase/firestore-compat",oL="firebase",aL="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0="[DEFAULT]",uL={[j0]:"fire-core",[M3]:"fire-core-compat",[O3]:"fire-analytics",[L3]:"fire-analytics-compat",[B3]:"fire-app-check",[V3]:"fire-app-check-compat",[U3]:"fire-auth",[$3]:"fire-auth-compat",[j3]:"fire-rtdb",[G3]:"fire-data-connect",[z3]:"fire-rtdb-compat",[q3]:"fire-fn",[H3]:"fire-fn-compat",[W3]:"fire-iid",[K3]:"fire-iid-compat",[Y3]:"fire-fcm",[X3]:"fire-fcm-compat",[Z3]:"fire-perf",[Q3]:"fire-perf-compat",[J3]:"fire-rc",[eL]:"fire-rc-compat",[tL]:"fire-gcs",[rL]:"fire-gcs-compat",[nL]:"fire-fst",[sL]:"fire-fst-compat",[iL]:"fire-vertex","fire-js":"fire-js",[oL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md=new Map,lL=new Map,z0=new Map;function ux(n,t){try{n.container.addComponent(t)}catch(r){bs.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,r)}}function Gi(n){const t=n.name;if(z0.has(t))return bs.debug(`There were multiple attempts to register component ${t}.`),!1;z0.set(t,n);for(const r of Md.values())ux(r,n);for(const r of lL.values())ux(r,n);return!0}function Ua(n,t){const r=n.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),n.container.getProvider(t)}function fi(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fo=new Ba("app","Firebase",cL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(t,r,i){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new bi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw fo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=aL;function SA(n,t={}){let r=n;typeof t!="object"&&(t={name:t});const i={name:G0,automaticDataCollectionEnabled:!0,...t},s=i.name;if(typeof s!="string"||!s)throw fo.create("bad-app-name",{appName:String(s)});if(r||(r=dA()),!r)throw fo.create("no-options");const o=Md.get(s);if(o){if(wo(r,o.options)&&wo(i,o.config))return o;throw fo.create("duplicate-app",{appName:s})}const a=new v3(s);for(const l of z0.values())a.addComponent(l);const u=new hL(r,i,a);return Md.set(s,u),u}function CA(n=G0){const t=Md.get(n);if(!t&&n===G0&&dA())return SA();if(!t)throw fo.create("no-app",{appName:n});return t}function ti(n,t,r){let i=uL[n]??n;r&&(i+=`-${r}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${t}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),bs.warn(a.join(" "));return}Gi(new bi(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL="firebase-heartbeat-database",dL=1,Hc="firebase-heartbeat-store";let Dm=null;function AA(){return Dm||(Dm=EA(fL,dL,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Hc)}catch(r){console.warn(r)}}}}).catch(n=>{throw fo.create("idb-open",{originalErrorMessage:n.message})})),Dm}async function pL(n){try{const r=(await AA()).transaction(Hc),i=await r.objectStore(Hc).get(TA(n));return await r.done,i}catch(t){if(t instanceof wi)bs.warn(t.message);else{const r=fo.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});bs.warn(r.message)}}}async function lx(n,t){try{const i=(await AA()).transaction(Hc,"readwrite");await i.objectStore(Hc).put(t,TA(n)),await i.done}catch(r){if(r instanceof wi)bs.warn(r.message);else{const i=fo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});bs.warn(i.message)}}}function TA(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL=1024,mL=30;class yL{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _L(r),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=cx();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>mL){const a=bL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){bs.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=cx(),{heartbeatsToSend:i,unsentEntries:s}=vL(this._heartbeatsCache.heartbeats),o=cA(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return bs.warn(r),""}}}function cx(){return new Date().toISOString().substring(0,10)}function vL(n,t=gL){const r=[];let i=n.slice();for(const s of n){const o=r.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),hx(r)>t){o.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),hx(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class _L{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Dv()?bA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await pL(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return lx(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return lx(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function hx(n){return cA(JSON.stringify({version:2,heartbeats:n})).length}function bL(n){if(n.length===0)return-1;let t=0,r=n[0].date;for(let i=1;i<n.length;i++)n[i].date<r&&(r=n[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(n){Gi(new bi("platform-logger",t=>new F3(t),"PRIVATE")),Gi(new bi("heartbeat",t=>new yL(t),"PRIVATE")),ti(j0,ax,n),ti(j0,ax,"esm2020"),ti("fire-js","")}xL("");var wL="firebase",EL="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ti(wL,EL,"app");const IA="@firebase/installations",Nv="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=1e4,kA=`w:${Nv}`,NA="FIS_v2",SL="https://firebaseinstallations.googleapis.com/v1",CL=3600*1e3,AL="installations",TL="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ya=new Ba(AL,TL,IL);function RA(n){return n instanceof wi&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA({projectId:n}){return`${SL}/projects/${n}/installations`}function PA(n){return{token:n.token,requestStatus:2,expiresIn:kL(n.expiresIn),creationTime:Date.now()}}async function MA(n,t){const i=(await t.json()).error;return ya.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function LA({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function DL(n,{refreshToken:t}){const r=LA(n);return r.append("Authorization",NL(t)),r}async function OA(n){const t=await n();return t.status>=500&&t.status<600?n():t}function kL(n){return Number(n.replace("s","000"))}function NL(n){return`${NA} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RL({appConfig:n,heartbeatServiceProvider:t},{fid:r}){const i=FA(n),s=LA(n),o=t.getImmediate({optional:!0});if(o){const c=await o.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const a={fid:r,authVersion:NA,appId:n.appId,sdkVersion:kA},u={method:"POST",headers:s,body:JSON.stringify(a)},l=await OA(()=>fetch(i,u));if(l.ok){const c=await l.json();return{fid:c.fid||r,registrationStatus:2,refreshToken:c.refreshToken,authToken:PA(c.authToken)}}else throw await MA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(n){return new Promise(t=>{setTimeout(t,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FL(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PL=/^[cdef][\w-]{21}$/,q0="";function ML(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const r=LL(n);return PL.test(r)?r:q0}catch{return q0}}function LL(n){return FL(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA=new Map;function UA(n,t){const r=ig(n);$A(r,t),OL(r,t)}function $A(n,t){const r=BA.get(n);if(r)for(const i of r)i(t)}function OL(n,t){const r=VL();r&&r.postMessage({key:n,fid:t}),BL()}let aa=null;function VL(){return!aa&&"BroadcastChannel"in self&&(aa=new BroadcastChannel("[Firebase] FID Change"),aa.onmessage=n=>{$A(n.data.key,n.data.fid)}),aa}function BL(){BA.size===0&&aa&&(aa.close(),aa=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL="firebase-installations-database",$L=1,va="firebase-installations-store";let km=null;function Rv(){return km||(km=EA(UL,$L,{upgrade:(n,t)=>{switch(t){case 0:n.createObjectStore(va)}}})),km}async function Ld(n,t){const r=ig(n),s=(await Rv()).transaction(va,"readwrite"),o=s.objectStore(va),a=await o.get(r);return await o.put(t,r),await s.done,(!a||a.fid!==t.fid)&&UA(n,t.fid),t}async function jA(n){const t=ig(n),i=(await Rv()).transaction(va,"readwrite");await i.objectStore(va).delete(t),await i.done}async function sg(n,t){const r=ig(n),s=(await Rv()).transaction(va,"readwrite"),o=s.objectStore(va),a=await o.get(r),u=t(a);return u===void 0?await o.delete(r):await o.put(u,r),await s.done,u&&(!a||a.fid!==u.fid)&&UA(n,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fv(n){let t;const r=await sg(n.appConfig,i=>{const s=jL(i),o=GL(n,s);return t=o.registrationPromise,o.installationEntry});return r.fid===q0?{installationEntry:await t}:{installationEntry:r,registrationPromise:t}}function jL(n){const t=n||{fid:ML(),registrationStatus:0};return GA(t)}function GL(n,t){if(t.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(ya.create("app-offline"));return{installationEntry:t,registrationPromise:s}}const r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=zL(n,r);return{installationEntry:r,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:qL(n)}:{installationEntry:t}}async function zL(n,t){try{const r=await RL(n,t);return Ld(n.appConfig,r)}catch(r){throw RA(r)&&r.customData.serverCode===409?await jA(n.appConfig):await Ld(n.appConfig,{fid:t.fid,registrationStatus:0}),r}}async function qL(n){let t=await fx(n.appConfig);for(;t.registrationStatus===1;)await VA(100),t=await fx(n.appConfig);if(t.registrationStatus===0){const{installationEntry:r,registrationPromise:i}=await Fv(n);return i||r}return t}function fx(n){return sg(n,t=>{if(!t)throw ya.create("installation-not-found");return GA(t)})}function GA(n){return HL(n)?{fid:n.fid,registrationStatus:0}:n}function HL(n){return n.registrationStatus===1&&n.registrationTime+DA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WL({appConfig:n,heartbeatServiceProvider:t},r){const i=KL(n,r),s=DL(n,r),o=t.getImmediate({optional:!0});if(o){const c=await o.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const a={installation:{sdkVersion:kA,appId:n.appId}},u={method:"POST",headers:s,body:JSON.stringify(a)},l=await OA(()=>fetch(i,u));if(l.ok){const c=await l.json();return PA(c)}else throw await MA("Generate Auth Token",l)}function KL(n,{fid:t}){return`${FA(n)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pv(n,t=!1){let r;const i=await sg(n.appConfig,o=>{if(!zA(o))throw ya.create("not-registered");const a=o.authToken;if(!t&&ZL(a))return o;if(a.requestStatus===1)return r=YL(n,t),o;{if(!navigator.onLine)throw ya.create("app-offline");const u=JL(o);return r=XL(n,u),u}});return r?await r:i.authToken}async function YL(n,t){let r=await dx(n.appConfig);for(;r.authToken.requestStatus===1;)await VA(100),r=await dx(n.appConfig);const i=r.authToken;return i.requestStatus===0?Pv(n,t):i}function dx(n){return sg(n,t=>{if(!zA(t))throw ya.create("not-registered");const r=t.authToken;return eO(r)?{...t,authToken:{requestStatus:0}}:t})}async function XL(n,t){try{const r=await WL(n,t),i={...t,authToken:r};return await Ld(n.appConfig,i),r}catch(r){if(RA(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await jA(n.appConfig);else{const i={...t,authToken:{requestStatus:0}};await Ld(n.appConfig,i)}throw r}}function zA(n){return n!==void 0&&n.registrationStatus===2}function ZL(n){return n.requestStatus===2&&!QL(n)}function QL(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+CL}function JL(n){const t={requestStatus:1,requestTime:Date.now()};return{...n,authToken:t}}function eO(n){return n.requestStatus===1&&n.requestTime+DA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tO(n){const t=n,{installationEntry:r,registrationPromise:i}=await Fv(t);return i?i.catch(console.error):Pv(t).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rO(n,t=!1){const r=n;return await nO(r),(await Pv(r,t)).token}async function nO(n){const{registrationPromise:t}=await Fv(n);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO(n){if(!n||!n.options)throw Nm("App Configuration");if(!n.name)throw Nm("App Name");const t=["projectId","apiKey","appId"];for(const r of t)if(!n.options[r])throw Nm(r);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Nm(n){return ya.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA="installations",sO="installations-internal",oO=n=>{const t=n.getProvider("app").getImmediate(),r=iO(t),i=Ua(t,"heartbeat");return{app:t,appConfig:r,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},aO=n=>{const t=n.getProvider("app").getImmediate(),r=Ua(t,qA).getImmediate();return{getId:()=>tO(r),getToken:s=>rO(r,s)}};function uO(){Gi(new bi(qA,oO,"PUBLIC")),Gi(new bi(sO,aO,"PRIVATE"))}uO();ti(IA,Nv);ti(IA,Nv,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="analytics",lO="firebase_id",cO="origin",hO=60*1e3,fO="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Mv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new ng("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gn=new Ba("analytics","Analytics",dO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(n){if(!n.startsWith(Mv)){const t=Gn.create("invalid-gtag-resource",{gtagURL:n});return Rn.warn(t.message),""}return n}function HA(n){return Promise.all(n.map(t=>t.catch(r=>r)))}function gO(n,t){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(n,t)),r}function mO(n,t){const r=gO("firebase-js-sdk-policy",{createScriptURL:pO}),i=document.createElement("script"),s=`${Mv}?l=${n}&id=${t}`;i.src=r?r==null?void 0:r.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function yO(n){let t=[];return Array.isArray(window[n])?t=window[n]:window[n]=t,t}async function vO(n,t,r,i,s,o){const a=i[s];try{if(a)await t[a];else{const l=(await HA(r)).find(c=>c.measurementId===s);l&&await t[l.appId]}}catch(u){Rn.error(u)}n("config",s,o)}async function _O(n,t,r,i,s){try{let o=[];if(s&&s.send_to){let a=s.send_to;Array.isArray(a)||(a=[a]);const u=await HA(r);for(const l of a){const c=u.find(f=>f.measurementId===l),h=c&&t[c.appId];if(h)o.push(h);else{o=[];break}}}o.length===0&&(o=Object.values(t)),await Promise.all(o),n("event",i,s||{})}catch(o){Rn.error(o)}}function bO(n,t,r,i){async function s(o,...a){try{if(o==="event"){const[u,l]=a;await _O(n,t,r,u,l)}else if(o==="config"){const[u,l]=a;await vO(n,t,r,i,u,l)}else if(o==="consent"){const[u,l]=a;n("consent",u,l)}else if(o==="get"){const[u,l,c]=a;n("get",u,l,c)}else if(o==="set"){const[u]=a;n("set",u)}else n(o,...a)}catch(u){Rn.error(u)}}return s}function xO(n,t,r,i,s){let o=function(...a){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=bO(o,n,t,r),{gtagCore:o,wrappedGtag:window[s]}}function wO(n){const t=window.document.getElementsByTagName("script");for(const r of Object.values(t))if(r.src&&r.src.includes(Mv)&&r.src.includes(n))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=30,SO=1e3;class CO{constructor(t={},r=SO){this.throttleMetadata=t,this.intervalMillis=r}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,r){this.throttleMetadata[t]=r}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const WA=new CO;function AO(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function TO(n){var a;const{appId:t,apiKey:r}=n,i={method:"GET",headers:AO(r)},s=fO.replace("{app-id}",t),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let u="";try{const l=await o.json();(a=l.error)!=null&&a.message&&(u=l.error.message)}catch{}throw Gn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:u})}return o.json()}async function IO(n,t=WA,r){const{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw Gn.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw Gn.create("no-api-key")}const a=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new NO;return setTimeout(async()=>{u.abort()},hO),KA({appId:i,apiKey:s,measurementId:o},a,u,t)}async function KA(n,{throttleEndTimeMillis:t,backoffCount:r},i,s=WA){var u;const{appId:o,measurementId:a}=n;try{await DO(i,t)}catch(l){if(a)return Rn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await TO(n);return s.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!kO(c)){if(s.deleteThrottleMetadata(o),a)return Rn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const h=Number((u=c==null?void 0:c.customData)==null?void 0:u.httpStatus)===503?nx(r,s.intervalMillis,EO):nx(r,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:r+1};return s.setThrottleMetadata(o,f),Rn.debug(`Calling attemptFetch again in ${h} millis`),KA(n,f,i,s)}}function DO(n,t){return new Promise((r,i)=>{const s=Math.max(t-Date.now(),0),o=setTimeout(r,s);n.addEventListener(()=>{clearTimeout(o),i(Gn.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function kO(n){if(!(n instanceof wi)||!n.customData)return!1;const t=Number(n.customData.httpStatus);return t===429||t===500||t===503||t===504}class NO{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function RO(n,t,r,i,s){if(s&&s.global){n("event",r,i);return}else{const o=await t,a={...i,send_to:o};n("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FO(){if(Dv())try{await bA()}catch(n){return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return Rn.warn(Gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function PO(n,t,r,i,s,o,a){const u=IO(n);u.then(d=>{r[d.measurementId]=d.appId,n.options.measurementId&&d.measurementId!==n.options.measurementId&&Rn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>Rn.error(d)),t.push(u);const l=FO().then(d=>{if(d)return i.getId()}),[c,h]=await Promise.all([u,l]);wO(o)||mO(o,c.measurementId),s("js",new Date);const f=(a==null?void 0:a.config)??{};return f[cO]="firebase",f.update=!0,h!=null&&(f[lO]=h),s("config",c.measurementId,f),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(t){this.app=t}_delete(){return delete wc[this.app.options.appId],Promise.resolve()}}let wc={},px=[];const gx={};let Rm="dataLayer",LO="gtag",mx,YA,yx=!1;function OO(){const n=[];if(yA()&&n.push("This is a browser extension environment."),n3()||n.push("Cookies are not available."),n.length>0){const t=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),r=Gn.create("invalid-analytics-context",{errorInfo:t});Rn.warn(r.message)}}function VO(n,t,r){OO();const i=n.options.appId;if(!i)throw Gn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Rn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gn.create("no-api-key");if(wc[i]!=null)throw Gn.create("already-exists",{id:i});if(!yx){yO(Rm);const{wrappedGtag:o,gtagCore:a}=xO(wc,px,gx,Rm,LO);YA=o,mx=a,yx=!0}return wc[i]=PO(n,px,gx,t,mx,Rm,r),new MO(n)}function BO(n=CA()){n=$r(n);const t=Ua(n,Od);return t.isInitialized()?t.getImmediate():UO(n)}function UO(n,t={}){const r=Ua(n,Od);if(r.isInitialized()){const s=r.getImmediate();if(wo(t,r.getOptions()))return s;throw Gn.create("already-initialized")}return r.initialize({options:t})}function $O(n,t,r,i){n=$r(n),RO(YA,wc[n.app.options.appId],t,r,i).catch(s=>Rn.error(s))}const vx="@firebase/analytics",_x="0.10.18";function jO(){Gi(new bi(Od,(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();return VO(i,s,r)},"PUBLIC")),Gi(new bi("analytics-internal",n,"PRIVATE")),ti(vx,_x),ti(vx,_x,"esm2020");function n(t){try{const r=t.getProvider(Od).getImmediate();return{logEvent:(i,s,o)=>$O(r,i,s,o)}}catch(r){throw Gn.create("interop-component-reg-failed",{reason:r})}}}jO();function XA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GO=XA,ZA=new Ba("auth","Firebase",XA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd=new ng("@firebase/auth");function zO(n,...t){Vd.logLevel<=Tt.WARN&&Vd.warn(`Auth (${wl}): ${n}`,...t)}function td(n,...t){Vd.logLevel<=Tt.ERROR&&Vd.error(`Auth (${wl}): ${n}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(n,...t){throw Ov(n,...t)}function yi(n,...t){return Ov(n,...t)}function Lv(n,t,r){const i={...GO(),[t]:r};return new Ba("auth","Firebase",i).create(t,{appName:n.name})}function da(n){return Lv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qO(n,t,r){const i=r;if(!(t instanceof i))throw i.name!==t.constructor.name&&zi(n,"argument-error"),Lv(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ov(n,...t){if(typeof n!="string"){const r=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(r,...i)}return ZA.create(n,...t)}function ft(n,t,...r){if(!n)throw Ov(t,...r)}function cs(n){const t="INTERNAL ASSERTION FAILED: "+n;throw td(t),new Error(t)}function xs(n,t){n||cs(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function HO(){return bx()==="http:"||bx()==="https:"}function bx(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HO()||yA()||"connection"in navigator)?navigator.onLine:!0}function KO(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(t,r){this.shortDelay=t,this.longDelay=r,xs(r>t,"Short delay should be less than long delay!"),this.isMobile=JM()||t3()}get(){return WO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(n,t){xs(n.emulator,"Emulator should always be set here");const{url:r}=n.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{static initialize(t,r,i){this.fetchImpl=t,r&&(this.headersImpl=r),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ZO=new Wh(3e4,6e4);function Bv(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function El(n,t,r,i,s={}){return JA(n,s,async()=>{let o={},a={};i&&(t==="GET"?a=i:o={body:JSON.stringify(i)});const u=Hh({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:t,headers:l,...o};return e3()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&xl(n.emulatorConfig.host)&&(c.credentials="include"),QA.fetch()(await eT(n,n.config.apiHost,r,u),c)})}async function JA(n,t,r){n._canInitEmulator=!1;const i={...YO,...t};try{const s=new JO(n),o=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Sf(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const u=o.ok?a.errorMessage:a.error.message,[l,c]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sf(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Sf(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Sf(n,"user-disabled",a);const h=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Lv(n,h,c);zi(n,h)}}catch(s){if(s instanceof wi)throw s;zi(n,"network-request-failed",{message:String(s)})}}async function QO(n,t,r,i,s={}){const o=await El(n,t,r,i,s);return"mfaPendingCredential"in o&&zi(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function eT(n,t,r,i){const s=`${t}${r}?${i}`,o=n,a=o.config.emulator?Vv(n.config,s):`${n.config.apiScheme}://${s}`;return XO.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class JO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,i)=>{this.timer=setTimeout(()=>i(yi(this.auth,"network-request-failed")),ZO.get())})}}function Sf(n,t,r){const i={appName:n.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);const s=yi(n,t,i);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e4(n,t){return El(n,"POST","/v1/accounts:delete",t)}async function Bd(n,t){return El(n,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function t4(n,t=!1){const r=$r(n),i=await r.getIdToken(t),s=Uv(i);ft(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:Ec(Fm(s.auth_time)),issuedAtTime:Ec(Fm(s.iat)),expirationTime:Ec(Fm(s.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Fm(n){return Number(n)*1e3}function Uv(n){const[t,r,i]=n.split(".");if(t===void 0||r===void 0||i===void 0)return td("JWT malformed, contained fewer than 3 sections"),null;try{const s=hA(r);return s?JSON.parse(s):(td("Failed to decode base64 JWT payload"),null)}catch(s){return td("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function xx(n){const t=Uv(n);return ft(t,"internal-error"),ft(typeof t.exp<"u","internal-error"),ft(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wc(n,t,r=!1){if(r)return t;try{return await t}catch(i){throw i instanceof wi&&r4(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function r4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ec(this.lastLoginAt),this.creationTime=Ec(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ud(n){var f;const t=n.auth,r=await n.getIdToken(),i=await Wc(n,Bd(t,{idToken:r}));ft(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=(f=s.providerUserInfo)!=null&&f.length?tT(s.providerUserInfo):[],a=s4(n.providerData,o),u=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),c=u?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new W0(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function i4(n){const t=$r(n);await Ud(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function s4(n,t){return[...n.filter(i=>!t.some(s=>s.providerId===i.providerId)),...t]}function tT(n){return n.map(({providerId:t,...r})=>({providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o4(n,t){const r=await JA(n,{},async()=>{const i=Hh({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,a=await eT(n,s,"/v1/token",`key=${o}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:u,body:i};return n.emulatorConfig&&xl(n.emulatorConfig.host)&&(l.credentials="include"),QA.fetch()(a,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function a4(n,t){return El(n,"POST","/v2/accounts:revokeToken",Bv(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ft(t.idToken,"internal-error"),ft(typeof t.idToken<"u","internal-error"),ft(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):xx(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){ft(t.length!==0,"internal-error");const r=xx(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:i,refreshToken:s,expiresIn:o}=await o4(t,r);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(t,r,i){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,r){const{refreshToken:i,accessToken:s,expirationTime:o}=r,a=new Cu;return i&&(ft(typeof i=="string","internal-error",{appName:t}),a.refreshToken=i),s&&(ft(typeof s=="string","internal-error",{appName:t}),a.accessToken=s),o&&(ft(typeof o=="number","internal-error",{appName:t}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Cu,this.toJSON())}_performRefresh(){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(n,t){ft(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class di{constructor({uid:t,auth:r,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new n4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new W0(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await Wc(this,this.stsTokenManager.getToken(this.auth,t));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return t4(this,t)}reload(){return i4(this)}_assign(t){this!==t&&(ft(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>({...r})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new di({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(t){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),r&&await Ud(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fi(this.auth.app))return Promise.reject(da(this.auth));const t=await this.getIdToken();return await Wc(this,e4(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){const i=r.displayName??void 0,s=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,u=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:f,emailVerified:d,isAnonymous:p,providerData:g,stsTokenManager:y}=r;ft(f&&y,t,"internal-error");const v=Cu.fromJSON(this.name,y);ft(typeof f=="string",t,"internal-error"),Vs(i,t.name),Vs(s,t.name),ft(typeof d=="boolean",t,"internal-error"),ft(typeof p=="boolean",t,"internal-error"),Vs(o,t.name),Vs(a,t.name),Vs(u,t.name),Vs(l,t.name),Vs(c,t.name),Vs(h,t.name);const T=new di({uid:f,auth:t,email:s,emailVerified:d,displayName:i,isAnonymous:p,photoURL:a,phoneNumber:o,tenantId:u,stsTokenManager:v,createdAt:c,lastLoginAt:h});return g&&Array.isArray(g)&&(T.providerData=g.map(_=>({..._}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(t,r,i=!1){const s=new Cu;s.updateFromServerResponse(r);const o=new di({uid:r.localId,auth:t,stsTokenManager:s,isAnonymous:i});return await Ud(o),o}static async _fromGetAccountInfoResponse(t,r,i){const s=r.users[0];ft(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?tT(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),u=new Cu;u.updateFromIdToken(i);const l=new di({uid:s.localId,auth:t,stsTokenManager:u,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new W0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx=new Map;function hs(n){xs(n instanceof Function,"Expected a class definition");let t=wx.get(n);return t?(xs(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,wx.set(n,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}rT.type="NONE";const Ex=rT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(n,t,r){return`firebase:${n}:${t}:${r}`}class Au{constructor(t,r,i){this.persistence=t,this.auth=r,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=rd(this.userKey,s.apiKey,o),this.fullPersistenceKey=rd("persistence",s.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const r=await Bd(this.auth,{idToken:t}).catch(()=>{});return r?di._fromGetAccountInfoResponse(this.auth,r,t):null}return di._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,i="authUser"){if(!r.length)return new Au(hs(Ex),t,i);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let o=s[0]||hs(Ex);const a=rd(i,t.config.apiKey,t.name);let u=null;for(const c of r)try{const h=await c._get(a);if(h){let f;if(typeof h=="string"){const d=await Bd(t,{idToken:h}).catch(()=>{});if(!d)break;f=await di._fromGetAccountInfoResponse(t,d,h)}else f=di._fromJSON(t,h);c!==o&&(u=f),o=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new Au(o,t,i):(o=l[0],u&&await o._set(a,u.toJSON()),await Promise.all(r.map(async c=>{if(c!==o)try{await c._remove(a)}catch{}})),new Au(o,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(oT(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(nT(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(uT(t))return"Blackberry";if(lT(t))return"Webos";if(iT(t))return"Safari";if((t.includes("chrome/")||sT(t))&&!t.includes("edge/"))return"Chrome";if(aT(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(r);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function nT(n=Ur()){return/firefox\//i.test(n)}function iT(n=Ur()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function sT(n=Ur()){return/crios\//i.test(n)}function oT(n=Ur()){return/iemobile/i.test(n)}function aT(n=Ur()){return/android/i.test(n)}function uT(n=Ur()){return/blackberry/i.test(n)}function lT(n=Ur()){return/webos/i.test(n)}function $v(n=Ur()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function u4(n=Ur()){var t;return $v(n)&&!!((t=window.navigator)!=null&&t.standalone)}function l4(){return r3()&&document.documentMode===10}function cT(n=Ur()){return $v(n)||aT(n)||lT(n)||uT(n)||/windows phone/i.test(n)||oT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(n,t=[]){let r;switch(n){case"Browser":r=Sx(Ur());break;case"Worker":r=`${Sx(Ur())}-${n}`;break;default:r=n}const i=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${wl}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const i=o=>new Promise((a,u)=>{try{const l=t(o);a(l)}catch(l){u(l)}});i.onAbort=r,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const i of this.queue)await i(t),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h4(n,t={}){return El(n,"GET","/v2/passwordPolicy",Bv(n,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=6;class d4{constructor(t){var i;const r=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??f4,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=t.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,r),this.validatePasswordCharacterOptions(t,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(t,r){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(r.meetsMinPasswordLength=t.length>=i),s&&(r.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let i;for(let s=0;s<t.length;s++)i=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,r,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(t,r,i,s){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cx(this),this.idTokenSubscription=new Cx(this),this.beforeStateQueue=new c4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ZA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=hs(r)),this._initializationPromise=this.queue(async()=>{var i,s,o;if(!this._deleted&&(this.persistenceManager=await Au.create(this,t),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await Bd(this,{idToken:t}),i=await di._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var o;if(fi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(o=this.redirectUser)==null?void 0:o._redirectEventId,u=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===u)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await Ud(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=KO()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(fi(this.app))return Promise.reject(da(this));const r=t?$r(t):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&ft(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return fi(this.app)?Promise.reject(da(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return fi(this.app)?Promise.reject(da(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(hs(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await h4(this),r=new d4(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Ba("auth","Firebase",t())}onAuthStateChanged(t,r,i){return this.registerStateListener(this.authStateSubscription,t,r,i)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,i){return this.registerStateListener(this.idTokenSubscription,t,r,i)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(i.tenantId=this.tenantId),await a4(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)==null?void 0:t.toJSON()}}async _setRedirectUser(t,r){const i=await this.getOrInitRedirectPersistenceManager(r);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&hs(t)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await Au.create(this,[hs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,i;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===t?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,i,s){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,i,s);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=hT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var r;if(fi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return t!=null&&t.error&&zO(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function og(n){return $r(n)}class Cx{constructor(t){this.auth=t,this.observer=null,this.addObserver=u3(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function g4(n){jv=n}function m4(n){return jv.loadJS(n)}function y4(){return jv.gapiScript}function v4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(n,t){const r=Ua(n,"auth");if(r.isInitialized()){const s=r.getImmediate(),o=r.getOptions();if(wo(o,t??{}))return s;zi(s,"already-initialized")}return r.initialize({options:t})}function b4(n,t){const r=(t==null?void 0:t.persistence)||[],i=(Array.isArray(r)?r:[r]).map(hs);t!=null&&t.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function x4(n,t,r){const i=og(n);ft(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!1,o=fT(t),{host:a,port:u}=w4(t),l=u===null?"":`:${u}`,c={url:`${o}//${a}${l}/`},h=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){ft(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ft(wo(c,i.config.emulator)&&wo(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,xl(a)?(gA(`${o}//${a}${l}`),QM("Auth",!0)):E4()}function fT(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function w4(n){const t=fT(n),r=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!r)return{host:"",port:null};const i=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:Ax(i.substr(o.length+1))}}else{const[o,a]=i.split(":");return{host:o,port:Ax(a)}}}function Ax(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function E4(){function n(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return cs("not implemented")}_getIdTokenResponse(t){return cs("not implemented")}_linkToIdToken(t,r){return cs("not implemented")}_getReauthenticationResolver(t){return cs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tu(n,t){return QO(n,"POST","/v1/accounts:signInWithIdp",Bv(n,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4="http://localhost";class _a extends dT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new _a(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):zi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:s,...o}=r;if(!i||!s)return null;const a=new _a(i,s);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return Tu(t,r)}_linkToIdToken(t,r){const i=this.buildRequest();return i.idToken=r,Tu(t,i)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Tu(t,r)}buildRequest(){const t={requestUri:S4,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Hh(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends Gv{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks extends Kh{constructor(){super("facebook.com")}static credential(t){return _a._fromParams({providerId:Ks.PROVIDER_ID,signInMethod:Ks.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ks.credentialFromTaggedObject(t)}static credentialFromError(t){return Ks.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ks.credential(t.oauthAccessToken)}catch{return null}}}Ks.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ks.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls extends Kh{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return _a._fromParams({providerId:ls.PROVIDER_ID,signInMethod:ls.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return ls.credentialFromTaggedObject(t)}static credentialFromError(t){return ls.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return ls.credential(r,i)}catch{return null}}}ls.GOOGLE_SIGN_IN_METHOD="google.com";ls.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys extends Kh{constructor(){super("github.com")}static credential(t){return _a._fromParams({providerId:Ys.PROVIDER_ID,signInMethod:Ys.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ys.credentialFromTaggedObject(t)}static credentialFromError(t){return Ys.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ys.credential(t.oauthAccessToken)}catch{return null}}}Ys.GITHUB_SIGN_IN_METHOD="github.com";Ys.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs extends Kh{constructor(){super("twitter.com")}static credential(t,r){return _a._fromParams({providerId:Xs.PROVIDER_ID,signInMethod:Xs.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Xs.credentialFromTaggedObject(t)}static credentialFromError(t){return Xs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return Xs.credential(r,i)}catch{return null}}}Xs.TWITTER_SIGN_IN_METHOD="twitter.com";Xs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,i,s=!1){const o=await di._fromIdTokenResponse(t,i,s),a=Tx(i);return new zu({user:o,providerId:a,_tokenResponse:i,operationType:r})}static async _forOperation(t,r,i){await t._updateTokensIfNecessary(i,!0);const s=Tx(i);return new zu({user:t,providerId:s,_tokenResponse:i,operationType:r})}}function Tx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d extends wi{constructor(t,r,i,s){super(r.code,r.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,$d.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,r,i,s){return new $d(t,r,i,s)}}function pT(n,t,r,i){return(t==="reauthenticate"?r._getReauthenticationResolver(n):r._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?$d._fromErrorAndOperation(n,o,t,i):o})}async function C4(n,t,r=!1){const i=await Wc(n,t._linkToIdToken(n.auth,await n.getIdToken()),r);return zu._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(n,t,r=!1){const{auth:i}=n;if(fi(i.app))return Promise.reject(da(i));const s="reauthenticate";try{const o=await Wc(n,pT(i,s,t,n),r);ft(o.idToken,i,"internal-error");const a=Uv(o.idToken);ft(a,i,"internal-error");const{sub:u}=a;return ft(n.uid===u,i,"user-mismatch"),zu._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&zi(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T4(n,t,r=!1){if(fi(n.app))return Promise.reject(da(n));const i="signIn",s=await pT(n,i,t),o=await zu._fromIdTokenResponse(n,i,s);return r||await n._updateCurrentUser(o.user),o}function I4(n,t,r,i){return $r(n).onIdTokenChanged(t,r,i)}function D4(n,t,r){return $r(n).beforeAuthStateChanged(t,r)}function k4(n,t,r,i){return $r(n).onAuthStateChanged(t,r,i)}function N4(n){return $r(n).signOut()}const jd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(jd,"1"),this.storage.removeItem(jd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4=1e3,F4=10;class mT extends gT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cT(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,u,l)=>{this.notifyListeners(a,l)});return}const i=t.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);l4()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,F4):s()}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},R4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}mT.type="LOCAL";const P4=mT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT extends gT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}yT.type="SESSION";const vT=yT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;const i=new ag(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const u=Array.from(a).map(async c=>c(r.origin,o)),l=await M4(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ag.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(n="",t=10){let r="";for(let i=0;i<t;i++)r+=Math.floor(Math.random()*10);return n+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((u,l)=>{const c=zv("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},i);a={messageChannel:s,onMessage(f){const d=f;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(d.data.response);break;default:clearTimeout(h),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(){return window}function O4(n){Li().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(){return typeof Li().WorkerGlobalScope<"u"&&typeof Li().importScripts=="function"}async function V4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function B4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function U4(){return _T()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="firebaseLocalStorageDb",$4=1,Gd="firebaseLocalStorage",xT="fbase_key";class Yh{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ug(n,t){return n.transaction([Gd],t?"readwrite":"readonly").objectStore(Gd)}function j4(){const n=indexedDB.deleteDatabase(bT);return new Yh(n).toPromise()}function K0(){const n=indexedDB.open(bT,$4);return new Promise((t,r)=>{n.addEventListener("error",()=>{r(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Gd,{keyPath:xT})}catch(s){r(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Gd)?t(i):(i.close(),await j4(),t(await K0()))})})}async function Ix(n,t,r){const i=ug(n,!0).put({[xT]:t,value:r});return new Yh(i).toPromise()}async function G4(n,t){const r=ug(n,!1).get(t),i=await new Yh(r).toPromise();return i===void 0?null:i.value}function Dx(n,t){const r=ug(n,!0).delete(t);return new Yh(r).toPromise()}const z4=800,q4=3;class wT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await K0(),this.db)}async _withRetries(t){let r=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(r++>q4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _T()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ag._getInstance(U4()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var r,i;if(this.activeServiceWorker=await V4(),!this.activeServiceWorker)return;this.sender=new L4(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&(r=t[0])!=null&&r.fulfilled&&(i=t[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||B4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await K0();return await Ix(t,jd,"1"),await Dx(t,jd),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>Ix(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(i=>G4(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Dx(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const o=ug(s,!1).getAll();return new Yh(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],i=new Set;if(t.length!==0)for(const{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),z4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wT.type="LOCAL";const H4=wT;new Wh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(n,t){return t?hs(t):(ft(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv extends dT{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Tu(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Tu(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Tu(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function W4(n){return T4(n.auth,new qv(n),n.bypassAuthState)}function K4(n){const{auth:t,user:r}=n;return ft(r,t,"internal-error"),A4(r,new qv(n),n.bypassAuthState)}async function Y4(n){const{auth:t,user:r}=n;return ft(r,t,"internal-error"),C4(r,new qv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(t,r,i,s,o=!1){this.auth=t,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:i,postBody:s,tenantId:o,error:a,type:u}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return W4;case"linkViaPopup":case"linkViaRedirect":return Y4;case"reauthViaPopup":case"reauthViaRedirect":return K4;default:zi(this.auth,"internal-error")}}resolve(t){xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=new Wh(2e3,1e4);async function Z4(n,t,r){if(fi(n.app))return Promise.reject(yi(n,"operation-not-supported-in-this-environment"));const i=og(n);qO(n,t,Gv);const s=ET(i,r);return new ua(i,"signInViaPopup",t,s).executeNotNull()}class ua extends ST{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,ua.currentPopupAction&&ua.currentPopupAction.cancel(),ua.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return ft(t,this.auth,"internal-error"),t}async onExecution(){xs(this.filter.length===1,"Popup operations only handle one event");const t=zv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(yi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)==null?void 0:t.associatedEvent)||null}cancel(){this.reject(yi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ua.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,i;if((i=(r=this.authWindow)==null?void 0:r.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,X4.get())};t()}}ua.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="pendingRedirect",nd=new Map;class J4 extends ST{constructor(t,r,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i),this.eventId=null}async execute(){let t=nd.get(this.auth._key());if(!t){try{const i=await eV(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(r){t=()=>Promise.reject(r)}nd.set(this.auth._key(),t)}return this.bypassAuthState||nd.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function eV(n,t){const r=nV(t),i=rV(n);if(!await i._isAvailable())return!1;const s=await i._get(r)==="true";return await i._remove(r),s}function tV(n,t){nd.set(n._key(),t)}function rV(n){return hs(n._redirectPersistence)}function nV(n){return rd(Q4,n.config.apiKey,n.name)}async function iV(n,t,r=!1){if(fi(n.app))return Promise.reject(da(n));const i=og(n),s=ET(i,t),a=await new J4(i,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV=600*1e3;class oV{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(r=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!aV(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var i;if(t.error&&!CT(t)){const s=((i=t.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";r.onError(yi(this.auth,s))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const i=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=sV&&this.cachedEventUids.clear(),this.cachedEventUids.has(kx(t))}saveEventToCache(t){this.cachedEventUids.add(kx(t)),this.lastProcessedEventTime=Date.now()}}function kx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function CT({type:n,error:t}){return n==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function aV(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uV(n,t={}){return El(n,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cV=/^https?/;async function hV(n){if(n.config.emulator)return;const{authorizedDomains:t}=await uV(n);for(const r of t)try{if(fV(r))return}catch{}zi(n,"unauthorized-domain")}function fV(n){const t=H0(),{protocol:r,hostname:i}=new URL(t);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&i===""?r==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===i}if(!cV.test(r))return!1;if(lV.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=new Wh(3e4,6e4);function Nx(){const n=Li().___jsl;if(n!=null&&n.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let r=0;r<n.CP.length;r++)n.CP[r]=null}}function pV(n){return new Promise((t,r)=>{var s,o,a;function i(){Nx(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Nx(),r(yi(n,"network-request-failed"))},timeout:dV.get()})}if((o=(s=Li().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)t(gapi.iframes.getContext());else if((a=Li().gapi)!=null&&a.load)i();else{const u=v4("iframefcb");return Li()[u]=()=>{gapi.load?i():r(yi(n,"network-request-failed"))},m4(`${y4()}?onload=${u}`).catch(l=>r(l))}}).catch(t=>{throw id=null,t})}let id=null;function gV(n){return id=id||pV(n),id}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV=new Wh(5e3,15e3),yV="__/auth/iframe",vV="emulator/auth/iframe",_V={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xV(n){const t=n.config;ft(t.authDomain,n,"auth-domain-config-required");const r=t.emulator?Vv(t,vV):`https://${n.config.authDomain}/${yV}`,i={apiKey:t.apiKey,appName:n.name,v:wl},s=bV.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${r}?${Hh(i).slice(1)}`}async function wV(n){const t=await gV(n),r=Li().gapi;return ft(r,n,"internal-error"),t.open({where:document.body,url:xV(n),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_V,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const a=yi(n,"network-request-failed"),u=Li().setTimeout(()=>{o(a)},mV.get());function l(){Li().clearTimeout(u),s(i)}i.ping(l).then(l,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},SV=500,CV=600,AV="_blank",TV="http://localhost";class Rx{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function IV(n,t,r,i=SV,s=CV){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let u="";const l={...EV,width:i.toString(),height:s.toString(),top:o,left:a},c=Ur().toLowerCase();r&&(u=sT(c)?AV:r),nT(c)&&(t=t||TV,l.scrollbars="yes");const h=Object.entries(l).reduce((d,[p,g])=>`${d}${p}=${g},`,"");if(u4(c)&&u!=="_self")return DV(t||"",u),new Rx(null);const f=window.open(t||"",u,h);ft(f,n,"popup-blocked");try{f.focus()}catch{}return new Rx(f)}function DV(n,t){const r=document.createElement("a");r.href=n,r.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV="__/auth/handler",NV="emulator/auth/handler",RV=encodeURIComponent("fac");async function Fx(n,t,r,i,s,o){ft(n.config.authDomain,n,"auth-domain-config-required"),ft(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:r,redirectUrl:i,v:wl,eventId:s};if(t instanceof Gv){t.setDefaultLanguage(n.languageCode),a.providerId=t.providerId||"",a3(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[h,f]of Object.entries({}))a[h]=f}if(t instanceof Kh){const h=t.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const u=a;for(const h of Object.keys(u))u[h]===void 0&&delete u[h];const l=await n._getAppCheckToken(),c=l?`#${RV}=${encodeURIComponent(l)}`:"";return`${FV(n)}?${Hh(u).slice(1)}${c}`}function FV({config:n}){return n.emulator?Vv(n,NV):`https://${n.authDomain}/${kV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm="webStorageSupport";class PV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vT,this._completeRedirectFn=iV,this._overrideRedirectResult=tV}async _openPopup(t,r,i,s){var a;xs((a=this.eventManagers[t._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await Fx(t,r,i,H0(),s);return IV(t,o,zv())}async _openRedirect(t,r,i,s){await this._originValidation(t);const o=await Fx(t,r,i,H0(),s);return O4(o),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:s,promise:o}=this.eventManagers[r];return s?Promise.resolve(s):(xs(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(t);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(t){const r=await wV(t),i=new oV(t);return r.register("authEvent",s=>(ft(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=r,i}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(Pm,{type:Pm},s=>{var a;const o=(a=s==null?void 0:s[0])==null?void 0:a[Pm];o!==void 0&&r(!!o),zi(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=hV(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return cT()||iT()||$v()}}const MV=PV;var Px="@firebase/auth",Mx="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)==null?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function VV(n){Gi(new bi("auth",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=i.options;ft(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hT(n)},c=new p4(i,s,o,l);return b4(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,i)=>{t.getProvider("auth-internal").initialize()})),Gi(new bi("auth-internal",t=>{const r=og(t.getProvider("auth").getImmediate());return(i=>new LV(i))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ti(Px,Mx,OV(n)),ti(Px,Mx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=300,UV=pA("authIdTokenMaxAge")||BV;let Lx=null;const $V=n=>async t=>{const r=t&&await t.getIdTokenResult(),i=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>UV)return;const s=r==null?void 0:r.token;Lx!==s&&(Lx=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function jV(n=CA()){const t=Ua(n,"auth");if(t.isInitialized())return t.getImmediate();const r=_4(n,{popupRedirectResolver:MV,persistence:[H4,P4,vT]}),i=pA("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const a=$V(o.toString());D4(r,a,()=>a(r.currentUser)),I4(r,u=>a(u))}}const s=KM("auth");return s&&x4(r,`http://${s}`),r}function GV(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}g4({loadJS(n){return new Promise((t,r)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=t,i.onerror=s=>{const o=yi("internal-error");o.customData=s,r(o)},i.type="text/javascript",i.charset="UTF-8",GV().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});VV("Browser");var Ox=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var po,AT;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(w,x){function b(){}b.prototype=x.prototype,w.F=x.prototype,w.prototype=new b,w.prototype.constructor=w,w.D=function(A,k,N){for(var I=Array(arguments.length-2),j=2;j<arguments.length;j++)I[j-2]=arguments[j];return x.prototype[k].apply(A,I)}}function r(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,r),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,x,b){b||(b=0);const A=Array(16);if(typeof x=="string")for(var k=0;k<16;++k)A[k]=x.charCodeAt(b++)|x.charCodeAt(b++)<<8|x.charCodeAt(b++)<<16|x.charCodeAt(b++)<<24;else for(k=0;k<16;++k)A[k]=x[b++]|x[b++]<<8|x[b++]<<16|x[b++]<<24;x=w.g[0],b=w.g[1],k=w.g[2];let N=w.g[3],I;I=x+(N^b&(k^N))+A[0]+3614090360&4294967295,x=b+(I<<7&4294967295|I>>>25),I=N+(k^x&(b^k))+A[1]+3905402710&4294967295,N=x+(I<<12&4294967295|I>>>20),I=k+(b^N&(x^b))+A[2]+606105819&4294967295,k=N+(I<<17&4294967295|I>>>15),I=b+(x^k&(N^x))+A[3]+3250441966&4294967295,b=k+(I<<22&4294967295|I>>>10),I=x+(N^b&(k^N))+A[4]+4118548399&4294967295,x=b+(I<<7&4294967295|I>>>25),I=N+(k^x&(b^k))+A[5]+1200080426&4294967295,N=x+(I<<12&4294967295|I>>>20),I=k+(b^N&(x^b))+A[6]+2821735955&4294967295,k=N+(I<<17&4294967295|I>>>15),I=b+(x^k&(N^x))+A[7]+4249261313&4294967295,b=k+(I<<22&4294967295|I>>>10),I=x+(N^b&(k^N))+A[8]+1770035416&4294967295,x=b+(I<<7&4294967295|I>>>25),I=N+(k^x&(b^k))+A[9]+2336552879&4294967295,N=x+(I<<12&4294967295|I>>>20),I=k+(b^N&(x^b))+A[10]+4294925233&4294967295,k=N+(I<<17&4294967295|I>>>15),I=b+(x^k&(N^x))+A[11]+2304563134&4294967295,b=k+(I<<22&4294967295|I>>>10),I=x+(N^b&(k^N))+A[12]+1804603682&4294967295,x=b+(I<<7&4294967295|I>>>25),I=N+(k^x&(b^k))+A[13]+4254626195&4294967295,N=x+(I<<12&4294967295|I>>>20),I=k+(b^N&(x^b))+A[14]+2792965006&4294967295,k=N+(I<<17&4294967295|I>>>15),I=b+(x^k&(N^x))+A[15]+1236535329&4294967295,b=k+(I<<22&4294967295|I>>>10),I=x+(k^N&(b^k))+A[1]+4129170786&4294967295,x=b+(I<<5&4294967295|I>>>27),I=N+(b^k&(x^b))+A[6]+3225465664&4294967295,N=x+(I<<9&4294967295|I>>>23),I=k+(x^b&(N^x))+A[11]+643717713&4294967295,k=N+(I<<14&4294967295|I>>>18),I=b+(N^x&(k^N))+A[0]+3921069994&4294967295,b=k+(I<<20&4294967295|I>>>12),I=x+(k^N&(b^k))+A[5]+3593408605&4294967295,x=b+(I<<5&4294967295|I>>>27),I=N+(b^k&(x^b))+A[10]+38016083&4294967295,N=x+(I<<9&4294967295|I>>>23),I=k+(x^b&(N^x))+A[15]+3634488961&4294967295,k=N+(I<<14&4294967295|I>>>18),I=b+(N^x&(k^N))+A[4]+3889429448&4294967295,b=k+(I<<20&4294967295|I>>>12),I=x+(k^N&(b^k))+A[9]+568446438&4294967295,x=b+(I<<5&4294967295|I>>>27),I=N+(b^k&(x^b))+A[14]+3275163606&4294967295,N=x+(I<<9&4294967295|I>>>23),I=k+(x^b&(N^x))+A[3]+4107603335&4294967295,k=N+(I<<14&4294967295|I>>>18),I=b+(N^x&(k^N))+A[8]+1163531501&4294967295,b=k+(I<<20&4294967295|I>>>12),I=x+(k^N&(b^k))+A[13]+2850285829&4294967295,x=b+(I<<5&4294967295|I>>>27),I=N+(b^k&(x^b))+A[2]+4243563512&4294967295,N=x+(I<<9&4294967295|I>>>23),I=k+(x^b&(N^x))+A[7]+1735328473&4294967295,k=N+(I<<14&4294967295|I>>>18),I=b+(N^x&(k^N))+A[12]+2368359562&4294967295,b=k+(I<<20&4294967295|I>>>12),I=x+(b^k^N)+A[5]+4294588738&4294967295,x=b+(I<<4&4294967295|I>>>28),I=N+(x^b^k)+A[8]+2272392833&4294967295,N=x+(I<<11&4294967295|I>>>21),I=k+(N^x^b)+A[11]+1839030562&4294967295,k=N+(I<<16&4294967295|I>>>16),I=b+(k^N^x)+A[14]+4259657740&4294967295,b=k+(I<<23&4294967295|I>>>9),I=x+(b^k^N)+A[1]+2763975236&4294967295,x=b+(I<<4&4294967295|I>>>28),I=N+(x^b^k)+A[4]+1272893353&4294967295,N=x+(I<<11&4294967295|I>>>21),I=k+(N^x^b)+A[7]+4139469664&4294967295,k=N+(I<<16&4294967295|I>>>16),I=b+(k^N^x)+A[10]+3200236656&4294967295,b=k+(I<<23&4294967295|I>>>9),I=x+(b^k^N)+A[13]+681279174&4294967295,x=b+(I<<4&4294967295|I>>>28),I=N+(x^b^k)+A[0]+3936430074&4294967295,N=x+(I<<11&4294967295|I>>>21),I=k+(N^x^b)+A[3]+3572445317&4294967295,k=N+(I<<16&4294967295|I>>>16),I=b+(k^N^x)+A[6]+76029189&4294967295,b=k+(I<<23&4294967295|I>>>9),I=x+(b^k^N)+A[9]+3654602809&4294967295,x=b+(I<<4&4294967295|I>>>28),I=N+(x^b^k)+A[12]+3873151461&4294967295,N=x+(I<<11&4294967295|I>>>21),I=k+(N^x^b)+A[15]+530742520&4294967295,k=N+(I<<16&4294967295|I>>>16),I=b+(k^N^x)+A[2]+3299628645&4294967295,b=k+(I<<23&4294967295|I>>>9),I=x+(k^(b|~N))+A[0]+4096336452&4294967295,x=b+(I<<6&4294967295|I>>>26),I=N+(b^(x|~k))+A[7]+1126891415&4294967295,N=x+(I<<10&4294967295|I>>>22),I=k+(x^(N|~b))+A[14]+2878612391&4294967295,k=N+(I<<15&4294967295|I>>>17),I=b+(N^(k|~x))+A[5]+4237533241&4294967295,b=k+(I<<21&4294967295|I>>>11),I=x+(k^(b|~N))+A[12]+1700485571&4294967295,x=b+(I<<6&4294967295|I>>>26),I=N+(b^(x|~k))+A[3]+2399980690&4294967295,N=x+(I<<10&4294967295|I>>>22),I=k+(x^(N|~b))+A[10]+4293915773&4294967295,k=N+(I<<15&4294967295|I>>>17),I=b+(N^(k|~x))+A[1]+2240044497&4294967295,b=k+(I<<21&4294967295|I>>>11),I=x+(k^(b|~N))+A[8]+1873313359&4294967295,x=b+(I<<6&4294967295|I>>>26),I=N+(b^(x|~k))+A[15]+4264355552&4294967295,N=x+(I<<10&4294967295|I>>>22),I=k+(x^(N|~b))+A[6]+2734768916&4294967295,k=N+(I<<15&4294967295|I>>>17),I=b+(N^(k|~x))+A[13]+1309151649&4294967295,b=k+(I<<21&4294967295|I>>>11),I=x+(k^(b|~N))+A[4]+4149444226&4294967295,x=b+(I<<6&4294967295|I>>>26),I=N+(b^(x|~k))+A[11]+3174756917&4294967295,N=x+(I<<10&4294967295|I>>>22),I=k+(x^(N|~b))+A[2]+718787259&4294967295,k=N+(I<<15&4294967295|I>>>17),I=b+(N^(k|~x))+A[9]+3951481745&4294967295,w.g[0]=w.g[0]+x&4294967295,w.g[1]=w.g[1]+(k+(I<<21&4294967295|I>>>11))&4294967295,w.g[2]=w.g[2]+k&4294967295,w.g[3]=w.g[3]+N&4294967295}i.prototype.v=function(w,x){x===void 0&&(x=w.length);const b=x-this.blockSize,A=this.C;let k=this.h,N=0;for(;N<x;){if(k==0)for(;N<=b;)s(this,w,N),N+=this.blockSize;if(typeof w=="string"){for(;N<x;)if(A[k++]=w.charCodeAt(N++),k==this.blockSize){s(this,A),k=0;break}}else for(;N<x;)if(A[k++]=w[N++],k==this.blockSize){s(this,A),k=0;break}}this.h=k,this.o+=x},i.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var x=1;x<w.length-8;++x)w[x]=0;x=this.o*8;for(var b=w.length-8;b<w.length;++b)w[b]=x&255,x/=256;for(this.v(w),w=Array(16),x=0,b=0;b<4;++b)for(let A=0;A<32;A+=8)w[x++]=this.g[b]>>>A&255;return w};function o(w,x){var b=u;return Object.prototype.hasOwnProperty.call(b,w)?b[w]:b[w]=x(w)}function a(w,x){this.h=x;const b=[];let A=!0;for(let k=w.length-1;k>=0;k--){const N=w[k]|0;A&&N==x||(b[k]=N,A=!1)}this.g=b}var u={};function l(w){return-128<=w&&w<128?o(w,function(x){return new a([x|0],x<0?-1:0)}):new a([w|0],w<0?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return f;if(w<0)return v(c(-w));const x=[];let b=1;for(let A=0;w>=b;A++)x[A]=w/b|0,b*=4294967296;return new a(x,0)}function h(w,x){if(w.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(w.charAt(0)=="-")return v(h(w.substring(1),x));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=c(Math.pow(x,8));let A=f;for(let N=0;N<w.length;N+=8){var k=Math.min(8,w.length-N);const I=parseInt(w.substring(N,N+k),x);k<8?(k=c(Math.pow(x,k)),A=A.j(k).add(c(I))):(A=A.j(b),A=A.add(c(I)))}return A}var f=l(0),d=l(1),p=l(16777216);n=a.prototype,n.m=function(){if(y(this))return-v(this).m();let w=0,x=1;for(let b=0;b<this.g.length;b++){const A=this.i(b);w+=(A>=0?A:4294967296+A)*x,x*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(g(this))return"0";if(y(this))return"-"+v(this).toString(w);const x=c(Math.pow(w,6));var b=this;let A="";for(;;){const k=E(b,x).g;b=T(b,k.j(x));let N=((b.g.length>0?b.g[0]:b.h)>>>0).toString(w);if(b=k,g(b))return N+A;for(;N.length<6;)N="0"+N;A=N+A}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function g(w){if(w.h!=0)return!1;for(let x=0;x<w.g.length;x++)if(w.g[x]!=0)return!1;return!0}function y(w){return w.h==-1}n.l=function(w){return w=T(this,w),y(w)?-1:g(w)?0:1};function v(w){const x=w.g.length,b=[];for(let A=0;A<x;A++)b[A]=~w.g[A];return new a(b,~w.h).add(d)}n.abs=function(){return y(this)?v(this):this},n.add=function(w){const x=Math.max(this.g.length,w.g.length),b=[];let A=0;for(let k=0;k<=x;k++){let N=A+(this.i(k)&65535)+(w.i(k)&65535),I=(N>>>16)+(this.i(k)>>>16)+(w.i(k)>>>16);A=I>>>16,N&=65535,I&=65535,b[k]=I<<16|N}return new a(b,b[b.length-1]&-2147483648?-1:0)};function T(w,x){return w.add(v(x))}n.j=function(w){if(g(this)||g(w))return f;if(y(this))return y(w)?v(this).j(v(w)):v(v(this).j(w));if(y(w))return v(this.j(v(w)));if(this.l(p)<0&&w.l(p)<0)return c(this.m()*w.m());const x=this.g.length+w.g.length,b=[];for(var A=0;A<2*x;A++)b[A]=0;for(A=0;A<this.g.length;A++)for(let k=0;k<w.g.length;k++){const N=this.i(A)>>>16,I=this.i(A)&65535,j=w.i(k)>>>16,Q=w.i(k)&65535;b[2*A+2*k]+=I*Q,_(b,2*A+2*k),b[2*A+2*k+1]+=N*Q,_(b,2*A+2*k+1),b[2*A+2*k+1]+=I*j,_(b,2*A+2*k+1),b[2*A+2*k+2]+=N*j,_(b,2*A+2*k+2)}for(w=0;w<x;w++)b[w]=b[2*w+1]<<16|b[2*w];for(w=x;w<2*x;w++)b[w]=0;return new a(b,0)};function _(w,x){for(;(w[x]&65535)!=w[x];)w[x+1]+=w[x]>>>16,w[x]&=65535,x++}function C(w,x){this.g=w,this.h=x}function E(w,x){if(g(x))throw Error("division by zero");if(g(w))return new C(f,f);if(y(w))return x=E(v(w),x),new C(v(x.g),v(x.h));if(y(x))return x=E(w,v(x)),new C(v(x.g),x.h);if(w.g.length>30){if(y(w)||y(x))throw Error("slowDivide_ only works with positive integers.");for(var b=d,A=x;A.l(w)<=0;)b=S(b),A=S(A);var k=R(b,1),N=R(A,1);for(A=R(A,2),b=R(b,2);!g(A);){var I=N.add(A);I.l(w)<=0&&(k=k.add(b),N=I),A=R(A,1),b=R(b,1)}return x=T(w,k.j(x)),new C(k,x)}for(k=f;w.l(x)>=0;){for(b=Math.max(1,Math.floor(w.m()/x.m())),A=Math.ceil(Math.log(b)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),N=c(b),I=N.j(x);y(I)||I.l(w)>0;)b-=A,N=c(b),I=N.j(x);g(N)&&(N=d),k=k.add(N),w=T(w,I)}return new C(k,w)}n.B=function(w){return E(this,w).h},n.and=function(w){const x=Math.max(this.g.length,w.g.length),b=[];for(let A=0;A<x;A++)b[A]=this.i(A)&w.i(A);return new a(b,this.h&w.h)},n.or=function(w){const x=Math.max(this.g.length,w.g.length),b=[];for(let A=0;A<x;A++)b[A]=this.i(A)|w.i(A);return new a(b,this.h|w.h)},n.xor=function(w){const x=Math.max(this.g.length,w.g.length),b=[];for(let A=0;A<x;A++)b[A]=this.i(A)^w.i(A);return new a(b,this.h^w.h)};function S(w){const x=w.g.length+1,b=[];for(let A=0;A<x;A++)b[A]=w.i(A)<<1|w.i(A-1)>>>31;return new a(b,w.h)}function R(w,x){const b=x>>5;x%=32;const A=w.g.length-b,k=[];for(let N=0;N<A;N++)k[N]=x>0?w.i(N+b)>>>x|w.i(N+b+1)<<32-x:w.i(N+b);return new a(k,w.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,AT=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=h,po=a}).apply(typeof Ox<"u"?Ox:typeof self<"u"?self:typeof window<"u"?window:{});var Cf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var TT,oc,IT,sd,Y0,DT,kT,NT;(function(){var n,t=Object.defineProperty;function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cf=="object"&&Cf];for(var F=0;F<m.length;++F){var M=m[F];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var i=r(this);function s(m,F){if(F)e:{var M=i;m=m.split(".");for(var K=0;K<m.length-1;K++){var be=m[K];if(!(be in M))break e;M=M[be]}m=m[m.length-1],K=M[m],F=F(K),F!=K&&F!=null&&t(M,m,{configurable:!0,writable:!0,value:F})}}s("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(m){return m||function(F){var M=[],K;for(K in F)Object.prototype.hasOwnProperty.call(F,K)&&M.push([K,F[K]]);return M}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(m){var F=typeof m;return F=="object"&&m!=null||F=="function"}function l(m,F,M){return m.call.apply(m.bind,arguments)}function c(m,F,M){return c=l,c.apply(null,arguments)}function h(m,F){var M=Array.prototype.slice.call(arguments,1);return function(){var K=M.slice();return K.push.apply(K,arguments),m.apply(this,K)}}function f(m,F){function M(){}M.prototype=F.prototype,m.Z=F.prototype,m.prototype=new M,m.prototype.constructor=m,m.Ob=function(K,be,Ae){for(var je=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)je[xt-2]=arguments[xt];return F.prototype[be].apply(K,je)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function p(m){const F=m.length;if(F>0){const M=Array(F);for(let K=0;K<F;K++)M[K]=m[K];return M}return[]}function g(m,F){for(let K=1;K<arguments.length;K++){const be=arguments[K];var M=typeof be;if(M=M!="object"?M:be?Array.isArray(be)?"array":M:"null",M=="array"||M=="object"&&typeof be.length=="number"){M=m.length||0;const Ae=be.length||0;m.length=M+Ae;for(let je=0;je<Ae;je++)m[M+je]=be[je]}else m.push(be)}}class y{constructor(F,M){this.i=F,this.j=M,this.h=0,this.g=null}get(){let F;return this.h>0?(this.h--,F=this.g,this.g=F.next,F.next=null):F=this.i(),F}}function v(m){a.setTimeout(()=>{throw m},0)}function T(){var m=w;let F=null;return m.g&&(F=m.g,m.g=m.g.next,m.g||(m.h=null),F.next=null),F}class _{constructor(){this.h=this.g=null}add(F,M){const K=C.get();K.set(F,M),this.h?this.h.next=K:this.g=K,this.h=K}}var C=new y(()=>new E,m=>m.reset());class E{constructor(){this.next=this.g=this.h=null}set(F,M){this.h=F,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let S,R=!1,w=new _,x=()=>{const m=Promise.resolve(void 0);S=()=>{m.then(b)}};function b(){for(var m;m=T();){try{m.h.call(m.g)}catch(M){v(M)}var F=C;F.j(m),F.h<100&&(F.h++,m.next=F.g,F.g=m)}R=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(m,F){this.type=m,this.g=this.target=F,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var m=!1,F=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const M=()=>{};a.addEventListener("test",M,F),a.removeEventListener("test",M,F)}catch{}return m}();function I(m){return/^[\s\xa0]*$/.test(m)}function j(m,F){k.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,F)}f(j,k),j.prototype.init=function(m,F){const M=this.type=m.type,K=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=F,F=m.relatedTarget,F||(M=="mouseover"?F=m.fromElement:M=="mouseout"&&(F=m.toElement)),this.relatedTarget=F,K?(this.clientX=K.clientX!==void 0?K.clientX:K.pageX,this.clientY=K.clientY!==void 0?K.clientY:K.pageY,this.screenX=K.screenX||0,this.screenY=K.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&j.Z.h.call(this)},j.prototype.h=function(){j.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Q="closure_listenable_"+(Math.random()*1e6|0),le=0;function fe(m,F,M,K,be){this.listener=m,this.proxy=null,this.src=F,this.type=M,this.capture=!!K,this.ha=be,this.key=++le,this.da=this.fa=!1}function ne(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function oe(m,F,M){for(const K in m)F.call(M,m[K],K,m)}function ie(m,F){for(const M in m)F.call(void 0,m[M],M,m)}function ue(m){const F={};for(const M in m)F[M]=m[M];return F}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ve(m,F){let M,K;for(let be=1;be<arguments.length;be++){K=arguments[be];for(M in K)m[M]=K[M];for(let Ae=0;Ae<ee.length;Ae++)M=ee[Ae],Object.prototype.hasOwnProperty.call(K,M)&&(m[M]=K[M])}}function ge(m){this.src=m,this.g={},this.h=0}ge.prototype.add=function(m,F,M,K,be){const Ae=m.toString();m=this.g[Ae],m||(m=this.g[Ae]=[],this.h++);const je=Se(m,F,K,be);return je>-1?(F=m[je],M||(F.fa=!1)):(F=new fe(F,this.src,Ae,!!K,be),F.fa=M,m.push(F)),F};function we(m,F){const M=F.type;if(M in m.g){var K=m.g[M],be=Array.prototype.indexOf.call(K,F,void 0),Ae;(Ae=be>=0)&&Array.prototype.splice.call(K,be,1),Ae&&(ne(F),m.g[M].length==0&&(delete m.g[M],m.h--))}}function Se(m,F,M,K){for(let be=0;be<m.length;++be){const Ae=m[be];if(!Ae.da&&Ae.listener==F&&Ae.capture==!!M&&Ae.ha==K)return be}return-1}var ae="closure_lm_"+(Math.random()*1e6|0),xe={};function ce(m,F,M,K,be){if(Array.isArray(F)){for(let Ae=0;Ae<F.length;Ae++)ce(m,F[Ae],M,K,be);return null}return M=J(M),m&&m[Q]?m.J(F,M,u(K)?!!K.capture:!1,be):he(m,F,M,!1,K,be)}function he(m,F,M,K,be,Ae){if(!F)throw Error("Invalid event type");const je=u(be)?!!be.capture:!!be;let xt=L(m);if(xt||(m[ae]=xt=new ge(m)),M=xt.add(F,M,K,je,Ae),M.proxy)return M;if(K=ye(),M.proxy=K,K.src=m,K.listener=M,m.addEventListener)N||(be=je),be===void 0&&(be=!1),m.addEventListener(F.toString(),K,be);else if(m.attachEvent)m.attachEvent(X(F.toString()),K);else if(m.addListener&&m.removeListener)m.addListener(K);else throw Error("addEventListener and attachEvent are unavailable.");return M}function ye(){function m(M){return F.call(m.src,m.listener,M)}const F=V;return m}function G(m,F,M,K,be){if(Array.isArray(F))for(var Ae=0;Ae<F.length;Ae++)G(m,F[Ae],M,K,be);else K=u(K)?!!K.capture:!!K,M=J(M),m&&m[Q]?(m=m.i,Ae=String(F).toString(),Ae in m.g&&(F=m.g[Ae],M=Se(F,M,K,be),M>-1&&(ne(F[M]),Array.prototype.splice.call(F,M,1),F.length==0&&(delete m.g[Ae],m.h--)))):m&&(m=L(m))&&(F=m.g[F.toString()],m=-1,F&&(m=Se(F,M,K,be)),(M=m>-1?F[m]:null)&&W(M))}function W(m){if(typeof m!="number"&&m&&!m.da){var F=m.src;if(F&&F[Q])we(F.i,m);else{var M=m.type,K=m.proxy;F.removeEventListener?F.removeEventListener(M,K,m.capture):F.detachEvent?F.detachEvent(X(M),K):F.addListener&&F.removeListener&&F.removeListener(K),(M=L(F))?(we(M,m),M.h==0&&(M.src=null,F[ae]=null)):ne(m)}}}function X(m){return m in xe?xe[m]:xe[m]="on"+m}function V(m,F){if(m.da)m=!0;else{F=new j(F,this);const M=m.listener,K=m.ha||m.src;m.fa&&W(m),m=M.call(K,F)}return m}function L(m){return m=m[ae],m instanceof ge?m:null}var z="__closure_events_fn_"+(Math.random()*1e9>>>0);function J(m){return typeof m=="function"?m:(m[z]||(m[z]=function(F){return m.handleEvent(F)}),m[z])}function re(){A.call(this),this.i=new ge(this),this.M=this,this.G=null}f(re,A),re.prototype[Q]=!0,re.prototype.removeEventListener=function(m,F,M,K){G(this,m,F,M,K)};function te(m,F){var M,K=m.G;if(K)for(M=[];K;K=K.G)M.push(K);if(m=m.M,K=F.type||F,typeof F=="string")F=new k(F,m);else if(F instanceof k)F.target=F.target||m;else{var be=F;F=new k(K,m),ve(F,be)}be=!0;let Ae,je;if(M)for(je=M.length-1;je>=0;je--)Ae=F.g=M[je],be=me(Ae,K,!0,F)&&be;if(Ae=F.g=m,be=me(Ae,K,!0,F)&&be,be=me(Ae,K,!1,F)&&be,M)for(je=0;je<M.length;je++)Ae=F.g=M[je],be=me(Ae,K,!1,F)&&be}re.prototype.N=function(){if(re.Z.N.call(this),this.i){var m=this.i;for(const F in m.g){const M=m.g[F];for(let K=0;K<M.length;K++)ne(M[K]);delete m.g[F],m.h--}}this.G=null},re.prototype.J=function(m,F,M,K){return this.i.add(String(m),F,!1,M,K)},re.prototype.K=function(m,F,M,K){return this.i.add(String(m),F,!0,M,K)};function me(m,F,M,K){if(F=m.i.g[String(F)],!F)return!0;F=F.concat();let be=!0;for(let Ae=0;Ae<F.length;++Ae){const je=F[Ae];if(je&&!je.da&&je.capture==M){const xt=je.listener,Fr=je.ha||je.src;je.fa&&we(m.i,je),be=xt.call(Fr,K)!==!1&&be}}return be&&!K.defaultPrevented}function Ee(m,F){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=c(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(F)>2147483647?-1:a.setTimeout(m,F||0)}function Ce(m){m.g=Ee(()=>{m.g=null,m.i&&(m.i=!1,Ce(m))},m.l);const F=m.h;m.h=null,m.m.apply(null,F)}class Fe extends A{constructor(F,M){super(),this.m=F,this.l=M,this.h=null,this.i=!1,this.g=null}j(F){this.h=arguments,this.g?this.i=!0:Ce(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function De(m){A.call(this),this.h=m,this.g={}}f(De,A);var ze=[];function Me(m){oe(m.g,function(F,M){this.g.hasOwnProperty(M)&&W(F)},m),m.g={}}De.prototype.N=function(){De.Z.N.call(this),Me(this)},De.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ue=a.JSON.stringify,Qe=a.JSON.parse,kt=class{stringify(m){return a.JSON.stringify(m,void 0)}parse(m){return a.JSON.parse(m,void 0)}};function Lt(){}function lt(){}var Xt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function P(){k.call(this,"d")}f(P,k);function U(){k.call(this,"c")}f(U,k);var H={},Z=null;function se(){return Z=Z||new re}H.Ia="serverreachability";function Ie(m){k.call(this,H.Ia,m)}f(Ie,k);function Ne(m){const F=se();te(F,new Ie(F))}H.STAT_EVENT="statevent";function He(m,F){k.call(this,H.STAT_EVENT,m),this.stat=F}f(He,k);function Ze(m){const F=se();te(F,new He(F,m))}H.Ja="timingevent";function ct(m,F){k.call(this,H.Ja,m),this.size=F}f(ct,k);function Gt(m,F){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){m()},F)}function D(){this.g=!0}D.prototype.ua=function(){this.g=!1};function $(m,F,M,K,be,Ae){m.info(function(){if(m.g)if(Ae){var je="",xt=Ae.split("&");for(let Qt=0;Qt<xt.length;Qt++){var Fr=xt[Qt].split("=");if(Fr.length>1){const zr=Fr[0];Fr=Fr[1];const Si=zr.split("_");je=Si.length>=2&&Si[1]=="type"?je+(zr+"="+Fr+"&"):je+(zr+"=redacted&")}}}else je=null;else je=Ae;return"XMLHTTP REQ ("+K+") [attempt "+be+"]: "+F+`
`+M+`
`+je})}function O(m,F,M,K,be,Ae,je){m.info(function(){return"XMLHTTP RESP ("+K+") [ attempt "+be+"]: "+F+`
`+M+`
`+Ae+" "+je})}function B(m,F,M,K){m.info(function(){return"XMLHTTP TEXT ("+F+"): "+Te(m,M)+(K?" "+K:"")})}function Y(m,F){m.info(function(){return"TIMEOUT: "+F})}D.prototype.info=function(){};function Te(m,F){if(!m.g)return F;if(!F)return null;try{const Ae=JSON.parse(F);if(Ae){for(m=0;m<Ae.length;m++)if(Array.isArray(Ae[m])){var M=Ae[m];if(!(M.length<2)){var K=M[1];if(Array.isArray(K)&&!(K.length<1)){var be=K[0];if(be!="noop"&&be!="stop"&&be!="close")for(let je=1;je<K.length;je++)K[je]=""}}}}return Ue(Ae)}catch{return F}}var Re={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Le={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Xe;function wt(){}f(wt,Lt),wt.prototype.g=function(){return new XMLHttpRequest},Xe=new wt;function or(m){return encodeURIComponent(String(m))}function Ji(m){var F=1;m=m.split(":");const M=[];for(;F>0&&m.length;)M.push(m.shift()),F--;return m.length&&M.push(m.join(":")),M}function ln(m,F,M,K){this.j=m,this.i=F,this.l=M,this.S=K||1,this.V=new De(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pl}function Pl(){this.i=null,this.g="",this.h=!1}var Ml={},Sn={};function tm(m,F,M){m.M=1,m.A=df(Ei(F)),m.u=M,m.R=!0,B_(m,null)}function B_(m,F){m.F=Date.now(),ff(m),m.B=Ei(m.A);var M=m.B,K=m.S;Array.isArray(K)||(K=[String(K)]),Q_(M.i,"t",K),m.C=0,M=m.j.L,m.h=new Pl,m.g=mb(m.j,M?F:null,!m.u),m.P>0&&(m.O=new Fe(c(m.Y,m,m.g),m.P)),F=m.V,M=m.g,K=m.ba;var be="readystatechange";Array.isArray(be)||(be&&(ze[0]=be.toString()),be=ze);for(let Ae=0;Ae<be.length;Ae++){const je=ce(M,be[Ae],K||F.handleEvent,!1,F.h||F);if(!je)break;F.g[je.key]=je}F=m.J?ue(m.J):{},m.u?(m.v||(m.v="POST"),F["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,F)):(m.v="GET",m.g.ea(m.B,m.v,null,F)),Ne(),$(m.i,m.v,m.B,m.l,m.S,m.u)}ln.prototype.ba=function(m){m=m.target;const F=this.O;F&&Ms(m)==3?F.j():this.Y(m)},ln.prototype.Y=function(m){try{if(m==this.g)e:{const xt=Ms(this.g),Fr=this.g.ya(),Qt=this.g.ca();if(!(xt<3)&&(xt!=3||this.g&&(this.h.h||this.g.la()||sb(this.g)))){this.K||xt!=4||Fr==7||(Fr==8||Qt<=0?Ne(3):Ne(2)),rm(this);var F=this.g.ca();this.X=F;var M=jR(this);if(this.o=F==200,O(this.i,this.v,this.B,this.l,this.S,xt,F),this.o){if(this.U&&!this.L){t:{if(this.g){var K,be=this.g;if((K=be.g?be.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(K)){var Ae=K;break t}}Ae=null}if(m=Ae)B(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,nm(this,m);else{this.o=!1,this.m=3,Ze(12),Oo(this),Ll(this);break e}}if(this.R){m=!0;let zr;for(;!this.K&&this.C<M.length;)if(zr=GR(this,M),zr==Sn){xt==4&&(this.m=4,Ze(14),m=!1),B(this.i,this.l,null,"[Incomplete Response]");break}else if(zr==Ml){this.m=4,Ze(15),B(this.i,this.l,M,"[Invalid Chunk]"),m=!1;break}else B(this.i,this.l,zr,null),nm(this,zr);if(U_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||M.length!=0||this.h.h||(this.m=1,Ze(16),m=!1),this.o=this.o&&m,!m)B(this.i,this.l,M,"[Invalid Chunked Response]"),Oo(this),Ll(this);else if(M.length>0&&!this.W){this.W=!0;var je=this.j;je.g==this&&je.aa&&!je.P&&(je.j.info("Great, no buffering proxy detected. Bytes received: "+M.length),hm(je),je.P=!0,Ze(11))}}else B(this.i,this.l,M,null),nm(this,M);xt==4&&Oo(this),this.o&&!this.K&&(xt==4?fb(this.j,this):(this.o=!1,ff(this)))}else nF(this.g),F==400&&M.indexOf("Unknown SID")>0?(this.m=3,Ze(12)):(this.m=0,Ze(13)),Oo(this),Ll(this)}}}catch{}finally{}};function jR(m){if(!U_(m))return m.g.la();const F=sb(m.g);if(F==="")return"";let M="";const K=F.length,be=Ms(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Oo(m),Ll(m),"";m.h.i=new a.TextDecoder}for(let Ae=0;Ae<K;Ae++)m.h.h=!0,M+=m.h.i.decode(F[Ae],{stream:!(be&&Ae==K-1)});return F.length=0,m.h.g+=M,m.C=0,m.h.g}function U_(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function GR(m,F){var M=m.C,K=F.indexOf(`
`,M);return K==-1?Sn:(M=Number(F.substring(M,K)),isNaN(M)?Ml:(K+=1,K+M>F.length?Sn:(F=F.slice(K,K+M),m.C=K+M,F)))}ln.prototype.cancel=function(){this.K=!0,Oo(this)};function ff(m){m.T=Date.now()+m.H,$_(m,m.H)}function $_(m,F){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Gt(c(m.aa,m),F)}function rm(m){m.D&&(a.clearTimeout(m.D),m.D=null)}ln.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(Y(this.i,this.B),this.M!=2&&(Ne(),Ze(17)),Oo(this),this.m=2,Ll(this)):$_(this,this.T-m)};function Ll(m){m.j.I==0||m.K||fb(m.j,m)}function Oo(m){rm(m);var F=m.O;F&&typeof F.dispose=="function"&&F.dispose(),m.O=null,Me(m.V),m.g&&(F=m.g,m.g=null,F.abort(),F.dispose())}function nm(m,F){try{var M=m.j;if(M.I!=0&&(M.g==m||im(M.h,m))){if(!m.L&&im(M.h,m)&&M.I==3){try{var K=M.Ba.g.parse(F)}catch{K=null}if(Array.isArray(K)&&K.length==3){var be=K;if(be[0]==0){e:if(!M.v){if(M.g)if(M.g.F+3e3<m.F)vf(M),mf(M);else break e;cm(M),Ze(18)}}else M.xa=be[1],0<M.xa-M.K&&be[2]<37500&&M.F&&M.A==0&&!M.C&&(M.C=Gt(c(M.Va,M),6e3));z_(M.h)<=1&&M.ta&&(M.ta=void 0)}else Bo(M,11)}else if((m.L||M.g==m)&&vf(M),!I(F))for(be=M.Ba.g.parse(F),F=0;F<be.length;F++){let Qt=be[F];const zr=Qt[0];if(!(zr<=M.K))if(M.K=zr,Qt=Qt[1],M.I==2)if(Qt[0]=="c"){M.M=Qt[1],M.ba=Qt[2];const Si=Qt[3];Si!=null&&(M.ka=Si,M.j.info("VER="+M.ka));const Uo=Qt[4];Uo!=null&&(M.za=Uo,M.j.info("SVER="+M.za));const Ls=Qt[5];Ls!=null&&typeof Ls=="number"&&Ls>0&&(K=1.5*Ls,M.O=K,M.j.info("backChannelRequestTimeoutMs_="+K)),K=M;const Os=m.g;if(Os){const bf=Os.g?Os.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bf){var Ae=K.h;Ae.g||bf.indexOf("spdy")==-1&&bf.indexOf("quic")==-1&&bf.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(sm(Ae,Ae.h),Ae.h=null))}if(K.G){const fm=Os.g?Os.g.getResponseHeader("X-HTTP-Session-Id"):null;fm&&(K.wa=fm,ar(K.J,K.G,fm))}}M.I=3,M.l&&M.l.ra(),M.aa&&(M.T=Date.now()-m.F,M.j.info("Handshake RTT: "+M.T+"ms")),K=M;var je=m;if(K.na=gb(K,K.L?K.ba:null,K.W),je.L){q_(K.h,je);var xt=je,Fr=K.O;Fr&&(xt.H=Fr),xt.D&&(rm(xt),ff(xt)),K.g=je}else cb(K);M.i.length>0&&yf(M)}else Qt[0]!="stop"&&Qt[0]!="close"||Bo(M,7);else M.I==3&&(Qt[0]=="stop"||Qt[0]=="close"?Qt[0]=="stop"?Bo(M,7):lm(M):Qt[0]!="noop"&&M.l&&M.l.qa(Qt),M.A=0)}}Ne(4)}catch{}}var zR=class{constructor(m,F){this.g=m,this.map=F}};function j_(m){this.l=m||10,a.PerformanceNavigationTiming?(m=a.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function G_(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function z_(m){return m.h?1:m.g?m.g.size:0}function im(m,F){return m.h?m.h==F:m.g?m.g.has(F):!1}function sm(m,F){m.g?m.g.add(F):m.h=F}function q_(m,F){m.h&&m.h==F?m.h=null:m.g&&m.g.has(F)&&m.g.delete(F)}j_.prototype.cancel=function(){if(this.i=H_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function H_(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let F=m.i;for(const M of m.g.values())F=F.concat(M.G);return F}return p(m.i)}var W_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qR(m,F){if(m){m=m.split("&");for(let M=0;M<m.length;M++){const K=m[M].indexOf("=");let be,Ae=null;K>=0?(be=m[M].substring(0,K),Ae=m[M].substring(K+1)):be=m[M],F(be,Ae?decodeURIComponent(Ae.replace(/\+/g," ")):"")}}}function Fs(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let F;m instanceof Fs?(this.l=m.l,Ol(this,m.j),this.o=m.o,this.g=m.g,Vl(this,m.u),this.h=m.h,om(this,J_(m.i)),this.m=m.m):m&&(F=String(m).match(W_))?(this.l=!1,Ol(this,F[1]||"",!0),this.o=Bl(F[2]||""),this.g=Bl(F[3]||"",!0),Vl(this,F[4]),this.h=Bl(F[5]||"",!0),om(this,F[6]||"",!0),this.m=Bl(F[7]||"")):(this.l=!1,this.i=new $l(null,this.l))}Fs.prototype.toString=function(){const m=[];var F=this.j;F&&m.push(Ul(F,K_,!0),":");var M=this.g;return(M||F=="file")&&(m.push("//"),(F=this.o)&&m.push(Ul(F,K_,!0),"@"),m.push(or(M).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.u,M!=null&&m.push(":",String(M))),(M=this.h)&&(this.g&&M.charAt(0)!="/"&&m.push("/"),m.push(Ul(M,M.charAt(0)=="/"?KR:WR,!0))),(M=this.i.toString())&&m.push("?",M),(M=this.m)&&m.push("#",Ul(M,XR)),m.join("")},Fs.prototype.resolve=function(m){const F=Ei(this);let M=!!m.j;M?Ol(F,m.j):M=!!m.o,M?F.o=m.o:M=!!m.g,M?F.g=m.g:M=m.u!=null;var K=m.h;if(M)Vl(F,m.u);else if(M=!!m.h){if(K.charAt(0)!="/")if(this.g&&!this.h)K="/"+K;else{var be=F.h.lastIndexOf("/");be!=-1&&(K=F.h.slice(0,be+1)+K)}if(be=K,be==".."||be==".")K="";else if(be.indexOf("./")!=-1||be.indexOf("/.")!=-1){K=be.lastIndexOf("/",0)==0,be=be.split("/");const Ae=[];for(let je=0;je<be.length;){const xt=be[je++];xt=="."?K&&je==be.length&&Ae.push(""):xt==".."?((Ae.length>1||Ae.length==1&&Ae[0]!="")&&Ae.pop(),K&&je==be.length&&Ae.push("")):(Ae.push(xt),K=!0)}K=Ae.join("/")}else K=be}return M?F.h=K:M=m.i.toString()!=="",M?om(F,J_(m.i)):M=!!m.m,M&&(F.m=m.m),F};function Ei(m){return new Fs(m)}function Ol(m,F,M){m.j=M?Bl(F,!0):F,m.j&&(m.j=m.j.replace(/:$/,""))}function Vl(m,F){if(F){if(F=Number(F),isNaN(F)||F<0)throw Error("Bad port number "+F);m.u=F}else m.u=null}function om(m,F,M){F instanceof $l?(m.i=F,ZR(m.i,m.l)):(M||(F=Ul(F,YR)),m.i=new $l(F,m.l))}function ar(m,F,M){m.i.set(F,M)}function df(m){return ar(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Bl(m,F){return m?F?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Ul(m,F,M){return typeof m=="string"?(m=encodeURI(m).replace(F,HR),M&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function HR(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var K_=/[#\/\?@]/g,WR=/[#\?:]/g,KR=/[#\?]/g,YR=/[#\?@]/g,XR=/#/g;function $l(m,F){this.h=this.g=null,this.i=m||null,this.j=!!F}function Vo(m){m.g||(m.g=new Map,m.h=0,m.i&&qR(m.i,function(F,M){m.add(decodeURIComponent(F.replace(/\+/g," ")),M)}))}n=$l.prototype,n.add=function(m,F){Vo(this),this.i=null,m=Wa(this,m);let M=this.g.get(m);return M||this.g.set(m,M=[]),M.push(F),this.h+=1,this};function Y_(m,F){Vo(m),F=Wa(m,F),m.g.has(F)&&(m.i=null,m.h-=m.g.get(F).length,m.g.delete(F))}function X_(m,F){return Vo(m),F=Wa(m,F),m.g.has(F)}n.forEach=function(m,F){Vo(this),this.g.forEach(function(M,K){M.forEach(function(be){m.call(F,be,K,this)},this)},this)};function Z_(m,F){Vo(m);let M=[];if(typeof F=="string")X_(m,F)&&(M=M.concat(m.g.get(Wa(m,F))));else for(m=Array.from(m.g.values()),F=0;F<m.length;F++)M=M.concat(m[F]);return M}n.set=function(m,F){return Vo(this),this.i=null,m=Wa(this,m),X_(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[F]),this.h+=1,this},n.get=function(m,F){return m?(m=Z_(this,m),m.length>0?String(m[0]):F):F};function Q_(m,F,M){Y_(m,F),M.length>0&&(m.i=null,m.g.set(Wa(m,F),p(M)),m.h+=M.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],F=Array.from(this.g.keys());for(let K=0;K<F.length;K++){var M=F[K];const be=or(M);M=Z_(this,M);for(let Ae=0;Ae<M.length;Ae++){let je=be;M[Ae]!==""&&(je+="="+or(M[Ae])),m.push(je)}}return this.i=m.join("&")};function J_(m){const F=new $l;return F.i=m.i,m.g&&(F.g=new Map(m.g),F.h=m.h),F}function Wa(m,F){return F=String(F),m.j&&(F=F.toLowerCase()),F}function ZR(m,F){F&&!m.j&&(Vo(m),m.i=null,m.g.forEach(function(M,K){const be=K.toLowerCase();K!=be&&(Y_(this,K),Q_(this,be,M))},m)),m.j=F}function QR(m,F){const M=new D;if(a.Image){const K=new Image;K.onload=h(Ps,M,"TestLoadImage: loaded",!0,F,K),K.onerror=h(Ps,M,"TestLoadImage: error",!1,F,K),K.onabort=h(Ps,M,"TestLoadImage: abort",!1,F,K),K.ontimeout=h(Ps,M,"TestLoadImage: timeout",!1,F,K),a.setTimeout(function(){K.ontimeout&&K.ontimeout()},1e4),K.src=m}else F(!1)}function JR(m,F){const M=new D,K=new AbortController,be=setTimeout(()=>{K.abort(),Ps(M,"TestPingServer: timeout",!1,F)},1e4);fetch(m,{signal:K.signal}).then(Ae=>{clearTimeout(be),Ae.ok?Ps(M,"TestPingServer: ok",!0,F):Ps(M,"TestPingServer: server error",!1,F)}).catch(()=>{clearTimeout(be),Ps(M,"TestPingServer: error",!1,F)})}function Ps(m,F,M,K,be){try{be&&(be.onload=null,be.onerror=null,be.onabort=null,be.ontimeout=null),K(M)}catch{}}function eF(){this.g=new kt}function am(m){this.i=m.Sb||null,this.h=m.ab||!1}f(am,Lt),am.prototype.g=function(){return new pf(this.i,this.h)};function pf(m,F){re.call(this),this.H=m,this.o=F,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f(pf,re),n=pf.prototype,n.open=function(m,F){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=F,this.readyState=1,Gl(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const F={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(F.body=m),(this.H||a).fetch(new Request(this.D,F)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,jl(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Gl(this)),this.g&&(this.readyState=3,Gl(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;eb(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function eb(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var F=m.value?m.value:new Uint8Array(0);(F=this.B.decode(F,{stream:!m.done}))&&(this.response=this.responseText+=F)}m.done?jl(this):Gl(this),this.readyState==3&&eb(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,jl(this))},n.Na=function(m){this.g&&(this.response=m,jl(this))},n.ga=function(){this.g&&jl(this)};function jl(m){m.readyState=4,m.l=null,m.j=null,m.B=null,Gl(m)}n.setRequestHeader=function(m,F){this.A.append(m,F)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],F=this.h.entries();for(var M=F.next();!M.done;)M=M.value,m.push(M[0]+": "+M[1]),M=F.next();return m.join(`\r
`)};function Gl(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(pf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function tb(m){let F="";return oe(m,function(M,K){F+=K,F+=":",F+=M,F+=`\r
`}),F}function um(m,F,M){e:{for(K in M){var K=!1;break e}K=!0}K||(M=tb(M),typeof m=="string"?M!=null&&or(M):ar(m,F,M))}function yr(m){re.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(yr,re);var tF=/^https?$/i,rF=["POST","PUT"];n=yr.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,F,M,K){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);F=F?F.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Xe.g(),this.g.onreadystatechange=d(c(this.Ca,this));try{this.B=!0,this.g.open(F,String(m),!0),this.B=!1}catch(Ae){rb(this,Ae);return}if(m=M||"",M=new Map(this.headers),K)if(Object.getPrototypeOf(K)===Object.prototype)for(var be in K)M.set(be,K[be]);else if(typeof K.keys=="function"&&typeof K.get=="function")for(const Ae of K.keys())M.set(Ae,K.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(K));K=Array.from(M.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),be=a.FormData&&m instanceof a.FormData,!(Array.prototype.indexOf.call(rF,F,void 0)>=0)||K||be||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,je]of M)this.g.setRequestHeader(Ae,je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(Ae){rb(this,Ae)}};function rb(m,F){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=F,m.o=5,nb(m),gf(m)}function nb(m){m.A||(m.A=!0,te(m,"complete"),te(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,te(this,"complete"),te(this,"abort"),gf(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gf(this,!0)),yr.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ib(this):this.Xa())},n.Xa=function(){ib(this)};function ib(m){if(m.h&&typeof o<"u"){if(m.v&&Ms(m)==4)setTimeout(m.Ca.bind(m),0);else if(te(m,"readystatechange"),Ms(m)==4){m.h=!1;try{const Ae=m.ca();e:switch(Ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var F=!0;break e;default:F=!1}var M;if(!(M=F)){var K;if(K=Ae===0){let je=String(m.D).match(W_)[1]||null;!je&&a.self&&a.self.location&&(je=a.self.location.protocol.slice(0,-1)),K=!tF.test(je?je.toLowerCase():"")}M=K}if(M)te(m,"complete"),te(m,"success");else{m.o=6;try{var be=Ms(m)>2?m.g.statusText:""}catch{be=""}m.l=be+" ["+m.ca()+"]",nb(m)}}finally{gf(m)}}}}function gf(m,F){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const M=m.g;m.g=null,F||te(m,"ready");try{M.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ms(m){return m.g?m.g.readyState:0}n.ca=function(){try{return Ms(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var F=this.g.responseText;return m&&F.indexOf(m)==0&&(F=F.substring(m.length)),Qe(F)}};function sb(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function nF(m){const F={};m=(m.g&&Ms(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let K=0;K<m.length;K++){if(I(m[K]))continue;var M=Ji(m[K]);const be=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const Ae=F[be]||[];F[be]=Ae,Ae.push(M)}ie(F,function(K){return K.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zl(m,F,M){return M&&M.internalChannelParams&&M.internalChannelParams[m]||F}function ob(m){this.za=0,this.i=[],this.j=new D,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zl("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zl("baseRetryDelayMs",5e3,m),this.Za=zl("retryDelaySeedMs",1e4,m),this.Ta=zl("forwardChannelMaxRetries",2,m),this.va=zl("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new j_(m&&m.concurrentRequestLimit),this.Ba=new eF,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ob.prototype,n.ka=8,n.I=1,n.connect=function(m,F,M,K){Ze(0),this.W=m,this.H=F||{},M&&K!==void 0&&(this.H.OSID=M,this.H.OAID=K),this.F=this.X,this.J=gb(this,null,this.W),yf(this)};function lm(m){if(ab(m),m.I==3){var F=m.V++,M=Ei(m.J);if(ar(M,"SID",m.M),ar(M,"RID",F),ar(M,"TYPE","terminate"),ql(m,M),F=new ln(m,m.j,F),F.M=2,F.A=df(Ei(M)),M=!1,a.navigator&&a.navigator.sendBeacon)try{M=a.navigator.sendBeacon(F.A.toString(),"")}catch{}!M&&a.Image&&(new Image().src=F.A,M=!0),M||(F.g=mb(F.j,null),F.g.ea(F.A)),F.F=Date.now(),ff(F)}pb(m)}function mf(m){m.g&&(hm(m),m.g.cancel(),m.g=null)}function ab(m){mf(m),m.v&&(a.clearTimeout(m.v),m.v=null),vf(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&a.clearTimeout(m.m),m.m=null)}function yf(m){if(!G_(m.h)&&!m.m){m.m=!0;var F=m.Ea;S||x(),R||(S(),R=!0),w.add(F,m),m.D=0}}function iF(m,F){return z_(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=F.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Gt(c(m.Ea,m,F),db(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const be=new ln(this,this.j,m);let Ae=this.o;if(this.U&&(Ae?(Ae=ue(Ae),ve(Ae,this.U)):Ae=this.U),this.u!==null||this.R||(be.J=Ae,Ae=null),this.S)e:{for(var F=0,M=0;M<this.i.length;M++){t:{var K=this.i[M];if("__data__"in K.map&&(K=K.map.__data__,typeof K=="string")){K=K.length;break t}K=void 0}if(K===void 0)break;if(F+=K,F>4096){F=M;break e}if(F===4096||M===this.i.length-1){F=M+1;break e}}F=1e3}else F=1e3;F=lb(this,be,F),M=Ei(this.J),ar(M,"RID",m),ar(M,"CVER",22),this.G&&ar(M,"X-HTTP-Session-Id",this.G),ql(this,M),Ae&&(this.R?F="headers="+or(tb(Ae))+"&"+F:this.u&&um(M,this.u,Ae)),sm(this.h,be),this.Ra&&ar(M,"TYPE","init"),this.S?(ar(M,"$req",F),ar(M,"SID","null"),be.U=!0,tm(be,M,null)):tm(be,M,F),this.I=2}}else this.I==3&&(m?ub(this,m):this.i.length==0||G_(this.h)||ub(this))};function ub(m,F){var M;F?M=F.l:M=m.V++;const K=Ei(m.J);ar(K,"SID",m.M),ar(K,"RID",M),ar(K,"AID",m.K),ql(m,K),m.u&&m.o&&um(K,m.u,m.o),M=new ln(m,m.j,M,m.D+1),m.u===null&&(M.J=m.o),F&&(m.i=F.G.concat(m.i)),F=lb(m,M,1e3),M.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),sm(m.h,M),tm(M,K,F)}function ql(m,F){m.H&&oe(m.H,function(M,K){ar(F,K,M)}),m.l&&oe({},function(M,K){ar(F,K,M)})}function lb(m,F,M){M=Math.min(m.i.length,M);const K=m.l?c(m.l.Ka,m.l,m):null;e:{var be=m.i;let xt=-1;for(;;){const Fr=["count="+M];xt==-1?M>0?(xt=be[0].g,Fr.push("ofs="+xt)):xt=0:Fr.push("ofs="+xt);let Qt=!0;for(let zr=0;zr<M;zr++){var Ae=be[zr].g;const Si=be[zr].map;if(Ae-=xt,Ae<0)xt=Math.max(0,be[zr].g-100),Qt=!1;else try{Ae="req"+Ae+"_"||"";try{var je=Si instanceof Map?Si:Object.entries(Si);for(const[Uo,Ls]of je){let Os=Ls;u(Ls)&&(Os=Ue(Ls)),Fr.push(Ae+Uo+"="+encodeURIComponent(Os))}}catch(Uo){throw Fr.push(Ae+"type="+encodeURIComponent("_badmap")),Uo}}catch{K&&K(Si)}}if(Qt){je=Fr.join("&");break e}}je=void 0}return m=m.i.splice(0,M),F.G=m,je}function cb(m){if(!m.g&&!m.v){m.Y=1;var F=m.Da;S||x(),R||(S(),R=!0),w.add(F,m),m.A=0}}function cm(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Gt(c(m.Da,m),db(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,hb(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Gt(c(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ze(10),mf(this),hb(this))};function hm(m){m.B!=null&&(a.clearTimeout(m.B),m.B=null)}function hb(m){m.g=new ln(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var F=Ei(m.na);ar(F,"RID","rpc"),ar(F,"SID",m.M),ar(F,"AID",m.K),ar(F,"CI",m.F?"0":"1"),!m.F&&m.ia&&ar(F,"TO",m.ia),ar(F,"TYPE","xmlhttp"),ql(m,F),m.u&&m.o&&um(F,m.u,m.o),m.O&&(m.g.H=m.O);var M=m.g;m=m.ba,M.M=1,M.A=df(Ei(F)),M.u=null,M.R=!0,B_(M,m)}n.Va=function(){this.C!=null&&(this.C=null,mf(this),cm(this),Ze(19))};function vf(m){m.C!=null&&(a.clearTimeout(m.C),m.C=null)}function fb(m,F){var M=null;if(m.g==F){vf(m),hm(m),m.g=null;var K=2}else if(im(m.h,F))M=F.G,q_(m.h,F),K=1;else return;if(m.I!=0){if(F.o)if(K==1){M=F.u?F.u.length:0,F=Date.now()-F.F;var be=m.D;K=se(),te(K,new ct(K,M)),yf(m)}else cb(m);else if(be=F.m,be==3||be==0&&F.X>0||!(K==1&&iF(m,F)||K==2&&cm(m)))switch(M&&M.length>0&&(F=m.h,F.i=F.i.concat(M)),be){case 1:Bo(m,5);break;case 4:Bo(m,10);break;case 3:Bo(m,6);break;default:Bo(m,2)}}}function db(m,F){let M=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(M*=2),M*F}function Bo(m,F){if(m.j.info("Error code "+F),F==2){var M=c(m.bb,m),K=m.Ua;const be=!K;K=new Fs(K||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ol(K,"https"),df(K),be?QR(K.toString(),M):JR(K.toString(),M)}else Ze(2);m.I=0,m.l&&m.l.pa(F),pb(m),ab(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Ze(2)):(this.j.info("Failed to ping google.com"),Ze(1))};function pb(m){if(m.I=0,m.ja=[],m.l){const F=H_(m.h);(F.length!=0||m.i.length!=0)&&(g(m.ja,F),g(m.ja,m.i),m.h.i.length=0,p(m.i),m.i.length=0),m.l.oa()}}function gb(m,F,M){var K=M instanceof Fs?Ei(M):new Fs(M);if(K.g!="")F&&(K.g=F+"."+K.g),Vl(K,K.u);else{var be=a.location;K=be.protocol,F=F?F+"."+be.hostname:be.hostname,be=+be.port;const Ae=new Fs(null);K&&Ol(Ae,K),F&&(Ae.g=F),be&&Vl(Ae,be),M&&(Ae.h=M),K=Ae}return M=m.G,F=m.wa,M&&F&&ar(K,M,F),ar(K,"VER",m.ka),ql(m,K),K}function mb(m,F,M){if(F&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return F=m.Aa&&!m.ma?new yr(new am({ab:M})):new yr(m.ma),F.Fa(m.L),F}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function yb(){}n=yb.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _f(){}_f.prototype.g=function(m,F){return new Ln(m,F)};function Ln(m,F){re.call(this),this.g=new ob(F),this.l=m,this.h=F&&F.messageUrlParams||null,m=F&&F.messageHeaders||null,F&&F.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=F&&F.initMessageHeaders||null,F&&F.messageContentType&&(m?m["X-WebChannel-Content-Type"]=F.messageContentType:m={"X-WebChannel-Content-Type":F.messageContentType}),F&&F.sa&&(m?m["X-WebChannel-Client-Profile"]=F.sa:m={"X-WebChannel-Client-Profile":F.sa}),this.g.U=m,(m=F&&F.Qb)&&!I(m)&&(this.g.u=m),this.A=F&&F.supportsCrossDomainXhr||!1,this.v=F&&F.sendRawJson||!1,(F=F&&F.httpSessionIdParam)&&!I(F)&&(this.g.G=F,m=this.h,m!==null&&F in m&&(m=this.h,F in m&&delete m[F])),this.j=new Ka(this)}f(Ln,re),Ln.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){lm(this.g)},Ln.prototype.o=function(m){var F=this.g;if(typeof m=="string"){var M={};M.__data__=m,m=M}else this.v&&(M={},M.__data__=Ue(m),m=M);F.i.push(new zR(F.Ya++,m)),F.I==3&&yf(F)},Ln.prototype.N=function(){this.g.l=null,delete this.j,lm(this.g),delete this.g,Ln.Z.N.call(this)};function vb(m){P.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var F=m.__sm__;if(F){e:{for(const M in F){m=M;break e}m=void 0}(this.i=m)&&(m=this.i,F=F!==null&&m in F?F[m]:void 0),this.data=F}else this.data=m}f(vb,P);function _b(){U.call(this),this.status=1}f(_b,U);function Ka(m){this.g=m}f(Ka,yb),Ka.prototype.ra=function(){te(this.g,"a")},Ka.prototype.qa=function(m){te(this.g,new vb(m))},Ka.prototype.pa=function(m){te(this.g,new _b)},Ka.prototype.oa=function(){te(this.g,"b")},_f.prototype.createWebChannel=_f.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,NT=function(){return new _f},kT=function(){return se()},DT=H,Y0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,sd=Re,Le.COMPLETE="complete",IT=Le,lt.EventType=Xt,Xt.OPEN="a",Xt.CLOSE="b",Xt.ERROR="c",Xt.MESSAGE="d",re.prototype.listen=re.prototype.J,oc=lt,yr.prototype.listenOnce=yr.prototype.K,yr.prototype.getLastError=yr.prototype.Ha,yr.prototype.getLastErrorCode=yr.prototype.ya,yr.prototype.getStatus=yr.prototype.ca,yr.prototype.getResponseJson=yr.prototype.La,yr.prototype.getResponseText=yr.prototype.la,yr.prototype.send=yr.prototype.ea,yr.prototype.setWithCredentials=yr.prototype.Fa,TT=yr}).apply(typeof Cf<"u"?Cf:typeof self<"u"?self:typeof window<"u"?window:{});const Vx="@firebase/firestore",Bx="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}dn.UNAUTHENTICATED=new dn(null),dn.GOOGLE_CREDENTIALS=new dn("google-credentials-uid"),dn.FIRST_PARTY=new dn("first-party-uid"),dn.MOCK_USER=new dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=new ng("@firebase/firestore");function uu(){return ba.logLevel}function Oe(n,...t){if(ba.logLevel<=Tt.DEBUG){const r=t.map(Hv);ba.debug(`Firestore (${Sl}): ${n}`,...r)}}function yn(n,...t){if(ba.logLevel<=Tt.ERROR){const r=t.map(Hv);ba.error(`Firestore (${Sl}): ${n}`,...r)}}function Kc(n,...t){if(ba.logLevel<=Tt.WARN){const r=t.map(Hv);ba.warn(`Firestore (${Sl}): ${n}`,...r)}}function Hv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(n,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,RT(n,i,r)}function RT(n,t,r){let i=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(r!==void 0)try{i+=" CONTEXT: "+JSON.stringify(r)}catch{i+=" CONTEXT: "+r}throw yn(i),new Error(i)}function it(n,t,r,i){let s="Unexpected state";typeof r=="string"?s=r:i=r,n||RT(t,s,i)}function vt(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends wi{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class qV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(dn.UNAUTHENTICATED))}shutdown(){}}class HV{constructor(t){this.t=t,this.currentUser=dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){it(this.o===void 0,42304);let i=this.i;const s=l=>this.i!==i?(i=this.i,r(l)):Promise.resolve();let o=new ms;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ms,t.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},u=l=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ms)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(i=>this.i!==t?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(it(typeof i.accessToken=="string",31837,{l:i}),new zV(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return it(t===null||typeof t=="string",2055,{h:t}),new dn(t)}}class WV{constructor(t,r,i){this.P=t,this.T=r,this.I=i,this.type="FirstParty",this.user=dn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class KV{constructor(t,r,i){this.P=t,this.T=r,this.I=i}getToken(){return Promise.resolve(new WV(this.P,this.T,this.I))}start(t,r){t.enqueueRetryable(()=>r(dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ux{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class YV{constructor(t,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fi(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,r){it(this.o===void 0,3512);const i=o=>{o.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,Oe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>i(o))};const s=o=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ux(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(it(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Ux(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XV(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let i=0;i<n;i++)r[i]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=XV(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<r&&(i+=t.charAt(s[o]%62))}return i}}function gt(n,t){return n<t?-1:n>t?1:0}function X0(n,t){const r=Math.min(n.length,t.length);for(let i=0;i<r;i++){const s=n.charAt(i),o=t.charAt(i);if(s!==o)return Mm(s)===Mm(o)?gt(s,o):Mm(s)?1:-1}return gt(n.length,t.length)}const ZV=55296,QV=57343;function Mm(n){const t=n.charCodeAt(0);return t>=ZV&&t<=QV}function qu(n,t,r){return n.length===t.length&&n.every((i,s)=>r(i,t[s]))}function FT(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="__name__";class ki{constructor(t,r,i){r===void 0?r=0:r>t.length&&et(637,{offset:r,range:t.length}),i===void 0?i=t.length-r:i>t.length-r&&et(1746,{length:i,range:t.length-r}),this.segments=t,this.offset=r,this.len=i}get length(){return this.len}isEqual(t){return ki.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof ki?t.forEach(i=>{r.push(i)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,i=this.limit();r<i;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const i=Math.min(t.length,r.length);for(let s=0;s<i;s++){const o=ki.compareSegments(t.get(s),r.get(s));if(o!==0)return o}return gt(t.length,r.length)}static compareSegments(t,r){const i=ki.isNumericId(t),s=ki.isNumericId(r);return i&&!s?-1:!i&&s?1:i&&s?ki.extractNumericId(t).compare(ki.extractNumericId(r)):X0(t,r)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return po.fromString(t.substring(4,t.length-2))}}class $t extends ki{construct(t,r,i){return new $t(t,r,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const i of t){if(i.indexOf("//")>=0)throw new qe(ke.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);r.push(...i.split("/").filter(s=>s.length>0))}return new $t(r)}static emptyPath(){return new $t([])}}const JV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mr extends ki{construct(t,r,i){return new mr(t,r,i)}static isValidIdentifier(t){return JV.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$x}static keyField(){return new mr([$x])}static fromServerFormat(t){const r=[];let i="",s=0;const o=()=>{if(i.length===0)throw new qe(ke.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(i),i=""};let a=!1;for(;s<t.length;){const u=t[s];if(u==="\\"){if(s+1===t.length)throw new qe(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new qe(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,s+=2}else u==="`"?(a=!a,s++):u!=="."||a?(i+=u,s++):(o(),s++)}if(o(),a)throw new qe(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new mr(r)}static emptyPath(){return new mr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(t){this.path=t}static fromPath(t){return new Ke($t.fromString(t))}static fromName(t){return new Ke($t.fromString(t).popFirst(5))}static empty(){return new Ke($t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&$t.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return $t.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ke(new $t(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n,t,r){if(!r)throw new qe(ke.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function eB(n,t,r,i){if(t===!0&&i===!0)throw new qe(ke.INVALID_ARGUMENT,`${n} and ${r} cannot be used together.`)}function jx(n){if(!Ke.isDocumentKey(n))throw new qe(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Gx(n){if(Ke.isDocumentKey(n))throw new qe(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function MT(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":et(12329,{type:typeof n})}function Hu(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new qe(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=lg(n);throw new qe(ke.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(n,t){const r={typeString:n};return t&&(r.value=t),r}function Xh(n,t){if(!MT(n))throw new qe(ke.INVALID_ARGUMENT,"JSON must be an object");let r;for(const i in t)if(t[i]){const s=t[i].typeString,o="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){r=`JSON missing required field: '${i}'`;break}const a=n[i];if(s&&typeof a!==s){r=`JSON field '${i}' must be a ${s}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${i}' field to equal '${o.value}'`;break}}if(r)throw new qe(ke.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=-62135596800,qx=1e6;class Wt{static now(){return Wt.fromMillis(Date.now())}static fromDate(t){return Wt.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),i=Math.floor((t-1e3*r)*qx);return new Wt(r,i)}constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new qe(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new qe(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<zx)throw new qe(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qe(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qx}_compareTo(t){return this.seconds===t.seconds?gt(this.nanoseconds,t.nanoseconds):gt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Xh(t,Wt._jsonSchema))return new Wt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-zx;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Wt._jsonSchemaVersion="firestore/timestamp/1.0",Wt._jsonSchema={type:Dr("string",Wt._jsonSchemaVersion),seconds:Dr("number"),nanoseconds:Dr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{static fromTimestamp(t){return new ot(t)}static min(){return new ot(new Wt(0,0))}static max(){return new ot(new Wt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc=-1;class zd{constructor(t,r,i,s){this.indexId=t,this.collectionGroup=r,this.fields=i,this.indexState=s}}function Z0(n){return n.fields.find(t=>t.kind===2)}function Wo(n){return n.fields.filter(t=>t.kind!==2)}zd.UNKNOWN_ID=-1;class od{constructor(t,r){this.fieldPath=t,this.kind=r}}class Xc{constructor(t,r){this.sequenceNumber=t,this.offset=r}static empty(){return new Xc(0,zn.min())}}function tB(n,t){const r=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=ot.fromTimestamp(i===1e9?new Wt(r+1,0):new Wt(r,i));return new zn(s,Ke.empty(),t)}function LT(n){return new zn(n.readTime,n.key,Yc)}class zn{constructor(t,r,i){this.readTime=t,this.documentKey=r,this.largestBatchId=i}static min(){return new zn(ot.min(),Ke.empty(),Yc)}static max(){return new zn(ot.max(),Ke.empty(),Yc)}}function Kv(n,t){let r=n.readTime.compareTo(t.readTime);return r!==0?r:(r=Ke.comparator(n.documentKey,t.documentKey),r!==0?r:gt(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class VT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $a(n){if(n.code!==ke.FAILED_PRECONDITION||n.message!==OT)throw n;Oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new _e((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(r,o).next(i,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof _e?r:_e.resolve(r)}catch(r){return _e.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):_e.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):_e.reject(r)}static resolve(t){return new _e((r,i)=>{r(t)})}static reject(t){return new _e((r,i)=>{i(t)})}static waitFor(t){return new _e((r,i)=>{let s=0,o=0,a=!1;t.forEach(u=>{++s,u.next(()=>{++o,a&&o===s&&r()},l=>i(l))}),a=!0,o===s&&r()})}static or(t){let r=_e.resolve(!1);for(const i of t)r=r.next(s=>s?_e.resolve(s):i());return r}static forEach(t,r){const i=[];return t.forEach((s,o)=>{i.push(r.call(this,s,o))}),this.waitFor(i)}static mapArray(t,r){return new _e((i,s)=>{const o=t.length,a=new Array(o);let u=0;for(let l=0;l<o;l++){const c=l;r(t[c]).next(h=>{a[c]=h,++u,u===o&&i(a)},h=>s(h))}})}static doWhile(t,r){return new _e((i,s)=>{const o=()=>{t()===!0?r().next(()=>{o()},s):i()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="SimpleDb";class cg{static open(t,r,i,s){try{return new cg(r,t.transaction(s,i))}catch(o){throw new Sc(r,o)}}constructor(t,r){this.action=t,this.transaction=r,this.aborted=!1,this.S=new ms,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{r.error?this.S.reject(new Sc(t,r.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=Yv(i.target.error);this.S.reject(new Sc(t,s))}}get D(){return this.S.promise}abort(t){t&&this.S.reject(t),this.aborted||(Oe(Vn,"Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){const r=this.transaction.objectStore(t);return new nB(r)}}class go{static delete(t){return Oe(Vn,"Removing database:",t),ea(fA().indexedDB.deleteDatabase(t)).toPromise()}static v(){if(!Dv())return!1;if(go.F())return!0;const t=Ur(),r=go.M(t),i=0<r&&r<10,s=BT(t),o=0<s&&s<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||o)}static F(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)==null?void 0:t.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(t,r){return t.store(r)}static M(t){const r=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(t,r,i){this.name=t,this.version=r,this.N=i,this.B=null,go.M(Ur())===12.2&&yn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(t){return this.db||(Oe(Vn,"Opening database:",this.name),this.db=await new Promise((r,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const a=o.target.result;r(a)},s.onblocked=()=>{i(new Sc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;a.name==="VersionError"?i(new qe(ke.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?i(new qe(ke.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):i(new Sc(t,a))},s.onupgradeneeded=o=>{Oe(Vn,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;this.N.k(a,s.transaction,o.oldVersion,this.version).next(()=>{Oe(Vn,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=r=>this.q(r)),this.db}$(t){this.q=t,this.db&&(this.db.onversionchange=r=>t(r))}async runTransaction(t,r,i,s){const o=r==="readonly";let a=0;for(;;){++a;try{this.db=await this.L(t);const u=cg.open(this.db,t,o?"readonly":"readwrite",i),l=s(u).next(c=>(u.C(),c)).catch(c=>(u.abort(c),_e.reject(c))).toPromise();return l.catch(()=>{}),await u.D,l}catch(u){const l=u,c=l.name!=="FirebaseError"&&a<3;if(Oe(Vn,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function BT(n){const t=n.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class rB{constructor(t){this.U=t,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(t){this.U=t}done(){this.K=!0}j(t){this.W=t}delete(){return ea(this.U.delete())}}class Sc extends qe{constructor(t,r){super(ke.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Po(n){return n.name==="IndexedDbTransactionError"}class nB{constructor(t){this.store=t}put(t,r){let i;return r!==void 0?(Oe(Vn,"PUT",this.store.name,t,r),i=this.store.put(r,t)):(Oe(Vn,"PUT",this.store.name,"<auto-key>",t),i=this.store.put(t)),ea(i)}add(t){return Oe(Vn,"ADD",this.store.name,t,t),ea(this.store.add(t))}get(t){return ea(this.store.get(t)).next(r=>(r===void 0&&(r=null),Oe(Vn,"GET",this.store.name,t,r),r))}delete(t){return Oe(Vn,"DELETE",this.store.name,t),ea(this.store.delete(t))}count(){return Oe(Vn,"COUNT",this.store.name),ea(this.store.count())}J(t,r){const i=this.options(t,r),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(i.range);return new _e((a,u)=>{o.onerror=l=>{u(l.target.error)},o.onsuccess=l=>{a(l.target.result)}})}{const o=this.cursor(i),a=[];return this.H(o,(u,l)=>{a.push(l)}).next(()=>a)}}Y(t,r){const i=this.store.getAll(t,r===null?void 0:r);return new _e((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}Z(t,r){Oe(Vn,"DELETE ALL",this.store.name);const i=this.options(t,r);i.X=!1;const s=this.cursor(i);return this.H(s,(o,a,u)=>u.delete())}ee(t,r){let i;r?i=t:(i={},r=t);const s=this.cursor(i);return this.H(s,r)}te(t){const r=this.cursor({});return new _e((i,s)=>{r.onerror=o=>{const a=Yv(o.target.error);s(a)},r.onsuccess=o=>{const a=o.target.result;a?t(a.primaryKey,a.value).next(u=>{u?a.continue():i()}):i()}})}H(t,r){const i=[];return new _e((s,o)=>{t.onerror=a=>{o(a.target.error)},t.onsuccess=a=>{const u=a.target.result;if(!u)return void s();const l=new rB(u),c=r(u.primaryKey,u.value,l);if(c instanceof _e){const h=c.catch(f=>(l.done(),_e.reject(f)));i.push(h)}l.isDone?s():l.G===null?u.continue():u.continue(l.G)}}).next(()=>_e.waitFor(i))}options(t,r){let i;return t!==void 0&&(typeof t=="string"?i=t:r=t),{index:i,range:r}}cursor(t){let r="next";if(t.reverse&&(r="prev"),t.index){const i=this.store.index(t.index);return t.X?i.openKeyCursor(t.range,r):i.openCursor(t.range,r)}return this.store.openCursor(t.range,r)}}function ea(n){return new _e((t,r)=>{n.onsuccess=i=>{const s=i.target.result;t(s)},n.onerror=i=>{const s=Yv(i.target.error);r(s)}})}let Hx=!1;function Yv(n){const t=go.M(Ur());if(t>=12.2&&t<13){const r="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(r)>=0){const i=new qe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Hx||(Hx=!0,setTimeout(()=>{throw i},0)),i}}return n}const Cc="IndexBackfiller";class iB{constructor(t,r){this.asyncQueue=t,this.ne=r,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(t){Oe(Cc,`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,async()=>{this.task=null;try{const r=await this.ne.ie();Oe(Cc,`Documents written: ${r}`)}catch(r){Po(r)?Oe(Cc,"Ignoring IndexedDB error during index backfill: ",r):await $a(r)}await this.re(6e4)})}}class sB{constructor(t,r){this.localStore=t,this.persistence=r}async ie(t=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>this.se(r,t))}se(t,r){const i=new Set;let s=r,o=!0;return _e.doWhile(()=>o===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(a=>{if(a!==null&&!i.has(a))return Oe(Cc,`Processing collection: ${a}`),this.oe(t,a,s).next(u=>{s-=u,i.add(a)});o=!1})).next(()=>r-s)}oe(t,r,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,r).next(s=>this.localStore.localDocuments.getNextDocuments(t,r,s,i).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(t,a).next(()=>this._e(s,o)).next(u=>(Oe(Cc,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(t,r,u))).next(()=>a.size)}))}_e(t,r){let i=t;return r.changes.forEach((s,o)=>{const a=LT(o);Kv(a,i)>0&&(i=a)}),new zn(i.readTime,i.documentKey,Math.max(r.batchId,t.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Qn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=-1;function hg(n){return n==null}function Zc(n){return n===0&&1/n==-1/0}function oB(n){return typeof n=="number"&&Number.isInteger(n)&&!Zc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="";function an(n){let t="";for(let r=0;r<n.length;r++)t.length>0&&(t=Wx(t)),t=aB(n.get(r),t);return Wx(t)}function aB(n,t){let r=t;const i=n.length;for(let s=0;s<i;s++){const o=n.charAt(s);switch(o){case"\0":r+="";break;case qd:r+="";break;default:r+=o}}return r}function Wx(n){return n+qd+""}function Fi(n){const t=n.length;if(it(t>=2,64408,{path:n}),t===2)return it(n.charAt(0)===qd&&n.charAt(1)==="",56145,{path:n}),$t.emptyPath();const r=t-2,i=[];let s="";for(let o=0;o<t;){const a=n.indexOf(qd,o);switch((a<0||a>r)&&et(50515,{path:n}),n.charAt(a+1)){case"":const u=n.substring(o,a);let l;s.length===0?l=u:(s+=u,l=s,s=""),i.push(l);break;case"":s+=n.substring(o,a),s+="\0";break;case"":s+=n.substring(o,a+1);break;default:et(61167,{path:n})}o=a+2}return new $t(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko="remoteDocuments",Zh="owner",Za="owner",Qc="mutationQueues",uB="userId",ci="mutations",Kx="batchId",la="userMutationsIndex",Yx=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ad(n,t){return[n,an(t)]}function UT(n,t,r){return[n,an(t),r]}const lB={},Wu="documentMutations",Hd="remoteDocumentsV14",cB=["prefixPath","collectionGroup","readTime","documentId"],ud="documentKeyIndex",hB=["prefixPath","collectionGroup","documentId"],$T="collectionGroupIndex",fB=["collectionGroup","readTime","prefixPath","documentId"],Jc="remoteDocumentGlobal",Q0="remoteDocumentGlobalKey",Ku="targets",jT="queryTargetsIndex",dB=["canonicalId","targetId"],Yu="targetDocuments",pB=["targetId","path"],Xv="documentTargetsIndex",gB=["path","targetId"],Wd="targetGlobalKey",ga="targetGlobal",eh="collectionParents",mB=["collectionId","parent"],Xu="clientMetadata",yB="clientId",fg="bundles",vB="bundleId",dg="namedQueries",_B="name",Zv="indexConfiguration",bB="indexId",J0="collectionGroupIndex",xB="collectionGroup",Ac="indexState",wB=["indexId","uid"],GT="sequenceNumberIndex",EB=["uid","sequenceNumber"],Tc="indexEntries",SB=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zT="documentKeyIndex",CB=["indexId","uid","orderedDocumentKey"],pg="documentOverlays",AB=["userId","collectionPath","documentId"],ey="collectionPathOverlayIndex",TB=["userId","collectionPath","largestBatchId"],qT="collectionGroupOverlayIndex",IB=["userId","collectionGroup","largestBatchId"],Qv="globals",DB="name",HT=[Qc,ci,Wu,Ko,Ku,Zh,ga,Yu,Xu,Jc,eh,fg,dg],kB=[...HT,pg],WT=[Qc,ci,Wu,Hd,Ku,Zh,ga,Yu,Xu,Jc,eh,fg,dg,pg],KT=WT,Jv=[...KT,Zv,Ac,Tc],NB=Jv,YT=[...Jv,Qv],RB=YT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty extends VT{constructor(t,r){super(),this.le=t,this.currentSequenceNumber=r}}function Gr(n,t){const r=vt(n);return go.O(r.le,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(n){let t=0;for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t++;return t}function Mo(n,t){for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t(r,n[r])}function XT(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(t,r){this.comparator=t,this.root=r||Kr.EMPTY}insert(t,r){return new dr(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,Kr.BLACK,null,null))}remove(t){return new dr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Kr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return r.value;i<0?r=r.left:i>0&&(r=r.right)}return null}indexOf(t){let r=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return r+i.left.size;s<0?i=i.left:(r+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,i)=>(t(r,i),!1))}toString(){const t=[];return this.inorderTraversal((r,i)=>(t.push(`${r}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Af(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Af(this.root,t,this.comparator,!1)}getReverseIterator(){return new Af(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Af(this.root,t,this.comparator,!0)}}class Af{constructor(t,r,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=r?i(t.key,r):1,r&&s&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Kr{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??Kr.RED,this.left=s??Kr.EMPTY,this.right=o??Kr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,s,o){return new Kr(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Kr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return Kr.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Kr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Kr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw et(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw et(27949);return t+(this.isRed()?0:1)}}Kr.EMPTY=null,Kr.RED=!0,Kr.BLACK=!1;Kr.EMPTY=new class{constructor(){this.size=0}get key(){throw et(57766)}get value(){throw et(16141)}get color(){throw et(16727)}get left(){throw et(29726)}get right(){throw et(36894)}copy(t,r,i,s,o){return this}insert(t,r,i){return new Kr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(t){this.comparator=t,this.data=new dr(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,i)=>(t(r),!1))}forEachInRange(t,r){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let i;for(i=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new Zx(this.data.getIterator())}getIteratorFrom(t){return new Zx(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(i=>{r=r.add(i)}),r}isEqual(t){if(!(t instanceof Yt)||this.size!==t.size)return!1;const r=this.data.getIterator(),i=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Yt(this.comparator);return r.data=t,r}}class Zx{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Qa(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(t){this.fields=t,t.sort(mr.comparator)}static empty(){return new Nn([])}unionWith(t){let r=new Yt(mr.comparator);for(const i of this.fields)r=r.add(i);for(const i of t)r=r.add(i);return new Nn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return qu(this.fields,t.fields,(r,i)=>r.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ZT("Invalid base64 string: "+o):o}}(t);return new Nr(r)}static fromUint8Array(t){const r=function(s){let o="";for(let a=0;a<s.length;++a)o+=String.fromCharCode(s[a]);return o}(t);return new Nr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const i=new Uint8Array(r.length);for(let s=0;s<r.length;s++)i[s]=r.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return gt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Nr.EMPTY_BYTE_STRING=new Nr("");const FB=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ws(n){if(it(!!n,39018),typeof n=="string"){let t=0;const r=FB.exec(n);if(it(!!r,46558,{timestamp:n}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:hr(n.seconds),nanos:hr(n.nanos)}}function hr(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Es(n){return typeof n=="string"?Nr.fromBase64String(n):Nr.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT="server_timestamp",JT="__type__",eI="__previous_value__",tI="__local_write_time__";function e1(n){var r,i;return((i=(((r=n==null?void 0:n.mapValue)==null?void 0:r.fields)||{})[JT])==null?void 0:i.stringValue)===QT}function gg(n){const t=n.mapValue.fields[eI];return e1(t)?gg(t):t}function th(n){const t=ws(n.mapValue.fields[tI].timestampValue);return new Wt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PB{constructor(t,r,i,s,o,a,u,l,c,h){this.databaseId=t,this.appId=r,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const Kd="(default)";class xa{constructor(t,r){this.projectId=t,this.database=r||Kd}static empty(){return new xa("","")}get isDefaultDatabase(){return this.database===Kd}isEqual(t){return t instanceof xa&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="__type__",rI="__max__",to={mapValue:{fields:{__type__:{stringValue:rI}}}},r1="__vector__",Zu="value",ld={nullValue:"NULL_VALUE"};function Eo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?e1(n)?4:nI(n)?9007199254740991:mg(n)?10:11:et(28295,{value:n})}function qi(n,t){if(n===t)return!0;const r=Eo(n);if(r!==Eo(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return th(n).isEqual(th(t));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const a=ws(s.timestampValue),u=ws(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(s,o){return Es(s.bytesValue).isEqual(Es(o.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(s,o){return hr(s.geoPointValue.latitude)===hr(o.geoPointValue.latitude)&&hr(s.geoPointValue.longitude)===hr(o.geoPointValue.longitude)}(n,t);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return hr(s.integerValue)===hr(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const a=hr(s.doubleValue),u=hr(o.doubleValue);return a===u?Zc(a)===Zc(u):isNaN(a)&&isNaN(u)}return!1}(n,t);case 9:return qu(n.arrayValue.values||[],t.arrayValue.values||[],qi);case 10:case 11:return function(s,o){const a=s.mapValue.fields||{},u=o.mapValue.fields||{};if(Xx(a)!==Xx(u))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!qi(a[l],u[l])))return!1;return!0}(n,t);default:return et(52216,{left:n})}}function rh(n,t){return(n.values||[]).find(r=>qi(r,t))!==void 0}function So(n,t){if(n===t)return 0;const r=Eo(n),i=Eo(t);if(r!==i)return gt(r,i);switch(r){case 0:case 9007199254740991:return 0;case 1:return gt(n.booleanValue,t.booleanValue);case 2:return function(o,a){const u=hr(o.integerValue||o.doubleValue),l=hr(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,t);case 3:return Qx(n.timestampValue,t.timestampValue);case 4:return Qx(th(n),th(t));case 5:return X0(n.stringValue,t.stringValue);case 6:return function(o,a){const u=Es(o),l=Es(a);return u.compareTo(l)}(n.bytesValue,t.bytesValue);case 7:return function(o,a){const u=o.split("/"),l=a.split("/");for(let c=0;c<u.length&&c<l.length;c++){const h=gt(u[c],l[c]);if(h!==0)return h}return gt(u.length,l.length)}(n.referenceValue,t.referenceValue);case 8:return function(o,a){const u=gt(hr(o.latitude),hr(a.latitude));return u!==0?u:gt(hr(o.longitude),hr(a.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return Jx(n.arrayValue,t.arrayValue);case 10:return function(o,a){var d,p,g,y;const u=o.fields||{},l=a.fields||{},c=(d=u[Zu])==null?void 0:d.arrayValue,h=(p=l[Zu])==null?void 0:p.arrayValue,f=gt(((g=c==null?void 0:c.values)==null?void 0:g.length)||0,((y=h==null?void 0:h.values)==null?void 0:y.length)||0);return f!==0?f:Jx(c,h)}(n.mapValue,t.mapValue);case 11:return function(o,a){if(o===to.mapValue&&a===to.mapValue)return 0;if(o===to.mapValue)return 1;if(a===to.mapValue)return-1;const u=o.fields||{},l=Object.keys(u),c=a.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const d=X0(l[f],h[f]);if(d!==0)return d;const p=So(u[l[f]],c[h[f]]);if(p!==0)return p}return gt(l.length,h.length)}(n.mapValue,t.mapValue);default:throw et(23264,{he:r})}}function Qx(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return gt(n,t);const r=ws(n),i=ws(t),s=gt(r.seconds,i.seconds);return s!==0?s:gt(r.nanos,i.nanos)}function Jx(n,t){const r=n.values||[],i=t.values||[];for(let s=0;s<r.length&&s<i.length;++s){const o=So(r[s],i[s]);if(o)return o}return gt(r.length,i.length)}function Qu(n){return ry(n)}function ry(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=ws(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(r){return Es(r).toBase64()}(n.bytesValue):"referenceValue"in n?function(r){return Ke.fromName(r).toString()}(n.referenceValue):"geoPointValue"in n?function(r){return`geo(${r.latitude},${r.longitude})`}(n.geoPointValue):"arrayValue"in n?function(r){let i="[",s=!0;for(const o of r.values||[])s?s=!1:i+=",",i+=ry(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${ry(r.fields[a])}`;return s+"}"}(n.mapValue):et(61005,{value:n})}function cd(n){switch(Eo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=gg(n);return t?16+cd(t):16;case 5:return 2*n.stringValue.length;case 6:return Es(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,o)=>s+cd(o),0)}(n.arrayValue);case 10:case 11:return function(i){let s=0;return Mo(i.fields,(o,a)=>{s+=o.length+cd(a)}),s}(n.mapValue);default:throw et(13486,{value:n})}}function nh(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function ny(n){return!!n&&"integerValue"in n}function ih(n){return!!n&&"arrayValue"in n}function ew(n){return!!n&&"nullValue"in n}function tw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function hd(n){return!!n&&"mapValue"in n}function mg(n){var r,i;return((i=(((r=n==null?void 0:n.mapValue)==null?void 0:r.fields)||{})[t1])==null?void 0:i.stringValue)===r1}function Ic(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return Mo(n.mapValue.fields,(r,i)=>t.mapValue.fields[r]=Ic(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(n.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=Ic(n.arrayValue.values[r]);return t}return{...n}}function nI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===rI}const iI={mapValue:{fields:{[t1]:{stringValue:r1},[Zu]:{arrayValue:{}}}}};function MB(n){return"nullValue"in n?ld:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?nh(xa.empty(),Ke.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?mg(n)?iI:{mapValue:{}}:et(35942,{value:n})}function LB(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?nh(xa.empty(),Ke.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?iI:"mapValue"in n?mg(n)?{mapValue:{}}:to:et(61959,{value:n})}function rw(n,t){const r=So(n.value,t.value);return r!==0?r:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function nw(n,t){const r=So(n.value,t.value);return r!==0?r:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(t){this.value=t}static empty(){return new on({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let i=0;i<t.length-1;++i)if(r=(r.mapValue.fields||{})[t.get(i)],!hd(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ic(r)}setAll(t){let r=mr.emptyPath(),i={},s=[];t.forEach((a,u)=>{if(!r.isImmediateParentOf(u)){const l=this.getFieldsMap(r);this.applyChanges(l,i,s),i={},s=[],r=u.popLast()}a?i[u.lastSegment()]=Ic(a):s.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,i,s)}delete(t){const r=this.field(t.popLast());hd(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return qi(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=r.mapValue.fields[t.get(i)];hd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(i)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,i){Mo(r,(s,o)=>t[s]=o);for(const s of i)delete t[s]}clone(){return new on(Ic(this.value))}}function sI(n){const t=[];return Mo(n.fields,(r,i)=>{const s=new mr([r]);if(hd(i)){const o=sI(i.mapValue).fields;if(o.length===0)t.push(s);else for(const a of o)t.push(s.child(a))}else t.push(s)}),new Nn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(t,r,i,s,o,a,u){this.key=t,this.documentType=r,this.version=i,this.readTime=s,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(t){return new _r(t,0,ot.min(),ot.min(),ot.min(),on.empty(),0)}static newFoundDocument(t,r,i,s){return new _r(t,1,r,ot.min(),i,s,0)}static newNoDocument(t,r){return new _r(t,2,r,ot.min(),ot.min(),on.empty(),0)}static newUnknownDocument(t,r){return new _r(t,3,r,ot.min(),ot.min(),on.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ot.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof _r&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new _r(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(t,r){this.position=t,this.inclusive=r}}function iw(n,t,r){let i=0;for(let s=0;s<n.position.length;s++){const o=t[s],a=n.position[s];if(o.field.isKeyField()?i=Ke.comparator(Ke.fromName(a.referenceValue),r.key):i=So(a,r.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function sw(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let r=0;r<n.position.length;r++)if(!qi(n.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(t,r="asc"){this.field=t,this.dir=r}}function OB(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{}class It extends oI{constructor(t,r,i){super(),this.field=t,this.op=r,this.value=i}static create(t,r,i){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,i):new VB(t,r,i):r==="array-contains"?new $B(t,i):r==="in"?new fI(t,i):r==="not-in"?new jB(t,i):r==="array-contains-any"?new GB(t,i):new It(t,r,i)}static createKeyFieldInFilter(t,r,i){return r==="in"?new BB(t,i):new UB(t,i)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(So(r,this.value)):r!==null&&Eo(this.value)===Eo(r)&&this.matchesComparison(So(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kt extends oI{constructor(t,r){super(),this.filters=t,this.op=r,this.Pe=null}static create(t,r){return new Kt(t,r)}matches(t){return el(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function el(n){return n.op==="and"}function iy(n){return n.op==="or"}function n1(n){return aI(n)&&el(n)}function aI(n){for(const t of n.filters)if(t instanceof Kt)return!1;return!0}function sy(n){if(n instanceof It)return n.field.canonicalString()+n.op.toString()+Qu(n.value);if(n1(n))return n.filters.map(t=>sy(t)).join(",");{const t=n.filters.map(r=>sy(r)).join(",");return`${n.op}(${t})`}}function uI(n,t){return n instanceof It?function(i,s){return s instanceof It&&i.op===s.op&&i.field.isEqual(s.field)&&qi(i.value,s.value)}(n,t):n instanceof Kt?function(i,s){return s instanceof Kt&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,a,u)=>o&&uI(a,s.filters[u]),!0):!1}(n,t):void et(19439)}function lI(n,t){const r=n.filters.concat(t);return Kt.create(r,n.op)}function cI(n){return n instanceof It?function(r){return`${r.field.canonicalString()} ${r.op} ${Qu(r.value)}`}(n):n instanceof Kt?function(r){return r.op.toString()+" {"+r.getFilters().map(cI).join(" ,")+"}"}(n):"Filter"}class VB extends It{constructor(t,r,i){super(t,r,i),this.key=Ke.fromName(i.referenceValue)}matches(t){const r=Ke.comparator(t.key,this.key);return this.matchesComparison(r)}}class BB extends It{constructor(t,r){super(t,"in",r),this.keys=hI("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class UB extends It{constructor(t,r){super(t,"not-in",r),this.keys=hI("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function hI(n,t){var r;return(((r=t.arrayValue)==null?void 0:r.values)||[]).map(i=>Ke.fromName(i.referenceValue))}class $B extends It{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return ih(r)&&rh(r.arrayValue,this.value)}}class fI extends It{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&rh(this.value.arrayValue,r)}}class jB extends It{constructor(t,r){super(t,"not-in",r)}matches(t){if(rh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&r.nullValue===void 0&&!rh(this.value.arrayValue,r)}}class GB extends It{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!ih(r)||!r.arrayValue.values)&&r.arrayValue.values.some(i=>rh(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(t,r=null,i=[],s=[],o=null,a=null,u=null){this.path=t,this.collectionGroup=r,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=a,this.endAt=u,this.Te=null}}function oy(n,t=null,r=[],i=[],s=null,o=null,a=null){return new zB(n,t,r,i,s,o,a)}function wa(n){const t=vt(n);if(t.Te===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(i=>sy(i)).join(","),r+="|ob:",r+=t.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),hg(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Qu(i)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Qu(i)).join(",")),t.Te=r}return t.Te}function Qh(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<n.orderBy.length;r++)if(!OB(n.orderBy[r],t.orderBy[r]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let r=0;r<n.filters.length;r++)if(!uI(n.filters[r],t.filters[r]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!sw(n.startAt,t.startAt)&&sw(n.endAt,t.endAt)}function Xd(n){return Ke.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Zd(n,t){return n.filters.filter(r=>r instanceof It&&r.field.isEqual(t))}function ow(n,t,r){let i=ld,s=!0;for(const o of Zd(n,t)){let a=ld,u=!0;switch(o.op){case"<":case"<=":a=MB(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,u=!1;break;case"!=":case"not-in":a=ld}rw({value:i,inclusive:s},{value:a,inclusive:u})<0&&(i=a,s=u)}if(r!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(t)){const a=r.position[o];rw({value:i,inclusive:s},{value:a,inclusive:r.inclusive})<0&&(i=a,s=r.inclusive);break}}return{value:i,inclusive:s}}function aw(n,t,r){let i=to,s=!0;for(const o of Zd(n,t)){let a=to,u=!0;switch(o.op){case">=":case">":a=LB(o.value),u=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,u=!1;break;case"!=":case"not-in":a=to}nw({value:i,inclusive:s},{value:a,inclusive:u})>0&&(i=a,s=u)}if(r!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(t)){const a=r.position[o];nw({value:i,inclusive:s},{value:a,inclusive:r.inclusive})>0&&(i=a,s=r.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(t,r=null,i=[],s=[],o=null,a="F",u=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function qB(n,t,r,i,s,o,a,u){return new Jh(n,t,r,i,s,o,a,u)}function i1(n){return new Jh(n)}function uw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dI(n){return n.collectionGroup!==null}function Dc(n){const t=vt(n);if(t.Ie===null){t.Ie=[];const r=new Set;for(const o of t.explicitOrderBy)t.Ie.push(o),r.add(o.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Yt(mr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(u=u.add(c.field))})}),u})(t).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||t.Ie.push(new Yd(o,i))}),r.has(mr.keyField().canonicalString())||t.Ie.push(new Yd(mr.keyField(),i))}return t.Ie}function ri(n){const t=vt(n);return t.Ee||(t.Ee=HB(t,Dc(n))),t.Ee}function HB(n,t){if(n.limitType==="F")return oy(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new Yd(s.field,o)});const r=n.endAt?new Ju(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ju(n.startAt.position,n.startAt.inclusive):null;return oy(n.path,n.collectionGroup,t,n.filters,n.limit,r,i)}}function ay(n,t){const r=n.filters.concat([t]);return new Jh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),r,n.limit,n.limitType,n.startAt,n.endAt)}function uy(n,t,r){return new Jh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,r,n.startAt,n.endAt)}function yg(n,t){return Qh(ri(n),ri(t))&&n.limitType===t.limitType}function pI(n){return`${wa(ri(n))}|lt:${n.limitType}`}function lu(n){return`Query(target=${function(r){let i=r.path.canonicalString();return r.collectionGroup!==null&&(i+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(i+=`, filters: [${r.filters.map(s=>cI(s)).join(", ")}]`),hg(r.limit)||(i+=", limit: "+r.limit),r.orderBy.length>0&&(i+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(i+=", startAt: ",i+=r.startAt.inclusive?"b:":"a:",i+=r.startAt.position.map(s=>Qu(s)).join(",")),r.endAt&&(i+=", endAt: ",i+=r.endAt.inclusive?"a:":"b:",i+=r.endAt.position.map(s=>Qu(s)).join(",")),`Target(${i})`}(ri(n))}; limitType=${n.limitType})`}function ef(n,t){return t.isFoundDocument()&&function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Ke.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,t)&&function(i,s){for(const o of Dc(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,t)&&function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0}(n,t)&&function(i,s){return!(i.startAt&&!function(a,u,l){const c=iw(a,u,l);return a.inclusive?c<=0:c<0}(i.startAt,Dc(i),s)||i.endAt&&!function(a,u,l){const c=iw(a,u,l);return a.inclusive?c>=0:c>0}(i.endAt,Dc(i),s))}(n,t)}function WB(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function gI(n){return(t,r)=>{let i=!1;for(const s of Dc(n)){const o=KB(s,t,r);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function KB(n,t,r){const i=n.field.isKeyField()?Ke.comparator(t.key,r.key):function(o,a,u){const l=a.data.field(o),c=u.data.field(o);return l!==null&&c!==null?So(l,c):et(42886)}(n.field,t,r);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return et(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,t))return o}}has(t){return this.get(t)!==void 0}set(t,r){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,r]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],t))return void(s[o]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[r]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Mo(this.inner,(r,i)=>{for(const[s,o]of i)t(s,o)})}isEmpty(){return XT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB=new dr(Ke.comparator);function jn(){return YB}const mI=new dr(Ke.comparator);function ac(...n){let t=mI;for(const r of n)t=t.insert(r.key,r);return t}function yI(n){let t=mI;return n.forEach((r,i)=>t=t.insert(r,i.overlayedDocument)),t}function Pi(){return kc()}function vI(){return kc()}function kc(){return new Is(n=>n.toString(),(n,t)=>n.isEqual(t))}const XB=new dr(Ke.comparator),ZB=new Yt(Ke.comparator);function Et(...n){let t=ZB;for(const r of n)t=t.add(r);return t}const QB=new Yt(gt);function JB(){return QB}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zc(t)?"-0":t}}function _I(n){return{integerValue:""+n}}function e6(n,t){return oB(t)?_I(t):s1(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(){this._=void 0}}function t6(n,t,r){return n instanceof sh?function(s,o){const a={fields:{[JT]:{stringValue:QT},[tI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&e1(o)&&(o=gg(o)),o&&(a.fields[eI]=o),{mapValue:a}}(r,t):n instanceof tl?xI(n,t):n instanceof rl?wI(n,t):function(s,o){const a=bI(s,o),u=lw(a)+lw(s.Ae);return ny(a)&&ny(s.Ae)?_I(u):s1(s.serializer,u)}(n,t)}function r6(n,t,r){return n instanceof tl?xI(n,t):n instanceof rl?wI(n,t):r}function bI(n,t){return n instanceof oh?function(i){return ny(i)||function(o){return!!o&&"doubleValue"in o}(i)}(t)?t:{integerValue:0}:null}class sh extends vg{}class tl extends vg{constructor(t){super(),this.elements=t}}function xI(n,t){const r=EI(t);for(const i of n.elements)r.some(s=>qi(s,i))||r.push(i);return{arrayValue:{values:r}}}class rl extends vg{constructor(t){super(),this.elements=t}}function wI(n,t){let r=EI(t);for(const i of n.elements)r=r.filter(s=>!qi(s,i));return{arrayValue:{values:r}}}class oh extends vg{constructor(t,r){super(),this.serializer=t,this.Ae=r}}function lw(n){return hr(n.integerValue||n.doubleValue)}function EI(n){return ih(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(t,r){this.field=t,this.transform=r}}function i6(n,t){return n.field.isEqual(t.field)&&function(i,s){return i instanceof tl&&s instanceof tl||i instanceof rl&&s instanceof rl?qu(i.elements,s.elements,qi):i instanceof oh&&s instanceof oh?qi(i.Ae,s.Ae):i instanceof sh&&s instanceof sh}(n.transform,t.transform)}class s6{constructor(t,r){this.version=t,this.transformResults=r}}class _n{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new _n}static exists(t){return new _n(void 0,t)}static updateTime(t){return new _n(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function fd(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class _g{}function SI(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new bg(n.key,_n.none()):new Cl(n.key,n.data,_n.none());{const r=n.data,i=on.empty();let s=new Yt(mr.comparator);for(let o of t.fields)if(!s.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?i.delete(o):i.set(o,a),s=s.add(o)}return new Ds(n.key,i,new Nn(s.toArray()),_n.none())}}function o6(n,t,r){n instanceof Cl?function(s,o,a){const u=s.value.clone(),l=hw(s.fieldTransforms,o,a.transformResults);u.setAll(l),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,t,r):n instanceof Ds?function(s,o,a){if(!fd(s.precondition,o))return void o.convertToUnknownDocument(a.version);const u=hw(s.fieldTransforms,o,a.transformResults),l=o.data;l.setAll(CI(s)),l.setAll(u),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,t,r):function(s,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function Nc(n,t,r,i){return n instanceof Cl?function(o,a,u,l){if(!fd(o.precondition,a))return u;const c=o.value.clone(),h=fw(o.fieldTransforms,l,a);return c.setAll(h),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(n,t,r,i):n instanceof Ds?function(o,a,u,l){if(!fd(o.precondition,a))return u;const c=fw(o.fieldTransforms,l,a),h=a.data;return h.setAll(CI(o)),h.setAll(c),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,t,r,i):function(o,a,u){return fd(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,t,r)}function a6(n,t){let r=null;for(const i of n.fieldTransforms){const s=t.data.field(i.field),o=bI(i.transform,s||null);o!=null&&(r===null&&(r=on.empty()),r.set(i.field,o))}return r||null}function cw(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&qu(i,s,(o,a)=>i6(o,a))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Cl extends _g{constructor(t,r,i,s=[]){super(),this.key=t,this.value=r,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ds extends _g{constructor(t,r,i,s,o=[]){super(),this.key=t,this.data=r,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function CI(n){const t=new Map;return n.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const i=n.data.field(r);t.set(r,i)}}),t}function hw(n,t,r){const i=new Map;it(n.length===r.length,32656,{Re:r.length,Ve:n.length});for(let s=0;s<r.length;s++){const o=n[s],a=o.transform,u=t.data.field(o.field);i.set(o.field,r6(a,u,r[s]))}return i}function fw(n,t,r){const i=new Map;for(const s of n){const o=s.transform,a=r.data.field(s.field);i.set(s.field,t6(o,a,t))}return i}class bg extends _g{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AI extends _g{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(t,r,i,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,r){const i=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(t.key)&&o6(o,t,i[s])}}applyToLocalView(t,r){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(r=Nc(i,t,r,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(r=Nc(i,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const i=vI();return this.mutations.forEach(s=>{const o=t.get(s.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=r.has(s.key)?null:u;const l=SI(a,u);l!==null&&i.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(ot.min())}),i}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Et())}isEqual(t){return this.batchId===t.batchId&&qu(this.mutations,t.mutations,(r,i)=>cw(r,i))&&qu(this.baseMutations,t.baseMutations,(r,i)=>cw(r,i))}}class a1{constructor(t,r,i,s){this.batch=t,this.commitVersion=r,this.mutationResults=i,this.docVersions=s}static from(t,r,i){it(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let s=function(){return XB}();const o=t.mutations;for(let a=0;a<o.length;a++)s=s.insert(o[a].key,i[a].version);return new a1(t,r,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar,Ft;function l6(n){switch(n){case ke.OK:return et(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return et(15467,{code:n})}}function TI(n){if(n===void 0)return yn("GRPC error has no .code"),ke.UNKNOWN;switch(n){case Ar.OK:return ke.OK;case Ar.CANCELLED:return ke.CANCELLED;case Ar.UNKNOWN:return ke.UNKNOWN;case Ar.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case Ar.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case Ar.INTERNAL:return ke.INTERNAL;case Ar.UNAVAILABLE:return ke.UNAVAILABLE;case Ar.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case Ar.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case Ar.NOT_FOUND:return ke.NOT_FOUND;case Ar.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case Ar.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case Ar.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case Ar.ABORTED:return ke.ABORTED;case Ar.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case Ar.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case Ar.DATA_LOSS:return ke.DATA_LOSS;default:return et(39323,{code:n})}}(Ft=Ar||(Ar={}))[Ft.OK=0]="OK",Ft[Ft.CANCELLED=1]="CANCELLED",Ft[Ft.UNKNOWN=2]="UNKNOWN",Ft[Ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ft[Ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ft[Ft.NOT_FOUND=5]="NOT_FOUND",Ft[Ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ft[Ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ft[Ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ft[Ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ft[Ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ft[Ft.ABORTED=10]="ABORTED",Ft[Ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ft[Ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ft[Ft.INTERNAL=13]="INTERNAL",Ft[Ft.UNAVAILABLE=14]="UNAVAILABLE",Ft[Ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6=new po([4294967295,4294967295],0);function dw(n){const t=c6().encode(n),r=new AT;return r.update(t),new Uint8Array(r.digest())}function pw(n){const t=new DataView(n.buffer),r=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new po([r,i],0),new po([s,o],0)]}class l1{constructor(t,r,i){if(this.bitmap=t,this.padding=r,this.hashCount=i,r<0||r>=8)throw new uc(`Invalid padding: ${r}`);if(i<0)throw new uc(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new uc(`Invalid hash count: ${i}`);if(t.length===0&&r!==0)throw new uc(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*t.length-r,this.pe=po.fromNumber(this.ge)}ye(t,r,i){let s=t.add(r.multiply(po.fromNumber(i)));return s.compare(h6)===1&&(s=new po([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const r=dw(t),[i,s]=pw(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(i,s,o);if(!this.we(a))return!1}return!0}static create(t,r,i){const s=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),a=new l1(o,s,r);return i.forEach(u=>a.insert(u)),a}insert(t){if(this.ge===0)return;const r=dw(t),[i,s]=pw(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(i,s,o);this.Se(a)}}Se(t){const r=Math.floor(t/8),i=t%8;this.bitmap[r]|=1<<i}}class uc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(t,r,i,s,o){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,r,i){const s=new Map;return s.set(t,tf.createSynthesizedTargetChangeForCurrentChange(t,r,i)),new xg(ot.min(),s,new dr(gt),jn(),Et())}}class tf{constructor(t,r,i,s,o){this.resumeToken=t,this.current=r,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,r,i){return new tf(i,r,Et(),Et(),Et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(t,r,i,s){this.be=t,this.removedTargetIds=r,this.key=i,this.De=s}}class II{constructor(t,r){this.targetId=t,this.Ce=r}}class DI{constructor(t,r,i=Nr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=i,this.cause=s}}class gw{constructor(){this.ve=0,this.Fe=mw(),this.Me=Nr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Et(),r=Et(),i=Et();return this.Fe.forEach((s,o)=>{switch(o){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:i=i.add(s);break;default:et(38017,{changeType:o})}}),new tf(this.Me,this.xe,t,r,i)}qe(){this.Oe=!1,this.Fe=mw()}Qe(t,r){this.Oe=!0,this.Fe=this.Fe.insert(t,r)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,it(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class f6{constructor(t){this.Ge=t,this.ze=new Map,this.je=jn(),this.Je=Tf(),this.He=Tf(),this.Ye=new dr(gt)}Ze(t){for(const r of t.be)t.De&&t.De.isFoundDocument()?this.Xe(r,t.De):this.et(r,t.key,t.De);for(const r of t.removedTargetIds)this.et(r,t.key,t.De)}tt(t){this.forEachTarget(t,r=>{const i=this.nt(r);switch(t.state){case 0:this.rt(r)&&i.Le(t.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(t.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(i.We(),i.Le(t.resumeToken));break;case 4:this.rt(r)&&(this.it(r),i.Le(t.resumeToken));break;default:et(56790,{state:t.state})}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ze.forEach((i,s)=>{this.rt(s)&&r(s)})}st(t){const r=t.targetId,i=t.Ce.count,s=this.ot(r);if(s){const o=s.target;if(Xd(o))if(i===0){const a=new Ke(o.path);this.et(r,a,_r.newNoDocument(a,ot.min()))}else it(i===1,20013,{expectedCount:i});else{const a=this._t(r);if(a!==i){const u=this.ut(t),l=u?this.ct(u,t,a):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(t){const r=t.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=r;let a,u;try{a=Es(i).toUint8Array()}catch(l){if(l instanceof ZT)return Kc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new l1(a,s,o)}catch(l){return Kc(l instanceof uc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.ge===0?null:u}ct(t,r,i){return r.Ce.count===i-this.Pt(t,r.targetId)?0:2}Pt(t,r){const i=this.Ge.getRemoteKeysForTarget(r);let s=0;return i.forEach(o=>{const a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;t.mightContain(u)||(this.et(r,o,null),s++)}),s}Tt(t){const r=new Map;this.ze.forEach((o,a)=>{const u=this.ot(a);if(u){if(o.current&&Xd(u.target)){const l=new Ke(u.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,_r.newNoDocument(l,t))}o.Be&&(r.set(a,o.ke()),o.qe())}});let i=Et();this.He.forEach((o,a)=>{let u=!0;a.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(i=i.add(o))}),this.je.forEach((o,a)=>a.setReadTime(t));const s=new xg(t,r,this.Ye,this.je,i);return this.je=jn(),this.Je=Tf(),this.He=Tf(),this.Ye=new dr(gt),s}Xe(t,r){if(!this.rt(t))return;const i=this.Et(t,r.key)?2:0;this.nt(t).Qe(r.key,i),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(t)),this.He=this.He.insert(r.key,this.dt(r.key).add(t))}et(t,r,i){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(t)),this.He=this.He.insert(r,this.dt(r).add(t)),i&&(this.je=this.je.insert(r,i))}removeTarget(t){this.ze.delete(t)}_t(t){const r=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let r=this.ze.get(t);return r||(r=new gw,this.ze.set(t,r)),r}dt(t){let r=this.He.get(t);return r||(r=new Yt(gt),this.He=this.He.insert(t,r)),r}It(t){let r=this.Je.get(t);return r||(r=new Yt(gt),this.Je=this.Je.insert(t,r)),r}rt(t){const r=this.ot(t)!==null;return r||Oe("WatchChangeAggregator","Detected inactive target",t),r}ot(t){const r=this.ze.get(t);return r&&r.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new gw),this.Ge.getRemoteKeysForTarget(t).forEach(r=>{this.et(t,r,null)})}Et(t,r){return this.Ge.getRemoteKeysForTarget(t).has(r)}}function Tf(){return new dr(Ke.comparator)}function mw(){return new dr(Ke.comparator)}const d6={asc:"ASCENDING",desc:"DESCENDING"},p6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g6={and:"AND",or:"OR"};class m6{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function ly(n,t){return n.useProto3Json||hg(t)?t:{value:t}}function nl(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function kI(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function y6(n,t){return nl(n,t.toTimestamp())}function xn(n){return it(!!n,49232),ot.fromTimestamp(function(r){const i=ws(r);return new Wt(i.seconds,i.nanos)}(n))}function c1(n,t){return cy(n,t).canonicalString()}function cy(n,t){const r=function(s){return new $t(["projects",s.projectId,"databases",s.database])}(n).child("documents");return t===void 0?r:r.child(t)}function NI(n){const t=$t.fromString(n);return it(UI(t),10190,{key:t.toString()}),t}function Qd(n,t){return c1(n.databaseId,t.path)}function ma(n,t){const r=NI(t);if(r.get(1)!==n.databaseId.projectId)throw new qe(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+n.databaseId.projectId);if(r.get(3)!==n.databaseId.database)throw new qe(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+n.databaseId.database);return new Ke(PI(r))}function RI(n,t){return c1(n.databaseId,t)}function FI(n){const t=NI(n);return t.length===4?$t.emptyPath():PI(t)}function hy(n){return new $t(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PI(n){return it(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function yw(n,t,r){return{name:Qd(n,t),fields:r.value.mapValue.fields}}function v6(n,t,r){const i=ma(n,t.name),s=xn(t.updateTime),o=t.createTime?xn(t.createTime):ot.min(),a=new on({mapValue:{fields:t.fields}}),u=_r.newFoundDocument(i,s,o,a);return r&&u.setHasCommittedMutations(),r?u.setHasCommittedMutations():u}function _6(n,t){let r;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:et(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],o=function(c,h){return c.useProto3Json?(it(h===void 0||typeof h=="string",58123),Nr.fromBase64String(h||"")):(it(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Nr.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),a=t.targetChange.cause,u=a&&function(c){const h=c.code===void 0?ke.UNKNOWN:TI(c.code);return new qe(h,c.message||"")}(a);r=new DI(i,s,o,u||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=ma(n,i.document.name),o=xn(i.document.updateTime),a=i.document.createTime?xn(i.document.createTime):ot.min(),u=new on({mapValue:{fields:i.document.fields}}),l=_r.newFoundDocument(s,o,a,u),c=i.targetIds||[],h=i.removedTargetIds||[];r=new dd(c,h,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=ma(n,i.document),o=i.readTime?xn(i.readTime):ot.min(),a=_r.newNoDocument(s,o),u=i.removedTargetIds||[];r=new dd([],u,a.key,a)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=ma(n,i.document),o=i.removedTargetIds||[];r=new dd([],o,s,null)}else{if(!("filter"in t))return et(11601,{Rt:t});{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,a=new u6(s,o),u=i.targetId;r=new II(u,a)}}return r}function Jd(n,t){let r;if(t instanceof Cl)r={update:yw(n,t.key,t.value)};else if(t instanceof bg)r={delete:Qd(n,t.key)};else if(t instanceof Ds)r={update:yw(n,t.key,t.data),updateMask:C6(t.fieldMask)};else{if(!(t instanceof AI))return et(16599,{Vt:t.type});r={verify:Qd(n,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(i=>function(o,a){const u=a.transform;if(u instanceof sh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof tl)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof rl)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof oh)return{fieldPath:a.field.canonicalString(),increment:u.Ae};throw et(20930,{transform:a.transform})}(0,i))),t.precondition.isNone||(r.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:y6(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:et(27497)}(n,t.precondition)),r}function fy(n,t){const r=t.currentDocument?function(o){return o.updateTime!==void 0?_n.updateTime(xn(o.updateTime)):o.exists!==void 0?_n.exists(o.exists):_n.none()}(t.currentDocument):_n.none(),i=t.updateTransforms?t.updateTransforms.map(s=>function(a,u){let l=null;if("setToServerValue"in u)it(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),l=new sh;else if("appendMissingElements"in u){const h=u.appendMissingElements.values||[];l=new tl(h)}else if("removeAllFromArray"in u){const h=u.removeAllFromArray.values||[];l=new rl(h)}else"increment"in u?l=new oh(a,u.increment):et(16584,{proto:u});const c=mr.fromServerFormat(u.fieldPath);return new n6(c,l)}(n,s)):[];if(t.update){t.update.name;const s=ma(n,t.update.name),o=new on({mapValue:{fields:t.update.fields}});if(t.updateMask){const a=function(l){const c=l.fieldPaths||[];return new Nn(c.map(h=>mr.fromServerFormat(h)))}(t.updateMask);return new Ds(s,o,a,r,i)}return new Cl(s,o,r,i)}if(t.delete){const s=ma(n,t.delete);return new bg(s,r)}if(t.verify){const s=ma(n,t.verify);return new AI(s,r)}return et(1463,{proto:t})}function b6(n,t){return n&&n.length>0?(it(t!==void 0,14353),n.map(r=>function(s,o){let a=s.updateTime?xn(s.updateTime):xn(o);return a.isEqual(ot.min())&&(a=xn(o)),new s6(a,s.transformResults||[])}(r,t))):[]}function MI(n,t){return{documents:[RI(n,t.path)]}}function LI(n,t){const r={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),r.structuredQuery.from=[{collectionId:i.lastSegment()}]),r.parent=RI(n,s);const o=function(c){if(c.length!==0)return BI(Kt.create(c,"and"))}(t.filters);o&&(r.structuredQuery.where=o);const a=function(c){if(c.length!==0)return c.map(h=>function(d){return{field:cu(d.field),direction:w6(d.dir)}}(h))}(t.orderBy);a&&(r.structuredQuery.orderBy=a);const u=ly(n,t.limit);return u!==null&&(r.structuredQuery.limit=u),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ft:r,parent:s}}function OI(n){let t=FI(n.parent);const r=n.structuredQuery,i=r.from?r.from.length:0;let s=null;if(i>0){it(i===1,65062);const h=r.from[0];h.allDescendants?s=h.collectionId:t=t.child(h.collectionId)}let o=[];r.where&&(o=function(f){const d=VI(f);return d instanceof Kt&&n1(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(d=>function(g){return new Yd(hu(g.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let u=null;r.limit&&(u=function(f){let d;return d=typeof f=="object"?f.value:f,hg(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(f){const d=!!f.before,p=f.values||[];return new Ju(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const d=!f.before,p=f.values||[];return new Ju(p,d)}(r.endAt)),qB(t,s,a,o,u,"F",l,c)}function x6(n,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return et(28987,{purpose:s})}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function VI(n){return n.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const i=hu(r.unaryFilter.field);return It.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=hu(r.unaryFilter.field);return It.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=hu(r.unaryFilter.field);return It.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=hu(r.unaryFilter.field);return It.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return et(61313);default:return et(60726)}}(n):n.fieldFilter!==void 0?function(r){return It.create(hu(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return et(58110);default:return et(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(r){return Kt.create(r.compositeFilter.filters.map(i=>VI(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return et(1026)}}(r.compositeFilter.op))}(n):et(30097,{filter:n})}function w6(n){return d6[n]}function E6(n){return p6[n]}function S6(n){return g6[n]}function cu(n){return{fieldPath:n.canonicalString()}}function hu(n){return mr.fromServerFormat(n.fieldPath)}function BI(n){return n instanceof It?function(r){if(r.op==="=="){if(tw(r.value))return{unaryFilter:{field:cu(r.field),op:"IS_NAN"}};if(ew(r.value))return{unaryFilter:{field:cu(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(tw(r.value))return{unaryFilter:{field:cu(r.field),op:"IS_NOT_NAN"}};if(ew(r.value))return{unaryFilter:{field:cu(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cu(r.field),op:E6(r.op),value:r.value}}}(n):n instanceof Kt?function(r){const i=r.getFilters().map(s=>BI(s));return i.length===1?i[0]:{compositeFilter:{op:S6(r.op),filters:i}}}(n):et(54877,{filter:n})}function C6(n){const t=[];return n.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function UI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(t,r,i,s,o=ot.min(),a=ot.min(),u=Nr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(t){return new fs(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(t){this.yt=t}}function A6(n,t){let r;if(t.document)r=v6(n.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const i=Ke.fromSegments(t.noDocument.path),s=Sa(t.noDocument.readTime);r=_r.newNoDocument(i,s),t.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!t.unknownDocument)return et(56709);{const i=Ke.fromSegments(t.unknownDocument.path),s=Sa(t.unknownDocument.version);r=_r.newUnknownDocument(i,s)}}return t.readTime&&r.setReadTime(function(s){const o=new Wt(s[0],s[1]);return ot.fromTimestamp(o)}(t.readTime)),r}function vw(n,t){const r=t.key,i={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:ep(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document=function(o,a){return{name:Qd(o,a.key),fields:a.data.value.mapValue.fields,updateTime:nl(o,a.version.toTimestamp()),createTime:nl(o,a.createTime.toTimestamp())}}(n.yt,t);else if(t.isNoDocument())i.noDocument={path:r.path.toArray(),readTime:Ea(t.version)};else{if(!t.isUnknownDocument())return et(57904,{document:t});i.unknownDocument={path:r.path.toArray(),version:Ea(t.version)}}return i}function ep(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function Ea(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Sa(n){const t=new Wt(n.seconds,n.nanoseconds);return ot.fromTimestamp(t)}function ta(n,t){const r=(t.baseMutations||[]).map(o=>fy(n.yt,o));for(let o=0;o<t.mutations.length-1;++o){const a=t.mutations[o];if(o+1<t.mutations.length&&t.mutations[o+1].transform!==void 0){const u=t.mutations[o+1];a.updateTransforms=u.transform.fieldTransforms,t.mutations.splice(o+1,1),++o}}const i=t.mutations.map(o=>fy(n.yt,o)),s=Wt.fromMillis(t.localWriteTimeMs);return new o1(t.batchId,s,r,i)}function lc(n){const t=Sa(n.readTime),r=n.lastLimboFreeSnapshotVersion!==void 0?Sa(n.lastLimboFreeSnapshotVersion):ot.min();let i;return i=function(o){return o.documents!==void 0}(n.query)?function(o){const a=o.documents.length;return it(a===1,1966,{count:a}),ri(i1(FI(o.documents[0])))}(n.query):function(o){return ri(OI(o))}(n.query),new fs(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,r,Nr.fromBase64String(n.resumeToken))}function jI(n,t){const r=Ea(t.snapshotVersion),i=Ea(t.lastLimboFreeSnapshotVersion);let s;s=Xd(t.target)?MI(n.yt,t.target):LI(n.yt,t.target).ft;const o=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:wa(t.target),readTime:r,resumeToken:o,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function GI(n){const t=OI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?uy(t,t.limit,"L"):t}function Lm(n,t){return new u1(t.largestBatchId,fy(n.yt,t.overlayMutation))}function _w(n,t){const r=t.path.lastSegment();return[n,an(t.path.popLast()),r]}function bw(n,t,r,i){return{indexId:n,uid:t,sequenceNumber:r,readTime:Ea(i.readTime),documentKey:an(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{getBundleMetadata(t,r){return xw(t).get(r).next(i=>{if(i)return function(o){return{id:o.bundleId,createTime:Sa(o.createTime),version:o.version}}(i)})}saveBundleMetadata(t,r){return xw(t).put(function(s){return{bundleId:s.id,createTime:Ea(xn(s.createTime)),version:s.version}}(r))}getNamedQuery(t,r){return ww(t).get(r).next(i=>{if(i)return function(o){return{name:o.name,query:GI(o.bundledQuery),readTime:Sa(o.readTime)}}(i)})}saveNamedQuery(t,r){return ww(t).put(function(s){return{name:s.name,readTime:Ea(xn(s.readTime)),bundledQuery:s.bundledQuery}}(r))}}function xw(n){return Gr(n,fg)}function ww(n){return Gr(n,dg)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(t,r){this.serializer=t,this.userId=r}static wt(t,r){const i=r.uid||"";return new wg(t,i)}getOverlay(t,r){return Kl(t).get(_w(this.userId,r)).next(i=>i?Lm(this.serializer,i):null)}getOverlays(t,r){const i=Pi();return _e.forEach(r,s=>this.getOverlay(t,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(t,r,i){const s=[];return i.forEach((o,a)=>{const u=new u1(r,a);s.push(this.St(t,u))}),_e.waitFor(s)}removeOverlaysForBatchId(t,r,i){const s=new Set;r.forEach(a=>s.add(an(a.getCollectionPath())));const o=[];return s.forEach(a=>{const u=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,i+1],!1,!0);o.push(Kl(t).Z(ey,u))}),_e.waitFor(o)}getOverlaysForCollection(t,r,i){const s=Pi(),o=an(r),a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Kl(t).J(ey,a).next(u=>{for(const l of u){const c=Lm(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(t,r,i,s){const o=Pi();let a;const u=IDBKeyRange.bound([this.userId,r,i],[this.userId,r,Number.POSITIVE_INFINITY],!0);return Kl(t).ee({index:qT,range:u},(l,c,h)=>{const f=Lm(this.serializer,c);o.size()<s||f.largestBatchId===a?(o.set(f.getKey(),f),a=f.largestBatchId):h.done()}).next(()=>o)}St(t,r){return Kl(t).put(function(s,o,a){const[u,l,c]=_w(o,a.mutation.key);return{userId:o,collectionPath:l,documentId:c,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:Jd(s.yt,a.mutation)}}(this.serializer,this.userId,r))}}function Kl(n){return Gr(n,pg)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{bt(t){return Gr(t,Qv)}getSessionToken(t){return this.bt(t).get("sessionToken").next(r=>{const i=r==null?void 0:r.value;return i?Nr.fromUint8Array(i):Nr.EMPTY_BYTE_STRING})}setSessionToken(t,r){return this.bt(t).put({name:"sessionToken",value:r.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(){}Dt(t,r){this.Ct(t,r),r.vt()}Ct(t,r){if("nullValue"in t)this.Ft(r,5);else if("booleanValue"in t)this.Ft(r,10),r.Mt(t.booleanValue?1:0);else if("integerValue"in t)this.Ft(r,15),r.Mt(hr(t.integerValue));else if("doubleValue"in t){const i=hr(t.doubleValue);isNaN(i)?this.Ft(r,13):(this.Ft(r,15),Zc(i)?r.Mt(0):r.Mt(i))}else if("timestampValue"in t){let i=t.timestampValue;this.Ft(r,20),typeof i=="string"&&(i=ws(i)),r.xt(`${i.seconds||""}`),r.Mt(i.nanos||0)}else if("stringValue"in t)this.Ot(t.stringValue,r),this.Nt(r);else if("bytesValue"in t)this.Ft(r,30),r.Bt(Es(t.bytesValue)),this.Nt(r);else if("referenceValue"in t)this.Lt(t.referenceValue,r);else if("geoPointValue"in t){const i=t.geoPointValue;this.Ft(r,45),r.Mt(i.latitude||0),r.Mt(i.longitude||0)}else"mapValue"in t?nI(t)?this.Ft(r,Number.MAX_SAFE_INTEGER):mg(t)?this.kt(t.mapValue,r):(this.qt(t.mapValue,r),this.Nt(r)):"arrayValue"in t?(this.Qt(t.arrayValue,r),this.Nt(r)):et(19022,{$t:t})}Ot(t,r){this.Ft(r,25),this.Ut(t,r)}Ut(t,r){r.xt(t)}qt(t,r){const i=t.fields||{};this.Ft(r,55);for(const s of Object.keys(i))this.Ot(s,r),this.Ct(i[s],r)}kt(t,r){var a,u;const i=t.fields||{};this.Ft(r,53);const s=Zu,o=((u=(a=i[s].arrayValue)==null?void 0:a.values)==null?void 0:u.length)||0;this.Ft(r,15),r.Mt(hr(o)),this.Ot(s,r),this.Ct(i[s],r)}Qt(t,r){const i=t.values||[];this.Ft(r,50);for(const s of i)this.Ct(s,r)}Lt(t,r){this.Ft(r,37),Ke.fromName(t).path.forEach(i=>{this.Ft(r,60),this.Ut(i,r)})}Ft(t,r){t.Mt(r)}Nt(t){t.Mt(2)}}ra.Kt=new ra;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=255;function D6(n){if(n===0)return 8;let t=0;return n>>4||(t+=4,n<<=4),n>>6||(t+=2,n<<=2),n>>7||(t+=1),t}function Ew(n){const t=64-function(i){let s=0;for(let o=0;o<8;++o){const a=D6(255&i[o]);if(s+=a,a!==8)break}return s}(n);return Math.ceil(t/8)}class k6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(t){const r=t[Symbol.iterator]();let i=r.next();for(;!i.done;)this.Gt(i.value),i=r.next();this.zt()}jt(t){const r=t[Symbol.iterator]();let i=r.next();for(;!i.done;)this.Jt(i.value),i=r.next();this.Ht()}Yt(t){for(const r of t){const i=r.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(r<"\uD800"||"\uDBFF"<r)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const s=r.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(t){for(const r of t){const i=r.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(r<"\uD800"||"\uDBFF"<r)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=r.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(t){const r=this.en(t),i=Ew(r);this.tn(1+i),this.buffer[this.position++]=255&i;for(let s=r.length-i;s<r.length;++s)this.buffer[this.position++]=255&r[s]}nn(t){const r=this.en(t),i=Ew(r);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let s=r.length-i;s<r.length;++s)this.buffer[this.position++]=~(255&r[s])}rn(){this.sn(Ja),this.sn(255)}_n(){this.an(Ja),this.an(255)}reset(){this.position=0}seed(t){this.tn(t.length),this.buffer.set(t,this.position),this.position+=t.length}un(){return this.buffer.slice(0,this.position)}en(t){const r=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(t),i=!!(128&r[0]);r[0]^=i?255:128;for(let s=1;s<r.length;++s)r[s]^=i?255:0;return r}Gt(t){const r=255&t;r===0?(this.sn(0),this.sn(255)):r===Ja?(this.sn(Ja),this.sn(0)):this.sn(r)}Jt(t){const r=255&t;r===0?(this.an(0),this.an(255)):r===Ja?(this.an(Ja),this.an(0)):this.an(t)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(t){this.tn(1),this.buffer[this.position++]=t}an(t){this.tn(1),this.buffer[this.position++]=~t}tn(t){const r=t+this.position;if(r<=this.buffer.length)return;let i=2*this.buffer.length;i<r&&(i=r);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class N6{constructor(t){this.cn=t}Bt(t){this.cn.Wt(t)}xt(t){this.cn.Yt(t)}Mt(t){this.cn.Xt(t)}vt(){this.cn.rn()}}class R6{constructor(t){this.cn=t}Bt(t){this.cn.jt(t)}xt(t){this.cn.Zt(t)}Mt(t){this.cn.nn(t)}vt(){this.cn._n()}}class Yl{constructor(){this.cn=new k6,this.ln=new N6(this.cn),this.hn=new R6(this.cn)}seed(t){this.cn.seed(t)}Pn(t){return t===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(t,r,i,s){this.Tn=t,this.In=r,this.En=i,this.dn=s}An(){const t=this.dn.length,r=t===0||this.dn[t-1]===255?t+1:t,i=new Uint8Array(r);return i.set(this.dn,0),r!==t?i.set([0],this.dn.length):++i[i.length-1],new na(this.Tn,this.In,this.En,i)}Rn(t,r,i){return{indexId:this.Tn,uid:t,arrayValue:pd(this.En),directionalValue:pd(this.dn),orderedDocumentKey:pd(r),documentKey:i.path.toArray()}}Vn(t,r,i){const s=this.Rn(t,r,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Bs(n,t){let r=n.Tn-t.Tn;return r!==0?r:(r=Sw(n.En,t.En),r!==0?r:(r=Sw(n.dn,t.dn),r!==0?r:Ke.comparator(n.In,t.In)))}function Sw(n,t){for(let r=0;r<n.length&&r<t.length;++r){const i=n[r]-t[r];if(i!==0)return i}return n.length-t.length}function pd(n){return _A()?function(r){let i="";for(let s=0;s<r.length;s++)i+=String.fromCharCode(r[s]);return i}(n):n}function Cw(n){return typeof n!="string"?n:function(r){const i=new Uint8Array(r.length);for(let s=0;s<r.length;s++)i[s]=r.charCodeAt(s);return i}(n)}class Aw{constructor(t){this.mn=new Yt((r,i)=>mr.comparator(r.field,i.field)),this.collectionId=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment(),this.fn=t.orderBy,this.gn=[];for(const r of t.filters){const i=r;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(t){if(it(t.collectionGroup===this.collectionId,49279),this.pn)return!1;const r=Z0(t);if(r!==void 0&&!this.wn(r))return!1;const i=Wo(t);let s=new Set,o=0,a=0;for(;o<i.length&&this.wn(i[o]);++o)s=s.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!s.has(u.field.canonicalString())){const l=i[o];if(!this.Sn(u,l)||!this.bn(this.fn[a++],l))return!1}++o}for(;o<i.length;++o){const u=i[o];if(a>=this.fn.length||!this.bn(this.fn[a++],u))return!1}return!0}Dn(){if(this.pn)return null;let t=new Yt(mr.comparator);const r=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")r.push(new od(i.field,2));else{if(t.has(i.field))continue;t=t.add(i.field),r.push(new od(i.field,0))}for(const i of this.fn)i.field.isKeyField()||t.has(i.field)||(t=t.add(i.field),r.push(new od(i.field,i.dir==="asc"?0:1)));return new zd(zd.UNKNOWN_ID,this.collectionId,r,Xc.empty())}wn(t){for(const r of this.gn)if(this.Sn(r,t))return!0;return!1}Sn(t,r){if(t===void 0||!t.field.isEqual(r.fieldPath))return!1;const i=t.op==="array-contains"||t.op==="array-contains-any";return r.kind===2===i}bn(t,r){return!!t.field.isEqual(r.fieldPath)&&(r.kind===0&&t.dir==="asc"||r.kind===1&&t.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(n){var r,i;if(it(n instanceof It||n instanceof Kt,20012),n instanceof It){if(n instanceof fI){const s=((i=(r=n.value.arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>It.create(n.field,"==",o)))||[];return Kt.create(s,"or")}return n}const t=n.filters.map(s=>zI(s));return Kt.create(t,n.op)}function F6(n){if(n.getFilters().length===0)return[];const t=gy(zI(n));return it(qI(t),7391),dy(t)||py(t)?[t]:t.getFilters()}function dy(n){return n instanceof It}function py(n){return n instanceof Kt&&n1(n)}function qI(n){return dy(n)||py(n)||function(r){if(r instanceof Kt&&iy(r)){for(const i of r.getFilters())if(!dy(i)&&!py(i))return!1;return!0}return!1}(n)}function gy(n){if(it(n instanceof It||n instanceof Kt,34018),n instanceof It)return n;if(n.filters.length===1)return gy(n.filters[0]);const t=n.filters.map(i=>gy(i));let r=Kt.create(t,n.op);return r=tp(r),qI(r)?r:(it(r instanceof Kt,64498),it(el(r),40251),it(r.filters.length>1,57927),r.filters.reduce((i,s)=>h1(i,s)))}function h1(n,t){let r;return it(n instanceof It||n instanceof Kt,38388),it(t instanceof It||t instanceof Kt,25473),r=n instanceof It?t instanceof It?function(s,o){return Kt.create([s,o],"and")}(n,t):Tw(n,t):t instanceof It?Tw(t,n):function(s,o){if(it(s.filters.length>0&&o.filters.length>0,48005),el(s)&&el(o))return lI(s,o.getFilters());const a=iy(s)?s:o,u=iy(s)?o:s,l=a.filters.map(c=>h1(c,u));return Kt.create(l,"or")}(n,t),tp(r)}function Tw(n,t){if(el(t))return lI(t,n.getFilters());{const r=t.filters.map(i=>h1(n,i));return Kt.create(r,"or")}}function tp(n){if(it(n instanceof It||n instanceof Kt,11850),n instanceof It)return n;const t=n.getFilters();if(t.length===1)return tp(t[0]);if(aI(n))return n;const r=t.map(s=>tp(s)),i=[];return r.forEach(s=>{s instanceof It?i.push(s):s instanceof Kt&&(s.op===n.op?i.push(...s.filters):i.push(s))}),i.length===1?i[0]:Kt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(){this.Cn=new f1}addToCollectionParentIndex(t,r){return this.Cn.add(r),_e.resolve()}getCollectionParents(t,r){return _e.resolve(this.Cn.getEntries(r))}addFieldIndex(t,r){return _e.resolve()}deleteFieldIndex(t,r){return _e.resolve()}deleteAllFieldIndexes(t){return _e.resolve()}createTargetIndexes(t,r){return _e.resolve()}getDocumentsMatchingTarget(t,r){return _e.resolve(null)}getIndexType(t,r){return _e.resolve(0)}getFieldIndexes(t,r){return _e.resolve([])}getNextCollectionGroupToUpdate(t){return _e.resolve(null)}getMinOffset(t,r){return _e.resolve(zn.min())}getMinOffsetFromCollectionGroup(t,r){return _e.resolve(zn.min())}updateCollectionGroup(t,r,i){return _e.resolve()}updateIndexEntries(t,r){return _e.resolve()}}class f1{constructor(){this.index={}}add(t){const r=t.lastSegment(),i=t.popLast(),s=this.index[r]||new Yt($t.comparator),o=!s.has(i);return this.index[r]=s.add(i),o}has(t){const r=t.lastSegment(),i=t.popLast(),s=this.index[r];return s&&s.has(i)}getEntries(t){return(this.index[t]||new Yt($t.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="IndexedDbIndexManager",If=new Uint8Array(0);class M6{constructor(t,r){this.databaseId=r,this.vn=new f1,this.Fn=new Is(i=>wa(i),(i,s)=>Qh(i,s)),this.uid=t.uid||""}addToCollectionParentIndex(t,r){if(!this.vn.has(r)){const i=r.lastSegment(),s=r.popLast();t.addOnCommittedListener(()=>{this.vn.add(r)});const o={collectionId:i,parent:an(s)};return Dw(t).put(o)}return _e.resolve()}getCollectionParents(t,r){const i=[],s=IDBKeyRange.bound([r,""],[FT(r),""],!1,!0);return Dw(t).J(s).next(o=>{for(const a of o){if(a.collectionId!==r)break;i.push(Fi(a.parent))}return i})}addFieldIndex(t,r){const i=Xl(t),s=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(r);delete s.indexId;const o=i.add(s);if(r.indexState){const a=tu(t);return o.next(u=>{a.put(bw(u,this.uid,r.indexState.sequenceNumber,r.indexState.offset))})}return o.next()}deleteFieldIndex(t,r){const i=Xl(t),s=tu(t),o=eu(t);return i.delete(r.indexId).next(()=>s.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([r.indexId],[r.indexId+1],!1,!0)))}deleteAllFieldIndexes(t){const r=Xl(t),i=eu(t),s=tu(t);return r.Z().next(()=>i.Z()).next(()=>s.Z())}createTargetIndexes(t,r){return _e.forEach(this.Mn(r),i=>this.getIndexType(t,i).next(s=>{if(s===0||s===1){const o=new Aw(i).Dn();if(o!=null)return this.addFieldIndex(t,o)}}))}getDocumentsMatchingTarget(t,r){const i=eu(t);let s=!0;const o=new Map;return _e.forEach(this.Mn(r),a=>this.xn(t,a).next(u=>{s&&(s=!!u),o.set(a,u)})).next(()=>{if(s){let a=Et();const u=[];return _e.forEach(o,(l,c)=>{Oe(Iw,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`}(l)} to execute ${wa(r)}`);const h=function(C,E){const S=Z0(E);if(S===void 0)return null;for(const R of Zd(C,S.fieldPath))switch(R.op){case"array-contains-any":return R.value.arrayValue.values||[];case"array-contains":return[R.value]}return null}(c,l),f=function(C,E){const S=new Map;for(const R of Wo(E))for(const w of Zd(C,R.fieldPath))switch(w.op){case"==":case"in":S.set(R.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return S.set(R.fieldPath.canonicalString(),w.value),Array.from(S.values())}return null}(c,l),d=function(C,E){const S=[];let R=!0;for(const w of Wo(E)){const x=w.kind===0?ow(C,w.fieldPath,C.startAt):aw(C,w.fieldPath,C.startAt);S.push(x.value),R&&(R=x.inclusive)}return new Ju(S,R)}(c,l),p=function(C,E){const S=[];let R=!0;for(const w of Wo(E)){const x=w.kind===0?aw(C,w.fieldPath,C.endAt):ow(C,w.fieldPath,C.endAt);S.push(x.value),R&&(R=x.inclusive)}return new Ju(S,R)}(c,l),g=this.On(l,c,d),y=this.On(l,c,p),v=this.Nn(l,c,f),T=this.Bn(l.indexId,h,g,d.inclusive,y,p.inclusive,v);return _e.forEach(T,_=>i.Y(_,r.limit).next(C=>{C.forEach(E=>{const S=Ke.fromSegments(E.documentKey);a.has(S)||(a=a.add(S),u.push(S))})}))}).next(()=>u)}return _e.resolve(null)})}Mn(t){let r=this.Fn.get(t);return r||(t.filters.length===0?r=[t]:r=F6(Kt.create(t.filters,"and")).map(i=>oy(t.path,t.collectionGroup,t.orderBy,i.getFilters(),t.limit,t.startAt,t.endAt)),this.Fn.set(t,r),r)}Bn(t,r,i,s,o,a,u){const l=(r!=null?r.length:1)*Math.max(i.length,o.length),c=l/(r!=null?r.length:1),h=[];for(let f=0;f<l;++f){const d=r?this.Ln(r[f/c]):If,p=this.kn(t,d,i[f%c],s),g=this.qn(t,d,o[f%c],a),y=u.map(v=>this.kn(t,d,v,!0));h.push(...this.createRange(p,g,y))}return h}kn(t,r,i,s){const o=new na(t,Ke.empty(),r,i);return s?o:o.An()}qn(t,r,i,s){const o=new na(t,Ke.empty(),r,i);return s?o.An():o}xn(t,r){const i=new Aw(r),s=r.collectionGroup!=null?r.collectionGroup:r.path.lastSegment();return this.getFieldIndexes(t,s).next(o=>{let a=null;for(const u of o)i.yn(u)&&(!a||u.fields.length>a.fields.length)&&(a=u);return a})}getIndexType(t,r){let i=2;const s=this.Mn(r);return _e.forEach(s,o=>this.xn(t,o).next(a=>{a?i!==0&&a.fields.length<function(l){let c=new Yt(mr.comparator),h=!1;for(const f of l.filters)for(const d of f.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?h=!0:c=c.add(d.field));for(const f of l.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(h?1:0)}(o)&&(i=1):i=0})).next(()=>function(a){return a.limit!==null}(r)&&s.length>1&&i===2?1:i)}Qn(t,r){const i=new Yl;for(const s of Wo(t)){const o=r.data.field(s.fieldPath);if(o==null)return null;const a=i.Pn(s.kind);ra.Kt.Dt(o,a)}return i.un()}Ln(t){const r=new Yl;return ra.Kt.Dt(t,r.Pn(0)),r.un()}$n(t,r){const i=new Yl;return ra.Kt.Dt(nh(this.databaseId,r),i.Pn(function(o){const a=Wo(o);return a.length===0?0:a[a.length-1].kind}(t))),i.un()}Nn(t,r,i){if(i===null)return[];let s=[];s.push(new Yl);let o=0;for(const a of Wo(t)){const u=i[o++];for(const l of s)if(this.Un(r,a.fieldPath)&&ih(u))s=this.Kn(s,a,u);else{const c=l.Pn(a.kind);ra.Kt.Dt(u,c)}}return this.Wn(s)}On(t,r,i){return this.Nn(t,r,i.position)}Wn(t){const r=[];for(let i=0;i<t.length;++i)r[i]=t[i].un();return r}Kn(t,r,i){const s=[...t],o=[];for(const a of i.arrayValue.values||[])for(const u of s){const l=new Yl;l.seed(u.un()),ra.Kt.Dt(a,l.Pn(r.kind)),o.push(l)}return o}Un(t,r){return!!t.filters.find(i=>i instanceof It&&i.field.isEqual(r)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(t,r){const i=Xl(t),s=tu(t);return(r?i.J(J0,IDBKeyRange.bound(r,r)):i.J()).next(o=>{const a=[];return _e.forEach(o,u=>s.get([u.indexId,this.uid]).next(l=>{a.push(function(h,f){const d=f?new Xc(f.sequenceNumber,new zn(Sa(f.readTime),new Ke(Fi(f.documentKey)),f.largestBatchId)):Xc.empty(),p=h.fields.map(([g,y])=>new od(mr.fromServerFormat(g),y));return new zd(h.indexId,h.collectionGroup,p,d)}(u,l))})).next(()=>a)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(r=>r.length===0?null:(r.sort((i,s)=>{const o=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:gt(i.collectionGroup,s.collectionGroup)}),r[0].collectionGroup))}updateCollectionGroup(t,r,i){const s=Xl(t),o=tu(t);return this.Gn(t).next(a=>s.J(J0,IDBKeyRange.bound(r,r)).next(u=>_e.forEach(u,l=>o.put(bw(l.indexId,this.uid,a,i)))))}updateIndexEntries(t,r){const i=new Map;return _e.forEach(r,(s,o)=>{const a=i.get(s.collectionGroup);return(a?_e.resolve(a):this.getFieldIndexes(t,s.collectionGroup)).next(u=>(i.set(s.collectionGroup,u),_e.forEach(u,l=>this.zn(t,s,l).next(c=>{const h=this.jn(o,l);return c.isEqual(h)?_e.resolve():this.Jn(t,o,l,c,h)}))))})}Hn(t,r,i,s){return eu(t).put(s.Rn(this.uid,this.$n(i,r.key),r.key))}Yn(t,r,i,s){return eu(t).delete(s.Vn(this.uid,this.$n(i,r.key),r.key))}zn(t,r,i){const s=eu(t);let o=new Yt(Bs);return s.ee({index:zT,range:IDBKeyRange.only([i.indexId,this.uid,pd(this.$n(i,r))])},(a,u)=>{o=o.add(new na(i.indexId,r,Cw(u.arrayValue),Cw(u.directionalValue)))}).next(()=>o)}jn(t,r){let i=new Yt(Bs);const s=this.Qn(r,t);if(s==null)return i;const o=Z0(r);if(o!=null){const a=t.data.field(o.fieldPath);if(ih(a))for(const u of a.arrayValue.values||[])i=i.add(new na(r.indexId,t.key,this.Ln(u),s))}else i=i.add(new na(r.indexId,t.key,If,s));return i}Jn(t,r,i,s,o){Oe(Iw,"Updating index entries for document '%s'",r.key);const a=[];return function(l,c,h,f,d){const p=l.getIterator(),g=c.getIterator();let y=Qa(p),v=Qa(g);for(;y||v;){let T=!1,_=!1;if(y&&v){const C=h(y,v);C<0?_=!0:C>0&&(T=!0)}else y!=null?_=!0:T=!0;T?(f(v),v=Qa(g)):_?(d(y),y=Qa(p)):(y=Qa(p),v=Qa(g))}}(s,o,Bs,u=>{a.push(this.Hn(t,r,i,u))},u=>{a.push(this.Yn(t,r,i,u))}),_e.waitFor(a)}Gn(t){let r=1;return tu(t).ee({index:GT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,s,o)=>{o.done(),r=s.sequenceNumber+1}).next(()=>r)}createRange(t,r,i){i=i.sort((a,u)=>Bs(a,u)).filter((a,u,l)=>!u||Bs(a,l[u-1])!==0);const s=[];s.push(t);for(const a of i){const u=Bs(a,t),l=Bs(a,r);if(u===0)s[0]=t.An();else if(u>0&&l<0)s.push(a),s.push(a.An());else if(l>0)break}s.push(r);const o=[];for(let a=0;a<s.length;a+=2){if(this.Zn(s[a],s[a+1]))return[];const u=s[a].Vn(this.uid,If,Ke.empty()),l=s[a+1].Vn(this.uid,If,Ke.empty());o.push(IDBKeyRange.bound(u,l))}return o}Zn(t,r){return Bs(t,r)>0}getMinOffsetFromCollectionGroup(t,r){return this.getFieldIndexes(t,r).next(kw)}getMinOffset(t,r){return _e.mapArray(this.Mn(r),i=>this.xn(t,i).next(s=>s||et(44426))).next(kw)}}function Dw(n){return Gr(n,eh)}function eu(n){return Gr(n,Tc)}function Xl(n){return Gr(n,Zv)}function tu(n){return Gr(n,Ac)}function kw(n){it(n.length!==0,28825);let t=n[0].indexState.offset,r=t.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;Kv(s,t)<0&&(t=s),r<s.largestBatchId&&(r=s.largestBatchId)}return new zn(t.readTime,t.documentKey,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},HI=41943040;class en{static withCacheSize(t){return new en(t,en.DEFAULT_COLLECTION_PERCENTILE,en.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,r,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(n,t,r){const i=n.store(ci),s=n.store(Wu),o=[],a=IDBKeyRange.only(r.batchId);let u=0;const l=i.ee({range:a},(h,f,d)=>(u++,d.delete()));o.push(l.next(()=>{it(u===1,47070,{batchId:r.batchId})}));const c=[];for(const h of r.mutations){const f=UT(t,h.key.path,r.batchId);o.push(s.delete(f)),c.push(h.key)}return _e.waitFor(o).next(()=>c)}function rp(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw et(14731);t=n.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */en.DEFAULT_COLLECTION_PERCENTILE=10,en.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,en.DEFAULT=new en(HI,en.DEFAULT_COLLECTION_PERCENTILE,en.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),en.DISABLED=new en(-1,0,0);class Eg{constructor(t,r,i,s){this.userId=t,this.serializer=r,this.indexManager=i,this.referenceDelegate=s,this.Xn={}}static wt(t,r,i,s){it(t.uid!=="",64387);const o=t.isAuthenticated()?t.uid:"";return new Eg(o,r,i,s)}checkEmpty(t){let r=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Us(t).ee({index:la,range:i},(s,o,a)=>{r=!1,a.done()}).next(()=>r)}addMutationBatch(t,r,i,s){const o=fu(t),a=Us(t);return a.add({}).next(u=>{it(typeof u=="number",49019);const l=new o1(u,r,i,s),c=function(p,g,y){const v=y.baseMutations.map(_=>Jd(p.yt,_)),T=y.mutations.map(_=>Jd(p.yt,_));return{userId:g,batchId:y.batchId,localWriteTimeMs:y.localWriteTime.toMillis(),baseMutations:v,mutations:T}}(this.serializer,this.userId,l),h=[];let f=new Yt((d,p)=>gt(d.canonicalString(),p.canonicalString()));for(const d of s){const p=UT(this.userId,d.key.path,u);f=f.add(d.key.path.popLast()),h.push(a.put(c)),h.push(o.put(p,lB))}return f.forEach(d=>{h.push(this.indexManager.addToCollectionParentIndex(t,d))}),t.addOnCommittedListener(()=>{this.Xn[u]=l.keys()}),_e.waitFor(h).next(()=>l)})}lookupMutationBatch(t,r){return Us(t).get(r).next(i=>i?(it(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:r}),ta(this.serializer,i)):null)}er(t,r){return this.Xn[r]?_e.resolve(this.Xn[r]):this.lookupMutationBatch(t,r).next(i=>{if(i){const s=i.keys();return this.Xn[r]=s,s}return null})}getNextMutationBatchAfterBatchId(t,r){const i=r+1,s=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return Us(t).ee({index:la,range:s},(a,u,l)=>{u.userId===this.userId&&(it(u.batchId>=i,47524,{tr:i}),o=ta(this.serializer,u)),l.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(t){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=pa;return Us(t).ee({index:la,range:r,reverse:!0},(s,o,a)=>{i=o.batchId,a.done()}).next(()=>i)}getAllMutationBatches(t){const r=IDBKeyRange.bound([this.userId,pa],[this.userId,Number.POSITIVE_INFINITY]);return Us(t).J(la,r).next(i=>i.map(s=>ta(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(t,r){const i=ad(this.userId,r.path),s=IDBKeyRange.lowerBound(i),o=[];return fu(t).ee({range:s},(a,u,l)=>{const[c,h,f]=a,d=Fi(h);if(c===this.userId&&r.path.isEqual(d))return Us(t).get(f).next(p=>{if(!p)throw et(61480,{nr:a,batchId:f});it(p.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:p.userId,batchId:f}),o.push(ta(this.serializer,p))});l.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(t,r){let i=new Yt(gt);const s=[];return r.forEach(o=>{const a=ad(this.userId,o.path),u=IDBKeyRange.lowerBound(a),l=fu(t).ee({range:u},(c,h,f)=>{const[d,p,g]=c,y=Fi(p);d===this.userId&&o.path.isEqual(y)?i=i.add(g):f.done()});s.push(l)}),_e.waitFor(s).next(()=>this.rr(t,i))}getAllMutationBatchesAffectingQuery(t,r){const i=r.path,s=i.length+1,o=ad(this.userId,i),a=IDBKeyRange.lowerBound(o);let u=new Yt(gt);return fu(t).ee({range:a},(l,c,h)=>{const[f,d,p]=l,g=Fi(d);f===this.userId&&i.isPrefixOf(g)?g.length===s&&(u=u.add(p)):h.done()}).next(()=>this.rr(t,u))}rr(t,r){const i=[],s=[];return r.forEach(o=>{s.push(Us(t).get(o).next(a=>{if(a===null)throw et(35274,{batchId:o});it(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:o}),i.push(ta(this.serializer,a))}))}),_e.waitFor(s).next(()=>i)}removeMutationBatch(t,r){return WI(t.le,this.userId,r).next(i=>(t.addOnCommittedListener(()=>{this.ir(r.batchId)}),_e.forEach(i,s=>this.referenceDelegate.markPotentiallyOrphaned(t,s))))}ir(t){delete this.Xn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(r=>{if(!r)return _e.resolve();const i=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),s=[];return fu(t).ee({range:i},(o,a,u)=>{if(o[0]===this.userId){const l=Fi(o[1]);s.push(l)}else u.done()}).next(()=>{it(s.length===0,56720,{sr:s.map(o=>o.canonicalString())})})})}containsKey(t,r){return KI(t,this.userId,r)}_r(t){return YI(t).get(this.userId).next(r=>r||{userId:this.userId,lastAcknowledgedBatchId:pa,lastStreamToken:""})}}function KI(n,t,r){const i=ad(t,r.path),s=i[1],o=IDBKeyRange.lowerBound(i);let a=!1;return fu(n).ee({range:o,X:!0},(u,l,c)=>{const[h,f,d]=u;h===t&&f===s&&(a=!0),c.done()}).next(()=>a)}function Us(n){return Gr(n,ci)}function fu(n){return Gr(n,Wu)}function YI(n){return Gr(n,Qc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Ca(0)}static cr(){return new Ca(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(t,r){this.referenceDelegate=t,this.serializer=r}allocateTargetId(t){return this.lr(t).next(r=>{const i=new Ca(r.highestTargetId);return r.highestTargetId=i.next(),this.hr(t,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.lr(t).next(r=>ot.fromTimestamp(new Wt(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.lr(t).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(t,r,i){return this.lr(t).next(s=>(s.highestListenSequenceNumber=r,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),r>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=r),this.hr(t,s)))}addTargetData(t,r){return this.Pr(t,r).next(()=>this.lr(t).next(i=>(i.targetCount+=1,this.Tr(r,i),this.hr(t,i))))}updateTargetData(t,r){return this.Pr(t,r)}removeTargetData(t,r){return this.removeMatchingKeysForTargetId(t,r.targetId).next(()=>ru(t).delete(r.targetId)).next(()=>this.lr(t)).next(i=>(it(i.targetCount>0,8065),i.targetCount-=1,this.hr(t,i)))}removeTargets(t,r,i){let s=0;const o=[];return ru(t).ee((a,u)=>{const l=lc(u);l.sequenceNumber<=r&&i.get(l.targetId)===null&&(s++,o.push(this.removeTargetData(t,l)))}).next(()=>_e.waitFor(o)).next(()=>s)}forEachTarget(t,r){return ru(t).ee((i,s)=>{const o=lc(s);r(o)})}lr(t){return Rw(t).get(Wd).next(r=>(it(r!==null,2888),r))}hr(t,r){return Rw(t).put(Wd,r)}Pr(t,r){return ru(t).put(jI(this.serializer,r))}Tr(t,r){let i=!1;return t.targetId>r.highestTargetId&&(r.highestTargetId=t.targetId,i=!0),t.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t.sequenceNumber,i=!0),i}getTargetCount(t){return this.lr(t).next(r=>r.targetCount)}getTargetData(t,r){const i=wa(r),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return ru(t).ee({range:s,index:jT},(a,u,l)=>{const c=lc(u);Qh(r,c.target)&&(o=c,l.done())}).next(()=>o)}addMatchingKeys(t,r,i){const s=[],o=Zs(t);return r.forEach(a=>{const u=an(a.path);s.push(o.put({targetId:i,path:u})),s.push(this.referenceDelegate.addReference(t,i,a))}),_e.waitFor(s)}removeMatchingKeys(t,r,i){const s=Zs(t);return _e.forEach(r,o=>{const a=an(o.path);return _e.waitFor([s.delete([i,a]),this.referenceDelegate.removeReference(t,i,o)])})}removeMatchingKeysForTargetId(t,r){const i=Zs(t),s=IDBKeyRange.bound([r],[r+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(t,r){const i=IDBKeyRange.bound([r],[r+1],!1,!0),s=Zs(t);let o=Et();return s.ee({range:i,X:!0},(a,u,l)=>{const c=Fi(a[1]),h=new Ke(c);o=o.add(h)}).next(()=>o)}containsKey(t,r){const i=an(r.path),s=IDBKeyRange.bound([i],[FT(i)],!1,!0);let o=0;return Zs(t).ee({index:Xv,X:!0,range:s},([a,u],l,c)=>{a!==0&&(o++,c.done())}).next(()=>o>0)}At(t,r){return ru(t).get(r).next(i=>i?lc(i):null)}}function ru(n){return Gr(n,Ku)}function Rw(n){return Gr(n,ga)}function Zs(n){return Gr(n,Yu)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="LruGarbageCollector",XI=1048576;function Pw([n,t],[r,i]){const s=gt(n,r);return s===0?gt(t,i):s}class O6{constructor(t){this.Ir=t,this.buffer=new Yt(Pw),this.Er=0}dr(){return++this.Er}Ar(t){const r=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const i=this.buffer.last();Pw(r,i)<0&&(this.buffer=this.buffer.delete(i).add(r))}}get maxValue(){return this.buffer.last()[0]}}class ZI{constructor(t,r,i){this.garbageCollector=t,this.asyncQueue=r,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){Oe(Fw,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Po(r)?Oe(Fw,"Ignoring IndexedDB error during garbage collection: ",r):await $a(r)}await this.Vr(3e5)})}}class V6{constructor(t,r){this.mr=t,this.params=r}calculateTargetCount(t,r){return this.mr.gr(t).next(i=>Math.floor(r/100*i))}nthSequenceNumber(t,r){if(r===0)return _e.resolve(Qn.ce);const i=new O6(r);return this.mr.forEachTarget(t,s=>i.Ar(s.sequenceNumber)).next(()=>this.mr.pr(t,s=>i.Ar(s))).next(()=>i.maxValue)}removeTargets(t,r,i){return this.mr.removeTargets(t,r,i)}removeOrphanedDocuments(t,r){return this.mr.removeOrphanedDocuments(t,r)}collect(t,r){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(Nw)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Nw):this.yr(t,r))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,r){let i,s,o,a,u,l,c;const h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,a=Date.now(),this.nthSequenceNumber(t,s))).next(f=>(i=f,u=Date.now(),this.removeTargets(t,i,r))).next(f=>(o=f,l=Date.now(),this.removeOrphanedDocuments(t,i))).next(f=>(c=Date.now(),uu()<=Tt.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${s} in `+(u-a)+`ms
	Removed ${o} targets in `+(l-u)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:f})))}}function QI(n,t){return new V6(n,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{constructor(t,r){this.db=t,this.garbageCollector=QI(this,r)}gr(t){const r=this.wr(t);return this.db.getTargetCache().getTargetCount(t).next(i=>r.next(s=>i+s))}wr(t){let r=0;return this.pr(t,i=>{r++}).next(()=>r)}forEachTarget(t,r){return this.db.getTargetCache().forEachTarget(t,r)}pr(t,r){return this.Sr(t,(i,s)=>r(s))}addReference(t,r,i){return Df(t,i)}removeReference(t,r,i){return Df(t,i)}removeTargets(t,r,i){return this.db.getTargetCache().removeTargets(t,r,i)}markPotentiallyOrphaned(t,r){return Df(t,r)}br(t,r){return function(s,o){let a=!1;return YI(s).te(u=>KI(s,u,o).next(l=>(l&&(a=!0),_e.resolve(!l)))).next(()=>a)}(t,r)}removeOrphanedDocuments(t,r){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.Sr(t,(a,u)=>{if(u<=r){const l=this.br(t,a).next(c=>{if(!c)return o++,i.getEntry(t,a).next(()=>(i.removeEntry(a,ot.min()),Zs(t).delete(function(f){return[0,an(f.path)]}(a))))});s.push(l)}}).next(()=>_e.waitFor(s)).next(()=>i.apply(t)).next(()=>o)}removeTarget(t,r){const i=r.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,i)}updateLimboDocument(t,r){return Df(t,r)}Sr(t,r){const i=Zs(t);let s,o=Qn.ce;return i.ee({index:Xv},([a,u],{path:l,sequenceNumber:c})=>{a===0?(o!==Qn.ce&&r(new Ke(Fi(s)),o),o=c,s=l):o=Qn.ce}).next(()=>{o!==Qn.ce&&r(new Ke(Fi(s)),o)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function Df(n,t){return Zs(n).put(function(i,s){return{targetId:0,path:an(i.path),sequenceNumber:s}}(t,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(){this.changes=new Is(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,_r.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const i=this.changes.get(r);return i!==void 0?_e.resolve(i):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,r,i){return Go(t).put(i)}removeEntry(t,r,i){return Go(t).delete(function(o,a){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],ep(a),u[u.length-1]]}(r,i))}updateMetadata(t,r){return this.getMetadata(t).next(i=>(i.byteSize+=r,this.Dr(t,i)))}getEntry(t,r){let i=_r.newInvalidDocument(r);return Go(t).ee({index:ud,range:IDBKeyRange.only(Zl(r))},(s,o)=>{i=this.Cr(r,o)}).next(()=>i)}vr(t,r){let i={size:0,document:_r.newInvalidDocument(r)};return Go(t).ee({index:ud,range:IDBKeyRange.only(Zl(r))},(s,o)=>{i={document:this.Cr(r,o),size:rp(o)}}).next(()=>i)}getEntries(t,r){let i=jn();return this.Fr(t,r,(s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a)}).next(()=>i)}Mr(t,r){let i=jn(),s=new dr(Ke.comparator);return this.Fr(t,r,(o,a)=>{const u=this.Cr(o,a);i=i.insert(o,u),s=s.insert(o,rp(a))}).next(()=>({documents:i,Or:s}))}Fr(t,r,i){if(r.isEmpty())return _e.resolve();let s=new Yt(Ow);r.forEach(l=>s=s.add(l));const o=IDBKeyRange.bound(Zl(s.first()),Zl(s.last())),a=s.getIterator();let u=a.getNext();return Go(t).ee({index:ud,range:o},(l,c,h)=>{const f=Ke.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;u&&Ow(u,f)<0;)i(u,null),u=a.getNext();u&&u.isEqual(f)&&(i(u,c),u=a.hasNext()?a.getNext():null),u?h.j(Zl(u)):h.done()}).next(()=>{for(;u;)i(u,null),u=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(t,r,i,s,o){const a=r.path,u=[a.popLast().toArray(),a.lastSegment(),ep(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],l=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Go(t).J(IDBKeyRange.bound(u,l,!0)).next(c=>{o==null||o.incrementDocumentReadCount(c.length);let h=jn();for(const f of c){const d=this.Cr(Ke.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);d.isFoundDocument()&&(ef(r,d)||s.has(d.key))&&(h=h.insert(d.key,d))}return h})}getAllFromCollectionGroup(t,r,i,s){let o=jn();const a=Lw(r,i),u=Lw(r,zn.max());return Go(t).ee({index:$T,range:IDBKeyRange.bound(a,u,!0)},(l,c,h)=>{const f=this.Cr(Ke.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);o=o.insert(f.key,f),o.size===s&&h.done()}).next(()=>o)}newChangeBuffer(t){return new $6(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(r=>r.byteSize)}getMetadata(t){return Mw(t).get(Q0).next(r=>(it(!!r,20021),r))}Dr(t,r){return Mw(t).put(Q0,r)}Cr(t,r){if(r){const i=A6(this.serializer,r);if(!(i.isNoDocument()&&i.version.isEqual(ot.min())))return i}return _r.newInvalidDocument(t)}}function eD(n){return new U6(n)}class $6 extends JI{constructor(t,r){super(),this.Nr=t,this.trackRemovals=r,this.Br=new Is(i=>i.toString(),(i,s)=>i.isEqual(s))}applyChanges(t){const r=[];let i=0,s=new Yt((o,a)=>gt(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const u=this.Br.get(o);if(r.push(this.Nr.removeEntry(t,o,u.readTime)),a.isValidDocument()){const l=vw(this.Nr.serializer,a);s=s.add(o.path.popLast());const c=rp(l);i+=c-u.size,r.push(this.Nr.addEntry(t,o,l))}else if(i-=u.size,this.trackRemovals){const l=vw(this.Nr.serializer,a.convertToNoDocument(ot.min()));r.push(this.Nr.addEntry(t,o,l))}}),s.forEach(o=>{r.push(this.Nr.indexManager.addToCollectionParentIndex(t,o))}),r.push(this.Nr.updateMetadata(t,i)),_e.waitFor(r)}getFromCache(t,r){return this.Nr.vr(t,r).next(i=>(this.Br.set(r,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(t,r){return this.Nr.Mr(t,r).next(({documents:i,Or:s})=>(s.forEach((o,a)=>{this.Br.set(o,{size:a,readTime:i.get(o).readTime})}),i))}}function Mw(n){return Gr(n,Jc)}function Go(n){return Gr(n,Hd)}function Zl(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Lw(n,t){const r=t.documentKey.path.toArray();return[n,ep(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function Ow(n,t){const r=n.path.toArray(),i=t.path.toArray();let s=0;for(let o=0;o<r.length-2&&o<i.length-2;++o)if(s=gt(r[o],i[o]),s)return s;return s=gt(r.length,i.length),s||(s=gt(r[r.length-2],i[i.length-2]),s||gt(r[r.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(t,r,i,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,r){let i=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(i=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(i!==null&&Nc(i.mutation,s,Nn.empty(),Wt.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.getLocalViewOfDocuments(t,i,Et()).next(()=>i))}getLocalViewOfDocuments(t,r,i=Et()){const s=Pi();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,i).next(o=>{let a=ac();return o.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const i=Pi();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,Et()))}populateOverlays(t,r,i){const s=[];return i.forEach(o=>{r.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(t,s).next(o=>{o.forEach((a,u)=>{r.set(a,u)})})}computeViews(t,r,i,s){let o=jn();const a=kc(),u=function(){return kc()}();return r.forEach((l,c)=>{const h=i.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof Ds)?o=o.insert(c.key,c):h!==void 0?(a.set(c.key,h.mutation.getFieldMask()),Nc(h.mutation,c,h.mutation.getFieldMask(),Wt.now())):a.set(c.key,Nn.empty())}),this.recalculateAndSaveOverlays(t,o).next(l=>(l.forEach((c,h)=>a.set(c,h)),r.forEach((c,h)=>u.set(c,new j6(h,a.get(c)??null))),u))}recalculateAndSaveOverlays(t,r){const i=kc();let s=new dr((a,u)=>a-u),o=Et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const u of a)u.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let h=i.get(l)||Nn.empty();h=u.applyToLocalView(c,h),i.set(l,h);const f=(s.get(u.batchId)||Et()).add(l);s=s.insert(u.batchId,f)})}).next(()=>{const a=[],u=s.getReverseIterator();for(;u.hasNext();){const l=u.getNext(),c=l.key,h=l.value,f=vI();h.forEach(d=>{if(!o.has(d)){const p=SI(r.get(d),i.get(d));p!==null&&f.set(d,p),o=o.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,f))}return _e.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,r,i,s){return function(a){return Ke.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):dI(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,i,s):this.getDocumentsMatchingCollectionQuery(t,r,i,s)}getNextDocuments(t,r,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,i,s).next(o=>{const a=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,i.largestBatchId,s-o.size):_e.resolve(Pi());let u=Yc,l=o;return a.next(c=>_e.forEach(c,(h,f)=>(u<f.largestBatchId&&(u=f.largestBatchId),o.get(h)?_e.resolve():this.remoteDocumentCache.getEntry(t,h).next(d=>{l=l.insert(h,d)}))).next(()=>this.populateOverlays(t,c,o)).next(()=>this.computeViews(t,l,c,Et())).next(h=>({batchId:u,changes:yI(h)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Ke(r)).next(i=>{let s=ac();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,i,s){const o=r.collectionGroup;let a=ac();return this.indexManager.getCollectionParents(t,o).next(u=>_e.forEach(u,l=>{const c=function(f,d){return new Jh(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(o));return this.getDocumentsMatchingCollectionQuery(t,c,i,s).next(h=>{h.forEach((f,d)=>{a=a.insert(f,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,i.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,i,o,s))).next(a=>{o.forEach((l,c)=>{const h=c.getKey();a.get(h)===null&&(a=a.insert(h,_r.newInvalidDocument(h)))});let u=ac();return a.forEach((l,c)=>{const h=o.get(l);h!==void 0&&Nc(h.mutation,c,Nn.empty(),Wt.now()),ef(r,c)&&(u=u.insert(l,c))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,r){return _e.resolve(this.Lr.get(r))}saveBundleMetadata(t,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:xn(s.createTime)}}(r)),_e.resolve()}getNamedQuery(t,r){return _e.resolve(this.kr.get(r))}saveNamedQuery(t,r){return this.kr.set(r.name,function(s){return{name:s.name,query:GI(s.bundledQuery),readTime:xn(s.readTime)}}(r)),_e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z6{constructor(){this.overlays=new dr(Ke.comparator),this.qr=new Map}getOverlay(t,r){return _e.resolve(this.overlays.get(r))}getOverlays(t,r){const i=Pi();return _e.forEach(r,s=>this.getOverlay(t,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(t,r,i){return i.forEach((s,o)=>{this.St(t,r,o)}),_e.resolve()}removeOverlaysForBatchId(t,r,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(i)),_e.resolve()}getOverlaysForCollection(t,r,i){const s=Pi(),o=r.length+1,a=new Ke(r.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const l=u.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>i&&s.set(l.getKey(),l)}return _e.resolve(s)}getOverlaysForCollectionGroup(t,r,i,s){let o=new dr((c,h)=>c-h);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>i){let h=o.get(c.largestBatchId);h===null&&(h=Pi(),o=o.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const u=Pi(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>u.set(c,h)),!(u.size()>=s)););return _e.resolve(u)}St(t,r,i){const s=this.overlays.get(i.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new u1(r,i));let o=this.qr.get(r);o===void 0&&(o=Et(),this.qr.set(r,o)),this.qr.set(r,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(){this.sessionToken=Nr.EMPTY_BYTE_STRING}getSessionToken(t){return _e.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,_e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(){this.Qr=new Yt(qr.$r),this.Ur=new Yt(qr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,r){const i=new qr(t,r);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(t,r){t.forEach(i=>this.addReference(i,r))}removeReference(t,r){this.Gr(new qr(t,r))}zr(t,r){t.forEach(i=>this.removeReference(i,r))}jr(t){const r=new Ke(new $t([])),i=new qr(r,t),s=new qr(r,t+1),o=[];return this.Ur.forEachInRange([i,s],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const r=new Ke(new $t([])),i=new qr(r,t),s=new qr(r,t+1);let o=Et();return this.Ur.forEachInRange([i,s],a=>{o=o.add(a.key)}),o}containsKey(t){const r=new qr(t,0),i=this.Qr.firstAfterOrEqual(r);return i!==null&&t.isEqual(i.key)}}class qr{constructor(t,r){this.key=t,this.Yr=r}static $r(t,r){return Ke.comparator(t.key,r.key)||gt(t.Yr,r.Yr)}static Kr(t,r){return gt(t.Yr,r.Yr)||Ke.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Yt(qr.$r)}checkEmpty(t){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,i,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new o1(o,r,i,s);this.mutationQueue.push(a);for(const u of s)this.Zr=this.Zr.add(new qr(u.key,o)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return _e.resolve(a)}lookupMutationBatch(t,r){return _e.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(t,r){const i=r+1,s=this.ei(i),o=s<0?0:s;return _e.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?pa:this.tr-1)}getAllMutationBatches(t){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const i=new qr(r,0),s=new qr(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([i,s],a=>{const u=this.Xr(a.Yr);o.push(u)}),_e.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,r){let i=new Yt(gt);return r.forEach(s=>{const o=new qr(s,0),a=new qr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],u=>{i=i.add(u.Yr)})}),_e.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(t,r){const i=r.path,s=i.length+1;let o=i;Ke.isDocumentKey(o)||(o=o.child(""));const a=new qr(new Ke(o),0);let u=new Yt(gt);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(u=u.add(l.Yr)),!0)},a),_e.resolve(this.ti(u))}ti(t){const r=[];return t.forEach(i=>{const s=this.Xr(i);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){it(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return _e.forEach(r.mutations,s=>{const o=new qr(s.key,r.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Zr=i})}ir(t){}containsKey(t,r){const i=new qr(r,0),s=this.Zr.firstAfterOrEqual(i);return _e.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,_e.resolve()}ni(t,r){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const r=this.ei(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W6{constructor(t){this.ri=t,this.docs=function(){return new dr(Ke.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const i=r.key,s=this.docs.get(i),o=s?s.size:0,a=this.ri(r);return this.docs=this.docs.insert(i,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const i=this.docs.get(r);return _e.resolve(i?i.document.mutableCopy():_r.newInvalidDocument(r))}getEntries(t,r){let i=jn();return r.forEach(s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():_r.newInvalidDocument(s))}),_e.resolve(i)}getDocumentsMatchingQuery(t,r,i,s){let o=jn();const a=r.path,u=new Ke(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Kv(LT(h),i)<=0||(s.has(h.key)||ef(r,h))&&(o=o.insert(h.key,h.mutableCopy()))}return _e.resolve(o)}getAllFromCollectionGroup(t,r,i,s){et(9500)}ii(t,r){return _e.forEach(this.docs,i=>r(i))}newChangeBuffer(t){return new K6(this)}getSize(t){return _e.resolve(this.size)}}class K6 extends JI{constructor(t){super(),this.Nr=t}applyChanges(t){const r=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(i)}),_e.waitFor(r)}getFromCache(t,r){return this.Nr.getEntry(t,r)}getAllFromCache(t,r){return this.Nr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(t){this.persistence=t,this.si=new Is(r=>wa(r),Qh),this.lastRemoteSnapshotVersion=ot.min(),this.highestTargetId=0,this.oi=0,this._i=new d1,this.targetCount=0,this.ai=Ca.ur()}forEachTarget(t,r){return this.si.forEach((i,s)=>r(s)),_e.resolve()}getLastRemoteSnapshotVersion(t){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return _e.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(t,r,i){return i&&(this.lastRemoteSnapshotVersion=i),r>this.oi&&(this.oi=r),_e.resolve()}Pr(t){this.si.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.ai=new Ca(r),this.highestTargetId=r),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,r){return this.Pr(r),this.targetCount+=1,_e.resolve()}updateTargetData(t,r){return this.Pr(r),_e.resolve()}removeTargetData(t,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,_e.resolve()}removeTargets(t,r,i){let s=0;const o=[];return this.si.forEach((a,u)=>{u.sequenceNumber<=r&&i.get(u.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(t,u.targetId)),s++)}),_e.waitFor(o).next(()=>s)}getTargetCount(t){return _e.resolve(this.targetCount)}getTargetData(t,r){const i=this.si.get(r)||null;return _e.resolve(i)}addMatchingKeys(t,r,i){return this._i.Wr(r,i),_e.resolve()}removeMatchingKeys(t,r,i){this._i.zr(r,i);const s=this.persistence.referenceDelegate,o=[];return s&&r.forEach(a=>{o.push(s.markPotentiallyOrphaned(t,a))}),_e.waitFor(o)}removeMatchingKeysForTargetId(t,r){return this._i.jr(r),_e.resolve()}getMatchingKeysForTargetId(t,r){const i=this._i.Hr(r);return _e.resolve(i)}containsKey(t,r){return _e.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(t,r){this.ui={},this.overlays={},this.ci=new Qn(0),this.li=!1,this.li=!0,this.hi=new q6,this.referenceDelegate=t(this),this.Pi=new Y6(this),this.indexManager=new P6,this.remoteDocumentCache=function(s){return new W6(s)}(i=>this.referenceDelegate.Ti(i)),this.serializer=new $I(r),this.Ii=new G6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new z6,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let i=this.ui[t.toKey()];return i||(i=new H6(r,this.referenceDelegate),this.ui[t.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,r,i){Oe("MemoryPersistence","Starting transaction:",t);const s=new X6(this.ci.next());return this.referenceDelegate.Ei(),i(s).next(o=>this.referenceDelegate.di(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ai(t,r){return _e.or(Object.values(this.ui).map(i=>()=>i.containsKey(t,r)))}}class X6 extends VT{constructor(t){super(),this.currentSequenceNumber=t}}class Sg{constructor(t){this.persistence=t,this.Ri=new d1,this.Vi=null}static mi(t){return new Sg(t)}get fi(){if(this.Vi)return this.Vi;throw et(60996)}addReference(t,r,i){return this.Ri.addReference(i,r),this.fi.delete(i.toString()),_e.resolve()}removeReference(t,r,i){return this.Ri.removeReference(i,r),this.fi.add(i.toString()),_e.resolve()}markPotentiallyOrphaned(t,r){return this.fi.add(r.toString()),_e.resolve()}removeTarget(t,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(o=>this.fi.add(o.toString()))}).next(()=>i.removeTargetData(t,r))}Ei(){this.Vi=new Set}di(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.fi,i=>{const s=Ke.fromPath(i);return this.gi(t,s).next(o=>{o||r.removeEntry(s,ot.min())})}).next(()=>(this.Vi=null,r.apply(t)))}updateLimboDocument(t,r){return this.gi(t,r).next(i=>{i?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(t){return 0}gi(t,r){return _e.or([()=>_e.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Ai(t,r)])}}class np{constructor(t,r){this.persistence=t,this.pi=new Is(i=>an(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=QI(this,r)}static mi(t,r){return new np(t,r)}Ei(){}di(t){return _e.resolve()}forEachTarget(t,r){return this.persistence.getTargetCache().forEachTarget(t,r)}gr(t){const r=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>r.next(s=>i+s))}wr(t){let r=0;return this.pr(t,i=>{r++}).next(()=>r)}pr(t,r){return _e.forEach(this.pi,(i,s)=>this.br(t,i,s).next(o=>o?_e.resolve():r(s)))}removeTargets(t,r,i){return this.persistence.getTargetCache().removeTargets(t,r,i)}removeOrphanedDocuments(t,r){let i=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(t,a=>this.br(t,a,r).next(u=>{u||(i++,o.removeEntry(a,ot.min()))})).next(()=>o.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,r){return this.pi.set(r,t.currentSequenceNumber),_e.resolve()}removeTarget(t,r){const i=r.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,r,i){return this.pi.set(i,t.currentSequenceNumber),_e.resolve()}removeReference(t,r,i){return this.pi.set(i,t.currentSequenceNumber),_e.resolve()}updateLimboDocument(t,r){return this.pi.set(r,t.currentSequenceNumber),_e.resolve()}Ti(t){let r=t.key.toString().length;return t.isFoundDocument()&&(r+=cd(t.data.value)),r}br(t,r,i){return _e.or([()=>this.persistence.Ai(t,r),()=>this.persistence.getTargetCache().containsKey(t,r),()=>{const s=this.pi.get(r);return _e.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(t){this.serializer=t}k(t,r,i,s){const o=new cg("createOrUpgrade",r);i<1&&s>=1&&(function(l){l.createObjectStore(Zh)}(t),function(l){l.createObjectStore(Qc,{keyPath:uB}),l.createObjectStore(ci,{keyPath:Kx,autoIncrement:!0}).createIndex(la,Yx,{unique:!0}),l.createObjectStore(Wu)}(t),Vw(t),function(l){l.createObjectStore(Ko)}(t));let a=_e.resolve();return i<3&&s>=3&&(i!==0&&(function(l){l.deleteObjectStore(Yu),l.deleteObjectStore(Ku),l.deleteObjectStore(ga)}(t),Vw(t)),a=a.next(()=>function(l){const c=l.store(ga),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ot.min().toTimestamp(),targetCount:0};return c.put(Wd,h)}(o))),i<4&&s>=4&&(i!==0&&(a=a.next(()=>function(l,c){return c.store(ci).J().next(f=>{l.deleteObjectStore(ci),l.createObjectStore(ci,{keyPath:Kx,autoIncrement:!0}).createIndex(la,Yx,{unique:!0});const d=c.store(ci),p=f.map(g=>d.put(g));return _e.waitFor(p)})}(t,o))),a=a.next(()=>{(function(l){l.createObjectStore(Xu,{keyPath:yB})})(t)})),i<5&&s>=5&&(a=a.next(()=>this.yi(o))),i<6&&s>=6&&(a=a.next(()=>(function(l){l.createObjectStore(Jc)}(t),this.wi(o)))),i<7&&s>=7&&(a=a.next(()=>this.Si(o))),i<8&&s>=8&&(a=a.next(()=>this.bi(t,o))),i<9&&s>=9&&(a=a.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(t)})),i<10&&s>=10&&(a=a.next(()=>this.Di(o))),i<11&&s>=11&&(a=a.next(()=>{(function(l){l.createObjectStore(fg,{keyPath:vB})})(t),function(l){l.createObjectStore(dg,{keyPath:_B})}(t)})),i<12&&s>=12&&(a=a.next(()=>{(function(l){const c=l.createObjectStore(pg,{keyPath:AB});c.createIndex(ey,TB,{unique:!1}),c.createIndex(qT,IB,{unique:!1})})(t)})),i<13&&s>=13&&(a=a.next(()=>function(l){const c=l.createObjectStore(Hd,{keyPath:cB});c.createIndex(ud,hB),c.createIndex($T,fB)}(t)).next(()=>this.Ci(t,o)).next(()=>t.deleteObjectStore(Ko))),i<14&&s>=14&&(a=a.next(()=>this.Fi(t,o))),i<15&&s>=15&&(a=a.next(()=>function(l){l.createObjectStore(Zv,{keyPath:bB,autoIncrement:!0}).createIndex(J0,xB,{unique:!1}),l.createObjectStore(Ac,{keyPath:wB}).createIndex(GT,EB,{unique:!1}),l.createObjectStore(Tc,{keyPath:SB}).createIndex(zT,CB,{unique:!1})}(t))),i<16&&s>=16&&(a=a.next(()=>{r.objectStore(Ac).clear()}).next(()=>{r.objectStore(Tc).clear()})),i<17&&s>=17&&(a=a.next(()=>{(function(l){l.createObjectStore(Qv,{keyPath:DB})})(t)})),i<18&&s>=18&&_A()&&(a=a.next(()=>{r.objectStore(Ac).clear()}).next(()=>{r.objectStore(Tc).clear()})),a}wi(t){let r=0;return t.store(Ko).ee((i,s)=>{r+=rp(s)}).next(()=>{const i={byteSize:r};return t.store(Jc).put(Q0,i)})}yi(t){const r=t.store(Qc),i=t.store(ci);return r.J().next(s=>_e.forEach(s,o=>{const a=IDBKeyRange.bound([o.userId,pa],[o.userId,o.lastAcknowledgedBatchId]);return i.J(la,a).next(u=>_e.forEach(u,l=>{it(l.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=ta(this.serializer,l);return WI(t,o.userId,c).next(()=>{})}))}))}Si(t){const r=t.store(Yu),i=t.store(Ko);return t.store(ga).get(Wd).next(s=>{const o=[];return i.ee((a,u)=>{const l=new $t(a),c=function(f){return[0,an(f)]}(l);o.push(r.get(c).next(h=>h?_e.resolve():(f=>r.put({targetId:0,path:an(f),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>_e.waitFor(o))})}bi(t,r){t.createObjectStore(eh,{keyPath:mB});const i=r.store(eh),s=new f1,o=a=>{if(s.add(a)){const u=a.lastSegment(),l=a.popLast();return i.put({collectionId:u,parent:an(l)})}};return r.store(Ko).ee({X:!0},(a,u)=>{const l=new $t(a);return o(l.popLast())}).next(()=>r.store(Wu).ee({X:!0},([a,u,l],c)=>{const h=Fi(u);return o(h.popLast())}))}Di(t){const r=t.store(Ku);return r.ee((i,s)=>{const o=lc(s),a=jI(this.serializer,o);return r.put(a)})}Ci(t,r){const i=r.store(Ko),s=[];return i.ee((o,a)=>{const u=r.store(Hd),l=function(f){return f.document?new Ke($t.fromString(f.document.name).popFirst(5)):f.noDocument?Ke.fromSegments(f.noDocument.path):f.unknownDocument?Ke.fromSegments(f.unknownDocument.path):et(36783)}(a).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};s.push(u.put(c))}).next(()=>_e.waitFor(s))}Fi(t,r){const i=r.store(ci),s=eD(this.serializer),o=new p1(Sg.mi,this.serializer.yt);return i.J().next(a=>{const u=new Map;return a.forEach(l=>{let c=u.get(l.userId)??Et();ta(this.serializer,l).keys().forEach(h=>c=c.add(h)),u.set(l.userId,c)}),_e.forEach(u,(l,c)=>{const h=new dn(c),f=wg.wt(this.serializer,h),d=o.getIndexManager(h),p=Eg.wt(h,this.serializer,d,o.referenceDelegate);return new tD(s,p,f,d).recalculateAndSaveOverlaysForDocumentKeys(new ty(r,Qn.ce),l).next()})})}}function Vw(n){n.createObjectStore(Yu,{keyPath:pB}).createIndex(Xv,gB,{unique:!0}),n.createObjectStore(Ku,{keyPath:"targetId"}).createIndex(jT,dB,{unique:!0}),n.createObjectStore(ga)}const $s="IndexedDbPersistence",Om=18e5,Vm=5e3,Bm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Q6="main";class g1{constructor(t,r,i,s,o,a,u,l,c,h,f=18){if(this.allowTabSynchronization=t,this.persistenceKey=r,this.clientId=i,this.Mi=o,this.window=a,this.document=u,this.xi=c,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=d=>Promise.resolve(),!g1.v())throw new qe(ke.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new B6(this,s),this.$i=r+Q6,this.serializer=new $I(l),this.Ui=new go(this.$i,this.Ni,new Z6(this.serializer)),this.hi=new I6,this.Pi=new L6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eD(this.serializer),this.Ii=new T6,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&yn($s,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new qe(ke.FAILED_PRECONDITION,Bm);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Pi.getHighestSequenceNumber(t))}).then(t=>{this.ci=new Qn(t,this.xi)}).then(()=>{this.li=!0}).catch(t=>(this.Ui&&this.Ui.close(),Promise.reject(t)))}Ji(t){return this.Qi=async r=>{if(this.started)return t(r)},t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ui.$(async r=>{r.newVersion===null&&await t()})}setNetworkEnabled(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>kf(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(t).next(r=>{r||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(t)).next(r=>this.isPrimary&&!r?this.Zi(t).next(()=>!1):!!r&&this.Xi(t).next(()=>!0))).catch(t=>{if(Po(t))return Oe($s,"Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return Oe($s,"Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.Mi.enqueueRetryable(()=>this.Qi(t)),this.isPrimary=t})}Hi(t){return Ql(t).get(Za).next(r=>_e.resolve(this.es(r)))}ts(t){return kf(t).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Om)){this.qi=Date.now();const t=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Gr(r,Xu);return i.J().next(s=>{const o=this.ss(s,Om),a=s.filter(u=>o.indexOf(u)===-1);return _e.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ki)for(const r of t)this.Ki.removeItem(this._s(r.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(t){return!!t&&t.ownerId===this.clientId}Yi(t){return this.Oi?_e.resolve(!0):Ql(t).get(Za).next(r=>{if(r!==null&&this.rs(r.leaseTimestampMs,Vm)&&!this.us(r.ownerId)){if(this.es(r)&&this.networkEnabled)return!0;if(!this.es(r)){if(!r.allowTabSynchronization)throw new qe(ke.FAILED_PRECONDITION,Bm);return!1}}return!(!this.networkEnabled||!this.inForeground)||kf(t).J().next(i=>this.ss(i,Vm).find(s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,a=!this.inForeground&&s.inForeground,u=this.networkEnabled===s.networkEnabled;if(o||a&&u)return!0}return!1})===void 0)}).next(r=>(this.isPrimary!==r&&Oe($s,`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Zh,Xu],t=>{const r=new ty(t,Qn.ce);return this.Zi(r).next(()=>this.ts(r))}),this.Ui.close(),this.Ps()}ss(t,r){return t.filter(i=>this.rs(i.updateTimeMs,r)&&!this.us(i.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",t=>kf(t).J().next(r=>this.ss(r,Om).map(i=>i.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(t,r){return Eg.wt(t,this.serializer,r,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new M6(t,this.serializer.yt.databaseId)}getDocumentOverlayCache(t){return wg.wt(this.serializer,t)}getBundleCache(){return this.Ii}runTransaction(t,r,i){Oe($s,"Starting transaction:",t);const s=r==="readonly"?"readonly":"readwrite",o=function(l){return l===18?RB:l===17?YT:l===16?NB:l===15?Jv:l===14?KT:l===13?WT:l===12?kB:l===11?HT:void et(60245)}(this.Ni);let a;return this.Ui.runTransaction(t,s,o,u=>(a=new ty(u,this.ci?this.ci.next():Qn.ce),r==="readwrite-primary"?this.Hi(a).next(l=>!!l||this.Yi(a)).next(l=>{if(!l)throw yn(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new qe(ke.FAILED_PRECONDITION,OT);return i(a)}).next(l=>this.Xi(a).next(()=>l)):this.Is(a).next(()=>i(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Is(t){return Ql(t).get(Za).next(r=>{if(r!==null&&this.rs(r.leaseTimestampMs,Vm)&&!this.us(r.ownerId)&&!this.es(r)&&!(this.Oi||this.allowTabSynchronization&&r.allowTabSynchronization))throw new qe(ke.FAILED_PRECONDITION,Bm)})}Xi(t){const r={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ql(t).put(Za,r)}static v(){return go.v()}Zi(t){const r=Ql(t);return r.get(Za).next(i=>this.es(i)?(Oe($s,"Releasing primary lease."),r.delete(Za)):_e.resolve())}rs(t,r){const i=Date.now();return!(t<i-r)&&(!(t>i)||(yn(`Detected an update time that is in the future: ${t} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var t;typeof((t=this.window)==null?void 0:t.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const r=/(?:Version|Mobile)\/1[456]/;vA()&&(navigator.appVersion.match(r)||navigator.userAgent.match(r))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(t){var r;try{const i=((r=this.Ki)==null?void 0:r.getItem(this._s(t)))!==null;return Oe($s,`Client '${t}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return yn($s,"Failed to get zombied client id.",i),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(t){yn("Failed to set zombie client id.",t)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function Ql(n){return Gr(n,Zh)}function kf(n){return Gr(n,Xu)}function J6(n,t){let r=n.projectId;return n.isDefaultDatabase||(r+="."+n.database),"firestore/"+t+"/"+r+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(t,r,i,s){this.targetId=t,this.fromCache=r,this.Es=i,this.ds=s}static As(t,r){let i=Et(),s=Et();for(const o of r.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new m1(t,r.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return vA()?8:BT(Ur())>0?6:4}()}initialize(t,r){this.ps=t,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(t,r,i,s){const o={result:null};return this.ys(t,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(t,r,s,i).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new e8;return this.Ss(t,r,a).next(u=>{if(o.result=u,this.Vs)return this.bs(t,r,a,u.size)})}).next(()=>o.result)}bs(t,r,i,s){return i.documentReadCount<this.fs?(uu()<=Tt.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",lu(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),_e.resolve()):(uu()<=Tt.DEBUG&&Oe("QueryEngine","Query:",lu(r),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(uu()<=Tt.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",lu(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ri(r))):_e.resolve())}ys(t,r){if(uw(r))return _e.resolve(null);let i=ri(r);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=uy(r,null,"F"),i=ri(r)),this.indexManager.getDocumentsMatchingTarget(t,i).next(o=>{const a=Et(...o);return this.ps.getDocuments(t,a).next(u=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.Ds(r,u);return this.Cs(r,c,a,l.readTime)?this.ys(t,uy(r,null,"F")):this.vs(t,c,r,l)}))})))}ws(t,r,i,s){return uw(r)||s.isEqual(ot.min())?_e.resolve(null):this.ps.getDocuments(t,i).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,i,s)?_e.resolve(null):(uu()<=Tt.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),lu(r)),this.vs(t,a,r,tB(s,Yc)).next(u=>u))})}Ds(t,r){let i=new Yt(gI(t));return r.forEach((s,o)=>{ef(t,o)&&(i=i.add(o))}),i}Cs(t,r,i,s){if(t.limit===null)return!1;if(i.size!==r.size)return!0;const o=t.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(t,r,i){return uu()<=Tt.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",lu(r)),this.ps.getDocumentsMatchingQuery(t,r,zn.min(),i)}vs(t,r,i,s){return this.ps.getDocumentsMatchingQuery(t,i,s).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="LocalStore",t8=3e8;class r8{constructor(t,r,i,s){this.persistence=t,this.Fs=r,this.serializer=s,this.Ms=new dr(gt),this.xs=new Is(o=>wa(o),Qh),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(i)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new tD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.Ms))}}function nD(n,t,r,i){return new r8(n,t,r,i)}async function iD(n,t){const r=vt(n);return await r.persistence.runTransaction("Handle user change","readonly",i=>{let s;return r.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,r.Bs(t),r.mutationQueue.getAllMutationBatches(i))).next(o=>{const a=[],u=[];let l=Et();for(const c of s){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of o){u.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return r.localDocuments.getDocuments(i,l).next(c=>({Ls:c,removedBatchIds:a,addedBatchIds:u}))})})}function n8(n,t){const r=vt(n);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=t.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(u,l,c,h){const f=c.batch,d=f.keys();let p=_e.resolve();return d.forEach(g=>{p=p.next(()=>h.getEntry(l,g)).next(y=>{const v=c.docVersions.get(g);it(v!==null,48541),y.version.compareTo(v)<0&&(f.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),h.addEntry(y)))})}),p.next(()=>u.mutationQueue.removeMutationBatch(l,f))}(r,i,t,o).next(()=>o.apply(i)).next(()=>r.mutationQueue.performConsistencyCheck(i)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(u){let l=Et();for(let c=0;c<u.mutationResults.length;++c)u.mutationResults[c].transformResults.length>0&&(l=l.add(u.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(i,s))})}function sD(n){const t=vt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Pi.getLastRemoteSnapshotVersion(r))}function i8(n,t){const r=vt(n),i=t.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const u=[];t.targetChanges.forEach((h,f)=>{const d=s.get(f);if(!d)return;u.push(r.Pi.removeMatchingKeys(o,h.removedDocuments,f).next(()=>r.Pi.addMatchingKeys(o,h.addedDocuments,f)));let p=d.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(f)!==null?p=p.withResumeToken(Nr.EMPTY_BYTE_STRING,ot.min()).withLastLimboFreeSnapshotVersion(ot.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,i)),s=s.insert(f,p),function(y,v,T){return y.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=t8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,p,h)&&u.push(r.Pi.updateTargetData(o,p))});let l=jn(),c=Et();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,h))}),u.push(s8(o,a,t.documentUpdates).next(h=>{l=h.ks,c=h.qs})),!i.isEqual(ot.min())){const h=r.Pi.getLastRemoteSnapshotVersion(o).next(f=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,i));u.push(h)}return _e.waitFor(u).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(r.Ms=s,o))}function s8(n,t,r){let i=Et(),s=Et();return r.forEach(o=>i=i.add(o)),t.getEntries(n,i).next(o=>{let a=jn();return r.forEach((u,l)=>{const c=o.get(u);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(u)),l.isNoDocument()&&l.version.isEqual(ot.min())?(t.removeEntry(u,l.readTime),a=a.insert(u,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(u,l)):Oe(y1,"Ignoring outdated watch update for ",u,". Current version:",c.version," Watch version:",l.version)}),{ks:a,qs:s}})}function o8(n,t){const r=vt(n);return r.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=pa),r.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function a8(n,t){const r=vt(n);return r.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return r.Pi.getTargetData(i,t).next(o=>o?(s=o,_e.resolve(s)):r.Pi.allocateTargetId(i).next(a=>(s=new fs(t,a,"TargetPurposeListen",i.currentSequenceNumber),r.Pi.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=r.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(i.targetId,i),r.xs.set(t,i.targetId)),i})}async function my(n,t,r){const i=vt(n),s=i.Ms.get(t),o=r?"readwrite":"readwrite-primary";try{r||await i.persistence.runTransaction("Release target",o,a=>i.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Po(a))throw a;Oe(y1,`Failed to update sequence numbers for target ${t}: ${a}`)}i.Ms=i.Ms.remove(t),i.xs.delete(s.target)}function Bw(n,t,r){const i=vt(n);let s=ot.min(),o=Et();return i.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,h){const f=vt(l),d=f.xs.get(h);return d!==void 0?_e.resolve(f.Ms.get(d)):f.Pi.getTargetData(c,h)}(i,a,ri(t)).next(u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(a,u.targetId).next(l=>{o=l})}).next(()=>i.Fs.getDocumentsMatchingQuery(a,t,r?s:ot.min(),r?o:Et())).next(u=>(u8(i,WB(t),u),{documents:u,Qs:o})))}function u8(n,t,r){let i=n.Os.get(t)||ot.min();r.forEach((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Os.set(t,i)}class Uw{constructor(){this.activeTargetIds=JB()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class oD{constructor(){this.Mo=new Uw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,i){}addLocalQueryTarget(t,r=!0){return r&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,r,i){this.xo[t]=r}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Uw,Promise.resolve()}handleUserChange(t,r,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="ConnectivityMonitor";class jw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Oe($w,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){Oe($w,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nf=null;function yy(){return Nf===null?Nf=function(){return 268435456+Math.round(2147483648*Math.random())}():Nf++,"0x"+Nf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="RestConnection",c8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class h8{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+t.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===Kd?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(t,r,i,s,o){const a=yy(),u=this.zo(t,r.toUriEncodedString());Oe(Um,`Sending RPC '${t}' ${a}:`,u,i);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,o);const{host:c}=new URL(u),h=xl(c);return this.Jo(t,u,l,i,h).then(f=>(Oe(Um,`Received RPC '${t}' ${a}: `,f),f),f=>{throw Kc(Um,`RPC '${t}' ${a} failed with error: `,f,"url: ",u,"request:",i),f})}Ho(t,r,i,s,o,a){return this.Go(t,r,i,s,o)}jo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}zo(t,r){const i=c8[t];return`${this.Uo}/v1/${r}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr="WebChannelConnection";class d8 extends h8{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,r,i,s,o){const a=yy();return new Promise((u,l)=>{const c=new TT;c.setWithCredentials(!0),c.listenOnce(IT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case sd.NO_ERROR:const f=c.getResponseJson();Oe(Qr,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(f)),u(f);break;case sd.TIMEOUT:Oe(Qr,`RPC '${t}' ${a} timed out`),l(new qe(ke.DEADLINE_EXCEEDED,"Request time out"));break;case sd.HTTP_ERROR:const d=c.getStatus();if(Oe(Qr,`RPC '${t}' ${a} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(T){const _=T.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(_)>=0?_:ke.UNKNOWN}(g.status);l(new qe(y,g.message))}else l(new qe(ke.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new qe(ke.UNAVAILABLE,"Connection failed."));break;default:et(9055,{l_:t,streamId:a,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Oe(Qr,`RPC '${t}' ${a} completed.`)}});const h=JSON.stringify(s);Oe(Qr,`RPC '${t}' ${a} sending request:`,s),c.send(r,"POST",h,i,15)})}T_(t,r,i){const s=yy(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=NT(),u=kT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,i),l.encodeInitMessageHeaders=!0;const h=o.join("");Oe(Qr,`Creating RPC '${t}' stream ${s}: ${h}`,l);const f=a.createWebChannel(h,l);this.I_(f);let d=!1,p=!1;const g=new f8({Yo:v=>{p?Oe(Qr,`Not sending because RPC '${t}' stream ${s} is closed:`,v):(d||(Oe(Qr,`Opening RPC '${t}' stream ${s} transport.`),f.open(),d=!0),Oe(Qr,`RPC '${t}' stream ${s} sending:`,v),f.send(v))},Zo:()=>f.close()}),y=(v,T,_)=>{v.listen(T,C=>{try{_(C)}catch(E){setTimeout(()=>{throw E},0)}})};return y(f,oc.EventType.OPEN,()=>{p||(Oe(Qr,`RPC '${t}' stream ${s} transport opened.`),g.o_())}),y(f,oc.EventType.CLOSE,()=>{p||(p=!0,Oe(Qr,`RPC '${t}' stream ${s} transport closed`),g.a_(),this.E_(f))}),y(f,oc.EventType.ERROR,v=>{p||(p=!0,Kc(Qr,`RPC '${t}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),g.a_(new qe(ke.UNAVAILABLE,"The operation could not be completed")))}),y(f,oc.EventType.MESSAGE,v=>{var T;if(!p){const _=v.data[0];it(!!_,16349);const C=_,E=(C==null?void 0:C.error)||((T=C[0])==null?void 0:T.error);if(E){Oe(Qr,`RPC '${t}' stream ${s} received error:`,E);const S=E.status;let R=function(b){const A=Ar[b];if(A!==void 0)return TI(A)}(S),w=E.message;R===void 0&&(R=ke.INTERNAL,w="Unknown error status: "+S+" with message "+E.message),p=!0,g.a_(new qe(R,w)),f.close()}else Oe(Qr,`RPC '${t}' stream ${s} received:`,_),g.u_(_)}}),y(u,DT.STAT_EVENT,v=>{v.stat===Y0.PROXY?Oe(Qr,`RPC '${t}' stream ${s} detected buffering proxy`):v.stat===Y0.NOPROXY&&Oe(Qr,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(r=>r===t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p8(){return typeof window<"u"?window:null}function gd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cg(n){return new m6(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(t,r,i=1e3,s=1.5,o=6e4){this.Mi=t,this.timerId=r,this.d_=i,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const r=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-i);s>0&&Oe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw="PersistentStream";class uD{constructor(t,r,i,s,o,a,u,l){this.Mi=t,this.S_=i,this.b_=s,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new aD(t,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():r&&r.code===ke.RESOURCE_EXHAUSTED?(yn(r.toString()),yn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(r)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.D_===r&&this.G_(i,s)},i=>{t(()=>{const s=new qe(ke.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)})})}G_(t,r){const i=this.W_(this.D_);this.stream=this.j_(t,r),this.stream.Xo(()=>{i(()=>this.listener.Xo())}),this.stream.t_(()=>{i(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{i(()=>this.z_(s))}),this.stream.onMessage(s=>{i(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return Oe(Gw,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return r=>{this.Mi.enqueueAndForget(()=>this.D_===t?r():(Oe(Gw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g8 extends uD{constructor(t,r,i,s,o,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,s,a),this.serializer=o}j_(t,r){return this.connection.T_("Listen",t,r)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const r=_6(this.serializer,t),i=function(o){if(!("targetChange"in o))return ot.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?ot.min():a.readTime?xn(a.readTime):ot.min()}(t);return this.listener.H_(r,i)}Y_(t){const r={};r.database=hy(this.serializer),r.addTarget=function(o,a){let u;const l=a.target;if(u=Xd(l)?{documents:MI(o,l)}:{query:LI(o,l).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=kI(o,a.resumeToken);const c=ly(o,a.expectedCount);c!==null&&(u.expectedCount=c)}else if(a.snapshotVersion.compareTo(ot.min())>0){u.readTime=nl(o,a.snapshotVersion.toTimestamp());const c=ly(o,a.expectedCount);c!==null&&(u.expectedCount=c)}return u}(this.serializer,t);const i=x6(this.serializer,t);i&&(r.labels=i),this.q_(r)}Z_(t){const r={};r.database=hy(this.serializer),r.removeTarget=t,this.q_(r)}}class m8 extends uD{constructor(t,r,i,s,o,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,s,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,r){return this.connection.T_("Write",t,r)}J_(t){return it(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,it(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){it(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const r=b6(t.writeResults,t.commitTime),i=xn(t.commitTime);return this.listener.na(i,r)}ra(){const t={};t.database=hy(this.serializer),this.q_(t)}ea(t){const r={streamToken:this.lastStreamToken,writes:t.map(i=>Jd(this.serializer,i))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y8{}class v8 extends y8{constructor(t,r,i,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new qe(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(t,cy(r,i),s,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new qe(ke.UNKNOWN,o.toString())})}Ho(t,r,i,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Ho(t,cy(r,i),s,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new qe(ke.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class _8{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(yn(r),this.aa=!1):Oe("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa="RemoteStore";class b8{constructor(t,r,i,s,o){this.localStore=t,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{i.enqueueAndForget(async()=>{ja(this)&&(Oe(Aa,"Restarting streams for network reachability change."),await async function(l){const c=vt(l);c.Ea.add(4),await rf(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Ag(c)}(this))})}),this.Ra=new _8(i,s)}}async function Ag(n){if(ja(n))for(const t of n.da)await t(!0)}async function rf(n){for(const t of n.da)await t(!1)}function lD(n,t){const r=vt(n);r.Ia.has(t.targetId)||(r.Ia.set(t.targetId,t),x1(r)?b1(r):Al(r).O_()&&_1(r,t))}function v1(n,t){const r=vt(n),i=Al(r);r.Ia.delete(t),i.O_()&&cD(r,t),r.Ia.size===0&&(i.O_()?i.L_():ja(r)&&r.Ra.set("Unknown"))}function _1(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ot.min())>0){const r=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Al(n).Y_(t)}function cD(n,t){n.Va.Ue(t),Al(n).Z_(t)}function b1(n){n.Va=new f6({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Al(n).start(),n.Ra.ua()}function x1(n){return ja(n)&&!Al(n).x_()&&n.Ia.size>0}function ja(n){return vt(n).Ea.size===0}function hD(n){n.Va=void 0}async function x8(n){n.Ra.set("Online")}async function w8(n){n.Ia.forEach((t,r)=>{_1(n,t)})}async function E8(n,t){hD(n),x1(n)?(n.Ra.ha(t),b1(n)):n.Ra.set("Unknown")}async function S8(n,t,r){if(n.Ra.set("Online"),t instanceof DI&&t.state===2&&t.cause)try{await async function(s,o){const a=o.cause;for(const u of o.targetIds)s.Ia.has(u)&&(await s.remoteSyncer.rejectListen(u,a),s.Ia.delete(u),s.Va.removeTarget(u))}(n,t)}catch(i){Oe(Aa,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await ip(n,i)}else if(t instanceof dd?n.Va.Ze(t):t instanceof II?n.Va.st(t):n.Va.tt(t),!r.isEqual(ot.min()))try{const i=await sD(n.localStore);r.compareTo(i)>=0&&await function(o,a){const u=o.Va.Tt(a);return u.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=o.Ia.get(c);h&&o.Ia.set(c,h.withResumeToken(l.resumeToken,a))}}),u.targetMismatches.forEach((l,c)=>{const h=o.Ia.get(l);if(!h)return;o.Ia.set(l,h.withResumeToken(Nr.EMPTY_BYTE_STRING,h.snapshotVersion)),cD(o,l);const f=new fs(h.target,l,c,h.sequenceNumber);_1(o,f)}),o.remoteSyncer.applyRemoteEvent(u)}(n,r)}catch(i){Oe(Aa,"Failed to raise snapshot:",i),await ip(n,i)}}async function ip(n,t,r){if(!Po(t))throw t;n.Ea.add(1),await rf(n),n.Ra.set("Offline"),r||(r=()=>sD(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Oe(Aa,"Retrying IndexedDB access"),await r(),n.Ea.delete(1),await Ag(n)})}function fD(n,t){return t().catch(r=>ip(n,r,t))}async function nf(n){const t=vt(n),r=Co(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:pa;for(;C8(t);)try{const s=await o8(t.localStore,i);if(s===null){t.Ta.length===0&&r.L_();break}i=s.batchId,A8(t,s)}catch(s){await ip(t,s)}dD(t)&&pD(t)}function C8(n){return ja(n)&&n.Ta.length<10}function A8(n,t){n.Ta.push(t);const r=Co(n);r.O_()&&r.X_&&r.ea(t.mutations)}function dD(n){return ja(n)&&!Co(n).x_()&&n.Ta.length>0}function pD(n){Co(n).start()}async function T8(n){Co(n).ra()}async function I8(n){const t=Co(n);for(const r of n.Ta)t.ea(r.mutations)}async function D8(n,t,r){const i=n.Ta.shift(),s=a1.from(i,t,r);await fD(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await nf(n)}async function k8(n,t){t&&Co(n).X_&&await async function(i,s){if(function(a){return l6(a)&&a!==ke.ABORTED}(s.code)){const o=i.Ta.shift();Co(i).B_(),await fD(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),await nf(i)}}(n,t),dD(n)&&pD(n)}async function zw(n,t){const r=vt(n);r.asyncQueue.verifyOperationInProgress(),Oe(Aa,"RemoteStore received new credentials");const i=ja(r);r.Ea.add(3),await rf(r),i&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.Ea.delete(3),await Ag(r)}async function N8(n,t){const r=vt(n);t?(r.Ea.delete(2),await Ag(r)):t||(r.Ea.add(2),await rf(r),r.Ra.set("Unknown"))}function Al(n){return n.ma||(n.ma=function(r,i,s){const o=vt(r);return o.sa(),new g8(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{Xo:x8.bind(null,n),t_:w8.bind(null,n),r_:E8.bind(null,n),H_:S8.bind(null,n)}),n.da.push(async t=>{t?(n.ma.B_(),x1(n)?b1(n):n.Ra.set("Unknown")):(await n.ma.stop(),hD(n))})),n.ma}function Co(n){return n.fa||(n.fa=function(r,i,s){const o=vt(r);return o.sa(),new m8(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:T8.bind(null,n),r_:k8.bind(null,n),ta:I8.bind(null,n),na:D8.bind(null,n)}),n.da.push(async t=>{t?(n.fa.B_(),await nf(n)):(await n.fa.stop(),n.Ta.length>0&&(Oe(Aa,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(t,r,i,s,o){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new ms,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,i,s,o){const a=Date.now()+i,u=new w1(t,r,a,s,o);return u.start(i),u}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(ke.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function E1(n,t){if(yn("AsyncQueue",`${t}: ${n}`),Po(n))return new qe(ke.UNAVAILABLE,`${t}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{static emptySet(t){return new Iu(t.comparator)}constructor(t){this.comparator=t?(r,i)=>t(r,i)||Ke.comparator(r.key,i.key):(r,i)=>Ke.comparator(r.key,i.key),this.keyedMap=ac(),this.sortedSet=new dr(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,i)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof Iu)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const i=new Iu;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=r,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(){this.ga=new dr(Ke.comparator)}track(t){const r=t.doc.key,i=this.ga.get(r);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(r,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(r,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(r,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(r,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(r):t.type===1&&i.type===2?this.ga=this.ga.insert(r,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(r,{type:2,doc:t.doc}):et(63341,{Rt:t,pa:i}):this.ga=this.ga.insert(r,t)}ya(){const t=[];return this.ga.inorderTraversal((r,i)=>{t.push(i)}),t}}class il{constructor(t,r,i,s,o,a,u,l,c){this.query=t,this.docs=r,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,i,s,o){const a=[];return r.forEach(u=>{a.push({type:0,doc:u})}),new il(t,r,Iu.emptySet(r),a,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&yg(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,i=t.docChanges;if(r.length!==i.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==i[s].type||!r[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class F8{constructor(){this.queries=Hw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,i){const s=vt(r),o=s.queries;s.queries=Hw(),o.forEach((a,u)=>{for(const l of u.Sa)l.onError(i)})})(this,new qe(ke.ABORTED,"Firestore shutting down"))}}function Hw(){return new Is(n=>pI(n),yg)}async function P8(n,t){const r=vt(n);let i=3;const s=t.query;let o=r.queries.get(s);o?!o.ba()&&t.Da()&&(i=2):(o=new R8,i=t.Da()?0:1);try{switch(i){case 0:o.wa=await r.onListen(s,!0);break;case 1:o.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const u=E1(a,`Initialization of query '${lu(t.query)}' failed`);return void t.onError(u)}r.queries.set(s,o),o.Sa.push(t),t.va(r.onlineState),o.wa&&t.Fa(o.wa)&&S1(r)}async function M8(n,t){const r=vt(n),i=t.query;let s=3;const o=r.queries.get(i);if(o){const a=o.Sa.indexOf(t);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?s=t.Da()?0:1:!o.ba()&&t.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(i),r.onUnlisten(i,!0);case 1:return r.queries.delete(i),r.onUnlisten(i,!1);case 2:return r.onLastRemoteStoreUnlisten(i);default:return}}function L8(n,t){const r=vt(n);let i=!1;for(const s of t){const o=s.query,a=r.queries.get(o);if(a){for(const u of a.Sa)u.Fa(s)&&(i=!0);a.wa=s}}i&&S1(r)}function O8(n,t,r){const i=vt(n),s=i.queries.get(t);if(s)for(const o of s.Sa)o.onError(r);i.queries.delete(t)}function S1(n){n.Ca.forEach(t=>{t.next()})}var vy,Ww;(Ww=vy||(vy={})).Ma="default",Ww.Cache="cache";class V8{constructor(t,r,i){this.query=t,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new il(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),r=!0):this.La(t,this.onlineState)&&(this.ka(t),r=!0),this.Na=t,r}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),r=!0),r}La(t,r){if(!t.fromCache||!this.Da())return!0;const i=r!=="Offline";return(!this.options.qa||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(t){t=il.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==vy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(t){this.key=t}}class mD{constructor(t){this.key=t}}class B8{constructor(t,r){this.query=t,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Et(),this.mutatedKeys=Et(),this.eu=gI(t),this.tu=new Iu(this.eu)}get nu(){return this.Ya}ru(t,r){const i=r?r.iu:new qw,s=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=s,u=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((h,f)=>{const d=s.get(h),p=ef(this.query,f)?f:null,g=!!d&&this.mutatedKeys.has(d.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;d&&p?d.data.isEqual(p.data)?g!==y&&(i.track({type:3,doc:p}),v=!0):this.su(d,p)||(i.track({type:2,doc:p}),v=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(u=!0)):!d&&p?(i.track({type:0,doc:p}),v=!0):d&&!p&&(i.track({type:1,doc:d}),v=!0,(l||c)&&(u=!0)),v&&(p?(a=a.add(p),o=y?o.add(h):o.delete(h)):(a=a.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),i.track({type:1,doc:h})}return{tu:a,iu:i,Cs:u,mutatedKeys:o}}su(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,i,s){const o=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const a=t.iu.ya();a.sort((h,f)=>function(p,g){const y=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return et(20277,{Rt:v})}};return y(p)-y(g)}(h.type,f.type)||this.eu(h.doc,f.doc)),this.ou(i),s=s??!1;const u=r&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,a.length!==0||c?{snapshot:new il(this.query,t.tu,o,a,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new qw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Et(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))});const r=[];return t.forEach(i=>{this.Xa.has(i)||r.push(new mD(i))}),this.Xa.forEach(i=>{t.has(i)||r.push(new gD(i))}),r}cu(t){this.Ya=t.Qs,this.Xa=Et();const r=this.ru(t.documents);return this.applyChanges(r,!0)}lu(){return il.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const C1="SyncEngine";class U8{constructor(t,r,i){this.query=t,this.targetId=r,this.view=i}}class $8{constructor(t){this.key=t,this.hu=!1}}class j8{constructor(t,r,i,s,o,a){this.localStore=t,this.remoteStore=r,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Is(u=>pI(u),yg),this.Iu=new Map,this.Eu=new Set,this.du=new dr(Ke.comparator),this.Au=new Map,this.Ru=new d1,this.Vu={},this.mu=new Map,this.fu=Ca.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function G8(n,t,r=!0){const i=wD(n);let s;const o=i.Tu.get(t);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await yD(i,t,r,!0),s}async function z8(n,t){const r=wD(n);await yD(r,t,!0,!1)}async function yD(n,t,r,i){const s=await a8(n.localStore,ri(t)),o=s.targetId,a=n.sharedClientState.addLocalQueryTarget(o,r);let u;return i&&(u=await q8(n,t,o,a==="current",s.resumeToken)),n.isPrimaryClient&&r&&lD(n.remoteStore,s),u}async function q8(n,t,r,i,s){n.pu=(f,d,p)=>async function(y,v,T,_){let C=v.view.ru(T);C.Cs&&(C=await Bw(y.localStore,v.query,!1).then(({documents:w})=>v.view.ru(w,C)));const E=_&&_.targetChanges.get(v.targetId),S=_&&_.targetMismatches.get(v.targetId)!=null,R=v.view.applyChanges(C,y.isPrimaryClient,E,S);return Yw(y,v.targetId,R.au),R.snapshot}(n,f,d,p);const o=await Bw(n.localStore,t,!0),a=new B8(t,o.Qs),u=a.ru(o.documents),l=tf.createSynthesizedTargetChangeForCurrentChange(r,i&&n.onlineState!=="Offline",s),c=a.applyChanges(u,n.isPrimaryClient,l);Yw(n,r,c.au);const h=new U8(t,r,a);return n.Tu.set(t,h),n.Iu.has(r)?n.Iu.get(r).push(t):n.Iu.set(r,[t]),c.snapshot}async function H8(n,t,r){const i=vt(n),s=i.Tu.get(t),o=i.Iu.get(s.targetId);if(o.length>1)return i.Iu.set(s.targetId,o.filter(a=>!yg(a,t))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await my(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),r&&v1(i.remoteStore,s.targetId),_y(i,s.targetId)}).catch($a)):(_y(i,s.targetId),await my(i.localStore,s.targetId,!0))}async function W8(n,t){const r=vt(n),i=r.Tu.get(t),s=r.Iu.get(i.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(i.targetId),v1(r.remoteStore,i.targetId))}async function K8(n,t,r){const i=ED(n);try{const s=await function(a,u){const l=vt(a),c=Wt.now(),h=u.reduce((p,g)=>p.add(g.key),Et());let f,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=jn(),y=Et();return l.Ns.getEntries(p,h).next(v=>{g=v,g.forEach((T,_)=>{_.isValidDocument()||(y=y.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(v=>{f=v;const T=[];for(const _ of u){const C=a6(_,f.get(_.key).overlayedDocument);C!=null&&T.push(new Ds(_.key,C,sI(C.value.mapValue),_n.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,T,u)}).next(v=>{d=v;const T=v.applyToLocalDocumentSet(f,y);return l.documentOverlayCache.saveOverlays(p,v.batchId,T)})}).then(()=>({batchId:d.batchId,changes:yI(f)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),function(a,u,l){let c=a.Vu[a.currentUser.toKey()];c||(c=new dr(gt)),c=c.insert(u,l),a.Vu[a.currentUser.toKey()]=c}(i,s.batchId,r),await sf(i,s.changes),await nf(i.remoteStore)}catch(s){const o=E1(s,"Failed to persist write");r.reject(o)}}async function vD(n,t){const r=vt(n);try{const i=await i8(r.localStore,t);t.targetChanges.forEach((s,o)=>{const a=r.Au.get(o);a&&(it(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?it(a.hu,14607):s.removedDocuments.size>0&&(it(a.hu,42227),a.hu=!1))}),await sf(r,i,t)}catch(i){await $a(i)}}function Kw(n,t,r){const i=vt(n);if(i.isPrimaryClient&&r===0||!i.isPrimaryClient&&r===1){const s=[];i.Tu.forEach((o,a)=>{const u=a.view.va(t);u.snapshot&&s.push(u.snapshot)}),function(a,u){const l=vt(a);l.onlineState=u;let c=!1;l.queries.forEach((h,f)=>{for(const d of f.Sa)d.va(u)&&(c=!0)}),c&&S1(l)}(i.eventManager,t),s.length&&i.Pu.H_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Y8(n,t,r){const i=vt(n);i.sharedClientState.updateQueryState(t,"rejected",r);const s=i.Au.get(t),o=s&&s.key;if(o){let a=new dr(Ke.comparator);a=a.insert(o,_r.newNoDocument(o,ot.min()));const u=Et().add(o),l=new xg(ot.min(),new Map,new dr(gt),a,u);await vD(i,l),i.du=i.du.remove(o),i.Au.delete(t),A1(i)}else await my(i.localStore,t,!1).then(()=>_y(i,t,r)).catch($a)}async function X8(n,t){const r=vt(n),i=t.batch.batchId;try{const s=await n8(r.localStore,t);bD(r,i,null),_D(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),await sf(r,s)}catch(s){await $a(s)}}async function Z8(n,t,r){const i=vt(n);try{const s=await function(a,u){const l=vt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,u).next(f=>(it(f!==null,37113),h=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(i.localStore,t);bD(i,t,r),_D(i,t),i.sharedClientState.updateMutationState(t,"rejected",r),await sf(i,s)}catch(s){await $a(s)}}function _D(n,t){(n.mu.get(t)||[]).forEach(r=>{r.resolve()}),n.mu.delete(t)}function bD(n,t,r){const i=vt(n);let s=i.Vu[i.currentUser.toKey()];if(s){const o=s.get(t);o&&(r?o.reject(r):o.resolve(),s=s.remove(t)),i.Vu[i.currentUser.toKey()]=s}}function _y(n,t,r=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Iu.get(t))n.Tu.delete(i),r&&n.Pu.yu(i,r);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach(i=>{n.Ru.containsKey(i)||xD(n,i)})}function xD(n,t){n.Eu.delete(t.path.canonicalString());const r=n.du.get(t);r!==null&&(v1(n.remoteStore,r),n.du=n.du.remove(t),n.Au.delete(r),A1(n))}function Yw(n,t,r){for(const i of r)i instanceof gD?(n.Ru.addReference(i.key,t),Q8(n,i)):i instanceof mD?(Oe(C1,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,t),n.Ru.containsKey(i.key)||xD(n,i.key)):et(19791,{wu:i})}function Q8(n,t){const r=t.key,i=r.path.canonicalString();n.du.get(r)||n.Eu.has(i)||(Oe(C1,"New document in limbo: "+r),n.Eu.add(i),A1(n))}function A1(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const r=new Ke($t.fromString(t)),i=n.fu.next();n.Au.set(i,new $8(r)),n.du=n.du.insert(r,i),lD(n.remoteStore,new fs(ri(i1(r.path)),i,"TargetPurposeLimboResolution",Qn.ce))}}async function sf(n,t,r){const i=vt(n),s=[],o=[],a=[];i.Tu.isEmpty()||(i.Tu.forEach((u,l)=>{a.push(i.pu(l,t,r).then(c=>{var h;if((c||r)&&i.isPrimaryClient){const f=c?!c.fromCache:(h=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:h.current;i.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=m1.As(l.targetId,c);o.push(f)}}))}),await Promise.all(a),i.Pu.H_(s),await async function(l,c){const h=vt(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>_e.forEach(c,d=>_e.forEach(d.Es,p=>h.persistence.referenceDelegate.addReference(f,d.targetId,p)).next(()=>_e.forEach(d.ds,p=>h.persistence.referenceDelegate.removeReference(f,d.targetId,p)))))}catch(f){if(!Po(f))throw f;Oe(y1,"Failed to update sequence numbers: "+f)}for(const f of c){const d=f.targetId;if(!f.fromCache){const p=h.Ms.get(d),g=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(g);h.Ms=h.Ms.insert(d,y)}}}(i.localStore,o))}async function J8(n,t){const r=vt(n);if(!r.currentUser.isEqual(t)){Oe(C1,"User change. New user:",t.toKey());const i=await iD(r.localStore,t);r.currentUser=t,function(o,a){o.mu.forEach(u=>{u.forEach(l=>{l.reject(new qe(ke.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await sf(r,i.Ls)}}function e9(n,t){const r=vt(n),i=r.Au.get(t);if(i&&i.hu)return Et().add(i.key);{let s=Et();const o=r.Iu.get(t);if(!o)return s;for(const a of o){const u=r.Tu.get(a);s=s.unionWith(u.view.nu)}return s}}function wD(n){const t=vt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=vD.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=e9.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Y8.bind(null,t),t.Pu.H_=L8.bind(null,t.eventManager),t.Pu.yu=O8.bind(null,t.eventManager),t}function ED(n){const t=vt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=X8.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Z8.bind(null,t),t}class ah{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Cg(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return nD(this.persistence,new rD,t.initialUser,this.serializer)}Cu(t){return new p1(Sg.mi,this.serializer)}Du(t){return new oD}async terminate(){var t,r;(t=this.gcScheduler)==null||t.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ah.provider={build:()=>new ah};class t9 extends ah{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,r){it(this.persistence.referenceDelegate instanceof np,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new ZI(i,t.asyncQueue,r)}Cu(t){const r=this.cacheSizeBytes!==void 0?en.withCacheSize(this.cacheSizeBytes):en.DEFAULT;return new p1(i=>np.mi(i,r),this.serializer)}}class r9 extends ah{constructor(t,r,i){super(),this.xu=t,this.cacheSizeBytes=r,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(t){await super.initialize(t),await this.xu.initialize(this,t),await ED(this.xu.syncEngine),await nf(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(t){return nD(this.persistence,new rD,t.initialUser,this.serializer)}Fu(t,r){const i=this.persistence.referenceDelegate.garbageCollector;return new ZI(i,t.asyncQueue,r)}Mu(t,r){const i=new sB(r,this.persistence);return new iB(t.asyncQueue,i)}Cu(t){const r=J6(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?en.withCacheSize(this.cacheSizeBytes):en.DEFAULT;return new g1(this.synchronizeTabs,r,t.clientId,i,t.asyncQueue,p8(),gd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(t){return new oD}}class sp{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Kw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=J8.bind(null,this.syncEngine),await N8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new F8}()}createDatastore(t){const r=Cg(t.databaseInfo.databaseId),i=function(o){return new d8(o)}(t.databaseInfo);return function(o,a,u,l){return new v8(o,a,u,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,a,u){return new b8(i,s,o,a,u)}(this.localStore,this.datastore,t.asyncQueue,r=>Kw(this.syncEngine,r,0),function(){return jw.v()?new jw:new l8}())}createSyncEngine(t,r){return function(s,o,a,u,l,c,h){const f=new j8(s,o,a,u,l,c);return h&&(f.gu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const o=vt(s);Oe(Aa,"RemoteStore shutting down."),o.Ea.add(5),await rf(o),o.Aa.shutdown(),o.Ra.set("Unknown")}(this.remoteStore),(t=this.datastore)==null||t.terminate(),(r=this.eventManager)==null||r.terminate()}}sp.provider={build:()=>new sp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):yn("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao="FirestoreClient";class i9{constructor(t,r,i,s,o){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=s,this.user=dn.UNAUTHENTICATED,this.clientId=Wv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async a=>{Oe(Ao,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(Oe(Ao,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ms;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=E1(r,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function $m(n,t){n.asyncQueue.verifyOperationInProgress(),Oe(Ao,"Initializing OfflineComponentProvider");const r=n.configuration;await t.initialize(r);let i=r.initialUser;n.setCredentialChangeListener(async s=>{i.isEqual(s)||(await iD(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function Xw(n,t){n.asyncQueue.verifyOperationInProgress();const r=await s9(n);Oe(Ao,"Initializing OnlineComponentProvider"),await t.initialize(r,n.configuration),n.setCredentialChangeListener(i=>zw(t.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>zw(t.remoteStore,s)),n._onlineComponents=t}async function s9(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Oe(Ao,"Using user provided OfflineComponentProvider");try{await $m(n,n._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===ke.FAILED_PRECONDITION||s.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Kc("Error using user provided cache. Falling back to memory cache: "+r),await $m(n,new ah)}}else Oe(Ao,"Using default OfflineComponentProvider"),await $m(n,new t9(void 0));return n._offlineComponents}async function SD(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Oe(Ao,"Using user provided OnlineComponentProvider"),await Xw(n,n._uninitializedComponentsProvider._online)):(Oe(Ao,"Using default OnlineComponentProvider"),await Xw(n,new sp))),n._onlineComponents}function o9(n){return SD(n).then(t=>t.syncEngine)}async function a9(n){const t=await SD(n),r=t.eventManager;return r.onListen=G8.bind(null,t.syncEngine),r.onUnlisten=H8.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=z8.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=W8.bind(null,t.syncEngine),r}function u9(n,t,r={}){const i=new ms;return n.asyncQueue.enqueueAndForget(async()=>function(o,a,u,l,c){const h=new n9({next:d=>{h.Nu(),a.enqueueAndForget(()=>M8(o,f)),d.fromCache&&l.source==="server"?c.reject(new qe(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new V8(u,h,{includeMetadataChanges:!0,qa:!0});return P8(o,f)}(await a9(n),n.asyncQueue,t,r,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l9="firestore.googleapis.com",Qw=!0;class Jw{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new qe(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=l9,this.ssl=Qw}else this.host=t.host,this.ssl=t.ssl??Qw;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=HI;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<XI)throw new qe(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}eB("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CD(t.experimentalLongPollingOptions??{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new qe(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new qe(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new qe(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class T1{constructor(t,r,i,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new qe(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jw(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new qV;switch(i.type){case"firstParty":return new KV(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new qe(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const i=Zw.get(r);i&&(Oe("ComponentProvider","Removing Datastore"),Zw.delete(r),i.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(t,r,i){this.converter=r,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Tl(this.firestore,t,this._query)}}class Vr{constructor(t,r,i){this.converter=r,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Vr(this.firestore,t,this._key)}toJSON(){return{type:Vr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,r,i){if(Xh(r,Vr._jsonSchema))return new Vr(t,i||null,new Ke($t.fromString(r.referencePath)))}}Vr._jsonSchemaVersion="firestore/documentReference/1.0",Vr._jsonSchema={type:Dr("string",Vr._jsonSchemaVersion),referencePath:Dr("string")};class mo extends Tl{constructor(t,r,i){super(t,r,i1(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Vr(this.firestore,null,new Ke(t))}withConverter(t){return new mo(this.firestore,t,this._path)}}function ys(n,t,...r){if(n=$r(n),PT("collection","path",t),n instanceof T1){const i=$t.fromString(t,...r);return Gx(i),new mo(n,null,i)}{if(!(n instanceof Vr||n instanceof mo))throw new qe(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child($t.fromString(t,...r));return Gx(i),new mo(n.firestore,null,i)}}function sl(n,t,...r){if(n=$r(n),arguments.length===1&&(t=Wv.newId()),PT("doc","path",t),n instanceof T1){const i=$t.fromString(t,...r);return jx(i),new Vr(n,null,new Ke(i))}{if(!(n instanceof Vr||n instanceof mo))throw new qe(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child($t.fromString(t,...r));return jx(i),new Vr(n.firestore,n instanceof mo?n.converter:null,new Ke(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE="AsyncQueue";class tE{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new aD(this,"async_queue_retry"),this._c=()=>{const i=gd();i&&Oe(eE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const r=gd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const r=gd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const r=new ms;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Po(t))throw t;Oe(eE,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const r=this.ac.then(()=>(this.rc=!0,t().catch(i=>{throw this.nc=i,this.rc=!1,yn("INTERNAL UNHANDLED ERROR: ",rE(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=r,r}enqueueAfterDelay(t,r,i){this.uc(),this.oc.indexOf(t)>-1&&(r=0);const s=w1.createAndSchedule(this,t,r,i,o=>this.hc(o));return this.tc.push(s),s}uc(){this.nc&&et(47125,{Pc:rE(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const r of this.tc)if(r.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((r,i)=>r.targetTimeMs-i.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const r=this.tc.indexOf(t);this.tc.splice(r,1)}}function rE(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class of extends T1{constructor(t,r,i,s){super(t,r,i,s),this.type="firestore",this._queue=new tE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new tE(t),this._firestoreClient=void 0,await t}}}function c9(n,t,r){r||(r=Kd);const i=Ua(n,"firestore");if(i.isInitialized(r)){const s=i.getImmediate({identifier:r}),o=i.getOptions(r);if(wo(o,t))return s;throw new qe(ke.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(t.cacheSizeBytes!==void 0&&t.localCache!==void 0)throw new qe(ke.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(t.cacheSizeBytes!==void 0&&t.cacheSizeBytes!==-1&&t.cacheSizeBytes<XI)throw new qe(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&xl(t.host)&&gA(t.host),i.initialize({options:t,instanceIdentifier:r})}function AD(n){if(n._terminated)throw new qe(ke.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||h9(n),n._firestoreClient}function h9(n){var i,s,o;const t=n._freezeSettings(),r=function(u,l,c,h){return new PB(u,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,CD(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,t);n._componentsProvider||(s=t.localCache)!=null&&s._offlineComponentProvider&&((o=t.localCache)!=null&&o._onlineComponentProvider)&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new i9(n._authCredentials,n._appCheckCredentials,n._queue,r,n._componentsProvider&&function(u){const l=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Yn(Nr.fromBase64String(t))}catch(r){throw new qe(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Yn(Nr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Xh(t,Yn._jsonSchema))return Yn.fromBase64String(t.bytes)}}Yn._jsonSchemaVersion="firestore/bytes/1.0",Yn._jsonSchema={type:Dr("string",Yn._jsonSchemaVersion),bytes:Dr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new qe(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new qe(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new qe(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return gt(this._lat,t._lat)||gt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Oi._jsonSchemaVersion}}static fromJSON(t){if(Xh(t,Oi._jsonSchema))return new Oi(t.latitude,t.longitude)}}Oi._jsonSchemaVersion="firestore/geoPoint/1.0",Oi._jsonSchema={type:Dr("string",Oi._jsonSchemaVersion),latitude:Dr("number"),longitude:Dr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Vi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Xh(t,Vi._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(r=>typeof r=="number"))return new Vi(t.vectorValues);throw new qe(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vi._jsonSchemaVersion="firestore/vectorValue/1.0",Vi._jsonSchema={type:Dr("string",Vi._jsonSchemaVersion),vectorValues:Dr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f9=/^__.*__$/;class d9{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return this.fieldMask!==null?new Ds(t,this.data,this.fieldMask,r,this.fieldTransforms):new Cl(t,this.data,r,this.fieldTransforms)}}class TD{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return new Ds(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function ID(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw et(40011,{Ac:n})}}class D1{constructor(t,r,i,s,o,a){this.settings=t,this.databaseId=r,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new D1({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){var s;const r=(s=this.path)==null?void 0:s.child(t),i=this.Vc({path:r,fc:!1});return i.gc(t),i}yc(t){var s;const r=(s=this.path)==null?void 0:s.child(t),i=this.Vc({path:r,fc:!1});return i.Rc(),i}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return op(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(ID(this.Ac)&&f9.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class p9{constructor(t,r,i){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=i||Cg(t)}Cc(t,r,i,s=!1){return new D1({Ac:t,methodName:r,Dc:i,path:mr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function k1(n){const t=n._freezeSettings(),r=Cg(n._databaseId);return new p9(n._databaseId,!!t.ignoreUndefinedProperties,r)}function g9(n,t,r,i,s,o={}){const a=n.Cc(o.merge||o.mergeFields?2:0,t,r,s);N1("Data must be an object, but it was:",a,i);const u=DD(i,a);let l,c;if(o.merge)l=new Nn(a.fieldMask),c=a.fieldTransforms;else if(o.mergeFields){const h=[];for(const f of o.mergeFields){const d=by(t,f,r);if(!a.contains(d))throw new qe(ke.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);ND(h,d)||h.push(d)}l=new Nn(h),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new d9(new on(u),l,c)}class Ig extends I1{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Ig}}function m9(n,t,r,i){const s=n.Cc(1,t,r);N1("Data must be an object, but it was:",s,i);const o=[],a=on.empty();Mo(i,(l,c)=>{const h=R1(t,l,r);c=$r(c);const f=s.yc(h);if(c instanceof Ig)o.push(h);else{const d=af(c,f);d!=null&&(o.push(h),a.set(h,d))}});const u=new Nn(o);return new TD(a,u,s.fieldTransforms)}function y9(n,t,r,i,s,o){const a=n.Cc(1,t,r),u=[by(t,i,r)],l=[s];if(o.length%2!=0)throw new qe(ke.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<o.length;d+=2)u.push(by(t,o[d])),l.push(o[d+1]);const c=[],h=on.empty();for(let d=u.length-1;d>=0;--d)if(!ND(c,u[d])){const p=u[d];let g=l[d];g=$r(g);const y=a.yc(p);if(g instanceof Ig)c.push(p);else{const v=af(g,y);v!=null&&(c.push(p),h.set(p,v))}}const f=new Nn(c);return new TD(h,f,a.fieldTransforms)}function v9(n,t,r,i=!1){return af(r,n.Cc(i?4:3,t))}function af(n,t){if(kD(n=$r(n)))return N1("Unsupported field value:",t,n),DD(n,t);if(n instanceof I1)return function(i,s){if(!ID(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return function(i,s){const o=[];let a=0;for(const u of i){let l=af(u,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),a++}return{arrayValue:{values:o}}}(n,t)}return function(i,s){if((i=$r(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return e6(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Wt.fromDate(i);return{timestampValue:nl(s.serializer,o)}}if(i instanceof Wt){const o=new Wt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:nl(s.serializer,o)}}if(i instanceof Oi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Yn)return{bytesValue:kI(s.serializer,i._byteString)};if(i instanceof Vr){const o=s.databaseId,a=i.firestore._databaseId;if(!a.isEqual(o))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:c1(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof Vi)return function(a,u){return{mapValue:{fields:{[t1]:{stringValue:r1},[Zu]:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw u.Sc("VectorValues must only contain numeric values.");return s1(u.serializer,c)})}}}}}}(i,s);throw s.Sc(`Unsupported field value: ${lg(i)}`)}(n,t)}function DD(n,t){const r={};return XT(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Mo(n,(i,s)=>{const o=af(s,t.mc(i));o!=null&&(r[i]=o)}),{mapValue:{fields:r}}}function kD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Wt||n instanceof Oi||n instanceof Yn||n instanceof Vr||n instanceof I1||n instanceof Vi)}function N1(n,t,r){if(!kD(r)||!MT(r)){const i=lg(r);throw i==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+i)}}function by(n,t,r){if((t=$r(t))instanceof Tg)return t._internalPath;if(typeof t=="string")return R1(n,t);throw op("Field path arguments must be of type string or ",n,!1,void 0,r)}const _9=new RegExp("[~\\*/\\[\\]]");function R1(n,t,r){if(t.search(_9)>=0)throw op(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,r);try{return new Tg(...t.split("."))._internalPath}catch{throw op(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,r)}}function op(n,t,r,i,s){const o=i&&!i.isEmpty(),a=s!==void 0;let u=`Function ${t}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(o||a)&&(l+=" (found",o&&(l+=` in field ${i}`),a&&(l+=` in document ${s}`),l+=")"),new qe(ke.INVALID_ARGUMENT,u+n+l)}function ND(n,t){return n.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(t,r,i,s,o){this._firestore=t,this._userDataWriter=r,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new b9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(F1("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class b9 extends RD{data(){return super.data()}}function F1(n,t){return typeof t=="string"?R1(n,t):t instanceof Tg?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x9(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new qe(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class P1{}class w9 extends P1{}function ol(n,t,...r){let i=[];t instanceof P1&&i.push(t),i=i.concat(r),function(o){const a=o.filter(l=>l instanceof M1).length,u=o.filter(l=>l instanceof Dg).length;if(a>1||a>0&&u>0)throw new qe(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)n=s._apply(n);return n}class Dg extends w9{constructor(t,r,i){super(),this._field=t,this._op=r,this._value=i,this.type="where"}static _create(t,r,i){return new Dg(t,r,i)}_apply(t){const r=this._parse(t);return FD(t._query,r),new Tl(t.firestore,t.converter,ay(t._query,r))}_parse(t){const r=k1(t.firestore);return function(o,a,u,l,c,h,f){let d;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new qe(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){iE(f,h);const g=[];for(const y of f)g.push(nE(l,o,y));d={arrayValue:{values:g}}}else d=nE(l,o,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||iE(f,h),d=v9(u,a,f,h==="in"||h==="not-in");return It.create(c,h,d)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function ro(n,t,r){const i=t,s=F1("where",n);return Dg._create(s,i,r)}class M1 extends P1{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new M1(t,r)}_parse(t){const r=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return r.length===1?r[0]:Kt.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(s,o){let a=s;const u=o.getFlattenedFilters();for(const l of u)FD(a,l),a=ay(a,l)}(t._query,r),new Tl(t.firestore,t.converter,ay(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function nE(n,t,r){if(typeof(r=$r(r))=="string"){if(r==="")throw new qe(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dI(t)&&r.indexOf("/")!==-1)throw new qe(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const i=t.path.child($t.fromString(r));if(!Ke.isDocumentKey(i))throw new qe(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return nh(n,new Ke(i))}if(r instanceof Vr)return nh(n,r._key);throw new qe(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lg(r)}.`)}function iE(n,t){if(!Array.isArray(n)||n.length===0)throw new qe(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function FD(n,t){const r=function(s,o){for(const a of s)for(const u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new qe(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new qe(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class E9{convertValue(t,r="none"){switch(Eo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return hr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Es(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw et(62114,{value:t})}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const i={};return Mo(t,(s,o)=>{i[s]=this.convertValue(o,r)}),i}convertVectorValue(t){var i,s,o;const r=(o=(s=(i=t.fields)==null?void 0:i[Zu].arrayValue)==null?void 0:s.values)==null?void 0:o.map(a=>hr(a.doubleValue));return new Vi(r)}convertGeoPoint(t){return new Oi(hr(t.latitude),hr(t.longitude))}convertArray(t,r){return(t.values||[]).map(i=>this.convertValue(i,r))}convertServerTimestamp(t,r){switch(r){case"previous":const i=gg(t);return i==null?null:this.convertValue(i,r);case"estimate":return this.convertTimestamp(th(t));default:return null}}convertTimestamp(t){const r=ws(t);return new Wt(r.seconds,r.nanos)}convertDocumentKey(t,r){const i=$t.fromString(t);it(UI(i),9688,{name:t});const s=new xa(i.get(1),i.get(3)),o=new Ke(i.popFirst(5));return s.isEqual(r)||yn(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S9(n,t,r){let i;return i=n?n.toFirestore(t):t,i}class Rf{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Du extends RD{constructor(t,r,i,s,o,a){super(t,r,i,s,a),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new md(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const i=this._document.data.field(F1("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,r={};return r.type=Du._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Du._jsonSchemaVersion="firestore/documentSnapshot/1.0",Du._jsonSchema={type:Dr("string",Du._jsonSchemaVersion),bundleSource:Dr("string","DocumentSnapshot"),bundleName:Dr("string"),bundle:Dr("string")};class md extends Du{data(t={}){return super.data(t)}}class ku{constructor(t,r,i,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new Rf(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(i=>{t.call(r,new md(this._firestore,this._userDataWriter,i.key,i,new Rf(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new qe(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(u=>{const l=new md(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Rf(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const l=new md(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Rf(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,h=-1;return u.type!==0&&(c=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),h=a.indexOf(u.doc.key)),{type:C9(u.type),doc:l,oldIndex:c,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=ku._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Wv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],i=[],s=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function C9(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return et(61501,{type:n})}}ku._jsonSchemaVersion="firestore/querySnapshot/1.0",ku._jsonSchema={type:Dr("string",ku._jsonSchemaVersion),bundleSource:Dr("string","QuerySnapshot"),bundleName:Dr("string"),bundle:Dr("string")};class A9 extends E9{constructor(t){super(),this.firestore=t}convertBytes(t){return new Yn(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Vr(this.firestore,null,r)}}function al(n){n=Hu(n,Tl);const t=Hu(n.firestore,of),r=AD(t),i=new A9(t);return x9(n._query),u9(r,n._query).then(s=>new ku(t,i,n,s))}function L1(n,t,r,...i){n=Hu(n,Vr);const s=Hu(n.firestore,of),o=k1(s);let a;return a=typeof(t=$r(t))=="string"||t instanceof Tg?y9(o,"updateDoc",n._key,t,r,i):m9(o,"updateDoc",n._key,t),V1(s,[a.toMutation(n._key,_n.exists(!0))])}function PD(n){return V1(Hu(n.firestore,of),[new bg(n._key,_n.none())])}function O1(n,t){const r=Hu(n.firestore,of),i=sl(n),s=S9(n.converter,t);return V1(r,[g9(k1(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,_n.exists(!1))]).then(()=>i)}function V1(n,t){return function(i,s){const o=new ms;return i.asyncQueue.enqueueAndForget(async()=>K8(await o9(i),s,o)),o.promise}(AD(n),t)}class T9{constructor(t){let r;this.kind="persistent",t!=null&&t.tabManager?(t.tabManager._initialize(t),r=t.tabManager):(r=k9(void 0),r._initialize(t)),this._onlineComponentProvider=r._onlineComponentProvider,this._offlineComponentProvider=r._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function I9(n){return new T9(n)}class D9{constructor(t){this.forceOwnership=t,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(t){this._onlineComponentProvider=sp.provider,this._offlineComponentProvider={build:r=>new r9(r,t==null?void 0:t.cacheSizeBytes,this.forceOwnership)}}}function k9(n){return new D9(n==null?void 0:n.forceOwnership)}(function(t,r=!0){(function(s){Sl=s})(wl),Gi(new bi("firestore",(i,{instanceIdentifier:s,options:o})=>{const a=i.getProvider("app").getImmediate(),u=new of(new HV(i.getProvider("auth-internal")),new YV(a,i.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new qe(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xa(c.options.projectId,h)}(a,s),a);return o={useFetchStreams:r,...o},u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),ti(Vx,Bx,t),ti(Vx,Bx,"esm2020")})();const N9={apiKey:"AIzaSyCX8g2c5jzORlgQKz57vahIsO-TP1nGX5E",authDomain:"journal-ddaf4.firebaseapp.com",projectId:"journal-ddaf4",storageBucket:"journal-ddaf4.firebasestorage.app",messagingSenderId:"136356893420",appId:"1:136356893420:web:5162103d01918488e84bc9",measurementId:"G-25Y1KHZNNP"},B1=SA(N9),wn=jV(B1);BO(B1);const bn=c9(B1,{localCache:I9({tabSynchronization:!0})});async function Ff(){let n=wn.currentUser;return n||await new Promise(t=>{const r=wn.onAuthStateChanged(i=>{n=i,r(),t()})}),wn.currentUser}const kg=aA("tasks",{state:()=>({tasks:[],error:null,isLoading:!1}),actions:{async loadTasks(){this.isLoading=!0,this.error=null;try{this.tasks=[];const n=await Ff();if(!n){this.error="Niet ingelogd";return}const t=ol(ys(bn,"tasks"),ro("userId","==",n.uid)),r=await al(t);this.tasks=r.docs.map(i=>({id:i.id,...i.data()})),console.log(this.tasks)}catch(n){this.error="Fout bij het laden van taken",console.error(this.error,n)}finally{this.isLoading=!1}},async addTask(n){this.error=null;try{const t=await Ff();if(!t)throw new Error("Niet ingelogd");const r=await O1(ys(bn,"tasks"),{...n,userId:t.uid});this.tasks.push({id:r.id,...n,userId:t.uid})}catch(t){this.error="Fout bij het toevoegen van een taak",console.error(this.error,t),await this.loadTasks()}},async updateTask(n,t){this.error=null;try{if(!n||typeof n!="string")throw new Error("Ongeldige taskId: "+n);const r=await Ff();if(!r)throw new Error("Niet ingelogd");const i=sl(bn,"tasks",n);console.log("Updating task:",n,t),await L1(i,{...t,userId:r.uid});const s=this.tasks.findIndex(o=>o.id===n);s!==-1&&(this.tasks[s]={id:n,...t,userId:r.uid}),await this.loadTasks()}catch(r){this.error="Fout bij het bijwerken van een taak",console.error(this.error,r),await this.loadTasks()}},async deleteTask(n){this.error=null;try{if(!n||typeof n!="string")throw new Error("Ongeldige taskId voor verwijdering: "+n);if(!await Ff())throw new Error("Niet ingelogd");const r=sl(bn,"tasks",n);await PD(r);const i=this.tasks.findIndex(s=>s.id===n);i!==-1&&this.tasks.splice(i,1)}catch(t){this.error="Fout bij het verwijderen van een taak",console.error(this.error,t),await this.loadTasks()}},async deleteTaskInstance(n,t){this.error=null;try{if(!n||typeof n!="string")throw new Error("Ongeldige taskId voor instantie-verwijdering: "+n);const r=this.tasks.findIndex(o=>o.id===n);if(r===-1)throw new Error("Taak niet gevonden met ID: "+n);const i=this.tasks[r];let s={...i};if(i.scheduledDates)s.scheduledDates=i.scheduledDates.filter(o=>o.date!==t),s.scheduledDates.length===0?await this.deleteTask(n):await this.updateTask(n,s);else if(i.timesByDate){const o={...i.timesByDate};delete o[t],Object.keys(o).length===0?await this.deleteTask(n):await this.updateTask(n,{timesByDate:o})}else i.dates&&(s.dates=i.dates.filter(o=>o!==t),s.dates.length===0?await this.deleteTask(n):await this.updateTask(n,s))}catch(r){throw this.error="Fout bij het verwijderen van taakinstantie",console.error(this.error,r),await this.loadTasks(),r}},async toggleTaskCompletion(n){this.error=null;try{const t=this.tasks.findIndex(r=>r.id===n);if(t!==-1){const r=this.tasks[t],i={...r,completed:!r.completed};await this.updateTask(n,i)}}catch(t){this.error="Fout bij het togglen van taak voltooiing",console.error(this.error,t),await this.loadTasks()}},async toggleTaskInstanceCompletion(n,t){this.error=null;try{const r=this.tasks.findIndex(i=>i.id===n);if(r!==-1){const i=this.tasks[r];if(i.scheduledDates&&i.scheduledDates.length>0){const s=i.scheduledDates.findIndex(o=>o.date===t);if(s!==-1){const o=[...i.scheduledDates];o[s]={...o[s],completed:!o[s].completed},await this.updateTask(n,{scheduledDates:o})}}else if(i.timesByDate&&i.timesByDate[t]){const s={...i.timesByDate};s[t]={...s[t],completed:!s[t].completed},await this.updateTask(n,{timesByDate:s})}}}catch(r){this.error="Fout bij het togglen van taakinstantie voltooiing",console.error(this.error,r),await this.loadTasks()}}},getters:{unplannedTasksCount:n=>n.tasks.filter(t=>!t.dates||t.dates.length===0).length}});async function Pf(n=5e3){let t=wn.currentUser;if(t||await new Promise((r,i)=>{const s=setTimeout(()=>{i(new Error("Timeout waiting for user authentication"))},n),o=wn.onAuthStateChanged(a=>{clearTimeout(s),t=a,o(),r()},i)}),!t)throw new Error("Geen gebruiker ingelogd");return t}function Jl(){if(!bn)throw new Error("Firestore is niet genitialiseerd. Controleer je firebase.js configuratie.")}const uf=aA("goals",{state:()=>({goals:[],error:null,isLoading:!1}),actions:{async loadGoals(){this.isLoading=!0,this.error=null;try{Jl();const n=await Pf(),t=ol(ys(bn,"goals"),ro("userId","==",n.uid)),r=await al(t);this.goals=r.docs.map(i=>({id:i.id,...i.data()}))}catch(n){this.error=`Fout bij het laden van doelen: ${n.message}`,console.error(this.error,n)}finally{this.isLoading=!1}},async addGoal(n){this.error=null;try{Jl();const t=await Pf(),r=await O1(ys(bn,"goals"),{...n,userId:t.uid,createdAt:new Date().toISOString(),completed:!1,deadline:n.deadline||null});this.goals.push({id:r.id,...n,userId:t.uid,createdAt:new Date().toISOString(),completed:!1,deadline:n.deadline||null})}catch(t){this.error=`Fout bij het toevoegen van een doel: ${t.message}`,console.error(this.error,t),await this.loadGoals()}},async updateGoal(n,t){this.error=null;try{if(Jl(),!n||typeof n!="string")throw new Error("Ongeldige goalId: "+n);const r=await Pf(),i=sl(bn,"goals",n);await L1(i,{...t,userId:r.uid,deadline:t.deadline||null});const s=this.goals.findIndex(o=>o.id===n);s!==-1&&(this.goals[s]={id:n,...t,userId:r.uid,deadline:t.deadline||null}),await this.loadGoals()}catch(r){this.error=`Fout bij het bijwerken van een doel: ${r.message}`,console.error(this.error,r),await this.loadGoals()}},async deleteGoal(n){this.error=null;try{if(Jl(),!n||typeof n!="string")throw new Error("Ongeldige goalId voor verwijdering: "+n);const t=await Pf(),r=sl(bn,"goals",n);await PD(r);const i=this.goals.findIndex(s=>s.id===n);i!==-1&&this.goals.splice(i,1)}catch(t){this.error=`Fout bij het verwijderen van een doel: ${t.message}`,console.error(this.error,t),await this.loadGoals()}},async toggleGoalCompletion(n){this.error=null;try{Jl();const t=this.goals.findIndex(r=>r.id===n);if(t!==-1){const r=this.goals[t],i={...r,completed:!r.completed};await this.updateGoal(n,i)}}catch(t){this.error=`Fout bij het togglen van doel voltooiing: ${t.message}`,console.error(this.error,t),await this.loadGoals()}}},getters:{activeGoalsCount:n=>n.goals.filter(t=>!t.completed).length}});/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const du=typeof document<"u";function MD(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function R9(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&MD(n.default)}const zt=Object.assign;function jm(n,t){const r={};for(const i in t){const s=t[i];r[i]=xi(s)?s.map(n):n(s)}return r}const Rc=()=>{},xi=Array.isArray,LD=/#/g,F9=/&/g,P9=/\//g,M9=/=/g,L9=/\?/g,OD=/\+/g,O9=/%5B/g,V9=/%5D/g,VD=/%5E/g,B9=/%60/g,BD=/%7B/g,U9=/%7C/g,UD=/%7D/g,$9=/%20/g;function U1(n){return encodeURI(""+n).replace(U9,"|").replace(O9,"[").replace(V9,"]")}function j9(n){return U1(n).replace(BD,"{").replace(UD,"}").replace(VD,"^")}function xy(n){return U1(n).replace(OD,"%2B").replace($9,"+").replace(LD,"%23").replace(F9,"%26").replace(B9,"`").replace(BD,"{").replace(UD,"}").replace(VD,"^")}function G9(n){return xy(n).replace(M9,"%3D")}function z9(n){return U1(n).replace(LD,"%23").replace(L9,"%3F")}function q9(n){return n==null?"":z9(n).replace(P9,"%2F")}function uh(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const H9=/\/$/,W9=n=>n.replace(H9,"");function Gm(n,t,r="/"){let i,s={},o="",a="";const u=t.indexOf("#");let l=t.indexOf("?");return u<l&&u>=0&&(l=-1),l>-1&&(i=t.slice(0,l),o=t.slice(l+1,u>-1?u:t.length),s=n(o)),u>-1&&(i=i||t.slice(0,u),a=t.slice(u,t.length)),i=Z9(i??t,r),{fullPath:i+(o&&"?")+o+a,path:i,query:s,hash:uh(a)}}function K9(n,t){const r=t.query?n(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function sE(n,t){return!t||!n.toLowerCase().startsWith(t.toLowerCase())?n:n.slice(t.length)||"/"}function Y9(n,t,r){const i=t.matched.length-1,s=r.matched.length-1;return i>-1&&i===s&&ul(t.matched[i],r.matched[s])&&$D(t.params,r.params)&&n(t.query)===n(r.query)&&t.hash===r.hash}function ul(n,t){return(n.aliasOf||n)===(t.aliasOf||t)}function $D(n,t){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const r in n)if(!X9(n[r],t[r]))return!1;return!0}function X9(n,t){return xi(n)?oE(n,t):xi(t)?oE(t,n):n===t}function oE(n,t){return xi(t)?n.length===t.length&&n.every((r,i)=>r===t[i]):n.length===1&&n[0]===t}function Z9(n,t){if(n.startsWith("/"))return n;if(!n)return t;const r=t.split("/"),i=n.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let o=r.length-1,a,u;for(a=0;a<i.length;a++)if(u=i[a],u!==".")if(u==="..")o>1&&o--;else break;return r.slice(0,o).join("/")+"/"+i.slice(a).join("/")}const js={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var lh;(function(n){n.pop="pop",n.push="push"})(lh||(lh={}));var Fc;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Fc||(Fc={}));function Q9(n){if(!n)if(du){const t=document.querySelector("base");n=t&&t.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),W9(n)}const J9=/^[^#]+#/;function eU(n,t){return n.replace(J9,"#")+t}function tU(n,t){const r=document.documentElement.getBoundingClientRect(),i=n.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const Ng=()=>({left:window.scrollX,top:window.scrollY});function rU(n){let t;if("el"in n){const r=n.el,i=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;t=tU(s,n)}else t=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function aE(n,t){return(history.state?history.state.position-t:-1)+n}const wy=new Map;function nU(n,t){wy.set(n,t)}function iU(n){const t=wy.get(n);return wy.delete(n),t}let sU=()=>location.protocol+"//"+location.host;function jD(n,t){const{pathname:r,search:i,hash:s}=t,o=n.indexOf("#");if(o>-1){let u=s.includes(n.slice(o))?n.slice(o).length:1,l=s.slice(u);return l[0]!=="/"&&(l="/"+l),sE(l,"")}return sE(r,n)+i+s}function oU(n,t,r,i){let s=[],o=[],a=null;const u=({state:d})=>{const p=jD(n,location),g=r.value,y=t.value;let v=0;if(d){if(r.value=p,t.value=d,a&&a===g){a=null;return}v=y?d.position-y.position:0}else i(p);s.forEach(T=>{T(r.value,g,{delta:v,type:lh.pop,direction:v?v>0?Fc.forward:Fc.back:Fc.unknown})})};function l(){a=r.value}function c(d){s.push(d);const p=()=>{const g=s.indexOf(d);g>-1&&s.splice(g,1)};return o.push(p),p}function h(){const{history:d}=window;d.state&&d.replaceState(zt({},d.state,{scroll:Ng()}),"")}function f(){for(const d of o)d();o=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function uE(n,t,r,i=!1,s=!1){return{back:n,current:t,forward:r,replaced:i,position:window.history.length,scroll:s?Ng():null}}function aU(n){const{history:t,location:r}=window,i={value:jD(n,r)},s={value:t.state};s.value||o(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function o(l,c,h){const f=n.indexOf("#"),d=f>-1?(r.host&&document.querySelector("base")?n:n.slice(f))+l:sU()+n+l;try{t[h?"replaceState":"pushState"](c,"",d),s.value=c}catch(p){console.error(p),r[h?"replace":"assign"](d)}}function a(l,c){const h=zt({},t.state,uE(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});o(l,h,!0),i.value=l}function u(l,c){const h=zt({},s.value,t.state,{forward:l,scroll:Ng()});o(h.current,h,!0);const f=zt({},uE(i.value,l,null),{position:h.position+1},c);o(l,f,!1),i.value=l}return{location:i,state:s,push:u,replace:a}}function uU(n){n=Q9(n);const t=aU(n),r=oU(n,t.state,t.location,t.replace);function i(o,a=!0){a||r.pauseListeners(),history.go(o)}const s=zt({location:"",base:n,go:i,createHref:eU.bind(null,n)},t,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function lU(n){return typeof n=="string"||n&&typeof n=="object"}function GD(n){return typeof n=="string"||typeof n=="symbol"}const zD=Symbol("");var lE;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(lE||(lE={}));function ll(n,t){return zt(new Error,{type:n,[zD]:!0},t)}function ts(n,t){return n instanceof Error&&zD in n&&(t==null||!!(n.type&t))}const cE="[^/]+?",cU={sensitive:!1,strict:!1,start:!0,end:!0},hU=/[.+*?^${}()[\]/\\]/g;function fU(n,t){const r=zt({},cU,t),i=[];let s=r.start?"^":"";const o=[];for(const c of n){const h=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const d=c[f];let p=40+(r.sensitive?.25:0);if(d.type===0)f||(s+="/"),s+=d.value.replace(hU,"\\$&"),p+=40;else if(d.type===1){const{value:g,repeatable:y,optional:v,regexp:T}=d;o.push({name:g,repeatable:y,optional:v});const _=T||cE;if(_!==cE){p+=10;try{new RegExp(`(${_})`)}catch(E){throw new Error(`Invalid custom RegExp for param "${g}" (${_}): `+E.message)}}let C=y?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;f||(C=v&&c.length<2?`(?:/${C})`:"/"+C),v&&(C+="?"),s+=C,p+=20,v&&(p+=-8),y&&(p+=-20),_===".*"&&(p+=-50)}h.push(p)}i.push(h)}if(r.strict&&r.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function u(c){const h=c.match(a),f={};if(!h)return null;for(let d=1;d<h.length;d++){const p=h[d]||"",g=o[d-1];f[g.name]=p&&g.repeatable?p.split("/"):p}return f}function l(c){let h="",f=!1;for(const d of n){(!f||!h.endsWith("/"))&&(h+="/"),f=!1;for(const p of d)if(p.type===0)h+=p.value;else if(p.type===1){const{value:g,repeatable:y,optional:v}=p,T=g in c?c[g]:"";if(xi(T)&&!y)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const _=xi(T)?T.join("/"):T;if(!_)if(v)d.length<2&&(h.endsWith("/")?h=h.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);h+=_}}return h||"/"}return{re:a,score:i,keys:o,parse:u,stringify:l}}function dU(n,t){let r=0;for(;r<n.length&&r<t.length;){const i=t[r]-n[r];if(i)return i;r++}return n.length<t.length?n.length===1&&n[0]===80?-1:1:n.length>t.length?t.length===1&&t[0]===80?1:-1:0}function qD(n,t){let r=0;const i=n.score,s=t.score;for(;r<i.length&&r<s.length;){const o=dU(i[r],s[r]);if(o)return o;r++}if(Math.abs(s.length-i.length)===1){if(hE(i))return 1;if(hE(s))return-1}return s.length-i.length}function hE(n){const t=n[n.length-1];return n.length>0&&t[t.length-1]<0}const pU={type:0,value:""},gU=/[a-zA-Z0-9_]/;function mU(n){if(!n)return[[]];if(n==="/")return[[pU]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function t(p){throw new Error(`ERR (${r})/"${c}": ${p}`)}let r=0,i=r;const s=[];let o;function a(){o&&s.push(o),o=[]}let u=0,l,c="",h="";function f(){c&&(r===0?o.push({type:0,value:c}):r===1||r===2||r===3?(o.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:c,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;u<n.length;){if(l=n[u++],l==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:l==="/"?(c&&f(),a()):l===":"?(f(),r=1):d();break;case 4:d(),r=i;break;case 1:l==="("?r=2:gU.test(l)?d():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&u--);break;case 2:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:r=3:h+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&u--,h="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),f(),a(),s}function yU(n,t,r){const i=fU(mU(n.path),r),s=zt(i,{record:n,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function vU(n,t){const r=[],i=new Map;t=gE({strict:!1,end:!0,sensitive:!1},t);function s(f){return i.get(f)}function o(f,d,p){const g=!p,y=dE(f);y.aliasOf=p&&p.record;const v=gE(t,f),T=[y];if("alias"in f){const E=typeof f.alias=="string"?[f.alias]:f.alias;for(const S of E)T.push(dE(zt({},y,{components:p?p.record.components:y.components,path:S,aliasOf:p?p.record:y})))}let _,C;for(const E of T){const{path:S}=E;if(d&&S[0]!=="/"){const R=d.record.path,w=R[R.length-1]==="/"?"":"/";E.path=d.record.path+(S&&w+S)}if(_=yU(E,d,v),p?p.alias.push(_):(C=C||_,C!==_&&C.alias.push(_),g&&f.name&&!pE(_)&&a(f.name)),HD(_)&&l(_),y.children){const R=y.children;for(let w=0;w<R.length;w++)o(R[w],_,p&&p.children[w])}p=p||_}return C?()=>{a(C)}:Rc}function a(f){if(GD(f)){const d=i.get(f);d&&(i.delete(f),r.splice(r.indexOf(d),1),d.children.forEach(a),d.alias.forEach(a))}else{const d=r.indexOf(f);d>-1&&(r.splice(d,1),f.record.name&&i.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function u(){return r}function l(f){const d=xU(f,r);r.splice(d,0,f),f.record.name&&!pE(f)&&i.set(f.record.name,f)}function c(f,d){let p,g={},y,v;if("name"in f&&f.name){if(p=i.get(f.name),!p)throw ll(1,{location:f});v=p.record.name,g=zt(fE(d.params,p.keys.filter(C=>!C.optional).concat(p.parent?p.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),f.params&&fE(f.params,p.keys.map(C=>C.name))),y=p.stringify(g)}else if(f.path!=null)y=f.path,p=r.find(C=>C.re.test(y)),p&&(g=p.parse(y),v=p.record.name);else{if(p=d.name?i.get(d.name):r.find(C=>C.re.test(d.path)),!p)throw ll(1,{location:f,currentLocation:d});v=p.record.name,g=zt({},d.params,f.params),y=p.stringify(g)}const T=[];let _=p;for(;_;)T.unshift(_.record),_=_.parent;return{name:v,path:y,params:g,matched:T,meta:bU(T)}}n.forEach(f=>o(f));function h(){r.length=0,i.clear()}return{addRoute:o,resolve:c,removeRoute:a,clearRoutes:h,getRoutes:u,getRecordMatcher:s}}function fE(n,t){const r={};for(const i of t)i in n&&(r[i]=n[i]);return r}function dE(n){const t={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:_U(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function _U(n){const t={},r=n.props||!1;if("component"in n)t.default=r;else for(const i in n.components)t[i]=typeof r=="object"?r[i]:r;return t}function pE(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function bU(n){return n.reduce((t,r)=>zt(t,r.meta),{})}function gE(n,t){const r={};for(const i in n)r[i]=i in t?t[i]:n[i];return r}function xU(n,t){let r=0,i=t.length;for(;r!==i;){const o=r+i>>1;qD(n,t[o])<0?i=o:r=o+1}const s=wU(n);return s&&(i=t.lastIndexOf(s,i-1)),i}function wU(n){let t=n;for(;t=t.parent;)if(HD(t)&&qD(n,t)===0)return t}function HD({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function EU(n){const t={};if(n===""||n==="?")return t;const i=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<i.length;++s){const o=i[s].replace(OD," "),a=o.indexOf("="),u=uh(a<0?o:o.slice(0,a)),l=a<0?null:uh(o.slice(a+1));if(u in t){let c=t[u];xi(c)||(c=t[u]=[c]),c.push(l)}else t[u]=l}return t}function mE(n){let t="";for(let r in n){const i=n[r];if(r=G9(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(xi(i)?i.map(o=>o&&xy(o)):[i&&xy(i)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+r,o!=null&&(t+="="+o))})}return t}function SU(n){const t={};for(const r in n){const i=n[r];i!==void 0&&(t[r]=xi(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const CU=Symbol(""),yE=Symbol(""),Rg=Symbol(""),$1=Symbol(""),Ey=Symbol("");function ec(){let n=[];function t(i){return n.push(i),()=>{const s=n.indexOf(i);s>-1&&n.splice(s,1)}}function r(){n=[]}return{add:t,list:()=>n.slice(),reset:r}}function Hs(n,t,r,i,s,o=a=>a()){const a=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((u,l)=>{const c=d=>{d===!1?l(ll(4,{from:r,to:t})):d instanceof Error?l(d):lU(d)?l(ll(2,{from:t,to:d})):(a&&i.enterCallbacks[s]===a&&typeof d=="function"&&a.push(d),u())},h=o(()=>n.call(i&&i.instances[s],t,r,c));let f=Promise.resolve(h);n.length<3&&(f=f.then(c)),f.catch(d=>l(d))})}function zm(n,t,r,i,s=o=>o()){const o=[];for(const a of n)for(const u in a.components){let l=a.components[u];if(!(t!=="beforeRouteEnter"&&!a.instances[u]))if(MD(l)){const h=(l.__vccOpts||l)[t];h&&o.push(Hs(h,r,i,a,u,s))}else{let c=l();o.push(()=>c.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${u}" at "${a.path}"`);const f=R9(h)?h.default:h;a.mods[u]=h,a.components[u]=f;const p=(f.__vccOpts||f)[t];return p&&Hs(p,r,i,a,u,s)()}))}}return o}function vE(n){const t=ei(Rg),r=ei($1),i=gr(()=>{const l=Er(n.to);return t.resolve(l)}),s=gr(()=>{const{matched:l}=i.value,{length:c}=l,h=l[c-1],f=r.matched;if(!h||!f.length)return-1;const d=f.findIndex(ul.bind(null,h));if(d>-1)return d;const p=_E(l[c-2]);return c>1&&_E(h)===p&&f[f.length-1].path!==p?f.findIndex(ul.bind(null,l[c-2])):d}),o=gr(()=>s.value>-1&&kU(r.params,i.value.params)),a=gr(()=>s.value>-1&&s.value===r.matched.length-1&&$D(r.params,i.value.params));function u(l={}){if(DU(l)){const c=t[Er(n.replace)?"replace":"push"](Er(n.to)).catch(Rc);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:i,href:gr(()=>i.value.href),isActive:o,isExactActive:a,navigate:u}}function AU(n){return n.length===1?n[0]:n}const TU=D2({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:vE,setup(n,{slots:t}){const r=jh(vE(n)),{options:i}=ei(Rg),s=gr(()=>({[bE(n.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[bE(n.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const o=t.default&&AU(t.default(r));return n.custom?o:tA("a",{"aria-current":r.isExactActive?n.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},o)}}}),IU=TU;function DU(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const t=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return n.preventDefault&&n.preventDefault(),!0}}function kU(n,t){for(const r in t){const i=t[r],s=n[r];if(typeof i=="string"){if(i!==s)return!1}else if(!xi(s)||s.length!==i.length||i.some((o,a)=>o!==s[a]))return!1}return!0}function _E(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const bE=(n,t,r)=>n??t??r,NU=D2({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:t,slots:r}){const i=ei(Ey),s=gr(()=>n.route||i.value),o=ei(yE,0),a=gr(()=>{let c=Er(o);const{matched:h}=s.value;let f;for(;(f=h[c])&&!f.components;)c++;return c}),u=gr(()=>s.value.matched[a.value]);Qf(yE,gr(()=>a.value+1)),Qf(CU,u),Qf(Ey,s);const l=Ht();return co(()=>[l.value,u.value,n.name],([c,h,f],[d,p,g])=>{h&&(h.instances[f]=c,p&&p!==h&&c&&c===d&&(h.leaveGuards.size||(h.leaveGuards=p.leaveGuards),h.updateGuards.size||(h.updateGuards=p.updateGuards))),c&&h&&(!p||!ul(h,p)||!d)&&(h.enterCallbacks[f]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=s.value,h=n.name,f=u.value,d=f&&f.components[h];if(!d)return xE(r.default,{Component:d,route:c});const p=f.props[h],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,v=tA(d,zt({},g,t,{onVnodeUnmounted:T=>{T.component.isUnmounted&&(f.instances[h]=null)},ref:l}));return xE(r.default,{Component:v,route:c})||v}}});function xE(n,t){if(!n)return null;const r=n(t);return r.length===1?r[0]:r}const RU=NU;function FU(n){const t=vU(n.routes,n),r=n.parseQuery||EU,i=n.stringifyQuery||mE,s=n.history,o=ec(),a=ec(),u=ec(),l=UF(js);let c=js;du&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=jm.bind(null,ae=>""+ae),f=jm.bind(null,q9),d=jm.bind(null,uh);function p(ae,xe){let ce,he;return GD(ae)?(ce=t.getRecordMatcher(ae),he=xe):he=ae,t.addRoute(he,ce)}function g(ae){const xe=t.getRecordMatcher(ae);xe&&t.removeRoute(xe)}function y(){return t.getRoutes().map(ae=>ae.record)}function v(ae){return!!t.getRecordMatcher(ae)}function T(ae,xe){if(xe=zt({},xe||l.value),typeof ae=="string"){const X=Gm(r,ae,xe.path),V=t.resolve({path:X.path},xe),L=s.createHref(X.fullPath);return zt(X,V,{params:d(V.params),hash:uh(X.hash),redirectedFrom:void 0,href:L})}let ce;if(ae.path!=null)ce=zt({},ae,{path:Gm(r,ae.path,xe.path).path});else{const X=zt({},ae.params);for(const V in X)X[V]==null&&delete X[V];ce=zt({},ae,{params:f(X)}),xe.params=f(xe.params)}const he=t.resolve(ce,xe),ye=ae.hash||"";he.params=h(d(he.params));const G=K9(i,zt({},ae,{hash:j9(ye),path:he.path})),W=s.createHref(G);return zt({fullPath:G,hash:ye,query:i===mE?SU(ae.query):ae.query||{}},he,{redirectedFrom:void 0,href:W})}function _(ae){return typeof ae=="string"?Gm(r,ae,l.value.path):zt({},ae)}function C(ae,xe){if(c!==ae)return ll(8,{from:xe,to:ae})}function E(ae){return w(ae)}function S(ae){return E(zt(_(ae),{replace:!0}))}function R(ae){const xe=ae.matched[ae.matched.length-1];if(xe&&xe.redirect){const{redirect:ce}=xe;let he=typeof ce=="function"?ce(ae):ce;return typeof he=="string"&&(he=he.includes("?")||he.includes("#")?he=_(he):{path:he},he.params={}),zt({query:ae.query,hash:ae.hash,params:he.path!=null?{}:ae.params},he)}}function w(ae,xe){const ce=c=T(ae),he=l.value,ye=ae.state,G=ae.force,W=ae.replace===!0,X=R(ce);if(X)return w(zt(_(X),{state:typeof X=="object"?zt({},ye,X.state):ye,force:G,replace:W}),xe||ce);const V=ce;V.redirectedFrom=xe;let L;return!G&&Y9(i,he,ce)&&(L=ll(16,{to:V,from:he}),ue(he,he,!0,!1)),(L?Promise.resolve(L):A(V,he)).catch(z=>ts(z)?ts(z,2)?z:ie(z):ne(z,V,he)).then(z=>{if(z){if(ts(z,2))return w(zt({replace:W},_(z.to),{state:typeof z.to=="object"?zt({},ye,z.to.state):ye,force:G}),xe||V)}else z=N(V,he,!0,W,ye);return k(V,he,z),z})}function x(ae,xe){const ce=C(ae,xe);return ce?Promise.reject(ce):Promise.resolve()}function b(ae){const xe=ge.values().next().value;return xe&&typeof xe.runWithContext=="function"?xe.runWithContext(ae):ae()}function A(ae,xe){let ce;const[he,ye,G]=PU(ae,xe);ce=zm(he.reverse(),"beforeRouteLeave",ae,xe);for(const X of he)X.leaveGuards.forEach(V=>{ce.push(Hs(V,ae,xe))});const W=x.bind(null,ae,xe);return ce.push(W),Se(ce).then(()=>{ce=[];for(const X of o.list())ce.push(Hs(X,ae,xe));return ce.push(W),Se(ce)}).then(()=>{ce=zm(ye,"beforeRouteUpdate",ae,xe);for(const X of ye)X.updateGuards.forEach(V=>{ce.push(Hs(V,ae,xe))});return ce.push(W),Se(ce)}).then(()=>{ce=[];for(const X of G)if(X.beforeEnter)if(xi(X.beforeEnter))for(const V of X.beforeEnter)ce.push(Hs(V,ae,xe));else ce.push(Hs(X.beforeEnter,ae,xe));return ce.push(W),Se(ce)}).then(()=>(ae.matched.forEach(X=>X.enterCallbacks={}),ce=zm(G,"beforeRouteEnter",ae,xe,b),ce.push(W),Se(ce))).then(()=>{ce=[];for(const X of a.list())ce.push(Hs(X,ae,xe));return ce.push(W),Se(ce)}).catch(X=>ts(X,8)?X:Promise.reject(X))}function k(ae,xe,ce){u.list().forEach(he=>b(()=>he(ae,xe,ce)))}function N(ae,xe,ce,he,ye){const G=C(ae,xe);if(G)return G;const W=xe===js,X=du?history.state:{};ce&&(he||W?s.replace(ae.fullPath,zt({scroll:W&&X&&X.scroll},ye)):s.push(ae.fullPath,ye)),l.value=ae,ue(ae,xe,ce,W),ie()}let I;function j(){I||(I=s.listen((ae,xe,ce)=>{if(!we.listening)return;const he=T(ae),ye=R(he);if(ye){w(zt(ye,{replace:!0,force:!0}),he).catch(Rc);return}c=he;const G=l.value;du&&nU(aE(G.fullPath,ce.delta),Ng()),A(he,G).catch(W=>ts(W,12)?W:ts(W,2)?(w(zt(_(W.to),{force:!0}),he).then(X=>{ts(X,20)&&!ce.delta&&ce.type===lh.pop&&s.go(-1,!1)}).catch(Rc),Promise.reject()):(ce.delta&&s.go(-ce.delta,!1),ne(W,he,G))).then(W=>{W=W||N(he,G,!1),W&&(ce.delta&&!ts(W,8)?s.go(-ce.delta,!1):ce.type===lh.pop&&ts(W,20)&&s.go(-1,!1)),k(he,G,W)}).catch(Rc)}))}let Q=ec(),le=ec(),fe;function ne(ae,xe,ce){ie(ae);const he=le.list();return he.length?he.forEach(ye=>ye(ae,xe,ce)):console.error(ae),Promise.reject(ae)}function oe(){return fe&&l.value!==js?Promise.resolve():new Promise((ae,xe)=>{Q.add([ae,xe])})}function ie(ae){return fe||(fe=!ae,j(),Q.list().forEach(([xe,ce])=>ae?ce(ae):xe()),Q.reset()),ae}function ue(ae,xe,ce,he){const{scrollBehavior:ye}=n;if(!du||!ye)return Promise.resolve();const G=!ce&&iU(aE(ae.fullPath,0))||(he||!ce)&&history.state&&history.state.scroll||null;return eo().then(()=>ye(ae,xe,G)).then(W=>W&&rU(W)).catch(W=>ne(W,ae,xe))}const ee=ae=>s.go(ae);let ve;const ge=new Set,we={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:v,getRoutes:y,resolve:T,options:n,push:E,replace:S,go:ee,back:()=>ee(-1),forward:()=>ee(1),beforeEach:o.add,beforeResolve:a.add,afterEach:u.add,onError:le.add,isReady:oe,install(ae){const xe=this;ae.component("RouterLink",IU),ae.component("RouterView",RU),ae.config.globalProperties.$router=xe,Object.defineProperty(ae.config.globalProperties,"$route",{enumerable:!0,get:()=>Er(l)}),du&&!ve&&l.value===js&&(ve=!0,E(s.location).catch(ye=>{}));const ce={};for(const ye in js)Object.defineProperty(ce,ye,{get:()=>l.value[ye],enumerable:!0});ae.provide(Rg,xe),ae.provide($1,b2(ce)),ae.provide(Ey,l);const he=ae.unmount;ge.add(ae),ae.unmount=function(){ge.delete(ae),ge.size<1&&(c=js,I&&I(),I=null,l.value=js,ve=!1,fe=!1),he()}}};function Se(ae){return ae.reduce((xe,ce)=>xe.then(()=>b(ce)),Promise.resolve())}return we}function PU(n,t){const r=[],i=[],s=[],o=Math.max(t.matched.length,n.matched.length);for(let a=0;a<o;a++){const u=t.matched[a];u&&(n.matched.find(c=>ul(c,u))?i.push(u):r.push(u));const l=n.matched[a];l&&(t.matched.find(c=>ul(c,l))||s.push(l))}return[r,i,s]}function ks(){return ei(Rg)}function j1(n){return ei($1)}const Mn=(n,t)=>{const r=n.__vccOpts||n;for(const[i,s]of t)r[i]=s;return r},MU={key:0,class:"dropdown"},LU={key:0,class:"dropdown-menu"},OU={class:"dropdown-item user-info"},VU={key:1},BU={__name:"AuthButtons",props:{user:Object},setup(n){const t=ks(),r=Ht(!1);function i(){r.value=!r.value}function s(u){u.target.closest(".dropdown")||(r.value=!1)}async function o(){try{const u=new ls;await Z4(wn,u),t.push("/")}catch(u){console.error("Fout bij inloggen:",u)}}async function a(){try{await N4(wn),r.value=!1,t.push("/")}catch(u){console.error("Fout bij uitloggen:",u)}}return Ki(()=>{document.addEventListener("click",s)}),Sv(()=>{document.removeEventListener("click",s)}),(u,l)=>(Ge(),We("div",{class:"auth-buttons",onClick:l[0]||(l[0]=qh(()=>{},["stop"]))},[n.user?(Ge(),We("div",MU,[pe("button",{class:"action-button dropdown-toggle",title:"Accountopties",onClick:i,"aria-expanded":"isDropdownOpen"},l[1]||(l[1]=[pe("span",null,"",-1)])),r.value?(Ge(),We("div",LU,[pe("div",OU,At(n.user.displayName||n.user.email),1),pe("button",{class:"dropdown-item logout-button",onClick:a,title:"Uitloggen"},"Uitloggen")])):pr("",!0)])):(Ge(),We("div",VU,[pe("button",{class:"action-button login-button",onClick:o,title:"Inloggen"},l[2]||(l[2]=[pe("span",null,"",-1)]))]))]))}},wE=Mn(BU,[["__scopeId","data-v-13a312ac"]]),UU={id:"app"},$U={key:0,class:"auth-container"},jU={key:1},GU={class:"floating-action-bar"},zU={class:"counter"},qU={class:"counter"},HU={__name:"App",setup(n){const t=Ht(null);Ki(()=>{const a=k4(wn,async u=>{t.value=u,u&&(await new Promise(l=>setTimeout(l,100)),await r.loadTasks(),await i.loadGoals()),a()})});const r=kg(),i=uf();ks();const s=gr(()=>r.tasks.filter(a=>{const u=!a.dates||a.dates.length===0,l=!a.scheduledDates||a.scheduledDates.length===0;return u&&l}).length),o=gr(()=>i.activeGoalsCount);return(a,u)=>{const l=pP("router-view");return Ge(),We("div",UU,[t.value?(Ge(),We("div",jU,[Xr(wE,{user:t.value},null,8,["user"]),Xr(l),pe("div",GU,[pe("button",{class:"action-button add-task",onClick:u[0]||(u[0]=c=>a.$router.push("/add-task")),title:"Taak toevoegen"},u[5]||(u[5]=[pe("span",null,"+",-1)])),pe("button",{class:"action-button view-unplanned",onClick:u[1]||(u[1]=c=>a.$router.push("/unplanned-tasks")),title:"Ongeplande taken"},[u[6]||(u[6]=pe("span",null,"",-1)),pe("span",zU,At(s.value),1)]),pe("button",{class:"action-button view-goals",onClick:u[2]||(u[2]=c=>a.$router.push("/goals")),title:"Doelen overzicht"},[u[7]||(u[7]=pe("span",null,"",-1)),pe("span",qU,At(o.value),1)]),pe("button",{class:"action-button go-home",onClick:u[3]||(u[3]=c=>a.$router.push("/")),title:"Ga naar homescherm"},u[8]||(u[8]=[pe("span",null,"",-1)])),pe("button",{class:"action-button go-dashboard",onClick:u[4]||(u[4]=c=>a.$router.push("/dashboard")),title:"Ga naar dashboard"},u[9]||(u[9]=[pe("span",null,"",-1)]))])])):(Ge(),We("div",$U,[Xr(wE)]))])}}},WU=Mn(HU,[["__scopeId","data-v-b76d3aad"]]),KU={class:"week-navigation"},YU={__name:"WeekNavigation",props:["currentWeekStart","formatWeekRange","previousWeek","nextWeek"],setup(n){return(t,r)=>(Ge(),We("div",KU,[pe("button",{onClick:r[0]||(r[0]=(...i)=>n.previousWeek&&n.previousWeek(...i))},"Vorige week"),pe("span",null,At(n.formatWeekRange(n.currentWeekStart)),1),pe("button",{onClick:r[1]||(r[1]=(...i)=>n.nextWeek&&n.nextWeek(...i))},"Volgende week")]))}},XU=Mn(YU,[["__scopeId","data-v-c6fb034e"]]),ZU={class:"task-info"},QU=["checked","id"],JU=["for"],e7={key:0},t7={class:"task-actions"},r7={__name:"TaskItem",props:["task","date","getTaskPosition","getTaskSchedule","getTaskTimeKey"],setup(n){return(t,r)=>{var i;return Ge(),We("div",{class:"task",style:Uh(n.getTaskPosition(n.task,n.date)),draggable:"false"},[pe("div",{class:"task-edge top-edge",draggable:"true",onDragstart:r[0]||(r[0]=s=>t.$emit("dragStart",s,n.task,n.date,"top"))},null,32),pe("div",{class:"task-content",draggable:"true",onDragstart:r[5]||(r[5]=s=>t.$emit("dragStart",s,n.task,n.date,"middle"))},[pe("div",ZU,[pe("input",{type:"checkbox",checked:((i=n.getTaskSchedule(n.task,n.date))==null?void 0:i.completed)??!1,onChange:r[1]||(r[1]=s=>t.$emit("toggleCompletion",n.task,n.date)),id:"task-"+n.task.id+"-"+n.date},null,40,QU),pe("label",{for:"task-"+n.task.id+"-"+n.date,class:"task-name",onMouseover:r[2]||(r[2]=s=>t.$emit("showTooltip",s,n.task.name||"Onbekende taak"))},[Eu(At(n.task.name||"Onbekende taak")+" ",1),n.getTaskSchedule(n.task,n.date)?(Ge(),We("span",e7,At(n.getTaskSchedule(n.task,n.date).startTime)+" - "+At(n.getTaskSchedule(n.task,n.date).endTime),1)):pr("",!0)],40,JU)]),pe("div",t7,[pe("button",{class:"icon-button",onClick:r[3]||(r[3]=s=>t.$emit("editTask",n.task.id)),"aria-label":"Bewerk taak"},"  "),pe("button",{class:"icon-button",onClick:r[4]||(r[4]=s=>t.$emit("deleteInstance",n.task,n.date)),"aria-label":"Verwijder instantie"},"  ")])],32),pe("div",{class:"task-edge bottom-edge",draggable:"true",onDragstart:r[6]||(r[6]=s=>t.$emit("dragStart",s,n.task,n.date,"bottom"))},null,32)],4)}}},n7=Mn(r7,[["__scopeId","data-v-8876c54e"]]),i7={class:"day"},s7={class:"day-header"},o7={class:"day-actions"},a7=["data-hour"],u7={__name:"DayColumn",props:["day","hourLines","hourLinesRef","tasksForDay","getTaskPosition","getTaskSchedule","getTaskTimeKey","showTooltip","formatShortDate","hasDiaryEntry"],setup(n){return(t,r)=>(Ge(),We("div",i7,[pe("div",s7,[pe("h3",null,At(n.formatShortDate(n.day.date)),1),pe("div",o7,[pe("button",{class:$h(["icon-button",{"has-diary":n.hasDiaryEntry(n.day.date)}]),onClick:r[0]||(r[0]=i=>t.$emit("openDiary",n.day.date)),"aria-label":"Dagboek voor deze dag"},"  ",2)])]),pe("div",{class:"hour-lines",ref:n.hourLinesRef,onDragover:r[5]||(r[5]=qh(i=>t.$emit("dragOver",i,n.day.date),["prevent"])),onDrop:r[6]||(r[6]=i=>t.$emit("drop",i,n.day.date))},[(Ge(!0),We(Or,null,ji(n.hourLines,(i,s)=>(Ge(),We("div",{key:i,class:"hour-line","data-hour":i,style:Uh(`--hour-index: ${s}`)},At(i)+":00 ",13,a7))),128)),(Ge(!0),We(Or,null,ji(n.tasksForDay(n.day.date),i=>(Ge(),Tv(n7,{key:`${i.id}-${n.day.date}-${n.getTaskTimeKey(i,n.day.date)}`,task:i,date:n.day.date,getTaskPosition:n.getTaskPosition,getTaskSchedule:n.getTaskSchedule,getTaskTimeKey:n.getTaskTimeKey,onDragStart:r[1]||(r[1]=(s,o,a,u)=>t.$emit("dragStart",s,o,a,u)),onToggleCompletion:r[2]||(r[2]=(s,o)=>t.$emit("toggleCompletion",s,o)),onDeleteInstance:r[3]||(r[3]=(s,o)=>t.$emit("deleteInstance",s,o)),onShowTooltip:n.showTooltip,onEditTask:r[4]||(r[4]=s=>t.$emit("editTask",s))},null,8,["task","date","getTaskPosition","getTaskSchedule","getTaskTimeKey","onShowTooltip"]))),128))],544)]))}},l7=Mn(u7,[["__scopeId","data-v-7590fa5d"]]),c7={class:"home"},h7={class:"week"},f7={__name:"Home",setup(n){const t=kg(),r=ks(),i=Ht(new Date().toISOString().split("T")[0]),s=Ht([]),o=Ht(null),a=Ht(null),u=Ht({}),l=Ht(null),c=Ht(0),h=Ht(0),f=Ht(null),d=Ht(0),p=Ht(new Map),g=[],y=gr(()=>{const ne=[],oe=new Date(i.value);for(let ie=0;ie<7;ie++){const ue=new Date(oe);ue.setDate(oe.getDate()+ie),ne.push({date:ue.toISOString().split("T")[0],dayOfWeek:ue.getDay()})}return ne}),v=gr(()=>{const ne=[];for(let oe=0;oe<=23;oe++)ne.push(oe.toString().padStart(2,"0"));return ne});Ki(async()=>{await t.loadTasks();const ne=new Date,oe=ne.getDay(),ie=ne.getDate()-oe+(oe===0?-6:1),ue=new Date(ne.setDate(ie));i.value=ue.toISOString().split("T")[0],eo(()=>{y.value.forEach((ee,ve)=>{const ge=g[ve];if(ge){const we=ge.querySelectorAll(".hour-line");u.value[ve]={},we.forEach(Se=>{const ae=Se.getAttribute("data-hour");u.value[ve][ae]=Se.offsetTop})}})});try{let ee=wn.currentUser;if(ee||await new Promise(ve=>{const ge=wn.onAuthStateChanged(we=>{ee=we,ge(),ve()})}),ee){const ve=ol(ys(bn,"diaryEntries"),ro("userId","==",ee.uid)),ge=await al(ve);s.value=ge.docs.map(we=>({id:we.id,...we.data()}))}else s.value=[]}catch(ee){console.error("Fout bij het laden van dagboekvermeldingen:",ee),s.value=[]}}),co([()=>t.tasks,i],()=>{p.value.clear(),eo(()=>{y.value.forEach((ne,oe)=>{const ie=g[oe];if(ie){const ue=ie.querySelectorAll(".hour-line");u.value[oe]={},ue.forEach(ee=>{const ve=ee.getAttribute("data-hour");u.value[oe][ve]=ee.offsetTop})}})})},{deep:!0});const T=gr(()=>ne=>{if(!p.value.has(ne)){const oe=t.tasks.map((ie,ue)=>({...ie,originalIndex:ue})).filter(ie=>ie.type==="one-time"&&ie.dates&&ie.dates.includes(ne)?!0:!!(ie.type==="recurring"&&ie.scheduledDates&&ie.scheduledDates.some(ue=>ue.date===ne)));p.value.set(ne,oe)}return p.value.get(ne)}),_=ne=>s.value.find(oe=>{var ie;return oe.date===ne&&((ie=oe.content)==null?void 0:ie.trim())})!==void 0,C=ne=>{const oe=new Date(ne);return oe.setDate(new Date(ne).getDate()+6),`${new Date(ne).toLocaleDateString("nl-NL",{day:"numeric",month:"long"})} - ${oe.toLocaleDateString("nl-NL",{day:"numeric",month:"long",year:"numeric"})}`},E=ne=>{const oe=new Date(ne),ie=oe.getDate(),ue=new Intl.DateTimeFormat("nl-NL",{weekday:"short"}).format(oe).slice(0,2).toLowerCase();return`${ie} (${ue})`},S=()=>{const ne=new Date(i.value);ne.setDate(ne.getDate()-7),i.value=ne.toISOString().split("T")[0]},R=()=>{const ne=new Date(i.value);ne.setDate(ne.getDate()+7),i.value=ne.toISOString().split("T")[0]},w=(ne,oe)=>{const ie=ne.target;ie.scrollWidth>ie.clientWidth?ie.setAttribute("title",oe):ie.removeAttribute("title")},x=(ne,oe)=>{var ee,ve;const ie=(ee=ne.scheduledDates)==null?void 0:ee.find(ge=>ge.date===oe);if(ie)return{...ie};const ue=(ve=ne.timesByDate)==null?void 0:ve[oe];return ue?{...ue}:null},b=(ne,oe)=>{const ie=x(ne,oe);return ie?`${ie.startTime}-${ie.endTime}`:"00:00-00:00"},A=(ne,oe)=>{const ie=x(ne,oe);if(!ie||!ie.startTime||!ie.endTime)return{top:"0em",height:"1.5em",background:"rgba(255, 0, 0, 0.2)"};const ue=y.value.findIndex(z=>z.date===oe),ee=u.value[ue]||{};if(Object.keys(ee).length===0)return{top:"0em",height:"1.5em",background:"rgba(255, 0, 0, 0.2)"};const[ve,ge]=ie.startTime.split(":").map(Number),[we,Se]=ie.endTime.split(":").map(Number),ae=ve.toString().padStart(2,"0"),xe=we.toString().padStart(2,"0"),ce=ee[ae]||0;ee[xe];const he=ee["01"]-ee["00"]||32,ye=ge/60*he,G=ce+ye,W=ve*60+ge,L=(we*60+Se-W)/60*he;return{top:`${G}px`,height:`${L}px`,background:"rgba(0, 255, 0, 0.2)"}};function k(ne){r.push(`/diary/${ne}`)}function N(ne){r.push(`/edit-task/${ne}`)}const I=(ne,oe,ie,ue)=>{o.value=oe,a.value=ie,l.value=ne.target.closest(".task"),f.value=ue,d.value=l.value?l.value.offsetHeight:0;const ee=new Image;if(ee.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",ne.dataTransfer.setDragImage(ee,0,0),l.value){const ve=l.value.getBoundingClientRect();h.value=ue==="bottom"?ve.bottom-ne.clientY:ne.clientY-ve.top,l.value.style.opacity="0.5"}ne.dataTransfer.setData("text/plain",oe.id.toString())},j=(ne,oe)=>{if(ne.preventDefault(),o.value&&l.value){const ie=ne.currentTarget,ue=ie.getBoundingClientRect(),ee=ie.querySelector(".hour-line"),ve=ee?ee.offsetHeight:32,ge=ne.clientY-ue.top+ie.scrollTop;let we,Se;const ae=y.value.findIndex(L=>L.date===oe),xe=u.value[ae]||{},ce=x(o.value,a.value),[he,ye]=ce?ce.startTime.split(":").map(Number):[0,0],[G,W]=ce?ce.endTime.split(":").map(Number):[1,0],X=xe[he.toString().padStart(2,"0")]+ye/60*ve,V=(G*60+W-(he*60+ye))/60*ve;f.value==="top"?(we=Math.max(0,ge-h.value),Se=Math.max(32,V+(X-we))):f.value==="bottom"?(we=X,Se=Math.max(32,ge+h.value-X)):f.value==="middle"&&(we=Math.max(0,ge-h.value),Se=V),l.value.style.top=`${we}px`,l.value.style.height=`${Se}px`,l.value.style.left="60px",c.value=we}},Q=async(ne,oe)=>{if(!o.value||!a.value)return;const ie=ne.currentTarget,ue=ie.querySelector(".hour-line"),ee=ue?ue.offsetHeight:32,ve=ie.getBoundingClientRect(),ge=ne.clientY-ve.top+ie.scrollTop-h.value,we=Math.floor(ge/ee),Se=Math.round(ge%ee/ee*60),ae=Math.min(23,Math.max(0,we)),xe=Math.min(59,Math.max(0,Se)),ce=`${ae.toString().padStart(2,"0")}:${xe.toString().padStart(2,"0")}`,he=x(o.value,a.value),ye=he?he.startTime:"00:00",G=he?he.endTime:"01:00",[W,X]=ye.split(":").map(Number),[V,L]=G.split(":").map(Number);let z,J;if(f.value==="top")z=ce,J=G;else if(f.value==="bottom")J=ce,z=ye;else if(f.value==="middle"){z=ce;const te=ae*60+xe,me=V*60+L-(W*60+X),Ee=te+me,Ce=Math.floor(Ee/60)%24,Fe=Ee%60;J=`${Ce.toString().padStart(2,"0")}:${Fe.toString().padStart(2,"0")}`}const re={...o.value};if(re.scheduledDates){const te=re.scheduledDates.map(me=>me.date===oe?{...me,startTime:z,endTime:J}:me);re.scheduledDates=te}else re.timesByDate?re.timesByDate={...re.timesByDate,[oe]:{startTime:z,endTime:J}}:(re.scheduledDates=[{date:oe,startTime:z,endTime:J}],re.type="recurring");oe!==a.value&&(re.type==="one-time"&&(re.dates=re.dates?re.dates.filter(te=>te!==a.value):[],re.dates.push(oe)),re.scheduledDates?(re.scheduledDates=re.scheduledDates.filter(te=>te.date!==a.value),re.scheduledDates.push({date:oe,startTime:z,endTime:J})):re.timesByDate&&(delete re.timesByDate[a.value],re.timesByDate[oe]={startTime:z,endTime:J})),await t.updateTask(o.value.id,re),p.value.clear(),l.value&&(l.value.style.opacity="1"),o.value=null,a.value=null,l.value=null,h.value=0,f.value=null,d.value=0},le=async(ne,oe)=>{const ie=ne.id;await t.toggleTaskInstanceCompletion(ie,oe),p.value.clear(),await eo()},fe=async(ne,oe)=>{const ie=ne.id;await t.deleteTaskInstance(ie,oe),p.value.clear(),await eo()};return(ne,oe)=>(Ge(),We("div",c7,[oe[0]||(oe[0]=pe("h1",null,"Weekoverzicht",-1)),Xr(XU,{currentWeekStart:i.value,formatWeekRange:C,previousWeek:S,nextWeek:R},null,8,["currentWeekStart"]),pe("div",h7,[(Ge(!0),We(Or,null,ji(y.value,(ie,ue)=>(Ge(),Tv(l7,{key:ie.date,day:ie,hourLines:v.value,hourLinesRef:ee=>g[ue]=ee,tasksForDay:T.value,getTaskPosition:A,getTaskSchedule:x,getTaskTimeKey:b,showTooltip:w,formatShortDate:E,hasDiaryEntry:_,onOpenDiary:k,onDragOver:j,onDrop:Q,onDragStart:I,onToggleCompletion:le,onDeleteInstance:fe,onEditTask:N},null,8,["day","hourLines","hourLinesRef","tasksForDay"]))),128))])]))}},d7=Mn(f7,[["__scopeId","data-v-e04cbfd8"]]),p7={class:"unplanned-tasks"},g7={key:0},m7={key:0,class:"task-list"},y7={class:"task-info"},v7=["onMouseover"],_7={class:"task-actions"},b7=["onClick"],x7=["onClick"],w7={key:1},E7={key:1},S7={__name:"UnplannedTasks",setup(n){const t=kg();ks();const r=Ht(!1);Ki(()=>{t.loadTasks().then(()=>{r.value=!0}).catch(a=>{console.error("Fout bij het laden van taken:",a),r.value=!0})});const i=gr(()=>!r.value||!t.tasks?[]:t.tasks.map((a,u)=>({...a,originalIndex:u})).filter(a=>{const u=!a.dates||a.dates.length===0,l=!a.scheduledDates||a.scheduledDates.length===0;return u&&l})),s=a=>a.replace(/<!--|-->/g,"").trim(),o=(a,u)=>{const l=a.target,c=s(u);l.scrollWidth>l.clientWidth?l.setAttribute("title",c):l.removeAttribute("title")};return(a,u)=>(Ge(),We("div",p7,[u[0]||(u[0]=pe("h1",null,"Ongeplande Taken",-1)),r.value?(Ge(),We("div",g7,[i.value.length?(Ge(),We("div",m7,[pe("ul",null,[(Ge(!0),We(Or,null,ji(i.value,l=>(Ge(),We("li",{key:l.id},[pe("div",y7,[pe("span",{class:"task-name",onMouseover:c=>o(c,l.name||"Onbekende taak")},At(l.name||"Onbekende taak")+" ("+At(l.type==="one-time"?"Eenmalig":"Terugkerend")+") ",41,v7)]),pe("div",_7,[pe("button",{class:"icon-button",onClick:c=>a.$router.push(`/edit-task/${l.id}`),"aria-label":"Bewerk taak"},"  ",8,b7),pe("button",{class:"icon-button",onClick:c=>Er(t).deleteTask(l.id),"aria-label":"Verwijder taak"},"  ",8,x7)])]))),128))])])):(Ge(),We("p",w7,"Geen ongeplande taken."))])):(Ge(),We("p",E7,"Laden..."))]))}},C7=Mn(S7,[["__scopeId","data-v-8313d09e"]]),A7={class:"add-task"},T7={class:"form-group"},I7={class:"form-group"},D7={key:0,class:"form-group"},k7={key:1},N7={class:"form-group"},R7={class:"form-group"},F7={class:"form-group"},P7={key:0,class:"form-group"},M7=["onUpdate:modelValue"],L7=["onClick","disabled"],O7={key:2,class:"form-group"},V7={key:3,class:"form-group"},B7={class:"form-group"},U7={class:"form-actions"},$7={__name:"AddTask",setup(n){const t=kg(),r=ks(),i=Ht({name:"",type:"one-time",date:"",startDate:"",endDate:"",frequency:"daily",startTime:"",endTime:"",tagsInput:"",completed:!1,customDates:[""]}),s=async()=>{if(!i.value.name.trim()||i.value.name.includes("<!--")){alert("Taaknaam mag niet leeg zijn en geen ongeldige HTML bevatten (bijv. <!--).");return}const u={name:i.value.name.trim(),type:i.value.type,completed:i.value.completed,tags:i.value.tagsInput?i.value.tagsInput.split(",").map(c=>c.trim()).filter(c=>c):[]};if(u.type==="one-time")if(!i.value.date)u.dates=[],u.timesByDate={};else{if(!i.value.startTime||!i.value.endTime){alert("Starttijd en eindtijd zijn verplicht als er een datum is opgegeven.");return}u.dates=[i.value.date],u.timesByDate={[i.value.date]:{startTime:i.value.startTime,endTime:i.value.endTime}}}else if(u.type==="recurring"){if(!i.value.startDate&&i.value.frequency!=="custom"){alert("Startdatum is verplicht voor een terugkerende taak (behalve bij 'Aangepast').");return}if((i.value.startDate||i.value.customDates.some(c=>c))&&(!i.value.startTime||!i.value.endTime)){alert("Starttijd en eindtijd zijn verplicht als er een datum is opgegeven.");return}u.startDate=i.value.startDate,u.endDate=i.value.endDate,u.frequency=i.value.frequency,u.scheduledDates=l()}await t.addTask(u),r.push("/");function l(){const c=[];if(i.value.frequency==="custom")i.value.customDates.forEach(h=>{h&&c.push({date:h,startTime:i.value.startTime||"09:00",endTime:i.value.endTime||"10:00"})});else{const h=new Date(i.value.startDate),f=i.value.endDate?new Date(i.value.endDate):new Date(h.getFullYear()+1,h.getMonth(),h.getDate());let d=new Date(h);for(;d<=f;)if(c.push({date:d.toISOString().split("T")[0],startTime:i.value.startTime||"09:00",endTime:i.value.endTime||"10:00"}),i.value.frequency==="daily")d.setDate(d.getDate()+1);else if(i.value.frequency==="weekly")d.setDate(d.getDate()+7);else if(i.value.frequency==="monthly"&&(d.setMonth(d.getMonth()+1),d.setDate(h.getDate()),d>f))break}return c}},o=()=>{i.value.customDates.push("")},a=u=>{i.value.customDates.splice(u,1)};return(u,l)=>(Ge(),We("div",A7,[l[23]||(l[23]=pe("h1",null,"Taak toevoegen",-1)),pe("form",{onSubmit:qh(s,["prevent"]),class:"task-form"},[pe("div",T7,[l[10]||(l[10]=pe("label",{for:"name"},"Taaknaam:",-1)),cr(pe("input",{id:"name","onUpdate:modelValue":l[0]||(l[0]=c=>i.value.name=c),type:"text",required:"",placeholder:"Voer de naam van de taak in"},null,512),[[xr,i.value.name]])]),pe("div",I7,[l[12]||(l[12]=pe("label",{for:"type"},"Type:",-1)),cr(pe("select",{id:"type","onUpdate:modelValue":l[1]||(l[1]=c=>i.value.type=c),required:""},l[11]||(l[11]=[pe("option",{value:"one-time"},"Eenmalig",-1),pe("option",{value:"recurring"},"Herhalend",-1)]),512),[[O0,i.value.type]])]),i.value.type==="one-time"?(Ge(),We("div",D7,[l[13]||(l[13]=pe("label",{for:"date"},"Datum (optioneel):",-1)),cr(pe("input",{id:"date","onUpdate:modelValue":l[2]||(l[2]=c=>i.value.date=c),type:"date"},null,512),[[xr,i.value.date]])])):pr("",!0),i.value.type==="recurring"?(Ge(),We("div",k7,[pe("div",N7,[l[14]||(l[14]=pe("label",{for:"startDate"},"Startdatum:",-1)),i.value.frequency!=="custom"?cr((Ge(),We("input",{key:0,id:"startDate","onUpdate:modelValue":l[3]||(l[3]=c=>i.value.startDate=c),type:"date",required:""},null,512)),[[xr,i.value.startDate]]):pr("",!0)]),pe("div",R7,[l[15]||(l[15]=pe("label",{for:"endDate"},"Einddatum (optioneel):",-1)),i.value.frequency!=="custom"?cr((Ge(),We("input",{key:0,id:"endDate","onUpdate:modelValue":l[4]||(l[4]=c=>i.value.endDate=c),type:"date"},null,512)),[[xr,i.value.endDate]]):pr("",!0)]),pe("div",F7,[l[17]||(l[17]=pe("label",{for:"frequency"},"Frequentie:",-1)),cr(pe("select",{id:"frequency","onUpdate:modelValue":l[5]||(l[5]=c=>i.value.frequency=c),required:""},l[16]||(l[16]=[pe("option",{value:"daily"},"Dagelijks",-1),pe("option",{value:"weekly"},"Wekelijks",-1),pe("option",{value:"monthly"},"Maandelijks",-1),pe("option",{value:"custom"},"Aangepast",-1)]),512),[[O0,i.value.frequency]])]),i.value.frequency==="custom"?(Ge(),We("div",P7,[l[18]||(l[18]=pe("label",null,"Aangepaste datums:",-1)),(Ge(!0),We(Or,null,ji(i.value.customDates,(c,h)=>(Ge(),We("div",{key:h,class:"custom-date-input"},[cr(pe("input",{"onUpdate:modelValue":f=>i.value.customDates[h]=f,type:"date",required:""},null,8,M7),[[xr,i.value.customDates[h]]]),pe("button",{type:"button",class:"remove-date",onClick:f=>a(h),disabled:i.value.customDates.length<=1},"Verwijder",8,L7)]))),128)),pe("button",{type:"button",class:"add-date",onClick:o},"Datum toevoegen")])):pr("",!0)])):pr("",!0),i.value.type==="one-time"&&i.value.date||i.value.type==="recurring"?(Ge(),We("div",O7,[l[19]||(l[19]=pe("label",{for:"startTime"},"Starttijd:",-1)),cr(pe("input",{id:"startTime","onUpdate:modelValue":l[6]||(l[6]=c=>i.value.startTime=c),type:"time",required:""},null,512),[[xr,i.value.startTime]])])):pr("",!0),i.value.type==="one-time"&&i.value.date||i.value.type==="recurring"?(Ge(),We("div",V7,[l[20]||(l[20]=pe("label",{for:"endTime"},"Eindtijd:",-1)),cr(pe("input",{id:"endTime","onUpdate:modelValue":l[7]||(l[7]=c=>i.value.endTime=c),type:"time",required:""},null,512),[[xr,i.value.endTime]])])):pr("",!0),pe("div",B7,[l[21]||(l[21]=pe("label",{for:"tags"},"Tags (door komma's gescheiden):",-1)),cr(pe("input",{id:"tags","onUpdate:modelValue":l[8]||(l[8]=c=>i.value.tagsInput=c),type:"text",placeholder:"Voer tags in"},null,512),[[xr,i.value.tagsInput]])]),pe("div",U7,[l[22]||(l[22]=pe("button",{type:"submit",title:"Taak opslaan"},"Opslaan",-1)),pe("button",{type:"button",onClick:l[9]||(l[9]=c=>u.$router.push("/")),title:"Annuleren"},"Annuleren")])],32)]))}},j7=Mn($7,[["__scopeId","data-v-60dd355e"]]),G7={class:"edit-goal"},z7={key:0,class:"loading"},q7={key:1,class:"error"},H7={key:2,class:"error"},W7={key:3,class:"goal-form"},K7={class:"form-group"},Y7={class:"form-group"},X7={class:"form-group"},Z7={class:"form-actions"},Q7={__name:"EditTask",setup(n){const t=uf(),r=ks(),i=j1(),s=Ht(null);Ki(async()=>{await t.loadGoals();const a=i.params.id,u=t.goals.find(l=>l.id===a);u?s.value={...u,deadline:u.deadline||""}:t.error="Doel niet gevonden"});async function o(){if(!s.value.title){t.error="Titel is verplicht";return}await t.updateGoal(i.params.id,s.value),t.error||r.push("/goals")}return(a,u)=>(Ge(),We("div",G7,[u[9]||(u[9]=pe("h1",null,"Doel Bewerken",-1)),Er(t).isLoading?(Ge(),We("div",z7,"Laden...")):Er(t).error?(Ge(),We("div",q7,At(Er(t).error),1)):s.value?(Ge(),We("div",W7,[pe("div",K7,[u[4]||(u[4]=pe("label",{for:"title"},"Titel",-1)),cr(pe("input",{"onUpdate:modelValue":u[0]||(u[0]=l=>s.value.title=l),id:"title",type:"text",placeholder:"Voer de titel van het doel in",required:""},null,512),[[xr,s.value.title]])]),pe("div",Y7,[u[5]||(u[5]=pe("label",{for:"description"},"Beschrijving",-1)),cr(pe("textarea",{"onUpdate:modelValue":u[1]||(u[1]=l=>s.value.description=l),id:"description",placeholder:"Voer een beschrijving in",rows:"5"},null,512),[[xr,s.value.description]])]),pe("div",X7,[u[6]||(u[6]=pe("label",{for:"deadline"},"Deadline",-1)),cr(pe("input",{"onUpdate:modelValue":u[2]||(u[2]=l=>s.value.deadline=l),id:"deadline",type:"date"},null,512),[[xr,s.value.deadline]])]),pe("div",Z7,[pe("button",{class:"action-button",onClick:o,title:"Doel opslaan"},u[7]||(u[7]=[pe("span",null,"",-1)])),pe("button",{class:"action-button cancel",onClick:u[3]||(u[3]=l=>a.$router.push("/goals")),title:"Annuleren"},u[8]||(u[8]=[pe("span",null,"",-1)]))])])):(Ge(),We("div",H7,"Doel niet gevonden"))]))}},J7=Mn(Q7,[["__scopeId","data-v-b159fcd4"]]),e$={class:"diary"},t$={class:"form-group"},r$={class:"form-group"},n$={class:"form-group"},i$={class:"form-group"},s$=["value"],o$={class:"form-group"},a$={class:"form-group"},u$={class:"motto-input-container"},l$={class:"mottos-list"},c$=["onClick"],h$=["disabled"],f$={key:0,class:"saved-message"},d$={__name:"Diary",setup(n){const t=j1();ks();const r=Ht(t.params.date||new Date().toISOString().split("T")[0]),i=Ht({date:"",content:"",limitingThoughts:"",focusThoughts:"",mood:"",tags:"",neverForget:[]}),s=Ht(""),o=Ht(""),a=Ht(!1);Ki(()=>{u()}),co(()=>t.params.date,d=>{r.value=d||new Date().toISOString().split("T")[0],u()});const u=async()=>{a.value=!0;try{const d=wn.currentUser;if(!d){i.value={date:r.value,content:"",limitingThoughts:"",focusThoughts:"",mood:"",tags:"",neverForget:[]};return}const p=ol(ys(bn,"diaryEntries"),ro("userId","==",d.uid),ro("date","==",r.value)),g=await al(p);if(g.empty)i.value={date:r.value,content:"",limitingThoughts:"",focusThoughts:"",mood:"",tags:"",neverForget:[]};else{const y=g.docs[0].data();i.value={...y,id:g.docs[0].id},i.value.neverForget||(i.value.neverForget=[])}}catch(d){console.error("Fout bij het laden van dagboekvermelding:",d)}finally{a.value=!1}},l=async()=>{if(!a.value){a.value=!0;try{const d=wn.currentUser;if(!d)throw new Error("Niet ingelogd");const p={...i.value,date:r.value,userId:d.uid};p.neverForget=p.neverForget.filter(v=>v&&v.trim());const g=ol(ys(bn,"diaryEntries"),ro("userId","==",d.uid),ro("date","==",r.value)),y=await al(g);if(y.empty)await O1(ys(bn,"diaryEntries"),p);else{const v=y.docs[0];await L1(sl(bn,"diaryEntries",v.id),p)}o.value="Dagboekvermelding opgeslagen!",setTimeout(()=>o.value="",2e3)}catch(d){console.error("Fout bij het opslaan van dagboekvermelding:",d),o.value="Fout bij opslaan, probeer het opnieuw.",setTimeout(()=>o.value="",2e3)}finally{a.value=!1}}},c=()=>{s.value.trim()&&!a.value&&(i.value.neverForget.push(s.value.trim()),s.value="")},h=d=>{a.value||i.value.neverForget.splice(d,1)},f=d=>new Date(d).toLocaleDateString("nl-NL",{day:"numeric",month:"long",year:"numeric"});return(d,p)=>(Ge(),We("div",e$,[pe("h1",null,"Dagboek - "+At(f(r.value)),1),pe("form",{onSubmit:qh(l,["prevent"])},[pe("div",t$,[p[6]||(p[6]=pe("label",{for:"content"},"Inhoud:",-1)),cr(pe("textarea",{id:"content","onUpdate:modelValue":p[0]||(p[0]=g=>i.value.content=g),placeholder:"Schrijf hier je gedachten...",rows:"5",required:""},null,512),[[xr,i.value.content]])]),pe("div",r$,[p[7]||(p[7]=pe("label",{for:"limitingThoughts"},"Beperkende gedachten:",-1)),cr(pe("textarea",{id:"limitingThoughts","onUpdate:modelValue":p[1]||(p[1]=g=>i.value.limitingThoughts=g),placeholder:"Schrijf hier je beperkende gedachten...",rows:"3"},null,512),[[xr,i.value.limitingThoughts]])]),pe("div",n$,[p[8]||(p[8]=pe("label",{for:"focusThoughts"},"Gedachten om op te focussen:",-1)),cr(pe("textarea",{id:"focusThoughts","onUpdate:modelValue":p[2]||(p[2]=g=>i.value.focusThoughts=g),placeholder:"Schrijf hier je positieve gedachten...",rows:"3"},null,512),[[xr,i.value.focusThoughts]])]),pe("div",i$,[p[10]||(p[10]=pe("label",{for:"mood"},"Stemming (1-5):",-1)),cr(pe("select",{id:"mood","onUpdate:modelValue":p[3]||(p[3]=g=>i.value.mood=g),required:""},[p[9]||(p[9]=pe("option",{value:"",disabled:""},"Selecteer een stemming",-1)),(Ge(),We(Or,null,ji(5,g=>pe("option",{key:g,value:g},At(g),9,s$)),64))],512),[[O0,i.value.mood]])]),pe("div",o$,[p[11]||(p[11]=pe("label",{for:"tags"},"Tags (gescheiden door komma's):",-1)),cr(pe("input",{id:"tags","onUpdate:modelValue":p[4]||(p[4]=g=>i.value.tags=g),type:"text",placeholder:"bijv. werk, familie, vakantie"},null,512),[[xr,i.value.tags]])]),pe("div",a$,[p[14]||(p[14]=pe("label",null,"Lijfspreuken:",-1)),pe("div",u$,[cr(pe("input",{"onUpdate:modelValue":p[5]||(p[5]=g=>s.value=g),type:"text",placeholder:"Voeg een lijfspreuk toe...",onKeypress:DM(c,["enter"])},null,544),[[xr,s.value]]),pe("button",{type:"button",onClick:c,class:"action-button add-motto"},p[12]||(p[12]=[pe("span",null,"+",-1)]))]),pe("ul",l$,[(Ge(!0),We(Or,null,ji(i.value.neverForget,(g,y)=>(Ge(),We("li",{key:y,class:"motto-item"},[Eu(At(g)+" ",1),pe("button",{type:"button",onClick:v=>h(y),class:"action-button trash"},p[13]||(p[13]=[pe("span",null,"",-1)]),8,c$)]))),128))])]),pe("button",{type:"submit",class:"save-button",disabled:a.value},"Opslaan",8,h$)],32),o.value?(Ge(),We("div",f$,At(o.value),1)):pr("",!0)]))}},p$=Mn(d$,[["__scopeId","data-v-b924abdb"]]),Ga=Math.PI,WD="2.0.3",Ta="p2d",g$="p2d-hdr",To="webgl",Ir="webgl2",KD="default",Sy="simple",Cy="full",YD="crosshair",XD="pointer",ZD="move",QD="text",JD="wait",Yo=Ga/2,Ay=Ga,m$=Ga/4,y$=Ga*2,pn=Ga*2,Xo=Ga/180,Zo=180/Ga,qn="corner",ch="corners",hh="radius",ap="right",e5="left",Dn="center",v$="top",Ty="bottom",t5="alphabetic",up=0,cl=1,_$=3,b$=2,Nu=4,Fg=6,fh=5,Pc="quads",dh="quad_strip",x$="tess",Ru=7,vi=8,ph="close",Ia="open",lp="chord",gh="pie",G1="square",z1="butt",yo="round",q1="bevel",H1="miter",r5="auto",w$="Alt",E$="Backspace",S$="Control",C$="Delete",A$="ArrowDown",T$="Enter",I$="Escape",D$="ArrowLeft",k$="Alt",N$="Enter",R$="ArrowRight",F$="Shift",P$="Tab",M$="ArrowUp",vn="source-over",Da="destination-out",mh="lighter",Pg="darken",Mg="lighten",n5="difference",Lg="subtract",Og="exclusion",Vg="multiply",Bg="screen",Ug="copy",W1="overlay",K1="hard-light",Y1="soft-light",X1="color-dodge",Z1="color-burn",$g="threshold",Q1="gray",J1="opaque",e_="invert",jg="posterize",t_="dilate",r_="erode",hl="blur",Ri="normal",L$="italic",O$="bold",V$="bold italic",B$="CHAR",i5="WORD",U$="#000000",$$=1.25,j$="middle",Iy="linear",G$="quadratic",z$="bezier",q$="curve",H$="stroke",cp="fill",hp="texture",W$="immediate",Gg="image",s5="nearest",Dy="repeat",ky="clamp",Ny="mirror",o5="flat",a5="smooth",K$="landscape",Y$="portrait",u5="#000000",l5="#FFFFFF",c5="grid",h5="axes",X$="label",Z$="fallback",f5="contain",d5="cover",Qs="unsigned-byte",Mc="unsigned-int",An="float",pu="half-float",Fu=Symbol("include"),mu=Symbol("exclude"),Ry=Symbol("join");var ka=Object.freeze({__proto__:null,ADD:mh,ALT:w$,ARROW:KD,AUTO:r5,AXES:h5,BACKSPACE:E$,BASELINE:t5,BEVEL:q1,BEZIER:z$,BLEND:vn,BLUR:hl,BOLD:O$,BOLDITALIC:V$,BOTTOM:Ty,BURN:Z1,CENTER:Dn,CHAR:B$,CHORD:lp,CLAMP:ky,CLOSE:ph,CONTAIN:f5,CONTROL:S$,CORNER:qn,CORNERS:ch,COVER:d5,CROSS:YD,CURVE:q$,DARKEST:Pg,DEG_TO_RAD:Xo,DELETE:C$,DIFFERENCE:n5,DILATE:t_,DODGE:X1,DOWN_ARROW:A$,EMPTY_PATH:Ru,ENTER:T$,ERODE:r_,ESCAPE:I$,EXCLUDE:mu,EXCLUSION:Og,FALLBACK:Z$,FILL:cp,FLAT:o5,FLOAT:An,FULL:Cy,GRAY:Q1,GRID:c5,HALF_FLOAT:pu,HALF_PI:Yo,HAND:XD,HARD_LIGHT:K1,IMAGE:Gg,IMMEDIATE:W$,INCLUDE:Fu,INVERT:e_,ITALIC:L$,JOIN:Ry,LABEL:X$,LANDSCAPE:K$,LEFT:e5,LEFT_ARROW:D$,LIGHTEST:Mg,LINEAR:Iy,LINES:cl,LINE_LOOP:b$,LINE_STRIP:_$,MIRROR:Ny,MITER:H1,MOVE:ZD,MULTIPLY:Vg,NEAREST:s5,NORMAL:Ri,OPAQUE:J1,OPEN:Ia,OPTION:k$,OVERLAY:W1,P2D:Ta,P2DHDR:g$,PATH:vi,PI:Ay,PIE:gh,POINTS:up,PORTRAIT:Y$,POSTERIZE:jg,PROJECT:G1,QUADRATIC:G$,QUADS:Pc,QUAD_STRIP:dh,QUARTER_PI:m$,RADIUS:hh,RAD_TO_DEG:Zo,REMOVE:Da,REPEAT:Dy,REPLACE:Ug,RETURN:N$,RIGHT:ap,RIGHT_ARROW:R$,ROUND:yo,SCREEN:Bg,SHIFT:F$,SIMPLE:Sy,SMOOTH:a5,SOFT_LIGHT:Y1,SQUARE:z1,STROKE:H$,SUBTRACT:Lg,TAB:P$,TAU:y$,TESS:x$,TEXT:QD,TEXTURE:hp,THRESHOLD:$g,TOP:v$,TRIANGLES:Nu,TRIANGLE_FAN:Fg,TRIANGLE_STRIP:fh,TWO_PI:pn,UNSIGNED_BYTE:Qs,UNSIGNED_INT:Mc,UP_ARROW:M$,VERSION:WD,WAIT:JD,WEBGL:To,WEBGL2:Ir,WORD:i5,_CTX_MIDDLE:j$,_DEFAULT_FILL:l5,_DEFAULT_LEADMULT:$$,_DEFAULT_STROKE:u5,_DEFAULT_TEXT_FILL:U$});function n_(n,t){t.applyMatrix=function(...r){let i=r[0]instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(r[0])||i?this._renderer.applyMatrix(...r[0]):this._renderer.applyMatrix(...r),this},t.resetMatrix=function(){return this._renderer.resetMatrix(),this},t.rotate=function(r,i){return this._renderer.rotate(this._toRadians(r),i),this},t.rotateX=function(r){return this._assert3d("rotateX"),this._renderer.rotateX(this._toRadians(r)),this},t.rotateY=function(r){return this._assert3d("rotateY"),this._renderer.rotateY(this._toRadians(r)),this},t.rotateZ=function(r){return this._assert3d("rotateZ"),this._renderer.rotateZ(this._toRadians(r)),this},t.scale=function(r,i,s){if(r instanceof n.Vector){const o=r;r=o.x,i=o.y,s=o.z}else if(Array.isArray(r)){const o=r;r=o[0],i=o[1],s=o[2]||1}return isNaN(i)?i=s=r:isNaN(s)&&(s=1),this._renderer.scale(r,i,s),this},t.shearX=function(r){const i=this._toRadians(r);return this._renderer.applyMatrix(1,0,Math.tan(i),1,0,0),this},t.shearY=function(r){const i=this._toRadians(r);return this._renderer.applyMatrix(1,Math.tan(i),0,1,0,0),this},t.translate=function(r,i,s){return this._renderer.isP3D?this._renderer.translate(r,i,s):this._renderer.translate(r,i),this},t.push=function(){this._renderer.push()},t.pop=function(){this._renderer.pop()}}typeof p5<"u"&&n_(p5,p5.prototype);function g5(n,t){t.noLoop=function(){this._loop=!1},t.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},t.isLooping=function(){return this._loop},t.redraw=async function(r){if(this._inUserDraw||!this._setupDone)return;let i=parseInt(r);(isNaN(i)||i<1)&&(i=1);const s=this._isGlobal?window:this;if(typeof s.draw=="function"){typeof s.setup>"u"&&s.scale(s._pixelDensity,s._pixelDensity);for(let o=0;o<i;o++){s.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),this._renderer.isP3D&&this._renderer._update(),this.frameCount=s.frameCount+1,await this._runLifecycleHook("predraw"),this._inUserDraw=!0;try{await s.draw()}finally{this._inUserDraw=!1}await this._runLifecycleHook("postdraw")}}}}typeof p5<"u"&&g5(p5,p5.prototype);const EE=function(n,t){return n!==0&&(this.x=this.x%n),t!==0&&(this.y=this.y%t),this},qm=function(n,t,r){return n!==0&&(this.x=this.x%n),t!==0&&(this.y=this.y%t),r!==0&&(this.z=this.z%r),this};class de{constructor(...t){let r=t.map(s=>s||0);typeof t[0]=="function"&&(this.isPInst=!0,this._fromRadians=t[0],this._toRadians=t[1],r=t.slice(2).map(s=>s||0));let i=r.length;i===0?(this.dimensions=2,this._values=[0,0,0]):(this.dimensions=i,this._values=r)}get values(){return this._values}set values(t){let r=t.length;r===0?(this.dimensions=2,this._values=[0,0,0]):(this.dimensions=r,this._values=t.slice())}get x(){return this._values[0]||0}getValue(t){if(t<this._values.length)return this._values[t];p5._friendlyError("The index parameter is trying to set a value outside the bounds of the vector","p5.Vector.setValue")}setValue(t,r){t<this._values.length?this._values[t]=r:p5._friendlyError("The index parameter is trying to set a value outside the bounds of the vector","p5.Vector.setValue")}get y(){return this._values[1]||0}get z(){return this._values[2]||0}get w(){return this._values[3]||0}set x(t){this._values.length>1&&(this._values[0]=t)}set y(t){this._values.length>1&&(this._values[1]=t)}set z(t){this._values.length>2&&(this._values[2]=t)}set w(t){this._values.length>3&&(this._values[3]=t)}toString(){return`[${this.values.join(", ")}]`}set(...t){return t[0]instanceof de?this.values=t[0].values.slice():Array.isArray(t[0])?this.values=t[0].map(r=>r||0):this.values=t.map(r=>r||0),this.dimensions=this.values.length,this}copy(){return this.isPInst?new de(this._fromRadians,this._toRadians,...this.values):new de(...this.values)}add(...t){return t[0]instanceof de?t=t[0].values:Array.isArray(t[0])&&(t=t[0]),t.forEach((r,i)=>{this.values[i]=(this.values[i]||0)+(r||0)}),this}rem(t,r,i){if(t instanceof de){if([t.x,t.y,t.z].every(Number.isFinite)){const s=parseFloat(t.x),o=parseFloat(t.y),a=parseFloat(t.z);return qm.call(this,s,o,a)}}else if(Array.isArray(t)){if(t.every(s=>Number.isFinite(s))){if(t.length===2)return EE.call(this,t[0],t[1]);if(t.length===3)return qm.call(this,t[0],t[1],t[2])}}else if(arguments.length===1){if(Number.isFinite(arguments[0])&&arguments[0]!==0)return this.x=this.x%arguments[0],this.y=this.y%arguments[0],this.z=this.z%arguments[0],this}else if(arguments.length===2){const s=[...arguments];if(s.every(o=>Number.isFinite(o))&&s.length===2)return EE.call(this,s[0],s[1])}else if(arguments.length===3){const s=[...arguments];if(s.every(o=>Number.isFinite(o))&&s.length===3)return qm.call(this,s[0],s[1],s[2])}}sub(...t){return t[0]instanceof de?t[0].values.forEach((r,i)=>{this.values[i]-=r||0}):Array.isArray(t[0])?t[0].forEach((r,i)=>{this.values[i]-=r||0}):t.forEach((r,i)=>{this.values[i]-=r||0}),this}mult(...t){if(t.length===1&&t[0]instanceof de){const r=t[0],i=Math.min(this.values.length,r.values.length);for(let s=0;s<i;s++)if(Number.isFinite(r.values[s])&&typeof r.values[s]=="number")this._values[s]*=r.values[s];else return console.warn("p5.Vector.prototype.mult:","v contains components that are either undefined or not finite numbers"),this}else if(t.length===1&&Array.isArray(t[0])){const r=t[0],i=Math.min(this.values.length,r.length);for(let s=0;s<i;s++)if(Number.isFinite(r[s])&&typeof r[s]=="number")this._values[s]*=r[s];else return console.warn("p5.Vector.prototype.mult:","arr contains elements that are either undefined or not finite numbers"),this}else if(t.length===1&&typeof t[0]=="number"&&Number.isFinite(t[0]))for(let r=0;r<this._values.length;r++)this._values[r]*=t[0];return this}div(...t){if(t.length===0)return this;if(t.length===1&&t[0]instanceof de){const r=t[0];if(r._values.every(i=>Number.isFinite(i)&&typeof i=="number")){if(r._values.some(i=>i===0))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this._values=this._values.map((i,s)=>i/r._values[s])}else console.warn("p5.Vector.prototype.div:","vector contains components that are either undefined or not finite numbers");return this}if(t.length===1&&Array.isArray(t[0])){const r=t[0];if(r.every(i=>Number.isFinite(i)&&typeof i=="number")){if(r.some(i=>i===0))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this._values=this._values.map((i,s)=>i/r[s])}else console.warn("p5.Vector.prototype.div:","array contains components that are either undefined or not finite numbers");return this}if(t.every(r=>Number.isFinite(r)&&typeof r=="number")){if(t.some(r=>r===0))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this._values=this._values.map((r,i)=>r/t[0])}else console.warn("p5.Vector.prototype.div:","arguments contain components that are either undefined or not finite numbers");return this}mag(){return Math.sqrt(this.magSq())}magSq(){return this._values.reduce((t,r)=>t+r*r,0)}dot(...t){return t[0]instanceof de?this.dot(...t[0]._values):this._values.reduce((r,i,s)=>r+i*(t[s]||0),0)}cross(t){const r=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,s=this.x*t.y-this.y*t.x;return this.isPInst?new de(this._fromRadians,this._toRadians,r,i,s):new de(r,i,s)}dist(t){return t.copy().sub(this).mag()}normalize(){const t=this.mag();return t!==0&&this.mult(1/t),this}limit(t){const r=this.magSq();return r>t*t&&this.div(Math.sqrt(r)).mult(t),this}setMag(t){return this.normalize().mult(t)}heading(){const t=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(t):t}setHeading(t){this.isPInst&&(t=this._toRadians(t));let r=this.mag();return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this}rotate(t){let r=this.heading()+t;this.isPInst&&(r=this._toRadians(r));const i=this.mag();return this.x=Math.cos(r)*i,this.y=Math.sin(r)*i,this}angleBetween(t){if(this.magSq()*t.magSq()===0)return NaN;const i=this.cross(t);let s=Math.atan2(i.mag(),this.dot(t))*Math.sign(i.z||1);return this.isPInst&&(s=this._fromRadians(s)),s}lerp(t,r,i,s){return t instanceof de?this.lerp(t.x,t.y,t.z,r):(this.x+=(t-this.x)*s||0,this.y+=(r-this.y)*s||0,this.z+=(i-this.z)*s||0,this)}slerp(t,r){if(r===0)return this;if(r===1)return this.set(t);const i=this.mag(),s=t.mag();if(i*s===0)return this.mult(1-r).add(t.x*r,t.y*r,t.z*r),this;const a=this.cross(t),u=a.mag(),l=Math.atan2(u,this.dot(t));if(u>0)a.x/=u,a.y/=u,a.z/=u;else{if(l<Math.PI*.5)return this.mult(1-r).add(t.x*r,t.y*r,t.z*r),this;this.z===0&&t.z===0?a.set(0,0,1):this.x!==0?a.set(this.y,-this.x,0).normalize():a.set(1,0,0)}const c=a.cross(this),h=1-r+r*s/i,f=h*Math.cos(r*l),d=h*Math.sin(r*l);return this.x=this.x*f+c.x*d,this.y=this.y*f+c.y*d,this.z=this.z*f+c.z*d,this}reflect(t){const r=de.normalize(t);return this.sub(r.mult(2*this.dot(r)))}array(){return[this.x||0,this.y||0,this.z||0]}equals(...t){let r;t[0]instanceof de?r=t[0]._values:Array.isArray(t[0])?r=t[0]:r=t;for(let i=0;i<this._values.length;i++)if(this._values[i]!==(r[i]||0))return!1;return!0}clampToZero(){for(let t=0;t<this._values.length;t++)this._values[t]=this._clampToZero(this._values[t]);return this}_clampToZero(t){return Math.abs((t||0)-0)<=Number.EPSILON?0:t}static fromAngle(t,r){return typeof r>"u"&&(r=1),new de(r*Math.cos(t),r*Math.sin(t),0)}static fromAngles(t,r,i){typeof i>"u"&&(i=1);const s=Math.cos(r),o=Math.sin(r),a=Math.cos(t),u=Math.sin(t);return new de(i*u*o,-i*a,i*u*s)}static random2D(){return this.fromAngle(Math.random()*pn)}static random3D(){const t=Math.random()*pn,r=Math.random()*2-1,i=Math.sqrt(1-r*r),s=i*Math.cos(t),o=i*Math.sin(t);return new de(s,o,r)}static copy(t){return t.copy(t)}static add(t,r,i){return i?i.set(t):(i=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),i.add(r),i}static rem(t,r){if(t instanceof de&&r instanceof de){let i=t.copy();return i.rem(r),i}}static sub(t,r,i){return i?i.set(t):(i=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),i.sub(r),i}static mult(t,r,i){return i?i.set(t):(i=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),i.mult(r),i}static rotate(t,r,i){return arguments.length===2?i=t.copy():(i instanceof de||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),i.set(t)),i.rotate(r),i}static div(t,r,i){return i?i.set(t):(i=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),i.div(r),i}static dot(t,r){return t.dot(r)}static cross(t,r){return t.cross(r)}static dist(t,r){return t.dist(r)}static lerp(t,r,i,s){return s?s.set(t):(s=t.copy(),arguments.length===4&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),s.lerp(r,i),s}static slerp(t,r,i,s){return s?s.set(t):(s=t.copy(),arguments.length===4&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.slerp")),s.slerp(r,i),s}static mag(t){return t.mag()}static magSq(t){return t.magSq()}static normalize(t,r){return arguments.length<2?r=t.copy():(r instanceof de||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),r.set(t)),r.normalize()}static limit(t,r,i){return arguments.length<3?i=t.copy():(i instanceof de||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit"),i.set(t)),i.limit(r)}static setMag(t,r,i){return arguments.length<3?i=t.copy():(i instanceof de||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag"),i.set(t)),i.setMag(r)}static heading(t){return t.heading()}static angleBetween(t,r){return t.angleBetween(r)}static reflect(t,r,i){return arguments.length<3?i=t.copy():(i instanceof de||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect"),i.set(t)),i.reflect(r)}static array(t){return t.array()}static equals(t,r){let i;return t instanceof de?i=t:t instanceof Array?i=new de().set(t):p5._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals"),i.equals(r)}}function m5(n,t){n.Vector=de}typeof p5<"u"&&m5(p5,p5.prototype);function y5(n,t){const r=[KD,YD,XD,ZD,QD,JD];t._frameRate=0,t._lastFrameTime=window.performance.now(),t._targetFrameRate=60;const i=window.print;let s=!1;t.print=function(...c){c.length?console.log(...c):s||(i(),window.confirm("You just tried to print the webpage. Do you want to prevent this from running again?")&&(s=!0))},t.frameCount=0,t.deltaTime=0,t.focused=document.hasFocus(),t.cursor=function(c,h,f){let d="auto";const p=this._curElement.elt;if(r.includes(c))d=c;else if(typeof c=="string"){let g="";h&&f&&typeof h=="number"&&typeof f=="number"&&(g=`${h} ${f}`),c.substring(0,7)==="http://"||c.substring(0,8)==="https://"?d=`url(${c}) ${g}, auto`:/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(c)?d=`url(${c}) ${g}, auto`:d=c}p.style.cursor=d},t.frameRate=function(c){return typeof c!="number"||c<0?this._frameRate:(this._targetFrameRate=c,c===0&&(this._frameRate=c),this)},t.getFrameRate=function(){return this.frameRate()},t.setFrameRate=function(c){return this.frameRate(c)},t.getTargetFrameRate=function(){return this._targetFrameRate},t.noCursor=function(){this._curElement.elt.style.cursor="none"},t.webglVersion=Ta,t.displayWidth=screen.width,t.displayHeight=screen.height,t.windowWidth=0,t.windowHeight=0,t._onresize=function(c){this.windowWidth=o(),this.windowHeight=a();const h=this._isGlobal?window:this;let f;typeof h.windowResized=="function"&&(f=h.windowResized(c),f!==void 0&&!f&&c.preventDefault())};function o(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function a(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}t._updateWindowSize=function(){this.windowWidth=o(),this.windowHeight=a()},Object.defineProperty(t,"width",{get(){return this._renderer.width}}),Object.defineProperty(t,"height",{get(){return this._renderer.height}}),t.fullscreen=function(c){if(typeof c>"u")return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;c?u(document.documentElement):l()},t.pixelDensity=function(c){let h;return typeof c=="number"?(c!==this._renderer._pixelDensity&&(this._renderer._pixelDensity=c),h=this,this.resizeCanvas(this.width,this.height,!0)):h=this._renderer._pixelDensity,h},t.displayDensity=()=>window.devicePixelRatio;function u(c){if(!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");c.requestFullscreen?c.requestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen?c.webkitRequestFullscreen():c.msRequestFullscreen&&c.msRequestFullscreen()}function l(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}t.getURL=()=>location.href,t.getURLPath=()=>location.pathname.split("/").filter(c=>c!==""),t.getURLParams=function(){const c=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim;let h;const f={};for(;(h=c.exec(location.search))!=null;)h.index===c.lastIndex&&c.lastIndex++,f[h[1]]=h[2];return f},t.worldToScreen=function(c){return typeof c=="number"&&(c=this.createVector(...arguments)),this._renderer.getWorldToScreenMatrix().multiplyAndNormalizePoint(c)},t.screenToWorld=function(c){typeof c=="number"&&(c=this.createVector(...arguments));const h=this._renderer.getWorldToScreenMatrix();if(c.dimensions==2){let p=h.mat4[14]/h.mat4[15];c=this.createVector(c.x,c.y,p)}return h.invert(h).multiplyAndNormalizePoint(c)}}typeof p5<"u"&&y5(p5,p5.prototype);function Br(n,t){let r=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(t[0])||(t=t.map(a=>[a]));let i=t[0].length,s=t[0].map((a,u)=>t.map(l=>l[u])),o=n.map(a=>s.map(u=>{let l=0;if(!Array.isArray(a)){for(let c of u)l+=a*c;return l}for(let c=0;c<a.length;c++)l+=a[c]*(u[c]||0);return l}));return r===1&&(o=o[0]),i===1?o.map(a=>a[0]):o}function v5(n){return Pu(n)==="string"}function Pu(n){return(Object.prototype.toString.call(n).match(/^\[object\s+(.*?)\]$/)[1]||"").toLowerCase()}function Fy(n,{precision:t,unit:r}){return Py(n)?"none":Q$(n,t)+(r??"")}function Py(n){return Number.isNaN(n)||n instanceof Number&&(n==null?void 0:n.none)}function Q$(n,t){if(n===0)return 0;let r=~~n,i=0;r&&t&&(i=~~Math.log10(Math.abs(r))+1);const s=10**(t-i);return Math.floor(n*s+.5)/s}const J$={deg:1,grad:.9,rad:180/Math.PI,turn:360};function ej(n){if(!n)return;n=n.trim();const t=/^([a-z]+)\((.+?)\)$/i,r=/^-?[\d.]+$/,i=/%|deg|g?rad|turn$/,s=/\/?\s*(none|[-\w.]+(?:%|deg|g?rad|turn)?)/g;let o=n.match(t);if(o){let a=[];return o[2].replace(s,(u,l)=>{let c=l.match(i),h=l;if(c){let f=c[0],d=h.slice(0,-f.length);f==="%"?(h=new Number(d/100),h.type="<percentage>"):(h=new Number(d*J$[f]),h.type="<angle>",h.unit=f)}else r.test(h)?(h=new Number(h),h.type="<number>"):h==="none"&&(h=new Number(NaN),h.none=!0);u.startsWith("/")&&(h=h instanceof Number?h:new Number(h),h.alpha=!0),typeof h=="object"&&h instanceof Number&&(h.raw=l),a.push(h)}),{name:o[1].toLowerCase(),rawName:o[1],rawArgs:o[2],args:a}}}function tj(n){return n[n.length-1]}function fp(n,t,r){return isNaN(n)?t:isNaN(t)?n:n+(t-n)*r}function rj(n,t,r){return(r-n)/(t-n)}function _5(n,t,r){return fp(t[0],t[1],rj(n[0],n[1],r))}function nj(n){return n.map(t=>t.split("|").map(r=>{r=r.trim();let i=r.match(/^(<[a-z]+>)\[(-?[.\d]+),\s*(-?[.\d]+)\]?$/);if(i){let s=new String(i[1]);return s.range=[+i[2],+i[3]],s}return r}))}function ij(n,t,r){return Math.max(Math.min(r,t),n)}function i_(n,t){return Math.sign(n)===Math.sign(t)?n:-n}function ds(n,t){return i_(Math.abs(n)**t,n)}function b5(n,t){return t===0?0:n/t}function sj(n,t,r=0,i=n.length){for(;r<i;){const s=r+i>>1;n[s]<t?r=s+1:i=s}return r}class oj{add(t,r,i){if(typeof arguments[0]!="string"){for(var t in arguments[0])this.add(t,arguments[0][t],arguments[1]);return}(Array.isArray(t)?t:[t]).forEach(function(s){this[s]=this[s]||[],r&&this[s][i?"unshift":"push"](r)},this)}run(t,r){this[t]=this[t]||[],this[t].forEach(function(i){i.call(r&&r.context?r.context:r,r)})}}const dp=new oj,ps={D50:[.3457/.3585,1,(1-.3457-.3585)/.3585],D65:[.3127/.329,1,(1-.3127-.329)/.329]};function My(n){return Array.isArray(n)?n:ps[n]}function pp(n,t,r,i={}){if(n=My(n),t=My(t),!n||!t)throw new TypeError(`Missing white point to convert ${n?"":"from"}${!n&&!t?"/":""}${t?"":"to"}`);if(n===t)return r;let s={W1:n,W2:t,XYZ:r,options:i};if(dp.run("chromatic-adaptation-start",s),s.M||(s.W1===ps.D65&&s.W2===ps.D50?s.M=[[1.0479297925449969,.022946870601609652,-.05019226628920524],[.02962780877005599,.9904344267538799,-.017073799063418826],[-.009243040646204504,.015055191490298152,.7518742814281371]]:s.W1===ps.D50&&s.W2===ps.D65&&(s.M=[[.955473421488075,-.02309845494876471,.06325924320057072],[-.0283697093338637,1.0099953980813041,.021041441191917323],[.012314014864481998,-.020507649298898964,1.330365926242124]])),dp.run("chromatic-adaptation-end",s),s.M)return Br(s.M,s.XYZ);throw new TypeError("Only Bradford CAT with white points D50 and D65 supported for now.")}var KC,YC,XC;const Na={gamut_mapping:"css",precision:5,deltaE:"76",verbose:((XC=(YC=(KC=globalThis==null?void 0:globalThis.process)==null?void 0:KC.env)==null?void 0:YC.NODE_ENV)==null?void 0:XC.toLowerCase())!=="test",warn:function(t){var r,i;this.verbose&&((i=(r=globalThis==null?void 0:globalThis.console)==null?void 0:r.warn)==null||i.call(r,t))}},aj=new Set(["<number>","<percentage>","<angle>"]);function SE(n,t,r,i){return Object.entries(n.coords).map(([o,a],u)=>{let l=t.coordGrammar[u],c=i[u],h=c==null?void 0:c.type,f;if(c.none?f=l.find(g=>aj.has(g)):f=l.find(g=>g==h),!f){let g=a.name||o;throw new TypeError(`${h??c.raw} not allowed for ${g} in ${r}()`)}let d=f.range;h==="<percentage>"&&(d||(d=[0,1]));let p=a.range||a.refRange;return d&&p&&(i[u]=_5(d,p,i[u])),f})}function x5(n,{meta:t}={}){var i,s,o,a;let r={str:(i=String(n))==null?void 0:i.trim()};if(dp.run("parse-start",r),r.color)return r.color;if(r.parsed=ej(r.str),r.parsed){let u=r.parsed.name;if(u==="color"){let l=r.parsed.args.shift(),c=l.startsWith("--")?l.substring(2):`--${l}`,h=[l,c],f=r.parsed.rawArgs.indexOf("/")>0?r.parsed.args.pop():1;for(let g of _t.all){let y=g.getFormat("color");if(y&&(h.includes(y.id)||(s=y.ids)!=null&&s.filter(v=>h.includes(v)).length)){const v=Object.keys(g.coords).map((_,C)=>r.parsed.args[C]||0);let T;return y.coordGrammar&&(T=SE(g,y,"color",v)),t&&Object.assign(t,{formatId:"color",types:T}),y.id.startsWith("--")&&!l.startsWith("--")&&Na.warn(`${g.name} is a non-standard space and not currently supported in the CSS spec. Use prefixed color(${y.id}) instead of color(${l}).`),l.startsWith("--")&&!y.id.startsWith("--")&&Na.warn(`${g.name} is a standard space and supported in the CSS spec. Use color(${y.id}) instead of prefixed color(${l}).`),{spaceId:g.id,coords:v,alpha:f}}}let d="",p=l in _t.registry?l:c;if(p in _t.registry){let g=(a=(o=_t.registry[p].formats)==null?void 0:o.color)==null?void 0:a.id;g&&(d=`Did you mean color(${g})?`)}throw new TypeError(`Cannot parse color(${l}). `+(d||"Missing a plugin?"))}else for(let l of _t.all){let c=l.getFormat(u);if(c&&c.type==="function"){let h=1;(c.lastAlpha||tj(r.parsed.args).alpha)&&(h=r.parsed.args.pop());let f=r.parsed.args,d;return c.coordGrammar&&(d=SE(l,c,u,f)),t&&Object.assign(t,{formatId:c.name,types:d}),{spaceId:l.id,coords:f,alpha:h}}}}else for(let u of _t.all)for(let l in u.formats){let c=u.formats[l];if(c.type!=="custom"||c.test&&!c.test(r.str))continue;let h=c.parse(r.str);if(h)return h.alpha??(h.alpha=1),t&&(t.formatId=l),h}throw new TypeError(`Could not parse ${n} as a color. Missing a plugin?`)}function Rr(n){if(Array.isArray(n))return n.map(Rr);if(!n)throw new TypeError("Empty color reference");v5(n)&&(n=x5(n));let t=n.space||n.spaceId;return t instanceof _t||(n.space=_t.get(t)),n.alpha===void 0&&(n.alpha=1),n}const uj=75e-6,In=class In{constructor(t){var s;this.id=t.id,this.name=t.name,this.base=t.base?In.get(t.base):null,this.aliases=t.aliases,this.base&&(this.fromBase=t.fromBase,this.toBase=t.toBase);let r=t.coords??this.base.coords;for(let o in r)"name"in r[o]||(r[o].name=o);this.coords=r;let i=t.white??this.base.white??"D65";this.white=My(i),this.formats=t.formats??{};for(let o in this.formats){let a=this.formats[o];a.type||(a.type="function"),a.name||(a.name=o)}(s=this.formats.color)!=null&&s.id||(this.formats.color={...this.formats.color??{},id:t.cssId||this.id}),t.gamutSpace?this.gamutSpace=t.gamutSpace==="self"?this:In.get(t.gamutSpace):this.isPolar?this.gamutSpace=this.base:this.gamutSpace=this,this.gamutSpace.isUnbounded&&(this.inGamut=(o,a)=>!0),this.referred=t.referred,Object.defineProperty(this,"path",{value:lj(this).reverse(),writable:!1,enumerable:!0,configurable:!0}),dp.run("colorspace-init-end",this)}inGamut(t,{epsilon:r=uj}={}){if(!this.equals(this.gamutSpace))return t=this.to(this.gamutSpace,t),this.gamutSpace.inGamut(t,{epsilon:r});let i=Object.values(this.coords);return t.every((s,o)=>{let a=i[o];if(a.type!=="angle"&&a.range){if(Number.isNaN(s))return!0;let[u,l]=a.range;return(u===void 0||s>=u-r)&&(l===void 0||s<=l+r)}return!0})}get isUnbounded(){return Object.values(this.coords).every(t=>!("range"in t))}get cssId(){var t,r;return((r=(t=this.formats)==null?void 0:t.color)==null?void 0:r.id)||this.id}get isPolar(){for(let t in this.coords)if(this.coords[t].type==="angle")return!0;return!1}getFormat(t){if(typeof t=="object")return t=CE(t,this),t;let r;return t==="default"?r=Object.values(this.formats)[0]:r=this.formats[t],r?(r=CE(r,this),r):null}equals(t){return t?this===t||this.id===t||this.id===t.id:!1}to(t,r){if(arguments.length===1){const u=Rr(t);[t,r]=[u.space,u.coords]}if(t=In.get(t),this.equals(t))return r;r=r.map(u=>Number.isNaN(u)?0:u);let i=this.path,s=t.path,o,a;for(let u=0;u<i.length&&i[u].equals(s[u]);u++)o=i[u],a=u;if(!o)throw new Error(`Cannot convert between color spaces ${this} and ${t}: no connection space was found`);for(let u=i.length-1;u>a;u--)r=i[u].toBase(r);for(let u=a+1;u<s.length;u++)r=s[u].fromBase(r);return r}from(t,r){if(arguments.length===1){const i=Rr(t);[t,r]=[i.space,i.coords]}return t=In.get(t),t.to(this,r)}toString(){return`${this.name} (${this.id})`}getMinCoords(){let t=[];for(let r in this.coords){let i=this.coords[r],s=i.range||i.refRange;t.push((s==null?void 0:s.min)??0)}return t}static get all(){return[...new Set(Object.values(In.registry))]}static register(t,r){if(arguments.length===1&&(r=arguments[0],t=r.id),r=this.get(r),this.registry[t]&&this.registry[t]!==r)throw new Error(`Duplicate color space registration: '${t}'`);if(this.registry[t]=r,arguments.length===1&&r.aliases)for(let i of r.aliases)this.register(i,r);return r}static get(t,...r){if(!t||t instanceof In)return t;if(Pu(t)==="string"){let s=In.registry[t.toLowerCase()];if(!s)throw new TypeError(`No color space found with id = "${t}"`);return s}if(r.length)return In.get(...r);throw new TypeError(`${t} is not a valid color space`)}static resolveCoord(t,r){var l;let i=Pu(t),s,o;if(i==="string"?t.includes(".")?[s,o]=t.split("."):[s,o]=[,t]:Array.isArray(t)?[s,o]=t:(s=t.space,o=t.coordId),s=In.get(s),s||(s=r),!s)throw new TypeError(`Cannot resolve coordinate reference ${t}: No color space specified and relative references are not allowed here`);if(i=Pu(o),i==="number"||i==="string"&&o>=0){let c=Object.entries(s.coords)[o];if(c)return{space:s,id:c[0],index:o,...c[1]}}s=In.get(s);let a=o.toLowerCase(),u=0;for(let c in s.coords){let h=s.coords[c];if(c.toLowerCase()===a||((l=h.name)==null?void 0:l.toLowerCase())===a)return{space:s,id:c,index:u,...h};u++}throw new TypeError(`No "${o}" coordinate found in ${s.name}. Its coordinates are: ${Object.keys(s.coords).join(", ")}`)}};Nt(In,"registry",{}),Nt(In,"DEFAULT_FORMAT",{type:"functions",name:"color"});let _t=In;function lj(n){let t=[n];for(let r=n;r=r.base;)t.push(r);return t}function CE(n,{coords:t}={}){if(n.coords&&!n.coordGrammar){n.type||(n.type="function"),n.name||(n.name="color"),n.coordGrammar=nj(n.coords);let r=Object.entries(t).map(([i,s],o)=>{let a=n.coordGrammar[o][0],u=s.range||s.refRange,l=a.range,c="";return a=="<percentage>"?(l=[0,100],c="%"):a=="<angle>"&&(c="deg"),{fromRange:u,toRange:l,suffix:c}});n.serializeCoords=(i,s)=>i.map((o,a)=>{let{fromRange:u,toRange:l,suffix:c}=r[a];return u&&l&&(o=_5(u,l,o)),o=Fy(o,{precision:s,unit:c}),o})}return n}const vo=new _t({id:"xyz-d65",name:"XYZ D65",coords:{x:{name:"X"},y:{name:"Y"},z:{name:"Z"}},white:"D65",formats:{color:{ids:["xyz-d65","xyz"]}},aliases:["xyz"]});class zg extends _t{constructor(t){t.coords||(t.coords={r:{range:[0,1],name:"Red"},g:{range:[0,1],name:"Green"},b:{range:[0,1],name:"Blue"}}),t.base||(t.base=vo),t.toXYZ_M&&t.fromXYZ_M&&(t.toBase??(t.toBase=r=>{let i=Br(t.toXYZ_M,r);return this.white!==this.base.white&&(i=pp(this.white,this.base.white,i)),i}),t.fromBase??(t.fromBase=r=>(r=pp(this.base.white,this.white,r),Br(t.fromXYZ_M,r)))),t.referred??(t.referred="display"),super(t)}}function w5(n,t){return n=Rr(n),!t||n.space.equals(t)?n.coords.slice():(t=_t.get(t),t.from(n))}function ca(n,t){n=Rr(n);let{space:r,index:i}=_t.resolveCoord(t,n.space);return w5(n,r)[i]}function E5(n,t,r){return n=Rr(n),t=_t.get(t),n.coords=t.to(n.space,r),n}E5.returns="color";function yh(n,t,r){if(n=Rr(n),arguments.length===2&&Pu(arguments[1])==="object"){let i=arguments[1];for(let s in i)yh(n,s,i[s])}else{typeof r=="function"&&(r=r(ca(n,t)));let{space:i,index:s}=_t.resolveCoord(t,n.space),o=w5(n,i);o[s]=r,E5(n,i,o)}return n}yh.returns="color";const cj=new _t({id:"xyz-d50",name:"XYZ D50",white:"D50",base:vo,fromBase:n=>pp(vo.white,"D50",n),toBase:n=>pp("D50",vo.white,n)}),hj=216/24389,AE=24/116,Mf=24389/27;let Hm=ps.D50;const pi=new _t({id:"lab",name:"Lab",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:Hm,base:cj,fromBase(n){let r=n.map((i,s)=>i/Hm[s]).map(i=>i>hj?Math.cbrt(i):(Mf*i+16)/116);return[116*r[1]-16,500*(r[0]-r[1]),200*(r[1]-r[2])]},toBase(n){let t=[];return t[1]=(n[0]+16)/116,t[0]=n[1]/500+t[1],t[2]=t[1]-n[2]/200,[t[0]>AE?Math.pow(t[0],3):(116*t[0]-16)/Mf,n[0]>8?Math.pow((n[0]+16)/116,3):n[0]/Mf,t[2]>AE?Math.pow(t[2],3):(116*t[2]-16)/Mf].map((i,s)=>i*Hm[s])},formats:{lab:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function Ns(n){return(n%360+360)%360}function fj(n,t){if(n==="raw")return t;let[r,i]=t.map(Ns),s=i-r;return n==="increasing"?s<0&&(i+=360):n==="decreasing"?s>0&&(r+=360):n==="longer"?-180<s&&s<180&&(s>0?r+=360:i+=360):n==="shorter"&&(s>180?r+=360:s<-180&&(i+=360)),[r,i]}const fl=new _t({id:"lch",name:"LCH",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,150],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:pi,fromBase(n){let[t,r,i]=n,s;const o=.02;return Math.abs(r)<o&&Math.abs(i)<o?s=NaN:s=Math.atan2(i,r)*180/Math.PI,[t,Math.sqrt(r**2+i**2),Ns(s)]},toBase(n){let[t,r,i]=n;return r<0&&(r=0),isNaN(i)&&(i=0),[t,r*Math.cos(i*Math.PI/180),r*Math.sin(i*Math.PI/180)]},formats:{lch:{coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}}),TE=25**7,gp=Math.PI,IE=180/gp,nu=gp/180;function DE(n){const t=n*n;return t*t*t*n}function S5(n,t,{kL:r=1,kC:i=1,kH:s=1}={}){[n,t]=Rr([n,t]);let[o,a,u]=pi.from(n),l=fl.from(pi,[o,a,u])[1],[c,h,f]=pi.from(t),d=fl.from(pi,[c,h,f])[1];l<0&&(l=0),d<0&&(d=0);let p=(l+d)/2,g=DE(p),y=.5*(1-Math.sqrt(g/(g+TE))),v=(1+y)*a,T=(1+y)*h,_=Math.sqrt(v**2+u**2),C=Math.sqrt(T**2+f**2),E=v===0&&u===0?0:Math.atan2(u,v),S=T===0&&f===0?0:Math.atan2(f,T);E<0&&(E+=2*gp),S<0&&(S+=2*gp),E*=IE,S*=IE;let R=c-o,w=C-_,x=S-E,b=E+S,A=Math.abs(x),k;_*C===0?k=0:A<=180?k=x:x>180?k=x-360:x<-180?k=x+360:Na.warn("the unthinkable has happened");let N=2*Math.sqrt(C*_)*Math.sin(k*nu/2),I=(o+c)/2,j=(_+C)/2,Q=DE(j),le;_*C===0?le=b:A<=180?le=b/2:b<360?le=(b+360)/2:le=(b-360)/2;let fe=(I-50)**2,ne=1+.015*fe/Math.sqrt(20+fe),oe=1+.045*j,ie=1;ie-=.17*Math.cos((le-30)*nu),ie+=.24*Math.cos(2*le*nu),ie+=.32*Math.cos((3*le+6)*nu),ie-=.2*Math.cos((4*le-63)*nu);let ue=1+.015*j*ie,ee=30*Math.exp(-1*((le-275)/25)**2),ve=2*Math.sqrt(Q/(Q+TE)),ge=-1*Math.sin(2*ee*nu)*ve,we=(R/(r*ne))**2;return we+=(w/(i*oe))**2,we+=(N/(s*ue))**2,we+=ge*(w/(i*oe))*(N/(s*ue)),Math.sqrt(we)}const dj=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],pj=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],gj=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],mj=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],Ra=new _t({id:"oklab",name:"Oklab",coords:{l:{refRange:[0,1],name:"Lightness"},a:{refRange:[-.4,.4]},b:{refRange:[-.4,.4]}},white:"D65",base:vo,fromBase(n){let r=Br(dj,n).map(i=>Math.cbrt(i));return Br(gj,r)},toBase(n){let r=Br(mj,n).map(i=>i**3);return Br(pj,r)},formats:{oklab:{coords:["<percentage> | <number>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function Ly(n,t){[n,t]=Rr([n,t]);let[r,i,s]=Ra.from(n),[o,a,u]=Ra.from(t),l=r-o,c=i-a,h=s-u;return Math.sqrt(l**2+c**2+h**2)}const yj=75e-6;function Mu(n,t,{epsilon:r=yj}={}){n=Rr(n),t||(t=n.space),t=_t.get(t);let i=n.coords;return t!==n.space&&(i=t.from(n)),t.inGamut(i,{epsilon:r})}function vh(n){return{space:n.space,coords:n.coords.slice(),alpha:n.alpha}}function vj(n,t,r="lab"){r=_t.get(r);let i=r.from(n),s=r.from(t);return Math.sqrt(i.reduce((o,a,u)=>{let l=s[u];return isNaN(a)||isNaN(l)?o:o+(l-a)**2},0))}function _j(n,t){return vj(n,t,"lab")}const bj=Math.PI,kE=bj/180;function xj(n,t,{l:r=2,c:i=1}={}){[n,t]=Rr([n,t]);let[s,o,a]=pi.from(n),[,u,l]=fl.from(pi,[s,o,a]),[c,h,f]=pi.from(t),d=fl.from(pi,[c,h,f])[1];u<0&&(u=0),d<0&&(d=0);let p=s-c,g=u-d,y=o-h,v=a-f,T=y**2+v**2-g**2,_=.511;s>=16&&(_=.040975*s/(1+.01765*s));let C=.0638*u/(1+.0131*u)+.638,E;Number.isNaN(l)&&(l=0),l>=164&&l<=345?E=.56+Math.abs(.2*Math.cos((l+168)*kE)):E=.36+Math.abs(.4*Math.cos((l+35)*kE));let S=Math.pow(u,4),R=Math.sqrt(S/(S+1900)),w=C*(R*E+1-R),x=(p/(r*_))**2;return x+=(g/(i*C))**2,x+=T/w**2,Math.sqrt(x)}const NE=203,C5=new _t({id:"xyz-abs-d65",cssId:"--xyz-abs-d65",name:"Absolute XYZ D65",coords:{x:{refRange:[0,9504.7],name:"Xa"},y:{refRange:[0,1e4],name:"Ya"},z:{refRange:[0,10888.3],name:"Za"}},base:vo,fromBase(n){return n.map(t=>Math.max(t*NE,0))},toBase(n){return n.map(t=>Math.max(t/NE,0))}}),Lf=1.15,Of=.66,RE=2610/2**14,wj=2**14/2610,FE=3424/2**12,PE=2413/2**7,ME=2392/2**7,Ej=1.7*2523/2**5,LE=2**5/(1.7*2523),Vf=-.56,Wm=16295499532821565e-27,Sj=[[.41478972,.579999,.014648],[-.20151,1.120649,.0531008],[-.0166008,.2648,.6684799]],Cj=[[1.9242264357876067,-1.0047923125953657,.037651404030618],[.35031676209499907,.7264811939316552,-.06538442294808501],[-.09098281098284752,-.3127282905230739,1.5227665613052603]],Aj=[[.5,.5,0],[3.524,-4.066708,.542708],[.199076,1.096799,-1.295875]],Tj=[[1,.1386050432715393,.05804731615611886],[.9999999999999999,-.1386050432715393,-.05804731615611886],[.9999999999999998,-.09601924202631895,-.8118918960560388]],Ij=new _t({id:"jzazbz",name:"Jzazbz",coords:{jz:{refRange:[0,1],name:"Jz"},az:{refRange:[-.5,.5]},bz:{refRange:[-.5,.5]}},base:C5,fromBase(n){let[t,r,i]=n,s=Lf*t-(Lf-1)*i,o=Of*r-(Of-1)*t,u=Br(Sj,[s,o,i]).map(function(d){let p=FE+PE*(d/1e4)**RE,g=1+ME*(d/1e4)**RE;return(p/g)**Ej}),[l,c,h]=Br(Aj,u);return[(1+Vf)*l/(1+Vf*l)-Wm,c,h]},toBase(n){let[t,r,i]=n,s=(t+Wm)/(1+Vf-Vf*(t+Wm)),a=Br(Tj,[s,r,i]).map(function(d){let p=FE-d**LE,g=ME*d**LE-PE;return 1e4*(p/g)**wj}),[u,l,c]=Br(Cj,a),h=(u+(Lf-1)*c)/Lf,f=(l+(Of-1)*h)/Of;return[h,f,c]},formats:{color:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),OE=new _t({id:"jzczhz",name:"JzCzHz",coords:{jz:{refRange:[0,1],name:"Jz"},cz:{refRange:[0,1],name:"Chroma"},hz:{refRange:[0,360],type:"angle",name:"Hue"}},base:Ij,fromBase(n){let[t,r,i]=n,s;const o=2e-4;return Math.abs(r)<o&&Math.abs(i)<o?s=NaN:s=Math.atan2(i,r)*180/Math.PI,[t,Math.sqrt(r**2+i**2),Ns(s)]},toBase(n){return[n[0],n[1]*Math.cos(n[2]*Math.PI/180),n[1]*Math.sin(n[2]*Math.PI/180)]}});function Dj(n,t){[n,t]=Rr([n,t]);let[r,i,s]=OE.from(n),[o,a,u]=OE.from(t),l=r-o,c=i-a;Number.isNaN(s)&&Number.isNaN(u)?(s=0,u=0):Number.isNaN(s)?s=u:Number.isNaN(u)&&(u=s);let h=s-u,f=2*Math.sqrt(i*a)*Math.sin(h/2*(Math.PI/180));return Math.sqrt(l**2+c**2+f**2)}const A5=3424/4096,T5=2413/128,I5=2392/128,VE=2610/16384,kj=2523/32,Nj=16384/2610,BE=32/2523,Rj=[[.3592832590121217,.6976051147779502,-.035891593232029],[-.1920808463704993,1.100476797037432,.0753748658519118],[.0070797844607479,.0748396662186362,.8433265453898765]],Fj=[[2048/4096,2048/4096,0],[6610/4096,-13613/4096,7003/4096],[17933/4096,-17390/4096,-543/4096]],Pj=[[.9999999999999998,.0086090370379328,.111029625003026],[.9999999999999998,-.0086090370379328,-.1110296250030259],[.9999999999999998,.5600313357106791,-.3206271749873188]],Mj=[[2.0701522183894223,-1.3263473389671563,.2066510476294053],[.3647385209748072,.6805660249472273,-.0453045459220347],[-.0497472075358123,-.0492609666966131,1.1880659249923042]],UE=new _t({id:"ictcp",name:"ICTCP",coords:{i:{refRange:[0,1],name:"I"},ct:{refRange:[-.5,.5],name:"CT"},cp:{refRange:[-.5,.5],name:"CP"}},base:C5,fromBase(n){let t=Br(Rj,n);return Lj(t)},toBase(n){let t=Oj(n);return Br(Mj,t)}});function Lj(n){let t=n.map(function(r){let i=A5+T5*(r/1e4)**VE,s=1+I5*(r/1e4)**VE;return(i/s)**kj});return Br(Fj,t)}function Oj(n){return Br(Pj,n).map(function(i){let s=Math.max(i**BE-A5,0),o=T5-I5*i**BE;return 1e4*(s/o)**Nj})}function Vj(n,t){[n,t]=Rr([n,t]);let[r,i,s]=UE.from(n),[o,a,u]=UE.from(t);return 720*Math.sqrt((r-o)**2+.25*(i-a)**2+(s-u)**2)}const Bj=ps.D65,D5=.42,$E=1/D5,Km=2*Math.PI,k5=[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],Uj=[[1.8620678550872327,-1.0112546305316843,.14918677544445175],[.38752654323613717,.6214474419314753,-.008973985167612518],[-.015841498849333856,-.03412293802851557,1.0499644368778496]],$j=[[460,451,288],[460,-891,-261],[460,-220,-6300]],jj={dark:[.8,.525,.8],dim:[.9,.59,.9],average:[1,.69,1]},ia={h:[20.14,90,164.25,237.53,380.14],e:[.8,.7,1,1.2,.8],H:[0,100,200,300,400]},Gj=180/Math.PI,jE=Math.PI/180;function N5(n,t){return n.map(i=>{const s=ds(t*Math.abs(i)*.01,D5);return 400*i_(s,i)/(s+27.13)})}function zj(n,t){const r=100/t*27.13**$E;return n.map(i=>{const s=Math.abs(i);return i_(r*ds(s/(400-s),$E),i)})}function qj(n){let t=Ns(n);t<=ia.h[0]&&(t+=360);const r=sj(ia.h,t)-1,[i,s]=ia.h.slice(r,r+2),[o,a]=ia.e.slice(r,r+2),u=ia.H[r],l=(t-i)/o;return u+100*l/(l+(s-t)/a)}function Hj(n){let t=(n%400+400)%400;const r=Math.floor(.01*t);t=t%100;const[i,s]=ia.h.slice(r,r+2),[o,a]=ia.e.slice(r,r+2);return Ns((t*(a*i-o*s)-100*i*a)/(t*(a-o)-100*a))}function R5(n,t,r,i,s){const o={};o.discounting=s,o.refWhite=n,o.surround=i;const a=n.map(y=>y*100);o.la=t,o.yb=r;const u=a[1],l=Br(k5,a);i=jj[o.surround];const c=i[0];o.c=i[1],o.nc=i[2];const f=(1/(5*o.la+1))**4;o.fl=f*o.la+.1*(1-f)*(1-f)*Math.cbrt(5*o.la),o.flRoot=o.fl**.25,o.n=o.yb/u,o.z=1.48+Math.sqrt(o.n),o.nbb=.725*o.n**-.2,o.ncb=o.nbb;const d=Math.max(Math.min(c*(1-1/3.6*Math.exp((-o.la-42)/92)),1),0);o.dRgb=l.map(y=>fp(1,u/y,d)),o.dRgbInv=o.dRgb.map(y=>1/y);const p=l.map((y,v)=>y*o.dRgb[v]),g=N5(p,o.fl);return o.aW=o.nbb*(2*g[0]+g[1]+.05*g[2]),o}const GE=R5(Bj,64/Math.PI*.2,20,"average",!1);function Oy(n,t){if(!(n.J!==void 0^n.Q!==void 0))throw new Error("Conversion requires one and only one: 'J' or 'Q'");if(!(n.C!==void 0^n.M!==void 0^n.s!==void 0))throw new Error("Conversion requires one and only one: 'C', 'M' or 's'");if(!(n.h!==void 0^n.H!==void 0))throw new Error("Conversion requires one and only one: 'h' or 'H'");if(n.J===0||n.Q===0)return[0,0,0];let r=0;n.h!==void 0?r=Ns(n.h)*jE:r=Hj(n.H)*jE;const i=Math.cos(r),s=Math.sin(r);let o=0;n.J!==void 0?o=ds(n.J,1/2)*.1:n.Q!==void 0&&(o=.25*t.c*n.Q/((t.aW+4)*t.flRoot));let a=0;n.C!==void 0?a=n.C/o:n.M!==void 0?a=n.M/t.flRoot/o:n.s!==void 0&&(a=4e-4*n.s**2*(t.aW+4)/t.c);const u=ds(a*Math.pow(1.64-Math.pow(.29,t.n),-.73),10/9),l=.25*(Math.cos(r+2)+3.8),c=t.aW*ds(o,2/t.c/t.z),h=5e4/13*t.nc*t.ncb*l,f=c/t.nbb,d=23*(f+.305)*b5(u,23*h+u*(11*i+108*s)),p=d*i,g=d*s,y=zj(Br($j,[f,p,g]).map(v=>v*1/1403),t.fl);return Br(Uj,y.map((v,T)=>v*t.dRgbInv[T])).map(v=>v/100)}function F5(n,t){const r=n.map(C=>C*100),i=N5(Br(k5,r).map((C,E)=>C*t.dRgb[E]),t.fl),s=i[0]+(-12*i[1]+i[2])/11,o=(i[0]+i[1]-2*i[2])/9,a=(Math.atan2(o,s)%Km+Km)%Km,u=.25*(Math.cos(a+2)+3.8),l=5e4/13*t.nc*t.ncb*b5(u*Math.sqrt(s**2+o**2),i[0]+i[1]+1.05*i[2]+.305),c=ds(l,.9)*Math.pow(1.64-Math.pow(.29,t.n),.73),h=t.nbb*(2*i[0]+i[1]+.05*i[2]),f=ds(h/t.aW,.5*t.c*t.z),d=100*ds(f,2),p=4/t.c*f*(t.aW+4)*t.flRoot,g=c*f,y=g*t.flRoot,v=Ns(a*Gj),T=qj(v),_=50*ds(t.c*c/(t.aW+4),1/2);return{J:d,C:g,h:v,s:_,Q:p,M:y,H:T}}new _t({id:"cam16-jmh",cssId:"--cam16-jmh",name:"CAM16-JMh",coords:{j:{refRange:[0,100],name:"J"},m:{refRange:[0,105],name:"Colorfulness"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:vo,fromBase(n){const t=F5(n,GE);return[t.J,t.M,t.h]},toBase(n){return Oy({J:n[0],M:n[1],h:n[2]},GE)}});const Wj=ps.D65,Kj=216/24389,P5=24389/27;function Yj(n){return 116*(n>Kj?Math.cbrt(n):(P5*n+16)/116)-16}function Vy(n){return n>8?Math.pow((n+16)/116,3):n/P5}function Xj(n,t){let[r,i,s]=n,o=[],a=0;if(s===0)return[0,0,0];let u=Vy(s);s>0?a=.00379058511492914*s**2+.608983189401032*s+.9155088574762233:a=9514440756550361e-21*s**2+.08693057439788597*s-21.928975842194614;const l=2e-12,c=15;let h=0,f=1/0;for(;h<=c;){o=Oy({J:a,C:i,h:r},t);const d=Math.abs(o[1]-u);if(d<f){if(d<=l)return o;f=d}a=a-(o[1]-u)*a/(2*o[1]),h+=1}return Oy({J:a,C:i,h:r},t)}function Zj(n,t){const r=Yj(n[1]);if(r===0)return[0,0,0];const i=F5(n,s_);return[Ns(i.h),i.C,r]}const s_=R5(Wj,200/Math.PI*Vy(50),Vy(50)*100,"average",!1),mp=new _t({id:"hct",name:"HCT",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},c:{refRange:[0,145],name:"Colorfulness"},t:{refRange:[0,100],name:"Tone"}},base:vo,fromBase(n){return Zj(n)},toBase(n){return Xj(n,s_)},formats:{color:{id:"--hct",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),Qj=Math.PI/180,zE=[1,.007,.0228];function qE(n){n[1]<0&&(n=mp.fromBase(mp.toBase(n)));const t=Math.log(Math.max(1+zE[2]*n[1]*s_.flRoot,1))/zE[2],r=n[0]*Qj,i=t*Math.cos(r),s=t*Math.sin(r);return[n[2],i,s]}function Jj(n,t){[n,t]=Rr([n,t]);let[r,i,s]=qE(mp.from(n)),[o,a,u]=qE(mp.from(t));return Math.sqrt((r-o)**2+(i-a)**2+(s-u)**2)}const HE={deltaE76:_j,deltaECMC:xj,deltaE2000:S5,deltaEJz:Dj,deltaEITP:Vj,deltaEOK:Ly,deltaEHCT:Jj};function eG(n){const t=n?Math.floor(Math.log10(Math.abs(n))):0;return Math.max(parseFloat(`1e${t-2}`),1e-6)}const WE={hct:{method:"hct.c",jnd:2,deltaEMethod:"hct",blackWhiteClamp:{}},"hct-tonal":{method:"hct.c",jnd:0,deltaEMethod:"hct",blackWhiteClamp:{channel:"hct.t",min:0,max:100}}};function Fa(n,{method:t=Na.gamut_mapping,space:r=void 0,deltaEMethod:i="",jnd:s=2,blackWhiteClamp:o={}}={}){if(n=Rr(n),v5(arguments[1])?r=arguments[1]:r||(r=n.space),r=_t.get(r),Mu(n,r,{epsilon:0}))return n;let a;if(t==="css")a=tG(n,{space:r});else{if(t!=="clip"&&!Mu(n,r)){Object.prototype.hasOwnProperty.call(WE,t)&&({method:t,jnd:s,deltaEMethod:i,blackWhiteClamp:o}=WE[t]);let u=S5;if(i!==""){for(let c in HE)if("deltae"+i.toLowerCase()===c.toLowerCase()){u=HE[c];break}}let l=Fa(Ct(n,r),{method:"clip",space:r});if(u(n,l)>s){if(Object.keys(o).length===3){let _=_t.resolveCoord(o.channel),C=ca(Ct(n,_.space),_.id);if(Py(C)&&(C=0),C>=o.max)return Ct({space:"xyz-d65",coords:ps.D65},n.space);if(C<=o.min)return Ct({space:"xyz-d65",coords:[0,0,0]},n.space)}let c=_t.resolveCoord(t),h=c.space,f=c.id,d=Ct(n,h);d.coords.forEach((_,C)=>{Py(_)&&(d.coords[C]=0)});let g=(c.range||c.refRange)[0],y=eG(s),v=g,T=ca(d,f);for(;T-v>y;){let _=vh(d);_=Fa(_,{space:r,method:"clip"}),u(d,_)-s<y?v=ca(d,f):T=ca(d,f),yh(d,f,(v+T)/2)}a=Ct(d,r)}else a=l}else a=Ct(n,r);if(t==="clip"||!Mu(a,r,{epsilon:0})){let u=Object.values(r.coords).map(l=>l.range||[]);a.coords=a.coords.map((l,c)=>{let[h,f]=u[c];return h!==void 0&&(l=Math.max(h,l)),f!==void 0&&(l=Math.min(l,f)),l})}}return r!==n.space&&(a=Ct(a,n.space)),n.coords=a.coords,n}Fa.returns="color";const KE={WHITE:{space:Ra,coords:[1,0,0]},BLACK:{space:Ra,coords:[0,0,0]}};function tG(n,{space:t}={}){n=Rr(n),t||(t=n.space),t=_t.get(t);const s=_t.get("oklch");if(t.isUnbounded)return Ct(n,t);const o=Ct(n,s);let a=o.coords[0];if(a>=1){const g=Ct(KE.WHITE,t);return g.alpha=n.alpha,Ct(g,t)}if(a<=0){const g=Ct(KE.BLACK,t);return g.alpha=n.alpha,Ct(g,t)}if(Mu(o,t,{epsilon:0}))return Ct(o,t);function u(g){const y=Ct(g,t),v=Object.values(t.coords);return y.coords=y.coords.map((T,_)=>{if("range"in v[_]){const[C,E]=v[_].range;return ij(C,T,E)}return T}),y}let l=0,c=o.coords[1],h=!0,f=vh(o),d=u(f),p=Ly(d,f);if(p<.02)return d;for(;c-l>1e-4;){const g=(l+c)/2;if(f.coords[1]=g,h&&Mu(f,t,{epsilon:0}))l=g;else if(d=u(f),p=Ly(d,f),p<.02){if(.02-p<1e-4)break;h=!1,l=g}else c=g}return d}function Ct(n,t,{inGamut:r}={}){n=Rr(n),t=_t.get(t);let i=t.from(n),s={space:t,coords:i,alpha:n.alpha};return r&&(s=Fa(s,r===!0?void 0:r)),s}Ct.returns="color";function rG(n,{precision:t=Na.precision,format:r="default",inGamut:i=!0,...s}={}){var l;let o;n=Rr(n);let a=r;r=n.space.getFormat(r)??n.space.getFormat("default")??_t.DEFAULT_FORMAT;let u=n.coords.slice();if(i||(i=r.toGamut),i&&!Mu(n)&&(u=Fa(vh(n),i===!0?void 0:i).coords),r.type==="custom")if(s.precision=t,r.serialize)o=r.serialize(u,n.alpha,s);else throw new TypeError(`format ${a} can only be used to parse colors, not for serialization`);else{let c=r.name||"color";r.serializeCoords?u=r.serializeCoords(u,t):t!==null&&(u=u.map(p=>Fy(p,{precision:t})));let h=[...u];if(c==="color"){let p=r.id||((l=r.ids)==null?void 0:l[0])||n.space.id;h.unshift(p)}let f=n.alpha;t!==null&&(f=Fy(f,{precision:t}));let d=n.alpha>=1||r.noAlpha?"":`${r.commas?",":" /"} ${f}`;o=`${c}(${h.join(r.commas?", ":" ")}${d})`}return o}const nG=[[.4865709486482162,.26566769316909306,.1982172852343625],[.2289745640697488,.6917385218365064,.079286914093745],[0,.04511338185890264,1.043944368900976]],iG=[[2.493496911941425,-.9313836179191239,-.40271078445071684],[-.8294889695615747,1.7626640603183463,.023624685841943577],[.03584583024378447,-.07617238926804182,.9568845240076872]],sG=new zg({id:"p3-linear",cssId:"--display-p3-linear",name:"Linear P3",white:"D65",toXYZ_M:nG,fromXYZ_M:iG}),oG=[[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],aG=[[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],uG=new zg({id:"srgb-linear",name:"Linear sRGB",white:"D65",toXYZ_M:oG,fromXYZ_M:aG}),YE={aliceblue:[240/255,248/255,1],antiquewhite:[250/255,235/255,215/255],aqua:[0,1,1],aquamarine:[127/255,1,212/255],azure:[240/255,1,1],beige:[245/255,245/255,220/255],bisque:[1,228/255,196/255],black:[0,0,0],blanchedalmond:[1,235/255,205/255],blue:[0,0,1],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,1,0],chocolate:[210/255,105/255,30/255],coral:[1,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[1,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0,1,1],darkblue:[0,0,139/255],darkcyan:[0,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0,100/255,0],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[1,140/255,0],darkorchid:[153/255,50/255,204/255],darkred:[139/255,0,0],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0,206/255,209/255],darkviolet:[148/255,0,211/255],deeppink:[1,20/255,147/255],deepskyblue:[0,191/255,1],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,1],firebrick:[178/255,34/255,34/255],floralwhite:[1,250/255,240/255],forestgreen:[34/255,139/255,34/255],fuchsia:[1,0,1],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,1],gold:[1,215/255,0],goldenrod:[218/255,165/255,32/255],gray:[128/255,128/255,128/255],green:[0,128/255,0],greenyellow:[173/255,1,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,1,240/255],hotpink:[1,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0,130/255],ivory:[1,1,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[1,240/255,245/255],lawngreen:[124/255,252/255,0],lemonchiffon:[1,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,1,1],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[1,182/255,193/255],lightsalmon:[1,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,153/255],lightslategrey:[119/255,136/255,153/255],lightsteelblue:[176/255,196/255,222/255],lightyellow:[1,1,224/255],lime:[0,1,0],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[1,0,1],maroon:[128/255,0,0],mediumaquamarine:[102/255,205/255,170/255],mediumblue:[0,0,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0,250/255,154/255],mediumturquoise:[72/255,209/255,204/255],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,1,250/255],mistyrose:[1,228/255,225/255],moccasin:[1,228/255,181/255],navajowhite:[1,222/255,173/255],navy:[0,0,128/255],oldlace:[253/255,245/255,230/255],olive:[128/255,128/255,0],olivedrab:[107/255,142/255,35/255],orange:[1,165/255,0],orangered:[1,69/255,0],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[1,239/255,213/255],peachpuff:[1,218/255,185/255],peru:[205/255,133/255,63/255],pink:[1,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],purple:[128/255,0,128/255],rebeccapurple:[102/255,51/255,153/255],red:[1,0,0],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[1,245/255,238/255],sienna:[160/255,82/255,45/255],silver:[192/255,192/255,192/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[1,250/255,250/255],springgreen:[0,1,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],teal:[0,128/255,128/255],thistle:[216/255,191/255,216/255],tomato:[1,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],white:[1,1,1],whitesmoke:[245/255,245/255,245/255],yellow:[1,1,0],yellowgreen:[154/255,205/255,50/255]};let XE=Array(3).fill("<percentage> | <number>[0, 255]"),ZE=Array(3).fill("<number>[0, 255]");const dl=new zg({id:"srgb",name:"sRGB",base:uG,fromBase:n=>n.map(t=>{let r=t<0?-1:1,i=t*r;return i>.0031308?r*(1.055*i**(1/2.4)-.055):12.92*t}),toBase:n=>n.map(t=>{let r=t<0?-1:1,i=t*r;return i<=.04045?t/12.92:r*((i+.055)/1.055)**2.4}),formats:{rgb:{coords:XE},rgb_number:{name:"rgb",commas:!0,coords:ZE,noAlpha:!0},color:{},rgba:{coords:XE,commas:!0,lastAlpha:!0},rgba_number:{name:"rgba",commas:!0,coords:ZE},hex:{type:"custom",toGamut:!0,test:n=>/^#([a-f0-9]{3,4}){1,2}$/i.test(n),parse(n){n.length<=5&&(n=n.replace(/[a-f0-9]/gi,"$&$&"));let t=[];return n.replace(/[a-f0-9]{2}/gi,r=>{t.push(parseInt(r,16)/255)}),{spaceId:"srgb",coords:t.slice(0,3),alpha:t.slice(3)[0]}},serialize:(n,t,{collapse:r=!0}={})=>{t<1&&n.push(t),n=n.map(o=>Math.round(o*255));let i=r&&n.every(o=>o%17===0);return"#"+n.map(o=>i?(o/17).toString(16):o.toString(16).padStart(2,"0")).join("")}},keyword:{type:"custom",test:n=>/^[a-z]+$/i.test(n),parse(n){n=n.toLowerCase();let t={spaceId:"srgb",coords:null,alpha:1};if(n==="transparent"?(t.coords=YE.black,t.alpha=0):t.coords=YE[n],t.coords)return t}}}}),QE=new zg({id:"p3",cssId:"display-p3",name:"P3",base:sG,fromBase:dl.fromBase,toBase:dl.toBase});function M5(n,t,r={}){if(lG(n)){let[l,c]=[n,t];return M5(...l.rangeArgs.colors,{...l.rangeArgs.options,...c})}let{space:i,outputSpace:s,progression:o,premultiplied:a}=r;n=Rr(n),t=Rr(t),n=vh(n),t=vh(t);let u={colors:[n,t],options:r};if(i?i=_t.get(i):i=_t.registry[Na.interpolationSpace]||n.space,s=s?_t.get(s):i,n=Ct(n,i),t=Ct(t,i),n=Fa(n),t=Fa(t),i.coords.h&&i.coords.h.type==="angle"){let l=r.hue=r.hue||"shorter",c=[i,"h"],[h,f]=[ca(n,c),ca(t,c)];isNaN(h)&&!isNaN(f)?h=f:isNaN(f)&&!isNaN(h)&&(f=h),[h,f]=fj(l,[h,f]),yh(n,c,h),yh(t,c,f)}return a&&(n.coords=n.coords.map(l=>l*n.alpha),t.coords=t.coords.map(l=>l*t.alpha)),Object.assign(l=>{l=o?o(l):l;let c=n.coords.map((d,p)=>{let g=t.coords[p];return fp(d,g,l)}),h=fp(n.alpha,t.alpha,l),f={space:i,coords:c,alpha:h};return a&&(f.coords=f.coords.map(d=>d/h)),s!==i&&(f=Ct(f,s)),f},{rangeArgs:u})}function lG(n){return Pu(n)==="function"&&!!n.rangeArgs}Na.interpolationSpace="lab";const By=new _t({id:"hsl",name:"HSL",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:dl,fromBase:n=>{let t=Math.max(...n),r=Math.min(...n),[i,s,o]=n,[a,u,l]=[NaN,0,(r+t)/2],c=t-r;if(c!==0){switch(u=l===0||l===1?0:(t-l)/Math.min(l,1-l),t){case i:a=(s-o)/c+(s<o?6:0);break;case s:a=(o-i)/c+2;break;case o:a=(i-s)/c+4}a=a*60}return u<0&&(a+=180,u=Math.abs(u)),a>=360&&(a-=360),[a,u*100,l*100]},toBase:n=>{let[t,r,i]=n;t=t%360,t<0&&(t+=360),r/=100,i/=100;function s(o){let a=(o+t/30)%12,u=r*Math.min(i,1-i);return i-u*Math.max(-1,Math.min(a-3,9-a,1))}return[s(0),s(8),s(4)]},formats:{hsl:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsla:{coords:["<number> | <angle>","<percentage>","<percentage>"],commas:!0,lastAlpha:!0}}}),cG=new _t({id:"hsv",name:"HSV",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},v:{range:[0,100],name:"Value"}},base:By,fromBase(n){let[t,r,i]=n;r/=100,i/=100;let s=i+r*Math.min(i,1-i);return[t,s===0?0:200*(1-i/s),100*s]},toBase(n){let[t,r,i]=n;r/=100,i/=100;let s=i*(1-r/2);return[t,s===0||s===1?0:(i-s)/Math.min(s,1-s)*100,s*100]},formats:{color:{id:"--hsv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),JE=new _t({id:"hwb",name:"HWB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},w:{range:[0,100],name:"Whiteness"},b:{range:[0,100],name:"Blackness"}},base:cG,fromBase(n){let[t,r,i]=n;return[t,i*(100-r)/100,100-i]},toBase(n){let[t,r,i]=n;r/=100,i/=100;let s=r+i;if(s>=1){let u=r/s;return[t,0,u*100]}let o=1-i,a=o===0?0:1-r/o;return[t,a*100,o*100]},formats:{hwb:{coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),eS=new _t({id:"oklch",name:"Oklch",coords:{l:{refRange:[0,1],name:"Lightness"},c:{refRange:[0,.4],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},white:"D65",base:Ra,fromBase(n){let[t,r,i]=n,s;const o=2e-4;return Math.abs(r)<o&&Math.abs(i)<o?s=NaN:s=Math.atan2(i,r)*180/Math.PI,[t,Math.sqrt(r**2+i**2),Ns(s)]},toBase(n){let[t,r,i]=n,s,o;return isNaN(i)?(s=0,o=0):(s=r*Math.cos(i*Math.PI/180),o=r*Math.sin(i*Math.PI/180)),[t,s,o]},formats:{oklch:{coords:["<percentage> | <number>","<number> | <percentage>[0,1]","<number> | <angle>"]}}});var tS=new _t({id:"hsb",name:"HSB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},b:{range:[0,100],name:"Brightness"}},base:dl,fromBase:n=>{const t=Math.max(...n),r=t-Math.min(...n);let[i,s,o]=n,a,u;return r===0?(a=0,u=0):(u=r/t,i===t?a=(s-o)/r:s===t?a=2+(o-i)/r:o===t&&(a=4+(i-s)/r),a<0?a+=6:a>=6&&(a-=6)),[a/6*360,u*100,t*100]},toBase:rS,formats:{default:{type:"custom",serialize:(n,t)=>{const r=rS(n);let i=`rgb(${Math.round(r[0]*100*100)/100}% ${Math.round(r[1]*100*100)/100}% ${Math.round(r[2]*100*100)/100}%`;return t<1&&(i+=` / ${t}`),i+=")",i}},hsb:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsba:{coords:["<number> | <angle>","<percentage>","<percentage>"],commans:!0,lastAlpha:!0}}});function rS(n){const t=n[0]/360*6,r=n[1]/100,i=n[2]/100;let s=[];if(r===0)s=[i,i,i];else{const o=Math.floor(t),a=i*(1-r),u=i*(1-r*(t-o)),l=i*(1-r*(1+o-t));let c,h,f;o===1?(c=u,h=i,f=a):o===2?(c=a,h=i,f=l):o===3?(c=a,h=u,f=i):o===4?(c=l,h=a,f=i):o===5?(c=i,h=a,f=u):(c=i,h=l,f=a),s=[c,h,f]}return s}const er=(n,t,r,i,s,o)=>{let a=(n-t)/(r-t)*(s-i)+i;return o&&(a=Math.max(a,Math.min(i,s)),a=Math.min(a,Math.max(i,s))),a},nS={};var Jt,Js,uv,hG;const ht=class ht{constructor(t,r,i,{clamp:s=!1}={}){Zt(this,uv);Nt(this,"_color");Nt(this,"mode");if(this.mode=r||nr,t instanceof ht){const o=r?ht.colorMap[r]:ht.colorMap[t.mode];this._color=Ct(t._color,o),this.mode=o}else if(typeof t=="object"&&!Array.isArray(t)&&t!==null){const o=r?ht.colorMap[r]:t.spaceId;this._color=Ct(t,o),this.mode=r||Object.entries(ht.colorMap).find(([a,u])=>u===this._color.spaceId)}else if(typeof t[0]=="string")try{this._color=x5(t[0]);const[o]=Object.entries(ht.colorMap).find(([a,u])=>u===this._color.spaceId);this.mode=o,this._color=Ct(this._color,this._color.spaceId)}catch{throw new Error("Invalid color string")}else{let o;if(i)if(t.length===4)o=ht.mapColorRange(t,this.mode,i,s);else if(t.length===3)o=ht.mapColorRange([t[0],t[1],t[2]],this.mode,i,s),o.push(1);else if(t.length===2){Ve(ht,Js)[this.mode]?o=Ve(ht,Js)[this.mode](t[0],i,s):o=ht.mapColorRange([t[0],t[0],t[0]],this.mode,i,s);const c=Array.isArray(i[i.length-1])?i[i.length-1]:[0,i[i.length-1]];o.push(er(t[1],c[0],c[1],0,1,s))}else if(t.length===1)Ve(ht,Js)[this.mode]?o=Ve(ht,Js)[this.mode](t[0],i,s):o=ht.mapColorRange([t[0],t[0],t[0]],this.mode,i,s),o.push(1);else throw new Error("Invalid color");else o=t;const a=ht.colorMap[this.mode]||console.error("Invalid color mode"),u=o.slice(0,3),l={space:a,coords:u,alpha:o[3]};this._color=Ct(l,a)}}static addColorMode(t,r){_t.register(r),ht.colorMap[t]=r.id,Ve(ht,Jt)[t]=Object.values(r.coords).reduce((i,s)=>(i.push(s.refRange||s.range),i),[]),Ve(ht,Jt)[t].push([0,1]),Ve(ht,Js)[t]=r.fromGray}static mapColorRange(t,r,i,s){const o=i.map(u=>Array.isArray(u)?u:[0,u]),a=Ve(ht,Jt)[r];return t.map((u,l)=>er(u,o[l][0],o[l][1],a[l][0],a[l][1],s))}static unmapColorRange(t,r,i){const s=i.map(a=>Array.isArray(a)?a:[0,a]),o=Ve(ht,Jt)[r];return t.map((a,u)=>er(a,o[u][0],o[u][1],s[u][0],s[u][1]))}get _array(){return this._getRGBA()}array(){return this._array}lerp(t,r,i){let s=-1;for(;(s+1<this._color.space.path.length||s+1<t._color.space.path.length)&&this._color.space.path[s+1]===t._color.space.path[s+1];)s+=1;if(s===-1)throw new Error("Cannot lerp colors. No common color space found");const o=M5(this._color,t._color,{space:this._color.space.path[s].id})(r);return new ht(o,i||this.mode)}toString(t){const r=`${this._color.space.id}-${this._color.coords.join(",")}-${this._color.alpha}-${t}`;let i=nS[r];return i||(i=rG(this._color,{format:t}),nS[r]=i),i}setRed(t,r=[0,1]){Array.isArray(r)||(r=[0,r]);const i=Ve(ht,Jt)[nr][0],s=er(t,r[0],r[1],i[0],i[1]);if(this.mode===nr||this.mode===mn)this._color.coords[0]=s;else{const o=this._color.space.id,a=Ct(this._color,"srgb");a.coords[0]=s,this._color=Ct(a,o)}}setGreen(t,r=[0,1]){Array.isArray(r)||(r=[0,r]);const i=Ve(ht,Jt)[nr][1],s=er(t,r[0],r[1],i[0],i[1]);if(this.mode===nr||this.mode===mn)this._color.coords[1]=s;else{const o=this._color.space.id,a=Ct(this._color,"srgb");a.coords[1]=s,this._color=Ct(a,o)}}setBlue(t,r=[0,1]){Array.isArray(r)||(r=[0,r]);const i=Ve(ht,Jt)[nr][2],s=er(t,r[0],r[1],i[0],i[1]);if(this.mode===nr||this.mode===mn)this._color.coords[2]=s;else{const o=this._color.space.id,a=Ct(this._color,"srgb");a.coords[2]=s,this._color=Ct(a,o)}}setAlpha(t,r=[0,1]){Array.isArray(r)||(r=[0,r]);const i=Ve(ht,Jt)[this.mode][3],s=er(t,r[0],r[1],i[0],i[1]);this._color.alpha=s}_getRGBA(t=[1,1,1,1]){const r=Ve(ht,Jt)[nr];let i=structuredClone(Ct(this._color,"srgb").coords);i.push(this._color.alpha);const s=t.map(o=>Array.isArray(o)?o:[0,o]);return i=i.map((o,a)=>er(o,r[a][0],r[a][1],s[a][0],s[a][1])),i}_getMode(){return this.mode}_getRed(t=[0,1]){if(Array.isArray(t)||(t=[0,t]),this.mode===nr||this.mode===mn){const r=Ve(ht,Jt)[this.mode][0];return er(this._color.coords[0],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[nr][0];return er(Ct(this._color,"srgb").coords[0],r[0],r[1],t[0],t[1])}}_getGreen(t=[0,1]){if(Array.isArray(t)||(t=[0,t]),this.mode===nr||this.mode===mn){const r=Ve(ht,Jt)[this.mode][1];return er(this._color.coords[1],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[nr][1];return er(Ct(this._color,"srgb").coords[1],r[0],r[1],t[0],t[1])}}_getBlue(t=[0,1]){if(Array.isArray(t)||(t=[0,t]),this.mode===nr||this.mode===mn){const r=Ve(ht,Jt)[this.mode][2];return er(this._color.coords[2],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[nr][2];return er(Ct(this._color,"srgb").coords[2],r[0],r[1],t[0],t[1])}}_getAlpha(t=[0,1]){Array.isArray(t)||(t=[0,t]);const r=Ve(ht,Jt)[this.mode][3];return er(this._color.alpha,r[0],r[1],t[0],t[1])}_getHue(t=[0,360]){if(Array.isArray(t)||(t=[0,t]),this.mode===Xn||this.mode===kn){const r=Ve(ht,Jt)[this.mode][0];return er(this._color.coords[0],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[kn][0];return er(Ct(this._color,"hsl").coords[0],r[0],r[1],t[0],t[1])}}_getSaturation(t=[0,100]){if(Array.isArray(t)||(t=[0,t]),this.mode===Xn||this.mode===kn){const r=Ve(ht,Jt)[this.mode][1];return er(this._color.coords[1],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[kn][1];return er(Ct(this._color,"hsl").coords[1],r[0],r[1],t[0],t[1])}}_getBrightness(t=[0,100]){if(Array.isArray(t)||(t=[0,t]),this.mode===Xn){const r=Ve(ht,Jt)[this.mode][2];return er(this._color.coords[2],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[Xn][2];return er(Ct(this._color,"hsb").coords[2],r[0],r[1],t[0],t[1])}}_getLightness(t=[0,100]){if(Array.isArray(t)||(t=[0,t]),this.mode===kn){const r=Ve(ht,Jt)[this.mode][2];return er(this._color.coords[2],r[0],r[1],t[0],t[1])}else{const r=Ve(ht,Jt)[kn][2];return er(Ct(this._color,"hsl").coords[2],r[0],r[1],t[0],t[1])}}};Jt=new WeakMap,Js=new WeakMap,uv=new WeakSet,hG=function(t){return new ht(this._color,t)},Nt(ht,"colorMap",{}),Zt(ht,Jt,{}),Zt(ht,Js,{});let ir=ht;function L5(n,t,r){n.Color=ir,dl.fromGray=QE.fromGray=function(i,s,o){const a=s.map(l=>Array.isArray(l)?l:[0,l]),u=er(i,a[2][0],a[2][1],0,1,o);return[u,u,u]},tS.fromGray=By.fromGray=function(i,s,o){const a=s.map(l=>Array.isArray(l)?l:[0,l]);return[0,0,er(i,a[2][0],a[2][1],0,100,o)]},JE.fromGray=function(i,s,o){const a=s.map(f=>Array.isArray(f)?f:[0,f]),u=Math.abs(a[1][0]-a[1][1])/2+Math.abs(a[2][0]-a[2][1])/2,l=er(i,0,u,0,100);let c,h;return l<50?(h=l,c=100-l):l>=50&&(c=l,h=100-l),[0,c,h]},pi.fromGray=fl.fromGray=Ra.fromGray=eS.fromGray=function(i,s,o){const a=s.map(l=>Array.isArray(l)?l:[0,l]);return[er(i,a[0][0],a[0][1],0,100,o),0,0]},n.Color.addColorMode(nr,dl),n.Color.addColorMode(mn,QE),n.Color.addColorMode(Xn,tS),n.Color.addColorMode(kn,By),n.Color.addColorMode(Lu,JE),n.Color.addColorMode(_h,pi),n.Color.addColorMode(Ou,fl),n.Color.addColorMode(bh,Ra),n.Color.addColorMode(Vu,eS),r.presetup=function(){const i=this,s=["Red","Green","Blue","Alpha"];for(let a in s){const u=s[a],l=n.Color.prototype["set"+u];n.Color.prototype["set"+u]=function(c,h){var f,d,p;return h=h||((p=(d=(f=i==null?void 0:i._renderer)==null?void 0:f.states)==null?void 0:d.colorMaxes)==null?void 0:p[nr][a]),l.call(this,c,h)}}function o(a,u){const l=n.Color.prototype["_get"+a];n.Color.prototype["_get"+a]=function(c){var h,f,d,p,g,y;if(Object.keys(u).includes(this.mode))c=c||((d=(f=(h=i==null?void 0:i._renderer)==null?void 0:h.states)==null?void 0:f.colorMaxes)==null?void 0:d[this.mode][u[this.mode]]);else{const v=Object.keys(u)[0];c=c||((y=(g=(p=i==null?void 0:i._renderer)==null?void 0:p.states)==null?void 0:g.colorMaxes)==null?void 0:y[v][u[v]])}return l.call(this,c)}}o("Red",{[nr]:0,[mn]:0}),o("Green",{[nr]:1,[mn]:1}),o("Blue",{[nr]:2,[mn]:2}),o("Alpha",{[nr]:3,[mn]:3,[Xn]:3,[kn]:3,[Lu]:3,[_h]:3,[Ou]:3,[bh]:3,[Vu]:3}),o("Hue",{[kn]:0,[Xn]:0,[Lu]:0,[Ou]:2,[Vu]:2}),o("Saturation",{[kn]:1,[Xn]:1}),o("Brightness",{[Xn]:2}),o("Lightness",{[kn]:2})}}typeof p5<"u"&&L5(p5,p5.prototype);const nr="rgb",mn="rgbhdr",Xn="hsb",kn="hsl",Lu="hwb",_h="lab",Ou="lch",bh="oklab",Vu="oklch",yd="rgba";function o_(n,t){t.RGB=nr,t.RGBHDR=mn,t.HSB=Xn,t.HSL=kn,t.HWB=Lu,t.LAB=_h,t.LCH=Ou,t.OKLAB=bh,t.OKLCH=Vu,t.RGBA=yd,n.Renderer.states.colorMode=nr,n.Renderer.states.colorMaxes={[nr]:[255,255,255,255],[mn]:[255,255,255,255],[Xn]:[360,100,100,1],[kn]:[360,100,100,1],[Lu]:[360,100,100,1],[_h]:[100,[-125,125],[-125,125],1],[Ou]:[100,150,360,1],[bh]:[100,[-125,125],[-125,125],1],[Vu]:[100,150,360,1],clone:function(){const r={...this};for(const i in r)r[i]instanceof Array&&(r[i]=[...r[i]]);return r}},t.color=function(...r){if(r[0]instanceof ir)return r[0];const i=Array.isArray(r[0])?r[0]:r;return new ir(i,this._renderer.states.colorMode,this._renderer.states.colorMaxes[this._renderer.states.colorMode],{clamp:!0})},t.red=function(r){return this.color(r)._getRed()},t.green=function(r){return this.color(r)._getGreen()},t.blue=function(r){return this.color(r)._getBlue()},t.alpha=function(r){return this.color(r)._getAlpha()},t.hue=function(r){return this.color(r)._getHue()},t.saturation=function(r){return this.color(r)._getSaturation()},t.brightness=function(r){return this.color(r)._getBrightness()},t.lightness=function(r){return this.color(r)._getLightness()},t.lerpColor=function(r,i,s){return r.lerp(i,s,this._renderer.states.colorMode)},t.paletteLerp=function(r,i){const s=r[0];if(i<s[1])return this.color(s[0]);for(let o=1;o<r.length;o++){const a=r[o];if(i<a[1]){const u=r[o-1];return this.lerpColor(this.color(u[0]),this.color(a[0]),(i-u[1])/(a[1]-u[1]))}}return this.color(r[r.length-1][0])}}typeof p5<"u"&&o_(p5,p5.prototype);class no{constructor(t){if(t)this.DOM=t;else{const r=document.implementation.createDocument(null,"doc");this.DOM=r.createElement("root")}}getParent(){return new no(this.DOM.parentElement)}getName(){return this.DOM.tagName}setName(t){const r=this.DOM.innerHTML,i=this.DOM.attributes,o=document.implementation.createDocument(null,"default").createElement(t);o.innerHTML=r;for(let a=0;a<i.length;a++)o.setAttribute(i[a].nodeName,i[a].nodeValue);this.DOM=o}hasChildren(){return this.DOM.children.length>0}listChildren(){const t=[];for(let r=0;r<this.DOM.childNodes.length;r++)t.push(this.DOM.childNodes[r].nodeName);return t}getChildren(t){return iS(t?this.DOM.getElementsByTagName(t):this.DOM.children)}getChild(t){if(typeof t=="string"){for(const r of this.DOM.children)if(r.tagName===t)return new no(r)}else return new no(this.DOM.children[t])}addChild(t){t instanceof no&&this.DOM.appendChild(t.DOM)}removeChild(t){let r=-1;if(typeof t=="string"){for(let i=0;i<this.DOM.children.length;i++)if(this.DOM.children[i].tagName===t){r=i;break}}else r=t;r!==-1&&this.DOM.removeChild(this.DOM.children[r])}getAttributeCount(){return this.DOM.attributes.length}listAttributes(){const t=[];for(const r of this.DOM.attributes)t.push(r.nodeName);return t}hasAttribute(t){const r={};for(const i of this.DOM.attributes)r[i.nodeName]=i.nodeValue;return!!r[t]}getNum(t,r){const i={};for(const s of this.DOM.attributes)i[s.nodeName]=s.nodeValue;return Number(i[t])||r||0}getString(t,r){const i={};for(const s of this.DOM.attributes)i[s.nodeName]=s.nodeValue;return i[t]?String(i[t]):r||null}setAttribute(t,r){this.DOM.setAttribute(t,r)}getContent(t){let r;return r=this.DOM.textContent,r=r.replace(/\s\s+/g,","),r||t||null}setContent(t){this.DOM.children.length||(this.DOM.textContent=t)}serialize(){return new XMLSerializer().serializeToString(this.DOM)}}function iS(n){const t=[];for(let r=0;r<n.length;r++)t.push(new no(n[r]));return t}function O5(n,t){n.XML=no}typeof p5<"u"&&O5(p5,p5.prototype);class io{constructor(t,r){this.file=t,this._pInst=r;const i=t.type.split("/");this.type=i[0],this.subtype=i[1],this.name=t.name,this.size=t.size,this.data=void 0}static _createLoader(t,r){const i=new FileReader;return i.onload=function(s){const o=new io(t);if(o.file.type==="application/json")o.data=JSON.parse(s.target.result);else if(o.file.type==="text/xml"){const u=new DOMParser().parseFromString(s.target.result,"text/xml");o.data=new no(u.documentElement)}else o.data=s.target.result;r(o)},i}static _load(t,r){if(/^text\//.test(t.type)||t.type==="application/json")io._createLoader(t,r).readAsText(t);else if(!/^(video|audio)\//.test(t.type))io._createLoader(t,r).readAsDataURL(t);else{const i=new io(t);i.data=URL.createObjectURL(t),r(i)}}}function V5(n,t){n.File=io}typeof p5<"u"&&V5(p5,p5.prototype);let Lr=class Pr{constructor(t,r){Nt(this,"width");Nt(this,"height");Nt(this,"elt");this.elt=t,this._pInst=this._pixelsState=r,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight}remove(){if(this.stop){this.stop();const r=this.elt.srcObject;r!==null&&r.getTracks().forEach(s=>{s.stop()})}const t=this._pInst._elements.indexOf(this);t!==-1&&this._pInst._elements.splice(t,1);for(let r in this._events)this.elt.removeEventListener(r,this._events[r]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)}parent(t){return typeof t>"u"?this.elt.parentNode:(typeof t=="string"?(t[0]==="#"&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof Pr&&(t=t.elt),t.appendChild(this.elt),this)}child(t){return typeof t>"u"?this.elt.childNodes:(typeof t=="string"?(t[0]==="#"&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof Pr&&(t=t.elt),t instanceof HTMLElement&&this.elt.appendChild(t),this)}html(...t){return t.length===0?this.elt.innerHTML:t[1]?(this.elt.insertAdjacentHTML("beforeend",t[0]),this):(this.elt.innerHTML=t[0],this)}id(t){return typeof t>"u"?this.elt.id:(this.elt.id=t,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)}class(t){return typeof t>"u"?this.elt.className:(this.elt.className=t,this)}addClass(t){return this.elt.className?this.hasClass(t)||(this.elt.className=this.elt.className+" "+t):this.elt.className=t,this}removeClass(t){return this.elt.classList.remove(t),this}hasClass(t){return this.elt.classList.contains(t)}toggleClass(t){return this.elt.classList.contains(t)?this.elt.classList.remove(t):this.elt.classList.add(t),this}center(t){const r=this.elt.style.display,i=this.elt.style.display==="none",s=this.parent().style.display==="none",o={x:this.elt.offsetLeft,y:this.elt.offsetTop};i&&this.show(),s&&this.parent().show(),this.elt.style.display="block",this.position(0,0);const a=Math.abs(this.parent().offsetWidth-this.elt.offsetWidth),u=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return t==="both"||t===void 0?this.position(a/2+this.parent().offsetLeft,u/2+this.parent().offsetTop):t==="horizontal"?this.position(a/2+this.parent().offsetLeft,o.y):t==="vertical"&&this.position(o.x,u/2+this.parent().offsetTop),this.style("display",r),i&&this.hide(),s&&this.parent().hide(),this}position(...t){if(t.length===0)return{x:this.elt.offsetLeft,y:this.elt.offsetTop};{let r="absolute";return(t[2]==="static"||t[2]==="fixed"||t[2]==="relative"||t[2]==="sticky"||t[2]==="initial"||t[2]==="inherit")&&(r=t[2]),this.elt.style.position=r,this.elt.style.left=t[0]+"px",this.elt.style.top=t[1]+"px",this.x=t[0],this.y=t[1],this}}show(){return this.elt.style.display="block",this}hide(){return this.elt.style.display="none",this}size(t,r){if(arguments.length===0)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};{let i=t,s=r;const o=r5;if(i!==o||s!==o){if(i===o?i=r*this.width/this.height:s===o&&(s=t*this.height/this.width),this.elt instanceof HTMLCanvasElement){const a={},u=this.elt.getContext("2d");let l;for(l in u)a[l]=u[l];this.elt.setAttribute("width",i*this._pInst._pixelDensity),this.elt.setAttribute("height",s*this._pInst._pixelDensity),this.elt.style.width=i+"px",this.elt.style.height=s+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);for(l in a)this.elt.getContext("2d")[l]=a[l]}else this.elt.style.width=i+"px",this.elt.style.height=s+"px",this.elt.width=i,this.elt.height=s;this.width=i,this.height=s,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst.width=i,this._pInst.height=s)}return this}}style(t,r){const i=this;if(r instanceof ir&&(r=r.toString()),typeof r>"u"){if(t.indexOf(":")===-1)return window.getComputedStyle(i.elt).getPropertyValue(t);{const s=t.split(";");for(let o=0;o<s.length;o++){const a=s[o].split(":");a[0]&&a[1]&&(this.elt.style[a[0].trim()]=a[1].trim())}}}else if(this.elt.style[t]=r,t==="width"||t==="height"||t==="left"||t==="top"){let a=window.getComputedStyle(i.elt).getPropertyValue(t).replace(/[^\d.]/g,"");this[t]=Math.round(parseFloat(a,10))}return this}_translate(...t){this.elt.style.position="absolute";let r="";return this.elt.style.transform&&(r=this.elt.style.transform.replace(/translate3d\(.*\)/g,""),r=r.replace(/translate[X-Z]?\(.*\)/g,"")),t.length===2?this.elt.style.transform="translate("+t[0]+"px, "+t[1]+"px)":t.length>2&&(this.elt.style.transform="translate3d("+t[0]+"px,"+t[1]+"px,"+t[2]+"px)",t.length===3?this.elt.parentElement.style.perspective="1000px":this.elt.parentElement.style.perspective=t[3]+"px"),this.elt.style.transform+=r,this}_rotate(...t){let r="";return this.elt.style.transform&&(r=this.elt.style.transform.replace(/rotate3d\(.*\)/g,""),r=r.replace(/rotate[X-Z]?\(.*\)/g,"")),t.length===1?this.elt.style.transform="rotate("+t[0]+"deg)":t.length===2?this.elt.style.transform="rotate("+t[0]+"deg, "+t[1]+"deg)":t.length===3&&(this.elt.style.transform="rotateX("+t[0]+"deg)",this.elt.style.transform+="rotateY("+t[1]+"deg)",this.elt.style.transform+="rotateZ("+t[2]+"deg)"),this.elt.style.transform+=r,this}attribute(t,r){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio")){if(typeof r>"u")return this.elt.firstChild.getAttribute(t);for(let i=0;i<this.elt.childNodes.length;i++)this.elt.childNodes[i].setAttribute(t,r)}else return typeof r>"u"?this.elt.getAttribute(t):(this.elt.setAttribute(t,r),this)}removeAttribute(t){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio"))for(let r=0;r<this.elt.childNodes.length;r++)this.elt.childNodes[r].removeAttribute(t);return this.elt.removeAttribute(t),this}value(...t){return t.length>0?(this.elt.value=t[0],this):this.elt.type==="range"?parseFloat(this.elt.value):this.elt.value}mousePressed(t){const r=function(i){return this._pInst.mouseIsPressed=!0,this._pInst._activePointers.set(i.pointerId,i),this._pInst._setMouseButton(i),this._pInst._updatePointerCoords(i),t.call(this,i)};return Pr._adjustListener("pointerdown",r,this),this}doubleClicked(t){return Pr._adjustListener("dblclick",t,this),this}mouseWheel(t){return Pr._adjustListener("wheel",t,this),this}mouseReleased(t){return Pr._adjustListener("pointerup",t,this),this}mouseClicked(t){return Pr._adjustListener("click",t,this),this}mouseMoved(t){return Pr._adjustListener("pointermove",t,this),this}mouseOver(t){return Pr._adjustListener("pointerover",t,this),this}mouseOut(t){return Pr._adjustListener("pointerout",t,this),this}dragOver(t){return Pr._adjustListener("dragover",t,this),this}dragLeave(t){return Pr._adjustListener("dragleave",t,this),this}changed(t){return Pr._adjustListener("change",t,this),this}input(t){return Pr._adjustListener("input",t,this),this}drop(t,r){if(window.File&&window.FileReader&&window.FileList&&window.Blob){if(!this._dragDisabled){this._dragDisabled=!0;const i=function(s){s.preventDefault()};this.elt.addEventListener("dragover",i),this.elt.addEventListener("dragleave",i)}Pr._attachListener("drop",function(i){i.preventDefault(),typeof r=="function"&&r.call(this,i);const s=i.dataTransfer.files;for(const o of s)io._load(o,t)},this)}else console.log("The File APIs are not fully supported in this browser.");return this}draggable(t){let r="ontouchstart"in window,i=0,s=0,o=0,a=0,u,l=r?"touchstart":"mousedown",c=r?"touchend":"mouseup",h=r?"touchmove":"mousemove";t===void 0?(t=this.elt,u=t):t!==this.elt&&t.elt!==this.elt&&(t=t.elt,u=this.elt),u.addEventListener(l,f,!1),u.style.cursor="move";function f(g){if(g=g||window.event,r){const y=g.changedTouches;o=parseInt(y[0].clientX),a=parseInt(y[0].clientY)}else o=parseInt(g.clientX),a=parseInt(g.clientY);return document.addEventListener(c,p,!1),document.addEventListener(h,d,!1),!1}function d(g){if(g=g||window.event,r){const y=g.changedTouches;i=o-parseInt(y[0].clientX),s=a-parseInt(y[0].clientY),o=parseInt(y[0].clientX),a=parseInt(y[0].clientY)}else i=o-parseInt(g.clientX),s=a-parseInt(g.clientY),o=parseInt(g.clientX),a=parseInt(g.clientY);t.style.left=t.offsetLeft-i+"px",t.style.top=t.offsetTop-s+"px"}function p(){document.removeEventListener(c,p,!1),document.removeEventListener(h,d,!1)}return this}static _adjustListener(t,r,i){return r===!1?Pr._detachListener(t,i):Pr._attachListener(t,r,i),this}static _attachListener(t,r,i){i._events[t]&&Pr._detachListener(t,i);const s=r.bind(i);i.elt.addEventListener(t,s,!1),i._events[t]=s}static _detachListener(t,r){const i=r._events[t];r.elt.removeEventListener(t,i,!1),r._events[t]=null}};function B5(n,t){n.Element=Lr}typeof p5<"u"&&B5(p5,p5.prototype);const Ut={_toPixels(n){if(n instanceof ImageData)return n.data;if(n.getContext("2d"))return n.getContext("2d").getImageData(0,0,n.width,n.height).data;if(n.getContext("webgl")){const t=n.getContext("webgl"),r=t.drawingBufferWidth*t.drawingBufferHeight*4,i=new Uint8Array(r);return t.readPixels(0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,i),i}},_getARGB(n,t){const r=t*4;return n[r+3]<<24&4278190080|n[r]<<16&16711680|n[r+1]<<8&65280|n[r+2]&255},_setPixels(n,t){let r=0;for(let i=0,s=n.length;i<s;i++)r=i*4,n[r+0]=(t[i]&16711680)>>>16,n[r+1]=(t[i]&65280)>>>8,n[r+2]=t[i]&255,n[r+3]=(t[i]&4278190080)>>>24},_toImageData(n){return n instanceof ImageData?n:n.getContext("2d").getImageData(0,0,n.width,n.height)},_createImageData(n,t){return Ut._tmpCanvas=document.createElement("canvas"),Ut._tmpCtx=Ut._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(n,t)},apply(n,t,r){const i=n.getContext("2d"),s=i.getImageData(0,0,n.width,n.height),o=t(s,r);o instanceof ImageData?i.putImageData(o,0,0,0,0,n.width,n.height):i.putImageData(s,0,0,0,0,n.width,n.height)},threshold(n,t=.5){const r=Ut._toPixels(n),i=Math.floor(t*255);for(let s=0;s<r.length;s+=4){const o=r[s],a=r[s+1],u=r[s+2],l=.2126*o+.7152*a+.0722*u;let c;l>=i?c=255:c=0,r[s]=r[s+1]=r[s+2]=c}},gray(n){const t=Ut._toPixels(n);for(let r=0;r<t.length;r+=4){const i=t[r],s=t[r+1],o=t[r+2],a=.2126*i+.7152*s+.0722*o;t[r]=t[r+1]=t[r+2]=a}},opaque(n){const t=Ut._toPixels(n);for(let r=0;r<t.length;r+=4)t[r+3]=255;return t},invert(n){const t=Ut._toPixels(n);for(let r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2]},posterize(n,t=4){const r=Ut._toPixels(n);if(t<2||t>255)throw new Error("Level must be greater than 2 and less than 255 for posterize");const i=t-1;for(let s=0;s<r.length;s+=4){const o=r[s],a=r[s+1],u=r[s+2];r[s]=(o*t>>8)*255/i,r[s+1]=(a*t>>8)*255/i,r[s+2]=(u*t>>8)*255/i}},dilate(n){const t=Ut._toPixels(n);let r=0;const i=t.length?t.length/4:0,s=new Int32Array(i);let o,a,u,l,c,h,f,d,p,g,y,v,T,_,C,E,S;for(;r<i;)for(o=r,a=r+n.width;r<a;)u=l=Ut._getARGB(t,r),f=r-1,h=r+1,d=r-n.width,p=r+n.width,f<o&&(f=r),h>=a&&(h=r),d<0&&(d=0),p>=i&&(p=r),v=Ut._getARGB(t,d),y=Ut._getARGB(t,f),T=Ut._getARGB(t,p),g=Ut._getARGB(t,h),c=77*(u>>16&255)+151*(u>>8&255)+28*(u&255),C=77*(y>>16&255)+151*(y>>8&255)+28*(y&255),_=77*(g>>16&255)+151*(g>>8&255)+28*(g&255),E=77*(v>>16&255)+151*(v>>8&255)+28*(v&255),S=77*(T>>16&255)+151*(T>>8&255)+28*(T&255),C>c&&(l=y,c=C),_>c&&(l=g,c=_),E>c&&(l=v,c=E),S>c&&(l=T,c=S),s[r++]=l;Ut._setPixels(t,s)},erode(n){const t=Ut._toPixels(n);let r=0;const i=t.length?t.length/4:0,s=new Int32Array(i);let o,a,u,l,c,h,f,d,p,g,y,v,T,_,C,E,S;for(;r<i;)for(o=r,a=r+n.width;r<a;)u=l=Ut._getARGB(t,r),f=r-1,h=r+1,d=r-n.width,p=r+n.width,f<o&&(f=r),h>=a&&(h=r),d<0&&(d=0),p>=i&&(p=r),v=Ut._getARGB(t,d),y=Ut._getARGB(t,f),T=Ut._getARGB(t,p),g=Ut._getARGB(t,h),c=77*(u>>16&255)+151*(u>>8&255)+28*(u&255),C=77*(y>>16&255)+151*(y>>8&255)+28*(y&255),_=77*(g>>16&255)+151*(g>>8&255)+28*(g&255),E=77*(v>>16&255)+151*(v>>8&255)+28*(v&255),S=77*(T>>16&255)+151*(T>>8&255)+28*(T&255),C<c&&(l=y,c=C),_<c&&(l=g,c=_),E<c&&(l=v,c=E),S<c&&(l=T,c=S),s[r++]=l;Ut._setPixels(t,s)},blur(n,t){dG(n,t)}};let Lc,yu,vu,sa;function fG(n){let t=n*3.5|0;if(t=t<1?1:t<248?t:248,Lc!==t){Lc=t,yu=1+Lc<<1,vu=new Int32Array(yu),sa=new Array(yu);for(let a=0;a<yu;a++)sa[a]=new Int32Array(256);let r,i,s,o;for(let a=1,u=t-1;a<t;a++){vu[t+a]=vu[u]=i=u*u,s=sa[t+a],o=sa[u--];for(let l=0;l<256;l++)s[l]=o[l]=i*l}r=vu[t]=t*t,s=sa[t];for(let a=0;a<256;a++)s[a]=r*a}}function dG(n,t){const r=Ut._toPixels(n),i=n.width,s=n.height,o=i*s,a=new Int32Array(o);for(let A=0;A<o;A++)a[A]=Ut._getARGB(r,A);let u,l,c,h,f,d,p,g,y,v;const T=new Int32Array(o),_=new Int32Array(o),C=new Int32Array(o),E=new Int32Array(o);let S=0;fG(t);let R,w,x,b;for(w=0;w<s;w++){for(R=0;R<i;R++){if(h=c=l=f=u=0,d=R-Lc,d<0)v=-d,d=0;else{if(d>=i)break;v=0}for(x=v;x<yu&&!(d>=i);x++){const A=a[d+S];b=sa[x],f+=b[(A&-16777216)>>>24],l+=b[(A&16711680)>>16],c+=b[(A&65280)>>8],h+=b[A&255],u+=vu[x],d++}p=S+R,T[p]=f/u,_[p]=l/u,C[p]=c/u,E[p]=h/u}S+=i}for(S=0,g=-Lc,y=g*i,w=0;w<s;w++){for(R=0;R<i;R++){if(h=c=l=f=u=0,g<0)v=p=-g,d=R;else{if(g>=s)break;v=0,p=g,d=R+y}for(x=v;x<yu&&!(p>=s);x++)b=sa[x],f+=b[T[d]],l+=b[_[d]],c+=b[C[d]],h+=b[E[d]],u+=vu[x],p++,d+=i;a[R+S]=f/u<<24|l/u<<16|c/u<<8|h/u}S+=i,y+=i,g++}Ut._setPixels(r,a)}function U5(n){let t=0;for(let r=1;r<n.length;r++)t+=n[r-1].position.dist(n[r].position);return t}class $5{constructor(t){for(const[r,i]of Object.entries(t))this[r]=i}}class oi{constructor(...t){Nt(this,"vertices");Nt(this,"_shape",null);Nt(this,"_primitivesIndex",null);Nt(this,"_contoursIndex",null);Nt(this,"isClosing",!1);if(this.constructor===oi)throw new Error("ShapePrimitive is an abstract class: it cannot be instantiated.");if(t.length>0)this.vertices=t;else throw new Error("At least one vertex must be passed to the constructor.")}get vertexCount(){return this.vertices.length}get vertexCapacity(){throw new Error("Getter vertexCapacity must be implemented.")}get _firstInterpolatedVertex(){return this.startVertex()}get canOverrideAnchor(){return!1}accept(t){throw new Error("Method accept() must be implemented.")}addToShape(t){let r=t.at(-1);if(r.primitives.length===0)r.primitives.push(this);else{let s=t.at(-1,-1),o=s instanceof this.constructor,a=s.vertexCapacity-s.vertexCount,u,l;o&&a>0?(u=this.vertices.splice(0,a),l=this.vertices,s.vertices.push(...u),l.length>0&&r.primitives.push(this)):r.primitives.push(this)}if(this.vertices.length>0){let s=t.at(-1);this._primitivesIndex=s.primitives.length-1,this._contoursIndex=t.contours.length-1,this._shape=t}return t.at(-1,-1)}get _nextPrimitive(){return this._belongsToShape?this._shape.at(this._contoursIndex,this._primitivesIndex+1):null}get _belongsToShape(){return this._shape!==null}handlesClose(){return!1}close(t){throw new Error("Unimplemented!")}}var $u;class j5{constructor(t=vi){Zt(this,$u);Nt(this,"primitives");Zr(this,$u,t),this.primitives=[]}get kind(){const t=this.primitives.length===0,r=Ve(this,$u)===vi;return t&&r?Ru:Ve(this,$u)}accept(t){for(const r of this.primitives)r.accept(t)}}$u=new WeakMap;var Rp;class vd extends oi{constructor(){super(...arguments);Zt(this,Rp,1)}get vertexCapacity(){return Ve(this,Rp)}accept(r){r.visitAnchor(this)}getEndVertex(){return this.vertices[0]}}Rp=new WeakMap;class Pa extends oi{constructor(...t){if(super(...t),this.constructor===Pa)throw new Error("Segment is an abstract class: it cannot be instantiated.")}get _previousPrimitive(){return this._belongsToShape?this._shape.at(this._contoursIndex,this._primitivesIndex-1):null}getStartVertex(){return this._previousPrimitive.getEndVertex()}getEndVertex(){return this.vertices.at(-1)}}var Fp;class G5 extends Pa{constructor(){super(...arguments);Zt(this,Fp,1)}get vertexCapacity(){return Ve(this,Fp)}accept(r){r.visitLineSegment(this)}}Fp=new WeakMap;var Ph,Mh,ju;class z5 extends Pa{constructor(r,...i){super(...i);Zt(this,Ph);Zt(this,Mh);Zt(this,ju);let s=Array.isArray(r)?r[0]:r;Zr(this,Ph,s),Zr(this,Mh,s)}get order(){return Ve(this,Ph)}get vertexCapacity(){return Ve(this,Mh)}hullLength(){return Ve(this,ju)===void 0&&Zr(this,ju,U5([this.getStartVertex(),...this.vertices])),Ve(this,ju)}accept(r){r.visitBezierSegment(this)}}Ph=new WeakMap,Mh=new WeakMap,ju=new WeakMap;var Pp;class q5 extends Pa{constructor(){super(...arguments);Zt(this,Pp,1/0);Nt(this,"_splineProperties",{ends:Fu,tightness:0})}get vertexCapacity(){return Ve(this,Pp)}accept(r){r.visitSplineSegment(this)}get _comesAfterSegment(){return this._previousPrimitive instanceof Pa}get canOverrideAnchor(){return this._splineProperties.ends===mu}get _firstInterpolatedVertex(){return this._splineProperties.ends===mu?this._comesAfterSegment?this.vertices[1]:this.vertices[0]:this.getStartVertex()}get _chainedToSegment(){if(this._belongsToShape&&this._comesAfterSegment){let r=this._firstInterpolatedVertex.position;return this.getStartVertex().position.equals(r)}else return!1}addToShape(r){const i=super.addToShape(r);if(this._splineProperties.ends=r._splineProperties.ends,this._splineProperties.tightness=r._splineProperties.tightness,this._splineProperties.ends!==mu)return i;let s=!this._belongsToShape,o=r.at(-1,-1),a=(u,l)=>`Spline does not start where previous path segment ends:
      second spline vertex at (${u})
      expected to be at (${l}).`;if(s&&o.vertices.length===2&&o._comesAfterSegment&&!o._chainedToSegment){let u=o._firstInterpolatedVertex.position,l=o.getStartVertex().position;console.warn(a(u.array(),l.array()))}return i}getEndVertex(){return this._splineProperties.ends===Fu?super.getEndVertex():this._splineProperties.ends===mu?this.vertices.at(-2):this.getStartVertex()}getControlPoints(){let r=[];this._comesAfterSegment&&r.push(this.getStartVertex()),r.push(this.getStartVertex());for(const s of this.vertices)r.push(s);const i=this.getStartVertex();return this._splineProperties.ends===Fu?(r.unshift(i),r.push(this.vertices.at(-1))):this._splineProperties.ends===Ry&&(r.unshift(this.vertices.at(-1)),r.push(i,this.vertices.at(0))),r}handlesClose(){return this._belongsToShape?this._shape.at(this._contoursIndex).primitives.length===2&&this._primitivesIndex===1:!1}close(){this._splineProperties.ends=Ry}}Pp=new WeakMap;var Mp;class H5 extends oi{constructor(){super(...arguments);Zt(this,Mp,1)}get vertexCapacity(){return Ve(this,Mp)}accept(r){r.visitPoint(this)}}Mp=new WeakMap;var Lp;class W5 extends oi{constructor(){super(...arguments);Zt(this,Lp,2)}get vertexCapacity(){return Ve(this,Lp)}accept(r){r.visitLine(this)}}Lp=new WeakMap;var Op;class K5 extends oi{constructor(){super(...arguments);Zt(this,Op,3)}get vertexCapacity(){return Ve(this,Op)}accept(r){r.visitTriangle(this)}}Op=new WeakMap;var Vp;class Y5 extends oi{constructor(){super(...arguments);Zt(this,Vp,4)}get vertexCapacity(){return Ve(this,Vp)}accept(r){r.visitQuad(this)}}Vp=new WeakMap;var Bp;class X5 extends oi{constructor(){super(...arguments);Zt(this,Bp,1/0)}get vertexCapacity(){return Ve(this,Bp)}accept(r){r.visitTriangleFan(this)}}Bp=new WeakMap;var Up;class Z5 extends oi{constructor(){super(...arguments);Zt(this,Up,1/0)}get vertexCapacity(){return Ve(this,Up)}accept(r){r.visitTriangleStrip(this)}}Up=new WeakMap;var $p;class Q5 extends oi{constructor(){super(...arguments);Zt(this,$p,1/0)}get vertexCapacity(){return Ve(this,$p)}accept(r){r.visitQuadStrip(this)}}$p=new WeakMap;class pG{constructor(){Nt(this,"creators");let t=new Map;t.set(`vertex-${Ru}`,(...r)=>new vd(...r)),t.set(`vertex-${vi}`,(...r)=>new G5(...r)),t.set(`vertex-${up}`,(...r)=>new H5(...r)),t.set(`vertex-${cl}`,(...r)=>new W5(...r)),t.set(`vertex-${Nu}`,(...r)=>new K5(...r)),t.set(`vertex-${Pc}`,(...r)=>new Y5(...r)),t.set(`vertex-${Fg}`,(...r)=>new X5(...r)),t.set(`vertex-${fh}`,(...r)=>new Z5(...r)),t.set(`vertex-${dh}`,(...r)=>new Q5(...r)),t.set(`bezierVertex-${Ru}`,(r,...i)=>new vd(...i)),t.set(`bezierVertex-${vi}`,(r,...i)=>new z5(r,...i)),t.set(`splineVertex-${Ru}`,(...r)=>new vd(...r)),t.set(`splineVertex-${vi}`,(...r)=>new q5(...r)),this.creators=t}get(t,r){const i=`${t}-${r}`;return this.creators.get(i)}set(t,r,i){const s=`${t}-${r}`;this.creators.set(s,i)}clear(){this.creators.clear()}}var Mr,Lh,Oh,Vh,gi,ek,tk,cc;class J5{constructor(t,r=new pG){Zt(this,gi);Zt(this,Mr);Zt(this,Lh);Zt(this,Oh);Zt(this,Vh,3);Nt(this,"kind",null);Nt(this,"contours",[]);Nt(this,"_splineProperties",{tightness:0,ends:Fu});Nt(this,"userVertexProperties",null);Zr(this,Lh,t),Zr(this,Mr,t),Zr(this,Oh,r);for(const i in Ve(this,Mr))i!=="position"&&i!=="textureCoordinates"&&(this[i]=function(s){Ve(this,Mr)[i]=s})}serializeToArray(t){if(t==null)return[];if(t instanceof Number)return[t];if(t instanceof Array)return t;if(t.array instanceof Function)return t.array();throw new Error(`Can't convert ${t} to array!`)}vertexToArray(t){const r=[];for(const i in Ve(this,Mr)){if(this.userVertexProperties&&i in this.userVertexProperties)continue;const s=t[i];r.push(...this.serializeToArray(s))}for(const i in this.userVertexProperties)i in t?r.push(...this.serializeToArray(t[i])):r.push(...new Array(this.userVertexProperties[i]).fill(0));return r}hydrateValue(t,r){if(r===null)return null;if(r instanceof Number)return t.shift();if(r instanceof Array){const i=[];for(let s=0;s<r.length;s++)i.push(t.shift());return i}else{if(r instanceof de)return new de(t.shift(),t.shift(),t.shift());if(r instanceof ir){const i=[t.shift(),t.shift(),t.shift(),t.shift()];return new ir(i)}}}arrayToVertex(t){const r={},i=[...t];for(const s in Ve(this,Mr)){if(this.userVertexProperties&&s in this.userVertexProperties)continue;const o=Ve(this,Mr)[s];r[s]=this.hydrateValue(i,o)}for(const s in this.userVertexProperties){const o=Ve(this,Mr)[s];r[s]=this.hydrateValue(i,o)}return r}arrayScale(t,r){return t.map(i=>i*r)}arraySum(t,...r){return t.map((i,s)=>{let o=i;for(let a=0;a<r.length;a++)o+=r[a][s];return o})}arrayMinus(t,r){return t.map((i,s)=>i-r[s])}evaluateCubicBezier([t,r,i,s],o){return this.arraySum(this.arrayScale(t,Math.pow(1-o,3)),this.arrayScale(r,3*Math.pow(1-o,2)*o),this.arrayScale(i,3*(1-o)*Math.pow(o,2)),this.arrayScale(s,Math.pow(o,3)))}evaluateQuadraticBezier([t,r,i],s){return this.arraySum(this.arrayScale(t,Math.pow(1-s,2)),this.arrayScale(r,2*(1-s)*s),this.arrayScale(i,s*s))}catmullRomToBezier(t,r){let i=1-r,s=[];for(let o=0;o+3<t.length;o++){const[a,u,l,c]=t.slice(o,o+4),h=this.arraySum(u,this.arrayScale(this.arrayMinus(l,a),i/6)),f=this.arraySum(l,this.arrayScale(this.arrayMinus(u,c),i/6)),d=l;s.push([h,f,d])}return s}at(t,r,i){let s,o;switch(s=this.contours.at(t),arguments.length){case 1:return s;case 2:return s.primitives.at(r);case 3:return o=s.primitives.at(r),o.vertices.at(i)}}reset(){Zr(this,Mr,{...Ve(this,Lh)}),this.kind=null,this.contours=[],this.userVertexProperties=null}vertexProperty(t,r){this.userVertexProperties=this.userVertexProperties||{};const i=this.vertexPropertyKey(t),s=Array.isArray(r)?r:[r];this.userVertexProperties[i]||(this.userVertexProperties[i]=s.length),Ve(this,Mr)[i]=s}vertexPropertyName(t){return t.replace(/Src$/,"")}vertexPropertyKey(t){return t+"Src"}bezierOrder(...t){Zr(this,Vh,t)}splineProperty(t,r){this._splineProperties[t]=r}splineProperties(t){if(t)for(const r in t)this.splineProperty(r,t[r]);else return this._splineProperties}vertex(t,r,{isClosing:i=!1}={}){const s=Cr(this,gi,cc).call(this,"vertex",t,r);s.isClosing=i}bezierVertex(t,r){Cr(this,gi,cc).call(this,"bezierVertex",t,r)}splineVertex(t,r){Cr(this,gi,cc).call(this,"splineVertex",t,r)}arcVertex(t,r){Cr(this,gi,cc).call(this,"arcVertex",t,r)}beginContour(t=vi){var r;((r=this.at(-1))==null?void 0:r.kind)===Ru&&this.contours.pop(),this.contours.push(new j5(t))}endContour(t=Ia,r=this.contours.length-1){const i=this.at(r);if(t===ph){const s=i.kind===vi,o=this.at(r,0,0),a=Object.hasOwn(o,"position"),u=this.at(r,-1);if(s&&a)if(u.handlesClose())u.close(o);else{const l=this.contours.splice(r+1,this.contours.length-r-1),c=Ve(this,Mr);Zr(this,Mr,{...c});for(const h in o)["position","textureCoordinates"].includes(h)||(Ve(this,Mr)[h]=o[h]);this.vertex(o.position,o.textureCoordinates,{isClosing:!0}),Zr(this,Mr,c),this.contours.push(...l)}}}beginShape(t=vi){this.kind=t,this.beginContour(t)}endShape(t=Ia){t===ph&&this.endContour(t,0)}accept(t){for(const r of this.contours)r.accept(t)}}Mr=new WeakMap,Lh=new WeakMap,Oh=new WeakMap,Vh=new WeakMap,gi=new WeakSet,ek=function(t,r){return Ve(this,Mr).position=t,r!==void 0&&(Ve(this,Mr).textureCoordinates=r),new $5(Ve(this,Mr))},tk=function(t,r,...i){let s=Ve(this,Oh).get(t,r);return t==="bezierVertex"?s(Ve(this,Vh),...i):s(...i)},cc=function(t,r,i){let s=t,o=this.at(-1).kind,a=Cr(this,gi,ek).call(this,r,i);return Cr(this,gi,tk).call(this,s,o,a).addToShape(this)};class Il{constructor(){if(this.constructor===Il)throw new Error("PrimitiveVisitor is an abstract class: it cannot be instantiated.")}visitAnchor(t){throw new Error("Method visitAnchor() has not been implemented.")}visitLineSegment(t){throw new Error("Method visitLineSegment() has not been implemented.")}visitBezierSegment(t){throw new Error("Method visitBezierSegment() has not been implemented.")}visitSplineSegment(t){throw new Error("Method visitSplineSegment() has not been implemented.")}visitArcSegment(t){throw new Error("Method visitArcSegment() has not been implemented.")}visitPoint(t){throw new Error("Method visitPoint() has not been implemented.")}visitLine(t){throw new Error("Method visitLine() has not been implemented.")}visitTriangle(t){throw new Error("Method visitTriangle() has not been implemented.")}visitQuad(t){throw new Error("Method visitQuad() has not been implemented.")}visitTriangleFan(t){throw new Error("Method visitTriangleFan() has not been implemented.")}visitTriangleStrip(t){throw new Error("Method visitTriangleStrip() has not been implemented.")}visitQuadStrip(t){throw new Error("Method visitQuadStrip() has not been implemented.")}}class rk extends Il{constructor({strokeWeight:r}){super();Nt(this,"path",new Path2D);Nt(this,"strokeWeight");this.strokeWeight=r}visitAnchor(r){let i=r.getEndVertex();this.path.moveTo(i.position.x,i.position.y)}visitLineSegment(r){if(r.isClosing)this.path.closePath();else{let i=r.getEndVertex();this.path.lineTo(i.position.x,i.position.y)}}visitBezierSegment(r){let[i,s,o]=r.vertices;switch(r.order){case 2:this.path.quadraticCurveTo(i.position.x,i.position.y,s.position.x,s.position.y);break;case 3:this.path.bezierCurveTo(i.position.x,i.position.y,s.position.x,s.position.y,o.position.x,o.position.y);break}}visitSplineSegment(r){const i=r._shape;if(r._splineProperties.ends===mu&&!r._comesAfterSegment){let a=r._firstInterpolatedVertex;this.path.moveTo(a.position.x,a.position.y)}const s=r.getControlPoints().map(a=>i.vertexToArray(a));let o=i.catmullRomToBezier(s,r._splineProperties.tightness).map(a=>a.map(u=>i.arrayToVertex(u)));for(const a of o){const u=a.flatMap(l=>[l.position.x,l.position.y]);this.path.bezierCurveTo(...u)}}visitPoint(r){const{x:i,y:s}=r.vertices[0].position;this.path.moveTo(i,s),this.path.lineTo(i+1e-5,s)}visitLine(r){const{x:i,y:s}=r.vertices[0].position,{x:o,y:a}=r.vertices[1].position;this.path.moveTo(i,s),this.path.lineTo(o,a)}visitTriangle(r){const[i,s,o]=r.vertices;this.path.moveTo(i.position.x,i.position.y),this.path.lineTo(s.position.x,s.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.closePath()}visitQuad(r){const[i,s,o,a]=r.vertices;this.path.moveTo(i.position.x,i.position.y),this.path.lineTo(s.position.x,s.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.closePath()}visitTriangleFan(r){const[i,...s]=r.vertices;for(let o=0;o<s.length-1;o++){const a=s[o],u=s[o+1];this.path.moveTo(i.position.x,i.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.lineTo(u.position.x,u.position.y),this.path.closePath()}}visitTriangleStrip(r){for(let i=0;i<r.vertices.length-2;i++){const s=r.vertices[i],o=r.vertices[i+1],a=r.vertices[i+2];this.path.moveTo(s.position.x,s.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.closePath()}}visitQuadStrip(r){for(let i=0;i<r.vertices.length-3;i+=2){const s=r.vertices[i],o=r.vertices[i+1],a=r.vertices[i+2],u=r.vertices[i+3];this.path.moveTo(s.position.x,s.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.lineTo(u.position.x,u.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.closePath()}}}class nk extends Il{constructor({curveDetail:r=1}={}){super();Nt(this,"contours",[]);Nt(this,"curveDetail");this.curveDetail=r}lastContour(){return this.contours[this.contours.length-1]}visitAnchor(r){this.contours.push([]);const i=r._nextPrimitive;i!=null&&i.canOverrideAnchor?this.lastContour().push(i._firstInterpolatedVertex):this.lastContour().push(r.getEndVertex())}visitLineSegment(r){this.lastContour().push(r.getEndVertex())}visitBezierSegment(r){const i=this.lastContour(),s=Math.max(1,Math.ceil(r.hullLength()*this.curveDetail)),o=[r.getStartVertex(),...r.vertices].map(a=>r._shape.vertexToArray(a));for(let a=0;a<s;a++){const u=(a+1)/s;i.push(r._shape.arrayToVertex(r.order===3?r._shape.evaluateCubicBezier(o,u):r._shape.evaluateQuadraticBezier(o,u)))}}visitSplineSegment(r){const i=r._shape,s=this.lastContour(),o=r.getControlPoints().map(l=>i.vertexToArray(l));let a=i.catmullRomToBezier(o,r._splineProperties.tightness),u=i.vertexToArray(r._firstInterpolatedVertex);for(const l of a){const c=[u,...l],h=Math.max(1,Math.ceil(U5(c.map(f=>i.arrayToVertex(f)))*this.curveDetail));for(let f=0;f<h;f++){const d=(f+1)/h;s.push(i.arrayToVertex(i.evaluateCubicBezier(c,d)))}u=l[2]}}visitPoint(r){this.contours.push(r.vertices.slice())}visitLine(r){this.contours.push(r.vertices.slice())}visitTriangle(r){this.contours.push(r.vertices.slice())}visitQuad(r){this.contours.push(r.vertices.slice())}visitTriangleFan(r){this.contours.push(r.vertices.slice())}visitTriangleStrip(r){this.contours.push(r.vertices.slice())}visitQuadStrip(r){this.contours.push(r.vertices.slice())}}class gG extends Il{constructor(){super()}}function a_(n,t){n.Shape=J5,n.Contour=j5,n.ShapePrimitive=oi,n.Vertex=$5,n.Anchor=vd,n.Segment=Pa,n.LineSegment=G5,n.BezierSegment=z5,n.SplineSegment=q5,n.Point=H5,n.Line=W5,n.Triangle=K5,n.Quad=Y5,n.TriangleFan=X5,n.TriangleStrip=Z5,n.QuadStrip=Q5,n.PrimitiveVisitor=Il,n.PrimitiveToPath2DConverter=rk,n.PrimitiveToVerticesConverter=nk,n.PointAtLengthGetter=gG,t.bezierOrder=function(r){return this._renderer.bezierOrder(r)},t.splineVertex=function(...r){let i=0,s=0,o=0,a=0,u=0;r.length===2?[i,s]=r:r.length===4?[i,s,a,u]=r:r.length===3?[i,s,o]=r:r.length===5&&([i,s,o,a,u]=r),this._renderer.splineVertex(i,s,o,a,u)},t.splineProperty=function(r,i){return this._renderer.splineProperty(r,i)},t.splineProperties=function(r){return this._renderer.splineProperties(r)},t.vertex=function(r,i){let s,o,a;s=o=a=0,arguments.length===3?s=arguments[2]:arguments.length===4?(o=arguments[2],a=arguments[3]):arguments.length===5&&(s=arguments[2],o=arguments[3],a=arguments[4]),this._renderer.vertex(r,i,s,o,a)},t.beginContour=function(r){this._renderer.beginContour(r)},t.endContour=function(r=Ia){this._renderer.endContour(r)}}typeof p5<"u"&&a_(p5,p5.prototype);var li;class mG{constructor(t){Zt(this,li,{});for(const r in t)this[r]=t[r]}setValue(t,r){t in Ve(this,li)||(Ve(this,li)[t]=this[t]),this[t]=r}getDiff(){const t=Ve(this,li);return Zr(this,li,{}),t}getModified(){return Ve(this,li)}applyDiff(t){for(const r in Ve(this,li))this[r]=Ve(this,li)[r];Zr(this,li,t)}}li=new WeakMap;var yG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ik(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var _d={exports:{}},vG=_d.exports,sS;function _G(){return sS||(sS=1,function(n){/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */var t=t||function(r){if(!(typeof r>"u"||typeof navigator<"u"&&/MSIE [1-9]\./.test(navigator.userAgent))){var i=r.document,s=function(){return r.URL||r.webkitURL||r},o=i.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in o,u=function(C){var E=new MouseEvent("click");C.dispatchEvent(E)},l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent),h=function(C){(r.setImmediate||r.setTimeout)(function(){throw C},0)},f="application/octet-stream",d=1e3*40,p=function(C){var E=function(){typeof C=="string"?s().revokeObjectURL(C):C.remove()};setTimeout(E,d)},g=function(C,E,S){E=[].concat(E);for(var R=E.length;R--;){var w=C["on"+E[R]];if(typeof w=="function")try{w.call(C,S||C)}catch(x){h(x)}}},y=function(C){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(C.type)?new Blob(["\uFEFF",C],{type:C.type}):C},v=function(C,E,S){S||(C=y(C));var R=this,w=C.type,x=w===f,b,A=function(){g(R,"writestart progress write writeend".split(" "))},k=function(){if((c||x&&l)&&r.FileReader){var N=new FileReader;N.onloadend=function(){var j=c?N.result:N.result.replace(/^data:[^;]*;/,"data:attachment/file;"),Q=r.open(j,"_blank");Q||(r.location.href=j),j=void 0,R.readyState=R.DONE,A()},N.readAsDataURL(C),R.readyState=R.INIT;return}if(b||(b=s().createObjectURL(C)),x)r.location.href=b;else{var I=r.open(b,"_blank");I||(r.location.href=b)}R.readyState=R.DONE,A(),p(b)};if(R.readyState=R.INIT,a){b=s().createObjectURL(C),setTimeout(function(){o.href=b,o.download=E,u(o),A(),p(b),R.readyState=R.DONE});return}k()},T=v.prototype,_=function(C,E,S){return new v(C,E||C.name||"download",S)};return typeof navigator<"u"&&navigator.msSaveOrOpenBlob?function(C,E,S){return E=E||C.name||"download",S||(C=y(C)),navigator.msSaveOrOpenBlob(C,E)}:(T.abort=function(){},T.readyState=T.INIT=0,T.WRITING=1,T.DONE=2,T.error=T.onwritestart=T.onprogress=T.onwrite=T.onabort=T.onerror=T.onwriteend=null,_)}}(typeof self<"u"&&self||typeof window<"u"&&window||vG.content);n.exports&&(n.exports.saveAs=t)}(_d)),_d.exports}var bG=_G();function u_(n,t,r){const s=yp(t,r)[0];let o=n;o instanceof Blob||(o=new Blob([n])),bG.saveAs(o,s)}function yp(n,t){(!t||t===!0||t==="true")&&(t=""),n||(n="untitled");let r="";return n&&n.includes(".")&&(r=n.split(".").pop()),t&&r!==t&&(r=t,n=`${n}.${r}`),[n,r]}let Io=class Uy{constructor(t,r){this.width=t,this.height=r,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),this._pixelsState=this,this._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]}pixelDensity(t){return typeof t<"u"?(t<=0&&(t=1),this._pixelDensity=t,this.width/=t,this.height/=t,this):this._pixelDensity}_animateGif(t){const r=this.gifProperties,i=t._lastRealFrameTime||window.performance.now();if(r.lastChangeTime===0&&(r.lastChangeTime=i),r.playing){r.timeDisplayed=i-r.lastChangeTime;const s=r.frames[r.displayIndex].delay;if(r.timeDisplayed>=s){const o=Math.floor(r.timeDisplayed/s);if(r.timeDisplayed=0,r.lastChangeTime=i,r.displayIndex+=o,r.loopCount=Math.floor(r.displayIndex/r.numFrames),r.loopLimit!==null&&r.loopCount>=r.loopLimit)r.playing=!1;else{const a=r.displayIndex%r.numFrames;this.drawingContext.putImageData(r.frames[a].image,0,0),r.displayIndex=a,this.setModified(!0)}}}}loadPixels(){const t=this._pixelsState,r=this._pixelDensity,i=this.width*r,s=this.height*r,o=this.drawingContext.getImageData(0,0,i,s);t.imageData=o,this.pixels=t.pixels=o.data,this.setModified(!0)}updatePixels(t,r,i,s){const o=this._pixelsState,a=this._pixelDensity;t===void 0&&r===void 0&&i===void 0&&s===void 0&&(t=0,r=0,i=this.width,s=this.height),t*=a,r*=a,i*=a,s*=a,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=o.imageData),this.drawingContext.putImageData(o.imageData,t,r,0,0,i,s),this.setModified(!0)}get(t,r,i,s){const o=this._pixelsState,a=this._pixelDensity,u=this.canvas;if(typeof t>"u"&&typeof r>"u")t=r=0,i=o.width,s=o.height;else if(t*=a,r*=a,typeof i>"u"&&typeof s>"u")return t<0||r<0||t>=u.width||r>=u.height?[0,0,0,0]:this._getPixel(t,r);const l=new Uy(i*a,s*a);return l.pixelDensity(a),l.canvas.getContext("2d").drawImage(u,t,r,i*a,s*a,0,0,i*a,s*a),l}_getPixel(t,r){let i,s;return i=this.drawingContext.getImageData(t,r,1,1).data,s=0,[i[s+0],i[s+1],i[s+2],i[s+3]]}set(t,r,i){t=Math.floor(t),r=Math.floor(r);const s=this._pixelsState;if(i instanceof Uy)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this.drawingContext.clearRect(t,r,i.width,i.height),this.drawingContext.drawImage(i.canvas,t,r),this.drawingContext.restore();else{let o=0,a=0,u=0,l=0,c=4*(r*this._pixelDensity*(this.width*this._pixelDensity)+t*this._pixelDensity);if(s.imageData||s.loadPixels(),typeof i=="number")c<s.pixels.length&&(o=i,a=i,u=i,l=255);else if(Array.isArray(i)){if(i.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");c<s.pixels.length&&(o=i[0],a=i[1],u=i[2],l=i[3])}else i instanceof p5.Color&&c<s.pixels.length&&([o,a,u,l]=i._getRGBA([255,255,255,255]));for(let h=0;h<this._pixelDensity;h++)for(let f=0;f<this._pixelDensity;f++)c=4*((r*this._pixelDensity+f)*this.width*this._pixelDensity+(t*this._pixelDensity+h)),s.pixels[c]=o,s.pixels[c+1]=a,s.pixels[c+2]=u,s.pixels[c+3]=l}this.setModified(!0)}resize(t,r){t===0&&r===0?(t=this.canvas.width,r=this.canvas.height):t===0?t=this.canvas.width*r/this.canvas.height:r===0&&(r=this.canvas.height*t/this.canvas.width),t=Math.floor(t),r=Math.floor(r);const i=document.createElement("canvas");if(i.width=t,i.height=r,this.gifProperties){const s=this.gifProperties,o=(a,u)=>{let l=0;for(let c=0;c<u.height;c++)for(let h=0;h<u.width;h++){const f=Math.floor(h*a.width/u.width);let p=(Math.floor(c*a.height/u.height)*a.width+f)*4;u.data[l++]=a.data[p++],u.data[l++]=a.data[p++],u.data[l++]=a.data[p++],u.data[l++]=a.data[p++]}};for(let a=0;a<s.numFrames;a++){const u=this.drawingContext.createImageData(t,r);o(s.frames[a].image,u),s.frames[a].image=u}}i.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,i.width,i.height),this.canvas.width=this.width=t,this.canvas.height=this.height=r,this.drawingContext.drawImage(i,0,0,t,r,0,0,t,r),this.pixels.length>0&&this.loadPixels(),this.setModified(!0)}copy(...t){let r,i,s,o,a,u,l,c,h;if(t.length===9)r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],u=t[5],l=t[6],c=t[7],h=t[8];else if(t.length===8)r=this,i=t[0],s=t[1],o=t[2],a=t[3],u=t[4],l=t[5],c=t[6],h=t[7];else throw new Error("Signature not supported");this._copyHelper(this,r,i,s,o,a,u,l,c,h)}_copyHelper(t,r,i,s,o,a,u,l,c,h){const f=r.canvas.width/r.width;let d=0,p=0;r._renderer&&r._renderer.isP3D&&(d=r.width/2,p=r.height/2),t._renderer&&t._renderer.isP3D?(t.push(),t.resetMatrix(),t.noLights(),t.blendMode(t.BLEND),t.imageMode(t.CORNER),t._renderer.image(r,i+d,s+p,o,a,u,l,c,h),t.pop()):t.drawingContext.drawImage(r.canvas,f*(i+d),f*(s+p),f*o,f*a,u,l,c,h)}mask(t){t===void 0&&(t=this);const r=this.drawingContext.globalCompositeOperation;let i=this._pixelDensity,s=1;t instanceof st&&(s=t._pInst._renderer._pixelDensity);const o=[t,0,0,s*t.width,s*t.height,0,0,i*this.width,i*this.height];if(this.drawingContext.globalCompositeOperation="destination-in",this.gifProperties){for(let a=0;a<this.gifProperties.frames.length;a++)this.drawingContext.putImageData(this.gifProperties.frames[a].image,0,0),this.copy(...o),this.gifProperties.frames[a].image=this.drawingContext.getImageData(0,0,i*this.width,i*this.height);this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else this.copy(...o);this.drawingContext.globalCompositeOperation=r,this.setModified(!0)}filter(t,r){Ut.apply(this.canvas,Ut[t],r),this.setModified(!0)}blend(...t){const r=this.drawingContext.globalCompositeOperation,i=t[t.length-1],s=Array.prototype.slice.call(t,0,t.length-1);this.drawingContext.globalCompositeOperation=i,this.copy(...s),this.drawingContext.globalCompositeOperation=r,this.setModified(!0)}setModified(t){this._modified=t}isModified(){return this._modified}save(t,r){if(this.gifProperties)xG(this,t);else{let i=this.canvas;r=r||yp(t,r)[1]||"png";let s;switch(r){default:s="image/png";break;case"webp":s="image/webp";break;case"jpeg":case"jpg":s="image/jpeg";break}i.toBlob(o=>{u_(o,t,r)},s)}}async toBlob(){return new Promise(t=>{this.canvas.toBlob(t)})}reset(){if(this.gifProperties){const t=this.gifProperties;t.playing=!0,t.timeSinceStart=0,t.timeDisplayed=0,t.lastChangeTime=0,t.loopCount=0,t.displayIndex=0,this.drawingContext.putImageData(t.frames[0].image,0,0)}}getCurrentFrame(){if(this.gifProperties){const t=this.gifProperties;return t.displayIndex%t.numFrames}}setFrame(t){if(this.gifProperties){const r=this.gifProperties;t<r.numFrames&&t>=0?(r.timeDisplayed=0,r.lastChangeTime=0,r.displayIndex=t,this.drawingContext.putImageData(r.frames[t].image,0,0)):console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero.")}}numFrames(){if(this.gifProperties)return this.gifProperties.numFrames}play(){this.gifProperties&&(this.gifProperties.playing=!0)}pause(){this.gifProperties&&(this.gifProperties.playing=!1)}delay(t,r){if(this.gifProperties){const i=this.gifProperties;if(r<i.numFrames&&r>=0)i.frames[r].delay=t;else for(const s of i.frames)s.delay=t}}};function xG(n,t){const r=n.gifProperties;let i=r.loopLimit;i===1?i=null:i===null&&(i=0);const s=new Uint8Array(n.width*n.height*r.numFrames),o=[],a={};for(let _=0;_<r.numFrames;_++){const C=new Set,E=r.frames[_].image.data,S=E.length,R=new Uint32Array(n.width*n.height);for(let x=0,b=0;x<S;x+=4,b++){const A=E[x+0],k=E[x+1],N=E[x+2],I=A<<16|k<<8|N<<0;C.add(I),R[b]=I}const w=[...C].sort().toString();a[w]===void 0?a[w]={freq:1,frames:[_]}:(a[w].freq+=1,a[w].frames.push(_)),o.push(R)}let u=[];const l=Object.keys(a).sort(function(_,C){return a[C].freq-a[_].freq}),c=l[0].split(",").map(_=>parseInt(_));u=u.concat(a[c].frames);const h=new Set(c);for(let _=1;_<l.length;_++){const E=l[_].split(",").map(S=>parseInt(S)).filter(S=>!h.has(S));if(c.length+E.length<=256){for(let S=0;S<E.length;S++)c.push(E[S]),h.add(E[S]);u=u.concat(a[l[_]].frames)}}u=new Set(u);const f={};for(let _=0;_<c.length;_++)f[c[_]]||(f[c[_]]=_);let d=1;for(;d<c.length;)d<<=1;c.length=d;const p={loop:i,palette:new Uint32Array(c)},g=new omggif.GifWriter(s,n.width,n.height,p);let y={};for(let _=0;_<r.numFrames;_++){const C=!u.has(_),E=C?[]:c,S=new Uint8Array(n.width*n.height),R={},w=new Set;o[_].forEach((A,k)=>{C?(R[A]===void 0&&(R[A]=E.length,E.push(A)),S[k]=R[A]):S[k]=f[A],_>0&&o[_-1][k]!==A&&w.add(A)});const x={},b=E.filter(A=>!w.has(A));if(b.length>0){const A=b[0],k=C?R[A]:f[A];if(_>0){for(let N=0;N<o[_].length;N++)o[_-1][N]===o[_][N]&&(S[N]=k);x.transparent=k,y.frameOpts.disposal=1}}if(x.delay=r.frames[_].delay/10,C){let A=1;for(;A<E.length;)A<<=1;E.length=A,x.palette=new Uint32Array(E)}_>0&&g.addFrame(0,0,n.width,n.height,y.pixelPaletteIndex,y.frameOpts),y={pixelPaletteIndex:S,frameOpts:x}}y.frameOpts.disposal=1,g.addFrame(0,0,n.width,n.height,y.pixelPaletteIndex,y.frameOpts);const v="gif",T=new Blob([s.slice(0,g.end())],{type:"image/gif"});u_(T,t,v)}function sk(n,t){n.Image=Io}typeof p5<"u"&&sk(p5,p5.prototype);class l_{constructor(t={}){for(const r in t)this[r]=t[r]}clone(){return new l_(this)}}const jp=class jp{constructor(t,r,i,s){this._pInst=t,this._isMainCanvas=s,this.pixels=[],this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this.width=r,this.height=i,this._events={},s&&(this._isMainCanvas=!0),this.states=new mG(jp.states),this.states.strokeColor=new ir([0,0,0]),this.states.fillColor=new ir([1,1,1]),this._pushPopStack=[],this._pushPopDepth=0,this._clipping=!1,this._clipInvert=!1,this._currentShape=void 0}get currentShape(){return this._currentShape||(this._currentShape=new J5(this.getCommonVertexProperties())),this._currentShape}remove(){}pixelDensity(t){let r;return typeof t=="number"?(t!==this._pixelDensity&&(this._pixelDensity=t),r=this,this.resize(this.width,this.height)):r=this._pixelDensity,r}push(){this._pushPopDepth++,this._pushPopStack.push(this.states.getDiff())}pop(){this._pushPopDepth--;const t=this._pushPopStack.pop()||{},r=this.states.getModified();this.states.applyDiff(t),this.updateShapeVertexProperties(r),this.updateShapeProperties(r)}bezierOrder(t){if(t===void 0)return this.states.bezierOrder;this.states.setValue("bezierOrder",t),this.updateShapeProperties()}bezierVertex(t,r,i=0,s=0,o=0){const a=new de(t,r,i),u=this.getSupportedIndividualVertexProperties().textureCoordinates?new de(s,o):void 0;this.currentShape.bezierVertex(a,u)}splineProperty(t,r){if(r===void 0)return this.states.splineProperties[t];this.states.setValue("splineProperties",this.states.splineProperties.clone()),this.states.splineProperties[t]=r,this.updateShapeProperties()}splineProperties(t){if(t)for(const r in t)this.splineProperty(r,t[r]);else return{...this.states.splineProperties}}splineVertex(t,r,i=0,s=0,o=0){const a=new de(t,r,i),u=this.getSupportedIndividualVertexProperties().textureCoordinates?new de(s,o):void 0;this.currentShape.splineVertex(a,u)}curveDetail(t){if(t===void 0)return this.states.curveDetail;this.states.setValue("curveDetail",t)}beginShape(...t){this.currentShape.reset(),this.updateShapeVertexProperties(),this.currentShape.beginShape(...t)}endShape(...t){this.currentShape.endShape(...t),this.drawShape(this.currentShape)}beginContour(t){this.currentShape.beginContour(t)}endContour(t){this.currentShape.endContour(t)}drawShape(t,r){throw new Error("Unimplemented")}vertex(t,r,i=0,s=0,o=0){const a=new de(t,r,i),u=this.getSupportedIndividualVertexProperties().textureCoordinates?new de(s,o):void 0;this.currentShape.vertex(a,u)}bezier(t,r,i,s,o,a,u,l){const c=this._pInst.bezierOrder();return this._pInst.bezierOrder(c),this._pInst.beginShape(),this._pInst.bezierVertex(t,r),this._pInst.bezierVertex(i,s),this._pInst.bezierVertex(o,a),this._pInst.bezierVertex(u,l),this._pInst.endShape(),this}spline(...t){if(t.length===8){const[r,i,s,o,a,u,l,c]=t;this._pInst.beginShape(),this._pInst.splineVertex(r,i),this._pInst.splineVertex(s,o),this._pInst.splineVertex(a,u),this._pInst.splineVertex(l,c),this._pInst.endShape()}else if(t.length===12){const[r,i,s,o,a,u,l,c,h,f,d,p]=t;this._pInst.beginShape(),this._pInst.splineVertex(r,i,s),this._pInst.splineVertex(o,a,u),this._pInst.splineVertex(l,c,h),this._pInst.splineVertex(f,d,p),this._pInst.endShape()}return this}beginClip(t={}){if(this._clipping)throw new Error("It looks like you're trying to clip while already in the middle of clipping. Did you forget to endClip()?");this._clipping=!0,this._clipInvert=t.invert}endClip(){if(!this._clipping)throw new Error("It looks like you've called endClip() without beginClip(). Did you forget to call beginClip() first?");this._clipping=!1}resize(t,r){this.width=t,this.height=r}get(t,r,i,s){const o=this._pixelDensity,a=this.canvas;if(typeof t>"u"&&typeof r>"u")t=r=0,i=this.width,s=this.height;else if(t*=o,r*=o,typeof i>"u"&&typeof s>"u")return t<0||r<0||t>=a.width||r>=a.height?[0,0,0,0]:this._getPixel(t,r);const u=new Io(i*o,s*o);return u.pixelDensity(o),u.canvas.getContext("2d").drawImage(a,t,r,i*o,s*o,0,0,i*o,s*o),u}scale(t,r){}fill(...t){this.states.setValue("fillSet",!0),this.states.setValue("fillColor",this._pInst.color(...t)),this.updateShapeVertexProperties()}noFill(){this.states.setValue("fillColor",null)}strokeWeight(t){if(t===void 0)return this.states.strokeWeight;this.states.setValue("strokeWeight",t)}stroke(...t){this.states.setValue("strokeSet",!0),this.states.setValue("strokeColor",this._pInst.color(...t)),this.updateShapeVertexProperties()}noStroke(){this.states.setValue("strokeColor",null)}getCommonVertexProperties(){return{}}getSupportedIndividualVertexProperties(){return{textureCoordinates:!1}}updateShapeProperties(t){if(!t||t.bezierOrder||t.splineProperties){const r=this.currentShape;r.bezierOrder(this.states.bezierOrder),r.splineProperty("ends",this.states.splineProperties.ends),r.splineProperty("tightness",this.states.splineProperties.tightness)}}updateShapeVertexProperties(t){const r=this.getCommonVertexProperties();if(!t||Object.keys(t).some(i=>i in r)){const i=this.currentShape;for(const s in r)i[s](r[s])}}_applyDefaults(){return this}};Nt(jp,"states",{strokeColor:null,strokeSet:!1,fillColor:null,fillSet:!1,tint:null,imageMode:qn,rectMode:qn,ellipseMode:Dn,strokeWeight:1,textFont:{family:"sans-serif"},textLeading:15,leadingSet:!1,textSize:12,textAlign:e5,textBaseline:t5,bezierOrder:3,splineProperties:new l_({ends:Fu,tightness:0}),textWrap:i5,fontStyle:Ri,fontStretch:Ri,fontWeight:Ri,lineHeight:Ri,fontVariant:Ri,direction:"inherit"});let st=jp;function wG(n,t){n.Renderer=st}class xh extends Lr{constructor(t,r){super(t,r);const i=this;this.elt.crossOrigin="anonymous",this._prevTime=0,this._cueIDCounter=0,this._cues=[],this.pixels=[],this._pixelsState=this,this._pixelDensity=1,this._modified=!1,this._frameOnCanvas=-1,Object.defineProperty(i,"src",{get(){const s=i.elt.children[0].src,o=i.elt.src===window.location.href?"":i.elt.src;return s===window.location.href?o:s},set(s){for(let a=0;a<i.elt.children.length;a++)i.elt.removeChild(i.elt.children[a]);const o=document.createElement("source");o.src=s,t.appendChild(o),i.elt.src=s,i.modified=!0}}),i._onended=function(){},i.elt.onended=function(){i._onended(i)}}play(){this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0);let t;return this.elt.readyState>1?t=this.elt.play():(this.elt.load(),t=this.elt.play()),t&&t.catch&&t.catch(r=>{r.name==="NotAllowedError"?typeof IS_MINIFIED>"u"?p5._friendlyAutoplayError(this.src):console.error(r):console.error("Media play method encountered an unexpected error",r)}),this}stop(){return this.elt.pause(),this.elt.currentTime=0,this}pause(){return this.elt.pause(),this}loop(){return this.elt.setAttribute("loop",!0),this.play(),this}noLoop(){return this.elt.removeAttribute("loop"),this}_setupAutoplayFailDetection(){const t=setTimeout(()=>{typeof IS_MINIFIED>"u"?p5._friendlyAutoplayError(this.src):console.error(e)},500);this.elt.addEventListener("play",()=>clearTimeout(t),{passive:!0,once:!0})}autoplay(t){const r=this.elt.getAttribute("autoplay");if(this.elt.setAttribute("autoplay",t),t&&!r){const i=()=>this._setupAutoplayFailDetection();this.elt.readyState===4?i():this.elt.addEventListener("canplay",i,{passive:!0,once:!0})}return this}volume(t){if(typeof t>"u")return this.elt.volume;this.elt.volume=t}speed(t){if(typeof t>"u")return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=t:this.presetPlaybackRate=t}time(t){return typeof t>"u"?this.elt.currentTime:(this.elt.currentTime=t,this)}duration(){return this.elt.duration}_ensureCanvas(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0));const t=this._frameOnCanvas!==this._pInst.frameCount;this.loadedmetadata&&t&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&(this.drawingContext.save(),this.drawingContext.scale(-1,1),this.drawingContext.translate(-this.canvas.width,0)),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&this.drawingContext.restore(),this.setModified(!0),this._frameOnCanvas=this._pInst.frameCount)}loadPixels(...t){return this._ensureCanvas(),p5.Renderer2D.prototype.loadPixels.apply(this,t)}updatePixels(t,r,i,s){return this.loadedmetadata&&(this._ensureCanvas(),p5.Renderer2D.prototype.updatePixels.call(this,t,r,i,s)),this.setModified(!0),this}get(...t){return this._ensureCanvas(),p5.Renderer2D.prototype.get.apply(this,t)}_getPixel(...t){return this.loadPixels(),p5.Renderer2D.prototype._getPixel.apply(this,t)}set(t,r,i){this.loadedmetadata&&(this._ensureCanvas(),p5.Renderer2D.prototype.set.call(this,t,r,i),this.setModified(!0))}copy(...t){this._ensureCanvas(),fn.copy.apply(this,t)}mask(...t){this.loadPixels(),this.setModified(!0),p5.Image.prototype.mask.apply(this,t)}isModified(){return this._modified}setModified(t){this._modified=t}onended(t){return this._onended=t,this}connect(t){let r,i;if(typeof fn.getAudioContext=="function")r=fn.getAudioContext(),i=p5.soundOut.input;else try{r=t.context,i=r.destination}catch{throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=r.createMediaElementSource(this.elt),this.audioSourceNode.connect(i)),t?t.input?this.audioSourceNode.connect(t.input):this.audioSourceNode.connect(t):this.audioSourceNode.connect(i)}disconnect(){if(this.audioSourceNode)this.audioSourceNode.disconnect();else throw"nothing to disconnect"}showControls(){this.elt.style["text-align"]="inherit",this.elt.controls=!0}hideControls(){this.elt.controls=!1}addCue(t,r,i){const s=this._cueIDCounter++,o=new EG(r,t,s,i);return this._cues.push(o),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),s}removeCue(t){for(let r=0;r<this._cues.length;r++)this._cues[r].id===t&&(console.log(t),this._cues.splice(r,1));this._cues.length===0&&(this.elt.ontimeupdate=null)}clearCues(){this._cues=[],this.elt.ontimeupdate=null}_onTimeUpdate(){const t=this.time();for(let r=0;r<this._cues.length;r++){const i=this._cues[r].time,s=this._cues[r].val;this._prevTime<i&&i<=t&&this._cues[r].callback(s)}this._prevTime=t}}class EG{constructor(t,r,i,s){this.callback=t,this.time=r,this.id=i,this.val=s}}function ok(n,t){function r(s,o,a){(o._userNode?o._userNode:document.body).appendChild(s);const l=a?new xh(s,o):new Lr(s,o);return o._elements.push(l),l}function i(s,o,a,u){const l=document.createElement(o);a=a||"",typeof a=="string"&&(a=[a]);for(const h of a){const f=document.createElement("source");f.setAttribute("src",h),l.appendChild(f)}if(typeof u=="function"){const h=()=>{u(),l.removeEventListener("canplaythrough",h)};l.addEventListener("canplaythrough",h)}const c=r(l,s,!0);return c.loadedmetadata=!1,l.addEventListener("loadedmetadata",()=>{c.width=l.videoWidth,c.height=l.videoHeight,c.elt.width===0&&(c.elt.width=l.videoWidth),c.elt.height===0&&(c.elt.height=l.videoHeight),c.presetPlaybackRate&&(c.elt.playbackRate=c.presetPlaybackRate,delete c.presetPlaybackRate),c.loadedmetadata=!0}),c}t.createVideo=function(s,o){return i(this,"video",s,o)},t.createAudio=function(s,o){return i(this,"audio",s,o)},t.VIDEO="video",t.AUDIO="audio",navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(s){const o=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return o?new Promise(function(a,u){o.call(navigator,s,a,u)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),t.createCapture=function(...s){if(!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia))throw new DOMException("getUserMedia not supported in this browser");let o=!0,a=!0,u,l,c=!1;for(const p of s)p===t.VIDEO?a=!1:p===t.AUDIO?o=!1:typeof p=="object"?(p.flipped!==void 0&&(c=p.flipped,delete p.flipped),u=Object.assign({},u,p)):typeof p=="function"&&(l=p);u=Object.assign({},{video:o,audio:a},u);const f=document.createElement("video");f.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(u).then(function(p){try{"srcObject"in f?f.srcObject=p:f.src=window.URL.createObjectURL(p)}catch{f.src=p}}).catch(p=>{p.name==="NotFoundError"&&n._friendlyError("No webcam found on this device","createCapture"),p.name==="NotAllowedError"&&n._friendlyError("Access to the camera was denied","createCapture"),console.error(p)});const d=r(f,this,!0);return d.loadedmetadata=!1,f.addEventListener("loadedmetadata",function(){f.play(),f.width?(d.width=f.width,d.height=f.height,c&&(d.elt.style.transform="scaleX(-1)")):(d.width=d.elt.width=f.videoWidth,d.height=d.elt.height=f.videoHeight),d.loadedmetadata=!0,l&&l(f.srcObject)}),d.flipped=c,d},n.MediaElement=xh}typeof p5<"u"&&ok(p5,p5.prototype);function SG(n,t,r,i,s){let o;return s===qn?o={x:n,y:t,w:Math.abs(r),h:Math.abs(i)}:s===ch?o={x:Math.min(n,r),y:Math.min(t,i),w:Math.abs(r-n),h:Math.abs(i-t)}:s===hh?(r=Math.abs(r),i=Math.abs(i),o={x:n-r,y:t-i,w:2*r,h:2*i}):s===Dn&&(r=Math.abs(r),i=Math.abs(i),o={x:n-r*.5,y:t-i*.5,w:r,h:i}),o}var bd={modeAdjust:SG};function c_(n,t){t._normalizeArcAngles=(r,i,s,o,a)=>{let l;return r=r-pn*Math.floor(r/pn),i=i-pn*Math.floor(i/pn),l=Math.min(Math.abs(r-i),pn-Math.abs(r-i)),a&&(r<=Yo?r=Math.atan(s/o*Math.tan(r)):r>Yo&&r<=3*Yo?r=Math.atan(s/o*Math.tan(r))+Ay:r=Math.atan(s/o*Math.tan(r))+pn,i<=Yo?i=Math.atan(s/o*Math.tan(i)):i>Yo&&i<=3*Yo?i=Math.atan(s/o*Math.tan(i))+Ay:i=Math.atan(s/o*Math.tan(i))+pn),r>i&&(i+=pn),{start:r,stop:i,correspondToSamePoint:l<1e-5}},t.arc=function(r,i,s,o,a,u,l,c){if(!this._renderer.states.strokeColor&&!this._renderer.states.fillColor)return this;if(a===u)return this;a=this._toRadians(a),u=this._toRadians(u);const h=bd.modeAdjust(r,i,s,o,this._renderer.states.ellipseMode),f=this._normalizeArcAngles(a,u,h.w,h.h,!0);return f.correspondToSamePoint?this._renderer.ellipse([h.x,h.y,h.w,h.h,c]):(this._renderer.arc(h.x,h.y,h.w,h.h,f.start,f.stop,l,c),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[h.x,h.y,h.w,h.h,f.start,f.stop,l])),this},t.ellipse=function(r,i,s,o,a){return this._renderEllipse(...arguments)},t.circle=function(...r){const i=r.slice(0,2);return i.push(r[2],r[2]),this._renderEllipse(...i)},t._renderEllipse=function(r,i,s,o,a){if(!this._renderer.states.strokeColor&&!this._renderer.states.fillColor)return this;typeof o>"u"&&(o=s);const u=bd.modeAdjust(r,i,s,o,this._renderer.states.ellipseMode);return this._renderer.ellipse([u.x,u.y,u.w,u.h,a]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[u.x,u.y,u.w,u.h]),this},t.line=function(...r){return this._renderer.states.strokeColor&&this._renderer.line(...r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",r),this},t.point=function(...r){return this._renderer.states.strokeColor&&(r.length===1&&r[0]instanceof n.Vector?this._renderer.point.call(this._renderer,r[0].x,r[0].y,r[0].z):(this._renderer.point(...r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",r))),this},t.quad=function(...r){return(this._renderer.states.strokeColor||this._renderer.states.fillColor)&&(this._renderer.isP3D&&r.length<12?this._renderer.quad.call(this._renderer,r[0],r[1],0,r[2],r[3],0,r[4],r[5],0,r[6],r[7],0,r[8],r[9]):(this._renderer.quad(...r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",r))),this},t.rect=function(...r){return this._renderRect(...r)},t.square=function(r,i,s,o,a,u,l){return this._renderRect.call(this,r,i,s,s,o,a,u,l)},t._renderRect=function(){if(this._renderer.states.strokeColor||this._renderer.states.fillColor){arguments.length===3&&(arguments[3]=arguments[2]);const r=bd.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer.states.rectMode);this._renderer.states.rectMode===qn&&(r.w=arguments[2],r.h=arguments[3]);const i=[r.x,r.y,r.w,r.h];for(let s=4;s<arguments.length;s++)i[s]=arguments[s];this._renderer.rect(i),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[r.x,r.y,r.w,r.h])}return this},t.triangle=function(...r){return(this._renderer.states.strokeColor||this._renderer.states.fillColor)&&this._renderer.triangle(r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",r),this}}typeof p5<"u"&&c_(p5,p5.prototype);function h_(n,t){t.ellipseMode=function(r){return(r===qn||r===ch||r===hh||r===Dn)&&this._renderer.states.setValue("ellipseMode",r),this},t.noSmooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!1):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},t.rectMode=function(r){return(r===qn||r===ch||r===hh||r===Dn)&&this._renderer.states.setValue("rectMode",r),this},t.smooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!0):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},t.strokeCap=function(r){return(r===yo||r===z1||r===G1)&&this._renderer.strokeCap(r),this},t.strokeJoin=function(r){return(r===yo||r===q1||r===H1)&&this._renderer.strokeJoin(r),this},t.strokeWeight=function(r){return this._renderer.strokeWeight(r),this}}typeof p5<"u"&&h_(p5,p5.prototype);function f_(n,t){t.bezier=function(...r){return!this._renderer.states.strokeColor&&!this._renderer.states.fillColor?this:(this._renderer.bezier(...r),this)},t.bezierPoint=function(r,i,s,o,a){const u=1-a;return Math.pow(u,3)*r+3*Math.pow(u,2)*a*i+3*u*Math.pow(a,2)*s+Math.pow(a,3)*o},t.bezierTangent=function(r,i,s,o,a){const u=1-a;return 3*o*Math.pow(a,2)-3*s*Math.pow(a,2)+6*s*u*a-6*i*u*a+3*i*Math.pow(u,2)-3*r*Math.pow(u,2)},t.spline=function(...r){return!this._renderer.states.strokeColor&&!this._renderer.states.fillColor?this:(this._renderer.spline(...r),this)},t.splinePoint=function(r,i,s,o,a){const u=this._renderer.states.splineProperties.tightness,l=a*a*a,c=a*a,h=(u-1)/2*l+(1-u)*c+(u-1)/2*a,f=(u+3)/2*l+(-5-u)/2*c+1,d=(-3-u)/2*l+(u+2)*c+(1-u)/2*a,p=(1-u)/2*l+(u-1)/2*c;return r*h+i*f+s*d+o*p},t.splineTangent=function(r,i,s,o,a){const u=this._renderer.states.splineProperties.tightness,l=a*a*3,c=a*2,h=(u-1)/2*l+(1-u)*c+(u-1)/2,f=(u+3)/2*l+(-5-u)/2*c,d=(-3-u)/2*l+(u+2)*c+(1-u)/2,p=(1-u)/2*l+(u-1)/2*c;return r*h+i*f+s*d+o*p}}typeof p5<"u"&&f_(p5,p5.prototype);function d_(n,t){t.beginShape=function(r){this._renderer.beginShape(...arguments)},t.bezierVertex=function(...r){this._renderer.bezierVertex(...r)},t.endShape=function(r,i=1){i<1&&(console.log(" p5.js says: You can not have less than one instance"),i=1),this._renderer.endShape(r,i)},t.normal=function(r,i,s){return this._assert3d("normal"),this._renderer.normal(...arguments),this},t.vertexProperty=function(r,i){this._renderer.vertexProperty(r,i)}}typeof p5<"u"&&d_(p5,p5.prototype);function p_(n,t){t.beginClip=function(r={}){this._renderer.beginClip(r)},t.endClip=function(){this._renderer.endClip()},t.clip=function(r,i){this._renderer.beginClip(i),r(),this._renderer.endClip(i)},t.background=function(...r){return this._renderer.background(...r),this},t.clear=function(...r){const i=r[0]||0,s=r[1]||0,o=r[2]||0,a=r[3]||0;return this._renderer.clear(i,s,o,a),this},t.colorMode=function(r,i,s,o,a){if([nr,mn,Xn,kn,Lu,_h,Ou,bh,Vu].includes(r)){this._renderer.states.setValue("colorMode",r),this._renderer.states.setValue("colorMaxes",this._renderer.states.colorMaxes.clone());const u=this._renderer.states.colorMaxes[r];arguments.length===2?(u[0]=i,u[1]=i,u[2]=i,u[3]=i):arguments.length===4?(u[0]=i,u[1]=s,u[2]=o):arguments.length===5&&(u[0]=i,u[1]=s,u[2]=o,u[3]=a)}return this._renderer.states.colorMode},t.fill=function(...r){return this._renderer.fill(...r),this},t.noFill=function(){return this._renderer.noFill(),this},t.noStroke=function(){return this._renderer.states.setValue("strokeColor",null),this},t.stroke=function(...r){return this._renderer.stroke(...r),this},t.erase=function(r=255,i=255){return this._renderer.erase(r,i),this},t.noErase=function(){return this._renderer.noErase(),this},t.blendMode=function(r){r===Ri&&(console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead."),r=vn),this._renderer.blendMode(r)}}typeof p5<"u"&&p_(p5,p5.prototype);var Bf={},oS;function CG(){if(oS)return Bf;oS=1;function n(s,o,a,c){var l=0,c=c===void 0?{}:c,h=c.loop===void 0?null:c.loop,f=c.palette===void 0?null:c.palette;if(o<=0||a<=0||o>65535||a>65535)throw new Error("Width/Height invalid.");function d(E){var S=E.length;if(S<2||S>256||S&S-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return S}s[l++]=71,s[l++]=73,s[l++]=70,s[l++]=56,s[l++]=57,s[l++]=97;var p=0,g=0;if(f!==null){for(var y=d(f);y>>=1;)++p;if(y=1<<p,--p,c.background!==void 0){if(g=c.background,g>=y)throw new Error("Background index out of range.");if(g===0)throw new Error("Background index explicitly passed as 0.")}}if(s[l++]=o&255,s[l++]=o>>8&255,s[l++]=a&255,s[l++]=a>>8&255,s[l++]=(f!==null?128:0)|p,s[l++]=g,s[l++]=0,f!==null)for(var v=0,T=f.length;v<T;++v){var _=f[v];s[l++]=_>>16&255,s[l++]=_>>8&255,s[l++]=_&255}if(h!==null){if(h<0||h>65535)throw new Error("Loop count invalid.");s[l++]=33,s[l++]=255,s[l++]=11,s[l++]=78,s[l++]=69,s[l++]=84,s[l++]=83,s[l++]=67,s[l++]=65,s[l++]=80,s[l++]=69,s[l++]=50,s[l++]=46,s[l++]=48,s[l++]=3,s[l++]=1,s[l++]=h&255,s[l++]=h>>8&255,s[l++]=0}var C=!1;this.addFrame=function(E,S,R,w,x,b){if(C===!0&&(--l,C=!1),b=b===void 0?{}:b,E<0||S<0||E>65535||S>65535)throw new Error("x/y invalid.");if(R<=0||w<=0||R>65535||w>65535)throw new Error("Width/Height invalid.");if(x.length<R*w)throw new Error("Not enough pixels for the frame size.");var A=!0,k=b.palette;if(k==null&&(A=!1,k=f),k==null)throw new Error("Must supply either a local or global palette.");for(var N=d(k),I=0;N>>=1;)++I;N=1<<I;var j=b.delay===void 0?0:b.delay,Q=b.disposal===void 0?0:b.disposal;if(Q<0||Q>3)throw new Error("Disposal out of range.");var le=!1,fe=0;if(b.transparent!==void 0&&b.transparent!==null&&(le=!0,fe=b.transparent,fe<0||fe>=N))throw new Error("Transparent color index.");if((Q!==0||le||j!==0)&&(s[l++]=33,s[l++]=249,s[l++]=4,s[l++]=Q<<2|(le===!0?1:0),s[l++]=j&255,s[l++]=j>>8&255,s[l++]=fe,s[l++]=0),s[l++]=44,s[l++]=E&255,s[l++]=E>>8&255,s[l++]=S&255,s[l++]=S>>8&255,s[l++]=R&255,s[l++]=R>>8&255,s[l++]=w&255,s[l++]=w>>8&255,s[l++]=A===!0?128|I-1:0,A===!0)for(var ne=0,oe=k.length;ne<oe;++ne){var ie=k[ne];s[l++]=ie>>16&255,s[l++]=ie>>8&255,s[l++]=ie&255}return l=t(s,l,I<2?2:I,x),l},this.end=function(){return C===!1&&(s[l++]=59,C=!0),l},this.getOutputBuffer=function(){return s},this.setOutputBuffer=function(E){s=E},this.getOutputBufferPosition=function(){return l},this.setOutputBufferPosition=function(E){l=E}}function t(s,o,a,u){s[o++]=a;var l=o++,c=1<<a,h=c-1,f=c+1,d=f+1,p=a+1,g=0,y=0;function v(b){for(;g>=b;)s[o++]=y&255,y>>=8,g-=8,o===l+256&&(s[l]=255,l=o++)}function T(b){y|=b<<g,g+=p,v(8)}var _=u[0]&h,C={};T(c);for(var E=1,S=u.length;E<S;++E){var R=u[E]&h,w=_<<8|R,x=C[w];if(x===void 0){for(y|=_<<g,g+=p;g>=8;)s[o++]=y&255,y>>=8,g-=8,o===l+256&&(s[l]=255,l=o++);d===4096?(T(c),d=f+1,p=a+1,C={}):(d>=1<<p&&++p,C[w]=d++),_=R}else _=x}return T(_),T(f),v(1),l+1===o?s[l]=0:(s[l]=o-l-1,s[o++]=0),o}function r(s){var o=0;if(s[o++]!==71||s[o++]!==73||s[o++]!==70||s[o++]!==56||(s[o++]+1&253)!==56||s[o++]!==97)throw new Error("Invalid GIF 87a/89a header.");var a=s[o++]|s[o++]<<8,u=s[o++]|s[o++]<<8,l=s[o++],c=l>>7,h=l&7,f=1<<h+1;s[o++],s[o++];var d=null,p=null;c&&(d=o,p=f,o+=f*3);var g=!0,y=[],v=0,T=null,_=0,C=null;for(this.width=a,this.height=u;g&&o<s.length;)switch(s[o++]){case 33:switch(s[o++]){case 255:if(s[o]!==11||s[o+1]==78&&s[o+2]==69&&s[o+3]==84&&s[o+4]==83&&s[o+5]==67&&s[o+6]==65&&s[o+7]==80&&s[o+8]==69&&s[o+9]==50&&s[o+10]==46&&s[o+11]==48&&s[o+12]==3&&s[o+13]==1&&s[o+16]==0)o+=14,C=s[o++]|s[o++]<<8,o++;else for(o+=12;;){var E=s[o++];if(!(E>=0))throw Error("Invalid block size");if(E===0)break;o+=E}break;case 249:if(s[o++]!==4||s[o+4]!==0)throw new Error("Invalid graphics extension block.");var S=s[o++];v=s[o++]|s[o++]<<8,T=s[o++],(S&1)===0&&(T=null),_=S>>2&7,o++;break;case 254:for(;;){var E=s[o++];if(!(E>=0))throw Error("Invalid block size");if(E===0)break;o+=E}break;default:throw new Error("Unknown graphic control label: 0x"+s[o-1].toString(16))}break;case 44:var R=s[o++]|s[o++]<<8,w=s[o++]|s[o++]<<8,x=s[o++]|s[o++]<<8,b=s[o++]|s[o++]<<8,A=s[o++],k=A>>7,N=A>>6&1,I=A&7,j=1<<I+1,Q=d,le=p,fe=!1;if(k){var fe=!0;Q=o,le=j,o+=j*3}var ne=o;for(o++;;){var E=s[o++];if(!(E>=0))throw Error("Invalid block size");if(E===0)break;o+=E}y.push({x:R,y:w,width:x,height:b,has_local_palette:fe,palette_offset:Q,palette_size:le,data_offset:ne,data_length:o-ne,transparent_index:T,interlaced:!!N,delay:v,disposal:_});break;case 59:g=!1;break;default:throw new Error("Unknown gif block: 0x"+s[o-1].toString(16))}this.numFrames=function(){return y.length},this.loopCount=function(){return C},this.frameInfo=function(oe){if(oe<0||oe>=y.length)throw new Error("Frame index out of range.");return y[oe]},this.decodeAndBlitFrameBGRA=function(oe,ie){var ue=this.frameInfo(oe),ee=ue.width*ue.height,ve=new Uint8Array(ee);i(s,ue.data_offset,ve,ee);var ge=ue.palette_offset,we=ue.transparent_index;we===null&&(we=256);var Se=ue.width,ae=a-Se,xe=Se,ce=(ue.y*a+ue.x)*4,he=((ue.y+ue.height)*a+ue.x)*4,ye=ce,G=ae*4;ue.interlaced===!0&&(G+=a*4*7);for(var W=8,X=0,V=ve.length;X<V;++X){var L=ve[X];if(xe===0&&(ye+=G,xe=Se,ye>=he&&(G=ae*4+a*4*(W-1),ye=ce+(Se+ae)*(W<<1),W>>=1)),L===we)ye+=4;else{var z=s[ge+L*3],J=s[ge+L*3+1],re=s[ge+L*3+2];ie[ye++]=re,ie[ye++]=J,ie[ye++]=z,ie[ye++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(oe,ie){var ue=this.frameInfo(oe),ee=ue.width*ue.height,ve=new Uint8Array(ee);i(s,ue.data_offset,ve,ee);var ge=ue.palette_offset,we=ue.transparent_index;we===null&&(we=256);var Se=ue.width,ae=a-Se,xe=Se,ce=(ue.y*a+ue.x)*4,he=((ue.y+ue.height)*a+ue.x)*4,ye=ce,G=ae*4;ue.interlaced===!0&&(G+=a*4*7);for(var W=8,X=0,V=ve.length;X<V;++X){var L=ve[X];if(xe===0&&(ye+=G,xe=Se,ye>=he&&(G=ae*4+a*4*(W-1),ye=ce+(Se+ae)*(W<<1),W>>=1)),L===we)ye+=4;else{var z=s[ge+L*3],J=s[ge+L*3+1],re=s[ge+L*3+2];ie[ye++]=z,ie[ye++]=J,ie[ye++]=re,ie[ye++]=255}--xe}}}function i(s,o,a,u){for(var l=s[o++],c=1<<l,h=c+1,f=h+1,d=l+1,p=(1<<d)-1,g=0,y=0,v=0,T=s[o++],_=new Int32Array(4096),C=null;;){for(;g<16&&T!==0;)y|=s[o++]<<g,g+=8,T===1?T=s[o++]:--T;if(g<d)break;var E=y&p;if(y>>=d,g-=d,E===c){f=h+1,d=l+1,p=(1<<d)-1,C=null;continue}else if(E===h)break;for(var S=E<f?E:C,R=0,w=S;w>c;)w=_[w]>>8,++R;var x=w,b=v+R+(S!==E?1:0);if(b>u){console.log("Warning, gif stream longer than expected.");return}a[v++]=x,v+=R;var A=v;for(S!==E&&(a[v++]=x),w=S;R--;)w=_[w],a[--A]=w&255,w>>=8;C!==null&&f<4096&&(_[f++]=C<<8|x,f>=p+1&&d<12&&(++d,p=p<<1|1)),C=E}return v!==u&&console.log("Warning, gif stream shorter than expected."),a}try{Bf.GifWriter=n,Bf.GifReader=r}catch{}return Bf}var ak=CG();function AG(n,t,r=i=>i){const i=Object.create(null);if(i.options=t||{},i.reviver=r,i.value="",i.entry=[],i.output=[],i.col=1,i.row=1,i.options.delimiter=i.options.delimiter===void 0?'"':t.delimiter,i.options.delimiter.length>1||i.options.delimiter.length===0)throw Error(`CSVError: delimiter must be one character [${i.options.separator}]`);if(i.options.separator=i.options.separator===void 0?",":t.separator,i.options.separator.length>1||i.options.separator.length===0)throw Error(`CSVError: separator must be one character [${i.options.separator}]`);const s=new RegExp(`${_u(i.options.delimiter)}|${_u(i.options.separator)}|\r
|
|\r|[^${_u(i.options.delimiter)}${_u(i.options.separator)}\r
]+`,"y"),o=/^(\r\n|\n|\r)$/;let a=[],u="",l=0;for(;(a=s.exec(n))!==null;)switch(u=a[0],l){case 0:switch(!0){case u===i.options.delimiter:l=3;break;case u===i.options.separator:l=0,zo(i);break;case o.test(u):l=0,zo(i),Uf(i);break;default:i.value+=u,l=2;break}break;case 2:switch(!0){case u===i.options.separator:l=0,zo(i);break;case o.test(u):l=0,zo(i),Uf(i);break;default:throw l=4,Error(`CSVError: Illegal state [row:${i.row}, col:${i.col}]`)}break;case 3:switch(!0){case u===i.options.delimiter:l=4;break;default:l=3,i.value+=u;break}break;case 4:switch(!0){case u===i.options.delimiter:l=3,i.value+=u;break;case u===i.options.separator:l=0,zo(i);break;case o.test(u):l=0,zo(i),Uf(i);break;default:throw Error(`CSVError: Illegal state [row:${i.row}, col:${i.col}]`)}break}return i.entry.length!==0&&(zo(i),Uf(i)),i.output}function TG(n,t={},r=i=>i){const i=Object.create(null);if(i.options=t,i.options.eof=i.options.eof!==void 0?i.options.eof:!0,i.row=1,i.col=1,i.output="",i.options.delimiter=i.options.delimiter===void 0?'"':t.delimiter,i.options.delimiter.length>1||i.options.delimiter.length===0)throw Error(`CSVError: delimiter must be one character [${i.options.separator}]`);if(i.options.separator=i.options.separator===void 0?",":t.separator,i.options.separator.length>1||i.options.separator.length===0)throw Error(`CSVError: separator must be one character [${i.options.separator}]`);const s=new RegExp(`${_u(i.options.delimiter)}|${_u(i.options.separator)}|\r
|
|\r`);return n.forEach((o,a)=>{let u="";switch(i.col=1,o.forEach((l,c)=>{typeof l=="string"&&(l=l.replace(new RegExp(i.options.delimiter,"g"),`${i.options.delimiter}${i.options.delimiter}`),l=s.test(l)?`${i.options.delimiter}${l}${i.options.delimiter}`:l),u+=r(l,i.row,i.col),c!==o.length-1&&(u+=i.options.separator),i.col++}),!0){case i.options.eof:case(!i.options.eof&&a!==n.length-1):i.output+=`${u}
`;break;default:i.output+=`${u}`;break}i.row++}),i.output}function zo(n){const t=n.options.typed?IG(n.value):n.value;n.entry.push(n.reviver(t,n.row,n.col)),n.value="",n.col++}function Uf(n){n.output.push(n.entry),n.entry=[],n.row++,n.col=1}function IG(n){const t=/.\./;switch(!0){case n==="true":case n==="false":return n==="true";case t.test(n):return parseFloat(n);case isFinite(n):return parseInt(n);default:return n}}function _u(n){return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var DG={trailer:59};function uk(n=256){let t=0,r=new Uint8Array(n);return{get buffer(){return r.buffer},reset(){t=0},bytesView(){return r.subarray(0,t)},bytes(){return r.slice(0,t)},writeByte(s){i(t+1),r[t]=s,t++},writeBytes(s,o=0,a=s.length){i(t+a);for(let u=0;u<a;u++)r[t++]=s[u+o]},writeBytesView(s,o=0,a=s.byteLength){i(t+a),r.set(s.subarray(o,o+a),t),t+=a}};function i(s){var o=r.length;if(o>=s)return;var a=1024*1024;s=Math.max(s,o*(o<a?2:1.125)>>>0),o!=0&&(s=Math.max(s,256));let u=r;r=new Uint8Array(s),t>0&&r.set(u.subarray(0,t),0)}}var Ym=12,aS=5003,kG=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function NG(n,t,r,i,s=uk(512),o=new Uint8Array(256),a=new Int32Array(aS),u=new Int32Array(aS)){let l=a.length,c=Math.max(2,i);o.fill(0),u.fill(0),a.fill(-1);let h=0,f=0,d=c+1,p=d,g=!1,y=p,v=(1<<y)-1,T=1<<d-1,_=T+1,C=T+2,E=0,S=r[0],R=0;for(let b=l;b<65536;b*=2)++R;R=8-R,s.writeByte(c),x(T);let w=r.length;for(let b=1;b<w;b++)e:{let A=r[b],k=(A<<Ym)+S,N=A<<R^S;if(a[N]===k){S=u[N];break e}let I=N===0?1:l-N;for(;a[N]>=0;)if(N-=I,N<0&&(N+=l),a[N]===k){S=u[N];break e}x(S),S=A,C<1<<Ym?(u[N]=C++,a[N]=k):(a.fill(-1),C=T+2,g=!0,x(T))}return x(S),x(_),s.writeByte(0),s.bytesView();function x(b){for(h&=kG[f],f>0?h|=b<<f:h=b,f+=y;f>=8;)o[E++]=h&255,E>=254&&(s.writeByte(E),s.writeBytesView(o,0,E),E=0),h>>=8,f-=8;if((C>v||g)&&(g?(y=p,v=(1<<y)-1,g=!1):(++y,v=y===Ym?1<<y:(1<<y)-1)),b==_){for(;f>0;)o[E++]=h&255,E>=254&&(s.writeByte(E),s.writeBytesView(o,0,E),E=0),h>>=8,f-=8;E>0&&(s.writeByte(E),s.writeBytesView(o,0,E),E=0)}}}var RG=NG;function FG(n,t,r){return n<<8&63488|t<<2&992|r>>3}function PG(n,t,r,i){return n>>4|t&240|(r&240)<<4|(i&240)<<8}function MG(n,t,r){return n>>4<<8|t&240|r>>4}function $f(n,t,r){return n<t?t:n>r?r:n}function xd(n){return n*n}function uS(n,t,r){var i=0,s=1e100;let o=n[t],a=o.cnt;o.ac;let u=o.rc,l=o.gc,c=o.bc;for(var h=o.fw;h!=0;h=n[h].fw){let d=n[h],p=d.cnt,g=a*p/(a+p);if(!(g>=s)){var f=0;f+=g*xd(d.rc-u),!(f>=s)&&(f+=g*xd(d.gc-l),!(f>=s)&&(f+=g*xd(d.bc-c),!(f>=s)&&(s=f,i=h)))}}o.err=s,o.nn=i}function Xm(){return{ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0}}function LG(n,t){let r=t==="rgb444"?4096:65536,i=new Array(r),s=n.length;if(t==="rgba4444")for(let o=0;o<s;++o){let a=n[o],u=a>>24&255,l=a>>16&255,c=a>>8&255,h=a&255,f=PG(h,c,l,u),d=f in i?i[f]:i[f]=Xm();d.rc+=h,d.gc+=c,d.bc+=l,d.ac+=u,d.cnt++}else if(t==="rgb444")for(let o=0;o<s;++o){let a=n[o],u=a>>16&255,l=a>>8&255,c=a&255,h=MG(c,l,u),f=h in i?i[h]:i[h]=Xm();f.rc+=c,f.gc+=l,f.bc+=u,f.cnt++}else for(let o=0;o<s;++o){let a=n[o],u=a>>16&255,l=a>>8&255,c=a&255,h=FG(c,l,u),f=h in i?i[h]:i[h]=Xm();f.rc+=c,f.gc+=l,f.bc+=u,f.cnt++}return i}function OG(n,t,r={}){let{format:i="rgb565",clearAlpha:s=!0,clearAlphaColor:o=0,clearAlphaThreshold:a=0,oneBitAlpha:u=!1}=r;if(!n||!n.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(n instanceof Uint8Array)&&!(n instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");let l=new Uint32Array(n.buffer),c=r.useSqrt!==!1,h=i==="rgba4444",f=LG(l,i),d=f.length,p=d-1,g=new Uint32Array(d+1);for(var y=0,v=0;v<d;++v){let j=f[v];if(j!=null){var T=1/j.cnt;h&&(j.ac*=T),j.rc*=T,j.gc*=T,j.bc*=T,f[y++]=j}}xd(t)/y<.022&&(c=!1);for(var v=0;v<y-1;++v)f[v].fw=v+1,f[v+1].bk=v,c&&(f[v].cnt=Math.sqrt(f[v].cnt));c&&(f[v].cnt=Math.sqrt(f[v].cnt));var _,C,E;for(v=0;v<y;++v){uS(f,v);var S=f[v].err;for(C=++g[0];C>1&&(E=C>>1,!(f[_=g[E]].err<=S));C=E)g[C]=_;g[C]=v}var R=y-t;for(v=0;v<R;){for(var w;;){var x=g[1];if(w=f[x],w.tm>=w.mtm&&f[w.nn].mtm<=w.tm)break;w.mtm==p?x=g[1]=g[g[0]--]:(uS(f,x),w.tm=v);var S=f[x].err;for(C=1;(E=C+C)<=g[0]&&(E<g[0]&&f[g[E]].err>f[g[E+1]].err&&E++,!(S<=f[_=g[E]].err));C=E)g[C]=_;g[C]=x}var b=f[w.nn],A=w.cnt,k=b.cnt,T=1/(A+k);h&&(w.ac=T*(A*w.ac+k*b.ac)),w.rc=T*(A*w.rc+k*b.rc),w.gc=T*(A*w.gc+k*b.gc),w.bc=T*(A*w.bc+k*b.bc),w.cnt+=b.cnt,w.mtm=++v,f[b.bk].fw=b.fw,f[b.fw].bk=b.bk,b.mtm=p}let N=[];var I=0;for(v=0;;++I){let j=$f(Math.round(f[v].rc),0,255),Q=$f(Math.round(f[v].gc),0,255),le=$f(Math.round(f[v].bc),0,255),fe=255;h&&(fe=$f(Math.round(f[v].ac),0,255),u&&(fe=fe<=(typeof u=="number"?u:127)?0:255),s&&fe<=a&&(j=Q=le=o,fe=0));let ne=h?[j,Q,le,fe]:[j,Q,le];if(VG(N,ne)||N.push(ne),(v=f[v].fw)==0)break}return N}function VG(n,t){for(let r=0;r<n.length;r++){let i=n[r],s=i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2],o=i.length>=4&&t.length>=4?i[3]===t[3]:!0;if(s&&o)return!0}return!1}function BG(n,t){var r=0,i;for(i=0;i<n.length;i++){let s=n[i]-t[i];r+=s*s}return r}function UG(n,t,r=BG){let i=1/0,s=-1;for(let o=0;o<n.length;o++){let a=n[o],u=r(t,a);u<i&&(i=u,s=o)}return s}function $G(n={}){let{initialCapacity:t=4096,auto:r=!0}=n,i=uk(t),s=5003,o=new Uint8Array(256),a=new Int32Array(s),u=new Int32Array(s),l=!1;return{reset(){i.reset(),l=!1},finish(){i.writeByte(DG.trailer)},bytes(){return i.bytes()},bytesView(){return i.bytesView()},get buffer(){return i.buffer},get stream(){return i},writeHeader:c,writeFrame(h,f,d,p={}){let{transparent:g=!1,transparentIndex:y=0,delay:v=0,palette:T=null,repeat:_=0,colorDepth:C=8,dispose:E=-1}=p,S=!1;if(r?l||(S=!0,c(),l=!0):S=!!p.first,f=Math.max(0,Math.floor(f)),d=Math.max(0,Math.floor(d)),S){if(!T)throw new Error("First frame must include a { palette } option");GG(i,f,d,T,C),lS(i,T),_>=0&&zG(i,_)}let R=Math.round(v/10);jG(i,E,R,g,y);let w=!!T&&!S;qG(i,f,d,w?T:null),w&&lS(i,T),HG(i,h,f,d,C,o,a,u)}};function c(){lk(i,"GIF89a")}}function jG(n,t,r,i,s){n.writeByte(33),n.writeByte(249),n.writeByte(4),s<0&&(s=0,i=!1);var o,a;i?(o=1,a=2):(o=0,a=0),t>=0&&(a=t&7),a<<=2,n.writeByte(0|a|0|o),so(n,r),n.writeByte(s||0),n.writeByte(0)}function GG(n,t,r,i,s=8){let o=1,a=0,u=g_(i.length)-1,l=o<<7|s-1<<4|a<<3|u;so(n,t),so(n,r),n.writeBytes([l,0,0])}function zG(n,t){n.writeByte(33),n.writeByte(255),n.writeByte(11),lk(n,"NETSCAPE2.0"),n.writeByte(3),n.writeByte(1),so(n,t),n.writeByte(0)}function lS(n,t){let r=1<<g_(t.length);for(let i=0;i<r;i++){let s=[0,0,0];i<t.length&&(s=t[i]),n.writeByte(s[0]),n.writeByte(s[1]),n.writeByte(s[2])}}function qG(n,t,r,i){if(n.writeByte(44),so(n,0),so(n,0),so(n,t),so(n,r),i){let s=0,o=0,a=g_(i.length)-1;n.writeByte(128|s|o|0|a)}else n.writeByte(0)}function HG(n,t,r,i,s=8,o,a,u){RG(r,i,t,s,n,o,a,u)}function so(n,t){n.writeByte(t&255),n.writeByte(t>>8&255)}function lk(n,t){for(var r=0;r<t.length;r++)n.writeByte(t.charCodeAt(r))}function g_(n){return Math.max(Math.ceil(Math.log2(n)),1)}function m_(n,t){t.blend=function(...i){this._renderer?this._renderer.blend(...i):n.Renderer2D.prototype.blend.apply(this,i)},t.copy=function(...i){let s,o,a,u,l,c,h,f,d;if(i.length===9)s=i[0],o=i[1],a=i[2],u=i[3],l=i[4],c=i[5],h=i[6],f=i[7],d=i[8];else if(i.length===8)s=this,o=i[0],a=i[1],u=i[2],l=i[3],c=i[4],h=i[5],f=i[6],d=i[7];else throw new Error("Signature not supported");t._copyHelper(this,s,o,a,u,l,c,h,f,d)},t._copyHelper=(i,s,o,a,u,l,c,h,f,d)=>{const p=s.canvas.width/s.width;let g=0,y=0;s._renderer&&s._renderer.isP3D&&(g=s.width/2,y=s.height/2),i._renderer&&i._renderer.isP3D?(i.push(),i.resetMatrix(),i.noLights(),i.blendMode(i.BLEND),i.imageMode(i.CORNER),i._renderer.image(s,o+g,a+y,u,l,c,h,f,d),i.pop()):i.drawingContext.drawImage(s.canvas,p*(o+g),p*(a+y),p*u,p*l,c,h,f,d)},t.getFilterGraphicsLayer=function(){return this._renderer.getFilterGraphicsLayer()},t.filter=function(...i){let{shader:s,operation:o,value:a,useWebGL:u}=r(...i);if(this._renderer.isP3D&&s){this._renderer.filter(s);return}if(!u&&!this._renderer.isP3D){this.canvas!==void 0?Ut.apply(this.canvas,Ut[o],a):Ut.apply(this.elt,Ut[o],a);return}!u&&this._renderer.isP3D&&console.warn("filter() with useWebGL=false is not supported in WEBGL"),this._renderer.isP3D?this._renderer.filter(o,a):(s?this._renderer.filterRenderer.setOperation(o,a,s):this._renderer.filterRenderer.setOperation(o,a),this._renderer.filterRenderer.applyFilter())};function r(...i){let s={shader:void 0,operation:void 0,value:void 0,useWebGL:!0};return i[0]instanceof n.Shader?(s.shader=i[0],s):(s.operation=i[0],i.length>1&&typeof i[1]=="number"&&(s.value=i[1]),i[i.length-1]===!1&&(s.useWebGL=!1),s)}t.get=function(i,s,o,a){return this._renderer.get(...arguments)},t.loadPixels=function(...i){this._renderer.loadPixels()},t.set=function(i,s,o){this._renderer.set(i,s,o)},t.updatePixels=function(i,s,o,a){this.pixels.length!==0&&this._renderer.updatePixels(i,s,o,a)}}typeof p5<"u"&&m_(p5,p5.prototype);var lv;const V_=class V_{constructor(...t){Zt(this,lv,null);if(this.constructor===V_)throw new Error("Class is of abstract type and can't be instantiated");["add","setElement","reset","set","get","copy","clone","diagonal","row","column","transpose","mult","multiplyVec","invert","createSubMatrix3x3","inverseTranspose4x4","apply","scale","rotate4x4","translate","rotateX","rotateY","rotateZ","perspective","ortho","multiplyVec4","multiplyPoint","multiplyAndNormalizePoint","multiplyDirection","multiplyVec3"].forEach(i=>{if(this[i]===void 0)throw new Error(`${i}() method must be implemented`)})}};lv=new WeakMap;let $y=V_;const Zm=n=>{if(Math.sqrt(Array.from(n).length)%1!==0)throw new Error("Array length must be a perfect square.");return!0};let is=Array,Qo=n=>Array.isArray(n);typeof Float32Array<"u"&&(is=Float32Array,Qo=n=>Array.isArray(n)||n instanceof Float32Array);var Bt,br,jy,ck,hk,fk,dk,pk,gk,mk,yk,WG;const Di=class Di extends $y{constructor(...r){super(...r);Zt(this,br);Nt(this,"matrix");Zt(this,Bt);if(Qo(r[0])&&Zm(r[0])){const i=Math.sqrt(Array.from(r[0]).length);Zr(this,Bt,i),this.matrix=is.from(r[0])}else typeof r[0]=="number"&&(Zr(this,Bt,Number(r[0])),this.matrix=Cr(this,br,jy).call(this,r[0]));return this}get mat3(){if(Ve(this,Bt)===3)return this.matrix}get mat4(){if(Ve(this,Bt)===4)return this.matrix}add(r){if(this.matrix.length!==r.matrix.length)throw new Error("Matrices must be of the same dimension to add.");for(let i=0;i<this.matrix.length;i++)this.matrix[i]+=r.matrix[i];return this}setElement(r,i){return r>=0&&r<this.matrix.length&&(this.matrix[r]=i),this}reset(){return this.matrix=Cr(this,br,jy).call(this,Ve(this,Bt)),this}set(r){let i=is.from([...arguments]);return r instanceof Di?i=is.from(r.matrix):Qo(r)&&(i=is.from(r)),i.length!==this.matrix.length?(p5._friendlyError(`Expected same dimensions values but received different ${i.length}.`,"p5.Matrix.set"),this):(this.matrix=i,this)}get(){return new Di(this.matrix)}copy(){return new Di(this.matrix)}clone(){return this.copy()}diagonal(){const r=[];for(let i=0;i<Ve(this,Bt);i++)r.push(this.matrix[i*(Ve(this,Bt)+1)]);return r}row(r){const i=[];for(let s=0;s<Ve(this,Bt);s++)i.push(this.matrix[s*Ve(this,Bt)+r]);return new de(...i)}column(r){const i=[];for(let s=0;s<Ve(this,Bt);s++)i.push(this.matrix[r*Ve(this,Bt)+s]);return new de(...i)}transpose(r){return Ve(this,Bt)===4?Cr(this,br,pk).call(this,r):Ve(this,Bt)===3?Cr(this,br,gk).call(this,r):Cr(this,br,dk).call(this,r)}mult(r){let i;return r===this||r===this.matrix?i=this.copy().matrix:r instanceof Di?i=r.matrix:Qo(r)&&Zm(r)?i=r:Zm(arguments)&&(i=Array.from(arguments)),Ve(this,Bt)===4&&i.length===16?Cr(this,br,ck).call(this,i):Ve(this,Bt)===3&&i.length===9?Cr(this,br,fk).call(this,i):Cr(this,br,hk).call(this,i)}multiplyVec(r,i){i===void 0&&(i=r.copy());for(let s=0;s<Ve(this,Bt);s++)i.values[s]=this.row(s).dot(r);return i}invert(r){if(Ve(this,Bt)===4)return Cr(this,br,mk).call(this,r);if(Ve(this,Bt)===3)return Cr(this,br,yk).call(this,r);throw new Error("Invert is not implemented for N>4 at the moment, we are working on it")}createSubMatrix3x3(){if(Ve(this,Bt)===4){const r=new Di(3);return r.mat3[0]=this.matrix[0],r.mat3[1]=this.matrix[1],r.mat3[2]=this.matrix[2],r.mat3[3]=this.matrix[4],r.mat3[4]=this.matrix[5],r.mat3[5]=this.matrix[6],r.mat3[6]=this.matrix[8],r.mat3[7]=this.matrix[9],r.mat3[8]=this.matrix[10],r}else throw new Error("Matrix dimension must be 4 to create a 3x3 submatrix.")}inverseTranspose4x4({mat4:r}){if(Ve(this,Bt)!==3)throw new Error("This function only works with 33 matrices.");this.matrix[0]=r[0],this.matrix[1]=r[1],this.matrix[2]=r[2],this.matrix[3]=r[4],this.matrix[4]=r[5],this.matrix[5]=r[6],this.matrix[6]=r[8],this.matrix[7]=r[9],this.matrix[8]=r[10];const i=this.invert();if(i)i.transpose(this.matrix);else for(let s=0;s<9;s++)this.matrix[s]=0;return this}apply(r){let i;if(r===this||r===this.matrix)i=this.copy().matrix;else if(r instanceof Di)i=r.matrix;else if(Qo(r))i=r;else if(arguments.length===16)i=arguments;else return;const s=this.matrix,o=s[0],a=s[4],u=s[8],l=s[12];s[0]=i[0]*o+i[1]*a+i[2]*u+i[3]*l,s[4]=i[4]*o+i[5]*a+i[6]*u+i[7]*l,s[8]=i[8]*o+i[9]*a+i[10]*u+i[11]*l,s[12]=i[12]*o+i[13]*a+i[14]*u+i[15]*l;const c=s[1],h=s[5],f=s[9],d=s[13];s[1]=i[0]*c+i[1]*h+i[2]*f+i[3]*d,s[5]=i[4]*c+i[5]*h+i[6]*f+i[7]*d,s[9]=i[8]*c+i[9]*h+i[10]*f+i[11]*d,s[13]=i[12]*c+i[13]*h+i[14]*f+i[15]*d;const p=s[2],g=s[6],y=s[10],v=s[14];s[2]=i[0]*p+i[1]*g+i[2]*y+i[3]*v,s[6]=i[4]*p+i[5]*g+i[6]*y+i[7]*v,s[10]=i[8]*p+i[9]*g+i[10]*y+i[11]*v,s[14]=i[12]*p+i[13]*g+i[14]*y+i[15]*v;const T=s[3],_=s[7],C=s[11],E=s[15];return s[3]=i[0]*T+i[1]*_+i[2]*C+i[3]*E,s[7]=i[4]*T+i[5]*_+i[6]*C+i[7]*E,s[11]=i[8]*T+i[9]*_+i[10]*C+i[11]*E,s[15]=i[12]*T+i[13]*_+i[14]*C+i[15]*E,this}scale(r,i,s){return r instanceof de?(i=r.y,s=r.z,r=r.x):r instanceof Array&&(i=r[1],s=r[2],r=r[0]),this.matrix[0]*=r,this.matrix[1]*=r,this.matrix[2]*=r,this.matrix[3]*=r,this.matrix[4]*=i,this.matrix[5]*=i,this.matrix[6]*=i,this.matrix[7]*=i,this.matrix[8]*=s,this.matrix[9]*=s,this.matrix[10]*=s,this.matrix[11]*=s,this}rotate4x4(r,i,s,o){i instanceof de?(s=i.y,o=i.z,i=i.x):i instanceof Array&&(s=i[1],o=i[2],i=i[0]);const a=Math.sqrt(i*i+s*s+o*o);i*=1/a,s*=1/a,o*=1/a;const u=this.matrix[0],l=this.matrix[1],c=this.matrix[2],h=this.matrix[3],f=this.matrix[4],d=this.matrix[5],p=this.matrix[6],g=this.matrix[7],y=this.matrix[8],v=this.matrix[9],T=this.matrix[10],_=this.matrix[11],C=Math.sin(r),E=Math.cos(r),S=1-E,R=i*i*S+E,w=s*i*S+o*C,x=o*i*S-s*C,b=i*s*S-o*C,A=s*s*S+E,k=o*s*S+i*C,N=i*o*S+s*C,I=s*o*S-i*C,j=o*o*S+E;return this.matrix[0]=u*R+f*w+y*x,this.matrix[1]=l*R+d*w+v*x,this.matrix[2]=c*R+p*w+T*x,this.matrix[3]=h*R+g*w+_*x,this.matrix[4]=u*b+f*A+y*k,this.matrix[5]=l*b+d*A+v*k,this.matrix[6]=c*b+p*A+T*k,this.matrix[7]=h*b+g*A+_*k,this.matrix[8]=u*N+f*I+y*j,this.matrix[9]=l*N+d*I+v*j,this.matrix[10]=c*N+p*I+T*j,this.matrix[11]=h*N+g*I+_*j,this}translate(r){const i=r[0],s=r[1],o=r[2]||0;return this.matrix[12]+=this.matrix[0]*i+this.matrix[4]*s+this.matrix[8]*o,this.matrix[13]+=this.matrix[1]*i+this.matrix[5]*s+this.matrix[9]*o,this.matrix[14]+=this.matrix[2]*i+this.matrix[6]*s+this.matrix[10]*o,this.matrix[15]+=this.matrix[3]*i+this.matrix[7]*s+this.matrix[11]*o,this}rotateX(r){this.rotate4x4(r,1,0,0)}rotateY(r){this.rotate4x4(r,0,1,0)}rotateZ(r){this.rotate4x4(r,0,0,1)}perspective(r,i,s,o){const a=1/Math.tan(r/2),u=1/(s-o);return this.matrix[0]=a/i,this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=0,this.matrix[5]=a,this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=0,this.matrix[9]=0,this.matrix[10]=(o+s)*u,this.matrix[11]=-1,this.matrix[12]=0,this.matrix[13]=0,this.matrix[14]=2*o*s*u,this.matrix[15]=0,this}ortho(r,i,s,o,a,u){const l=1/(r-i),c=1/(s-o),h=1/(a-u);return this.matrix[0]=-2*l,this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=0,this.matrix[5]=-2*c,this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=0,this.matrix[9]=0,this.matrix[10]=2*h,this.matrix[11]=0,this.matrix[12]=(r+i)*l,this.matrix[13]=(o+s)*c,this.matrix[14]=(u+a)*h,this.matrix[15]=1,this}multiplyVec4(r,i,s,o){const a=new Array(4),u=this.matrix;return a[0]=u[0]*r+u[4]*i+u[8]*s+u[12]*o,a[1]=u[1]*r+u[5]*i+u[9]*s+u[13]*o,a[2]=u[2]*r+u[6]*i+u[10]*s+u[14]*o,a[3]=u[3]*r+u[7]*i+u[11]*s+u[15]*o,a}multiplyPoint({x:r,y:i,z:s}){const o=this.multiplyVec4(r,i,s,1);return new de(o[0],o[1],o[2])}multiplyAndNormalizePoint({x:r,y:i,z:s}){const o=this.multiplyVec4(r,i,s,1);return o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],new de(o[0],o[1],o[2])}multiplyDirection({x:r,y:i,z:s}){const o=this.multiplyVec4(r,i,s,0);return new de(o[0],o[1],o[2])}multiplyVec3(r,i){return i===void 0&&(i=r.copy()),i.x=this.row(0).dot(r),i.y=this.row(1).dot(r),i.z=this.row(2).dot(r),i}};Bt=new WeakMap,br=new WeakSet,jy=function(r){if(r===3)return new is([1,0,0,0,1,0,0,0,1]);if(r===4)return new is([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);const i=new is(r*r).fill(0);for(let s=0;s<r;s++)i[s*r+s]=1;return i},ck=function(r){let i=this.matrix[0],s=this.matrix[1],o=this.matrix[2],a=this.matrix[3];return this.matrix[0]=i*r[0]+s*r[4]+o*r[8]+a*r[12],this.matrix[1]=i*r[1]+s*r[5]+o*r[9]+a*r[13],this.matrix[2]=i*r[2]+s*r[6]+o*r[10]+a*r[14],this.matrix[3]=i*r[3]+s*r[7]+o*r[11]+a*r[15],i=this.matrix[4],s=this.matrix[5],o=this.matrix[6],a=this.matrix[7],this.matrix[4]=i*r[0]+s*r[4]+o*r[8]+a*r[12],this.matrix[5]=i*r[1]+s*r[5]+o*r[9]+a*r[13],this.matrix[6]=i*r[2]+s*r[6]+o*r[10]+a*r[14],this.matrix[7]=i*r[3]+s*r[7]+o*r[11]+a*r[15],i=this.matrix[8],s=this.matrix[9],o=this.matrix[10],a=this.matrix[11],this.matrix[8]=i*r[0]+s*r[4]+o*r[8]+a*r[12],this.matrix[9]=i*r[1]+s*r[5]+o*r[9]+a*r[13],this.matrix[10]=i*r[2]+s*r[6]+o*r[10]+a*r[14],this.matrix[11]=i*r[3]+s*r[7]+o*r[11]+a*r[15],i=this.matrix[12],s=this.matrix[13],o=this.matrix[14],a=this.matrix[15],this.matrix[12]=i*r[0]+s*r[4]+o*r[8]+a*r[12],this.matrix[13]=i*r[1]+s*r[5]+o*r[9]+a*r[13],this.matrix[14]=i*r[2]+s*r[6]+o*r[10]+a*r[14],this.matrix[15]=i*r[3]+s*r[7]+o*r[11]+a*r[15],this},hk=function(r){if(r.length!==this.matrix.length)throw new Error("Matrices must be of the same dimension to multiply.");const i=new is(this.matrix.length).fill(0);for(let s=0;s<Ve(this,Bt);s++)for(let o=0;o<Ve(this,Bt);o++)for(let a=0;a<Ve(this,Bt);a++)i[s*Ve(this,Bt)+o]+=this.matrix[s*Ve(this,Bt)+a]*r[a*Ve(this,Bt)+o];return this.matrix=i,this},fk=function(r){let i=this.mat3[0],s=this.mat3[1],o=this.mat3[2];return this.mat3[0]=i*r[0]+s*r[3]+o*r[6],this.mat3[1]=i*r[1]+s*r[4]+o*r[7],this.mat3[2]=i*r[2]+s*r[5]+o*r[8],i=this.mat3[3],s=this.mat3[4],o=this.mat3[5],this.mat3[3]=i*r[0]+s*r[3]+o*r[6],this.mat3[4]=i*r[1]+s*r[4]+o*r[7],this.mat3[5]=i*r[2]+s*r[5]+o*r[8],i=this.mat3[6],s=this.mat3[7],o=this.mat3[8],this.mat3[6]=i*r[0]+s*r[3]+o*r[6],this.mat3[7]=i*r[1]+s*r[4]+o*r[7],this.mat3[8]=i*r[2]+s*r[5]+o*r[8],this},dk=function(){const r=Ve(this,Bt);for(let i=0;i<r;i++)for(let s=0;s<r;s++)this.matrix[i*r+s]=this.matrix[s*r+i];return this},pk=function(r){console.log("====> 4x4");let i,s,o,a,u,l;return r instanceof Di?(i=r.matrix[1],s=r.matrix[2],o=r.matrix[3],a=r.matrix[6],u=r.matrix[7],l=r.matrix[11],this.matrix[0]=r.matrix[0],this.matrix[1]=r.matrix[4],this.matrix[2]=r.matrix[8],this.matrix[3]=r.matrix[12],this.matrix[4]=i,this.matrix[5]=r.matrix[5],this.matrix[6]=r.matrix[9],this.matrix[7]=r.matrix[13],this.matrix[8]=s,this.matrix[9]=a,this.matrix[10]=r.matrix[10],this.matrix[11]=r.matrix[14],this.matrix[12]=o,this.matrix[13]=u,this.matrix[14]=l,this.matrix[15]=r.matrix[15]):Qo(r)&&(i=r[1],s=r[2],o=r[3],a=r[6],u=r[7],l=r[11],this.matrix[0]=r[0],this.matrix[1]=r[4],this.matrix[2]=r[8],this.matrix[3]=r[12],this.matrix[4]=i,this.matrix[5]=r[5],this.matrix[6]=r[9],this.matrix[7]=r[13],this.matrix[8]=s,this.matrix[9]=a,this.matrix[10]=r[10],this.matrix[11]=r[14],this.matrix[12]=o,this.matrix[13]=u,this.matrix[14]=l,this.matrix[15]=r[15]),this},gk=function(r){r===void 0&&(r=this.mat3);const i=r[1],s=r[2],o=r[5];return this.mat3[0]=r[0],this.mat3[1]=r[3],this.mat3[2]=r[6],this.mat3[3]=i,this.mat3[4]=r[4],this.mat3[5]=r[7],this.mat3[6]=s,this.mat3[7]=o,this.mat3[8]=r[8],this},mk=function(r){let i,s,o,a,u,l,c,h,f,d,p,g,y,v,T,_;r instanceof Di?(i=r.matrix[0],s=r.matrix[1],o=r.matrix[2],a=r.matrix[3],u=r.matrix[4],l=r.matrix[5],c=r.matrix[6],h=r.matrix[7],f=r.matrix[8],d=r.matrix[9],p=r.matrix[10],g=r.matrix[11],y=r.matrix[12],v=r.matrix[13],T=r.matrix[14],_=r.matrix[15]):Qo(r)&&(i=r[0],s=r[1],o=r[2],a=r[3],u=r[4],l=r[5],c=r[6],h=r[7],f=r[8],d=r[9],p=r[10],g=r[11],y=r[12],v=r[13],T=r[14],_=r[15]);const C=i*l-s*u,E=i*c-o*u,S=i*h-a*u,R=s*c-o*l,w=s*h-a*l,x=o*h-a*c,b=f*v-d*y,A=f*T-p*y,k=f*_-g*y,N=d*T-p*v,I=d*_-g*v,j=p*_-g*T;let Q=C*j-E*I+S*N+R*k-w*A+x*b;return Q?(Q=1/Q,this.matrix[0]=(l*j-c*I+h*N)*Q,this.matrix[1]=(o*I-s*j-a*N)*Q,this.matrix[2]=(v*x-T*w+_*R)*Q,this.matrix[3]=(p*w-d*x-g*R)*Q,this.matrix[4]=(c*k-u*j-h*A)*Q,this.matrix[5]=(i*j-o*k+a*A)*Q,this.matrix[6]=(T*S-y*x-_*E)*Q,this.matrix[7]=(f*x-p*S+g*E)*Q,this.matrix[8]=(u*I-l*k+h*b)*Q,this.matrix[9]=(s*k-i*I-a*b)*Q,this.matrix[10]=(y*w-v*S+_*C)*Q,this.matrix[11]=(d*S-f*w-g*C)*Q,this.matrix[12]=(l*A-u*N-c*b)*Q,this.matrix[13]=(i*N-s*A+o*b)*Q,this.matrix[14]=(v*E-y*R-T*C)*Q,this.matrix[15]=(f*R-d*E+p*C)*Q,this):null},yk=function(){const r=this.mat3[0],i=this.mat3[1],s=this.mat3[2],o=this.mat3[3],a=this.mat3[4],u=this.mat3[5],l=this.mat3[6],c=this.mat3[7],h=this.mat3[8],f=h*a-u*c,d=-h*o+u*l,p=c*o-a*l;let g=r*f+i*d+s*p;return g?(g=1/g,this.mat3[0]=f*g,this.mat3[1]=(-h*i+s*c)*g,this.mat3[2]=(u*i-s*a)*g,this.mat3[3]=d*g,this.mat3[4]=(h*r-s*l)*g,this.mat3[5]=(-u*r+s*o)*g,this.mat3[6]=p*g,this.mat3[7]=(-c*r+i*l)*g,this.mat3[8]=(a*r-i*o)*g,this):null},WG=function(){if(Ve(this,Bt)!==4)throw new Error("Determinant is only implemented for 4x4 matrices. We are working on it.");const r=this.matrix[0]*this.matrix[5]-this.matrix[1]*this.matrix[4],i=this.matrix[0]*this.matrix[6]-this.matrix[2]*this.matrix[4],s=this.matrix[0]*this.matrix[7]-this.matrix[3]*this.matrix[4],o=this.matrix[1]*this.matrix[6]-this.matrix[2]*this.matrix[5],a=this.matrix[1]*this.matrix[7]-this.matrix[3]*this.matrix[5],u=this.matrix[2]*this.matrix[7]-this.matrix[3]*this.matrix[6],l=this.matrix[8]*this.matrix[13]-this.matrix[9]*this.matrix[12],c=this.matrix[8]*this.matrix[14]-this.matrix[10]*this.matrix[12],h=this.matrix[8]*this.matrix[15]-this.matrix[11]*this.matrix[12],f=this.matrix[9]*this.matrix[14]-this.matrix[10]*this.matrix[13],d=this.matrix[9]*this.matrix[15]-this.matrix[11]*this.matrix[13],p=this.matrix[10]*this.matrix[15]-this.matrix[11]*this.matrix[14];return r*p-i*d+s*f+o*h-a*c+u*l};let wr=Di;function vk(n,t){n.Matrix=wr}typeof p5<"u"&&vk(p5,p5.prototype);class oa{constructor(t=128){this.length=0,this.data=new Float32Array(t),this.initialLength=t}dataArray(){return this.subArray(0,this.length)}clear(){this.length=0}rescale(){if(this.length<this.data.length/2){const t=1<<Math.ceil(Math.log2(this.length)),r=new Float32Array(t);r.set(this.data.subarray(0,this.length),0),this.data=r}}reset(){this.clear(),this.data=new Float32Array(this.initialLength)}push(...t){this.ensureLength(this.length+t.length),this.data.set(t,this.length),this.length+=t.length}slice(t,r){return this.data.slice(t,Math.min(r,this.length))}subArray(t,r){return this.data.subarray(t,Math.min(r,this.length))}ensureLength(t){for(;this.data.length<t;){const r=new Float32Array(this.data.length*2);r.set(this.data,0),this.data=r}}}function _k(n,t){n.DataArray=oa}typeof p5<"u"&&_k(p5,p5.prototype);class Hr{constructor(t,r,i,s){this.renderer=s,this.vertices=[],this.boundingBoxCache=null,this.lineVertices=new oa,this.lineTangentsIn=new oa,this.lineTangentsOut=new oa,this.lineSides=new oa,this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.vertexStrokeColors=[],this.userVertexProperties={},this.lineVertexColors=new oa,this.detailX=t!==void 0?t:1,this.detailY=r!==void 0?r:1,this.dirtyFlags={},this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,this.gid=`_p5_Geometry_${Hr.nextId}`,Hr.nextId++,i instanceof Function&&i.call(this)}calculateBoundingBox(){if(this.boundingBoxCache)return this.boundingBoxCache;let t=new de(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new de(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);for(let o=0;o<this.vertices.length;o++){let a=this.vertices[o];t.x=Math.min(t.x,a.x),t.y=Math.min(t.y,a.y),t.z=Math.min(t.z,a.z),r.x=Math.max(r.x,a.x),r.y=Math.max(r.y,a.y),r.z=Math.max(r.z,a.z)}let i=new de(r.x-t.x,r.y-t.y,r.z-t.z),s=new de((t.x+r.x)/2,(t.y+r.y)/2,(t.z+r.z)/2);return this.boundingBoxCache={min:t,max:r,size:i,offset:s},this.boundingBoxCache}reset(){this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear(),this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexStrokeColors.length=0,this.lineVertexColors.clear(),this.vertexNormals.length=0,this.uvs.length=0;for(const t in this.userVertexProperties)this.userVertexProperties[t].delete();this.userVertexProperties={},this.dirtyFlags={}}hasFillTransparency(){if(this._hasFillTransparency===void 0){this._hasFillTransparency=!1;for(let t=0;t<this.vertexColors.length;t+=4)if(this.vertexColors[t+3]<1){this._hasFillTransparency=!0;break}}return this._hasFillTransparency}hasStrokeTransparency(){if(this._hasStrokeTransparency===void 0){this._hasStrokeTransparency=!1;for(let t=0;t<this.lineVertexColors.length;t+=4)if(this.lineVertexColors[t+3]<1){this._hasStrokeTransparency=!0;break}}return this._hasStrokeTransparency}clearColors(){return this.vertexColors=[],this}saveObj(t="model.obj"){let r="";if(this.vertices.forEach(s=>{r+=`v ${s.x} ${s.y} ${s.z}
`}),this.uvs&&this.uvs.length>0)for(let s=0;s<this.uvs.length;s+=2)r+=`vt ${this.uvs[s]} ${this.uvs[s+1]}
`;this.vertexNormals&&this.vertexNormals.length>0&&this.vertexNormals.forEach(s=>{r+=`vn ${s.x} ${s.y} ${s.z}
`}),this.faces.forEach(s=>{let o="f";s.forEach(a=>{o+=" ",o+=a+1,(this.vertexNormals.length>0||this.uvs.length>0)&&(o+="/",this.uvs.length>0&&(o+=a+1),o+="/",this.vertexNormals.length>0&&(o+=a+1))}),r+=o+`
`});const i=new Blob([r],{type:"text/plain"});fn.downloadFile(i,t,"obj")}saveStl(t="model.stl",{binary:r=!1}={}){let i,s=t.substring(0,t.lastIndexOf(".")),o=[];for(let u of this.faces){const l=de.sub(this.vertices[u[1]],this.vertices[u[0]]),c=de.sub(this.vertices[u[2]],this.vertices[u[0]]),h=l.y*c.z-l.z*c.y,f=l.z*c.x-l.x*c.z,d=l.x*c.y-l.y*c.x;o.push(new de(h,f,d).normalize())}if(r){let u=80;const l=this.faces.length*2+this.faces.length*3*4*4+80+4,c=new ArrayBuffer(l);i=new DataView(c),i.setUint32(u,this.faces.length,!0),u+=4;for(const[h,f]of Object.entries(this.faces)){const d=o[h];i.setFloat32(u,d.x,!0),u+=4,i.setFloat32(u,d.y,!0),u+=4,i.setFloat32(u,d.z,!0),u+=4;for(let p of f){const g=this.vertices[p];i.setFloat32(u,g.x,!0),u+=4,i.setFloat32(u,g.y,!0),u+=4,i.setFloat32(u,g.z,!0),u+=4}i.setUint16(u,0,!0),u+=2}}else{i="solid "+s+`
`;for(const[u,l]of Object.entries(this.faces)){const c=o[u];i+=" facet norm "+c.x+" "+c.y+" "+c.z+`
`,i+=`  outer loop
`;for(let h of l){const f=this.vertices[h];i+="   vertex "+f.x+" "+f.y+" "+f.z+`
`}i+=`  endloop
`,i+=` endfacet
`}i+="endsolid "+s+`
`}const a=new Blob([i],{type:"text/plain"});fn.downloadFile(a,t,"stl")}flipU(){this.uvs=this.uvs.flat().map((t,r)=>r%2===0?1-t:t)}flipV(){this.uvs=this.uvs.flat().map((t,r)=>r%2===0?t:1-t)}computeFaces(){this.faces.length=0;const t=this.detailX+1;let r,i,s,o;for(let a=0;a<this.detailY;a++)for(let u=0;u<this.detailX;u++)r=a*t+u,i=a*t+u+1,s=(a+1)*t+u+1,o=(a+1)*t+u,this.faces.push([r,i,o]),this.faces.push([o,i,s]);return this}_getFaceNormal(t){const r=this.faces[t],i=this.vertices[r[0]],s=this.vertices[r[1]],o=this.vertices[r[2]],a=de.sub(s,i),u=de.sub(o,i),l=de.cross(a,u),c=de.mag(l);let h=c/(de.mag(a)*de.mag(u));return h===0||isNaN(h)?(console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex"),l):(h>1&&(h=1),l.mult(Math.asin(h)/c))}computeNormals(t=o5,{roundToPrecision:r=3}={}){const i=this.vertexNormals;let s=this.vertices;const o=this.faces;let a;if(t===a5){const u={},l=[],c=Math.pow(10,r),h=d=>Math.round(d*c)/c,f=d=>`${h(d.x)},${h(d.y)},${h(d.z)}`;for(let d=0;d<s.length;d++){const p=s[d],g=f(p);u[g]===void 0&&(u[g]=l.length,l.push(p))}o.forEach(d=>{for(let p=0;p<3;++p){const g=d[p],y=s[g],v=f(y);d[p]=u[v]}}),this.edges.forEach(d=>{for(let p=0;p<2;++p){const g=d[p],y=s[g],v=f(y);d[p]=u[v]}}),this.vertices=s=l}for(i.length=0,a=0;a<s.length;++a)i.push(new de);for(o.forEach((u,l)=>{const c=this._getFaceNormal(l);for(let h=0;h<3;++h){const f=u[h];i[f].add(c)}}),a=0;a<s.length;++a)i[a].normalize();return this}averageNormals(){for(let t=0;t<=this.detailY;t++){const r=this.detailX+1;let i=de.add(this.vertexNormals[t*r],this.vertexNormals[t*r+this.detailX]);i=de.div(i,2),this.vertexNormals[t*r]=i,this.vertexNormals[t*r+this.detailX]=i}return this}averagePoleNormals(){let t=new de(0,0,0);for(let r=0;r<this.detailX;r++)t.add(this.vertexNormals[r]);t=de.div(t,this.detailX);for(let r=0;r<this.detailX;r++)this.vertexNormals[r]=t;t=new de(0,0,0);for(let r=this.vertices.length-1;r>this.vertices.length-1-this.detailX;r--)t.add(this.vertexNormals[r]);t=de.div(t,this.detailX);for(let r=this.vertices.length-1;r>this.vertices.length-1-this.detailX;r--)this.vertexNormals[r]=t;return this}_makeTriangleEdges(){this.edges.length=0;for(let t=0;t<this.faces.length;t++)this.edges.push([this.faces[t][0],this.faces[t][1]]),this.edges.push([this.faces[t][1],this.faces[t][2]]),this.edges.push([this.faces[t][2],this.faces[t][0]]);return this}makeEdgesFromFaces(){this._makeTriangleEdges()}_edgesToVertices(){var s;this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear();const t=new Map,r=new Set;let i;for(let o=0;o<this.edges.length;o++){const a=this.edges[o-1],u=this.edges[o],l=this.vertices[u[0]],c=this.vertices[u[1]],h=this.vertexStrokeColors.length>0&&a?this.vertexStrokeColors.slice(a[1]*4,(a[1]+1)*4):[0,0,0,0],f=this.vertexStrokeColors.length>0?this.vertexStrokeColors.slice(u[0]*4,(u[0]+1)*4):[0,0,0,0],d=this.vertexStrokeColors.length>0?this.vertexStrokeColors.slice(u[1]*4,(u[1]+1)*4):[0,0,0,0],p=c.copy().sub(l).normalize(),g=p.magSq()>0;if(g&&this._addSegment(l,c,f,d,p),!((s=this.renderer)!=null&&s._simpleLines)){if(o>0&&a[1]===u[0])r.has(u[0])||(r.add(u[0]),t.delete(u[0]),i&&g&&p.dot(i)<1-1e-8&&this._addJoin(l,i,p,f));else{if(g&&!r.has(u[0])){const y=t.get(u[0]);y?(this._addJoin(l,y.dir,p,f),t.delete(u[0]),r.add(u[0])):t.set(u[0],{point:l,dir:p.copy().mult(-1),color:f})}if(i&&!r.has(a[1])){const y=t.get(a[1]);y?(this._addJoin(this.vertices[a[1]],i,y.dir.copy().mult(-1),h),t.delete(a[1]),r.add(a[1])):t.set(a[1],{point:this.vertices[a[1]],dir:i,color:h}),i=void 0}}if(o===this.edges.length-1&&!r.has(u[1])){const y=t.get(u[1]);y?(this._addJoin(c,p,y.dir.copy().mult(-1),d),t.delete(u[1]),r.add(u[1])):t.set(u[1],{point:c,dir:p,color:d})}g&&(i=p)}}for(const{point:o,dir:a,color:u}of t.values())this._addCap(o,a,u);return this}_addSegment(t,r,i,s,o){var c;const a=t.array(),u=r.array(),l=o.array();this.lineSides.push(1,1,-1,1,-1,-1);for(const h of[this.lineTangentsIn,this.lineTangentsOut])for(let f=0;f<6;f++)h.push(...l);return this.lineVertices.push(...a,...u,...a,...u,...u,...a),(c=this.renderer)!=null&&c._simpleLines||this.lineVertexColors.push(...i,...s,...i,...s,...s,...i),this}_addCap(t,r,i){const s=t.array(),o=r.array(),a=[0,0,0];for(let u=0;u<6;u++)this.lineVertices.push(...s),this.lineTangentsIn.push(...o),this.lineTangentsOut.push(...a),this.lineVertexColors.push(...i);return this.lineSides.push(-1,2,-2,1,2,-1),this}_addJoin(t,r,i,s){const o=t.array(),a=r.array(),u=i.array();for(let l=0;l<12;l++)this.lineVertices.push(...o),this.lineTangentsIn.push(...a),this.lineTangentsOut.push(...u),this.lineVertexColors.push(...s);return this.lineSides.push(-1,-3,-2,-1,0,-3),this.lineSides.push(3,1,2,3,0,1),this}normalize(){if(this.vertices.length>0){const t=this.vertices[0].copy(),r=this.vertices[0].copy();for(let u=0;u<this.vertices.length;u++)t.x=Math.max(t.x,this.vertices[u].x),r.x=Math.min(r.x,this.vertices[u].x),t.y=Math.max(t.y,this.vertices[u].y),r.y=Math.min(r.y,this.vertices[u].y),t.z=Math.max(t.z,this.vertices[u].z),r.z=Math.min(r.z,this.vertices[u].z);const i=de.lerp(t,r,.5),s=de.sub(t,r),a=200/Math.max(Math.max(s.x,s.y),s.z);for(let u=0;u<this.vertices.length;u++)this.vertices[u].sub(i),this.vertices[u].mult(a)}return this}vertexProperty(t,r,i){let s;this.userVertexProperties[t]||(s=this.userVertexProperties[t]=this._userVertexPropertyHelper(t,r,i)),s=this.userVertexProperties[t],i?s.pushDirect(r):(s.setCurrentData(r),s.pushCurrentData())}_userVertexPropertyHelper(t,r,i){const s=this,o=this.userVertexProperties[t]={name:t,dataSize:i||(r.length?r.length:1),geometry:s,getName(){return this.name},getCurrentData(){return this.currentData===void 0&&(this.currentData=new Array(this.getDataSize()).fill(0)),this.currentData},getDataSize(){return this.dataSize},getSrcName(){return this.name.concat("Src")},getDstName(){return this.name.concat("Buffer")},getSrcArray(){const a=this.getSrcName();return this.geometry[a]},setCurrentData(a){a.length&&a.length,this.currentData=a},pushCurrentData(){const a=this.getCurrentData();this.pushDirect(a)},pushDirect(a){a.length?this.getSrcArray().push(...a):this.getSrcArray().push(a)},resetSrcArray(){this.geometry[this.getSrcName()]=[]},delete(){const a=this.getSrcName();delete this.geometry[a],delete this}};return this[o.getSrcName()]=[],this.userVertexProperties[t]}}Hr.nextId=0;function bk(n,t){n.Geometry=Hr}typeof p5<"u"&&bk(p5,p5.prototype);class wh{constructor(t){this.renderer=t,t._pInst.push(),this.identityMatrix=new wr(4),t.states.setValue("uModelMatrix",new wr(4)),this.geometry=new Hr(void 0,void 0,void 0,this.renderer),this.geometry.gid=`_p5_GeometryBuilder_${wh.nextGeometryId}`,wh.nextGeometryId++,this.hasTransform=!1}transformVertices(t){return this.hasTransform?t.map(r=>this.renderer.states.uModelMatrix.multiplyPoint(r)):t}transformNormals(t){return this.hasTransform?t.map(r=>this.renderer.scratchMat3.multiplyVec(r)):t}addGeometry(t){this.hasTransform=!this.renderer.states.uModelMatrix.mat4.every((u,l)=>u===this.identityMatrix.mat4[l]),this.hasTransform&&this.renderer.scratchMat3.inverseTranspose4x4(this.renderer.states.uModelMatrix);let r=this.geometry.vertices.length;this.geometry.vertices.push(...this.transformVertices(t.vertices)),this.geometry.vertexNormals.push(...this.transformNormals(t.vertexNormals)),this.geometry.uvs.push(...t.uvs);const i=t.userVertexProperties,s=this.geometry.userVertexProperties,o=this.geometry.vertices.length-t.vertices.length;for(const u in s){if(u in i)continue;const l=s[u],h=l.getDataSize()*t.vertices.length,f=Array(h).fill(0);l.pushDirect(f)}for(const u in i){const l=i[u],c=l.getSrcArray(),h=l.getDataSize();if(o>0&&!(u in s)){const f=h*o,d=Array(f).fill(0);this.geometry.vertexProperty(u,d,h)}this.geometry.vertexProperty(u,c,h)}this.renderer.states.fillColor&&this.geometry.faces.push(...t.faces.map(u=>u.map(l=>l+r))),this.renderer.states.strokeColor&&this.geometry.edges.push(...t.edges.map(u=>u.map(l=>l+r)));const a=[...t.vertexColors];for(;a.length<t.vertices.length*4;)a.push(...this.renderer.states.curFillColor);this.geometry.vertexColors.push(...a)}addImmediate(t,r){const i=[];if(this.renderer.states.fillColor)if(r===fh||r===dh)for(let s=2;s<t.vertices.length;s++)s%2===0?i.push([s,s-1,s-2]):i.push([s,s-2,s-1]);else if(r===Fg)for(let s=2;s<t.vertices.length;s++)i.push([0,s-1,s]);else for(let s=0;s<t.vertices.length;s+=3)i.push([s,s+1,s+2]);this.addGeometry(Object.assign({},t,{faces:i}))}addRetained(t){this.addGeometry(t)}finish(){return this.renderer._pInst.pop(),this.geometry}}wh.nextGeometryId=0;class Bu{constructor(t,r,i,s){this.w=t,this.vec=new de(r,i,s)}static fromAxisAngle(t,r,i,s){const o=Math.cos(t/2),a=new de(r,i,s).normalize().mult(Math.sin(t/2));return new Bu(o,a.x,a.y,a.z)}conjugate(){return new Bu(this.w,-this.vec.x,-this.vec.y,-this.vec.z)}multiply(t){return new Bu(this.w*t.w-this.vec.x*t.vec.x-this.vec.y*t.vec.y-this.vec.z-t.vec.z,this.w*t.vec.x+this.vec.x*t.w+this.vec.y*t.vec.z-this.vec.z*t.vec.y,this.w*t.vec.y-this.vec.x*t.vec.z+this.vec.y*t.w+this.vec.z*t.vec.x,this.w*t.vec.z+this.vec.x*t.vec.y-this.vec.y*t.vec.x+this.vec.z*t.w)}rotateVector(t){return de.mult(t,this.w*this.w-this.vec.dot(this.vec)).add(de.mult(this.vec,2*t.dot(this.vec))).add(de.mult(this.vec,2*this.w).cross(t)).clampToZero()}rotateBy(t){return t.multiply(this).multiply(t.conjugate()).vec.clampToZero()}}function xk(n,t){n.Quat=Bu}typeof p5<"u"&&xk(p5,p5.prototype);class hn{constructor(t,r,i,s,o,a){this.size=t,this.src=r,this.dst=i,this.attr=s,this._renderer=o,this.map=a}_prepareBuffer(t,r){const i=r.attributes,s=this._renderer.GL,o=this._renderer._getOrMakeCachedBuffers(t),a=i[this.attr];if(!a)return;let u=o[this.dst];const l=t[this.src];if(l&&l.length>0){const c=!u;if(c&&(o[this.dst]=u=s.createBuffer()),s.bindBuffer(s.ARRAY_BUFFER,u),c||t.dirtyFlags[this.src]!==!1){const h=this.map,f=h?h(l):l;this._renderer._bindBuffer(u,s.ARRAY_BUFFER,f),t.dirtyFlags[this.src]=!1}r.enableAttrib(a,this.size)}else{const c=a.location;if(c===-1||!this._renderer.registerEnabled.has(c))return;s.disableVertexAttribArray(c),this._renderer.registerEnabled.delete(c)}}}function wk(n,t){n.RenderBuffer=hn}typeof p5<"u"&&wk(p5,p5.prototype);var wd={exports:{}},cS=wd.exports,hS;function KG(){return hS||(hS=1,function(n){var t;function r(P,U){return P.b===U.b&&P.a===U.a}function i(P,U){return P.b<U.b||P.b===U.b&&P.a<=U.a}function s(P,U,H){var Z=U.b-P.b,se=H.b-U.b;return 0<Z+se?Z<se?U.a-P.a+Z/(Z+se)*(P.a-H.a):U.a-H.a+se/(Z+se)*(H.a-P.a):0}function o(P,U,H){var Z=U.b-P.b,se=H.b-U.b;return 0<Z+se?(U.a-H.a)*Z+(U.a-P.a)*se:0}function a(P,U){return P.a<U.a||P.a===U.a&&P.b<=U.b}function u(P,U,H){var Z=U.a-P.a,se=H.a-U.a;return 0<Z+se?Z<se?U.b-P.b+Z/(Z+se)*(P.b-H.b):U.b-H.b+se/(Z+se)*(H.b-P.b):0}function l(P,U,H){var Z=U.a-P.a,se=H.a-U.a;return 0<Z+se?(U.b-H.b)*Z+(U.b-P.b)*se:0}function c(P){return i(P.b.a,P.a)}function h(P){return i(P.a,P.b.a)}function f(P,U,H,Z){return P=0>P?0:P,H=0>H?0:H,P<=H?H===0?(U+Z)/2:U+P/(P+H)*(Z-U):Z+H/(P+H)*(U-Z)}function d(P){var U=T(P.b);return C(U,P.c),C(U.b,P.c),E(U,P.a),U}function p(P,U){var H=!1,Z=!1;P!==U&&(U.a!==P.a&&(Z=!0,R(U.a,P.a)),U.d!==P.d&&(H=!0,w(U.d,P.d)),_(U,P),Z||(C(U,P.a),P.a.c=P),H||(E(U,P.d),P.d.a=P))}function g(P){var U=P.b,H=!1;P.d!==P.b.d&&(H=!0,w(P.d,P.b.d)),P.c===P?R(P.a,null):(P.b.d.a=z(P),P.a.c=P.c,_(P,z(P)),H||E(P,P.d)),U.c===U?(R(U.a,null),w(U.d,null)):(P.d.a=z(U),U.a.c=U.c,_(U,z(U))),S(P)}function y(P){var U=T(P),H=U.b;return _(U,P.e),U.a=P.b.a,C(H,U.a),U.d=H.d=P.d,U=U.b,_(P.b,z(P.b)),_(P.b,U),P.b.a=U.a,U.b.a.c=U.b,U.b.d=P.b.d,U.f=P.f,U.b.f=P.b.f,U}function v(P,U){var H=!1,Z=T(P),se=Z.b;return U.d!==P.d&&(H=!0,w(U.d,P.d)),_(Z,P.e),_(se,U),Z.a=P.b.a,se.a=U.a,Z.d=se.d=P.d,P.d.a=se,H||E(Z,P.d),Z}function T(P){var U=new L,H=new L,Z=P.b.h;return H.h=Z,Z.b.h=U,U.h=P,P.b.h=H,U.b=H,U.c=U,U.e=H,H.b=U,H.c=H,H.e=U}function _(P,U){var H=P.c,Z=U.c;H.b.e=U,Z.b.e=P,P.c=Z,U.c=H}function C(P,U){var H=U.f,Z=new re(U,H);H.e=Z,U.f=Z,H=Z.c=P;do H.a=Z,H=H.c;while(H!==P)}function E(P,U){var H=U.d,Z=new V(U,H);H.b=Z,U.d=Z,Z.a=P,Z.c=U.c,H=P;do H.d=Z,H=H.e;while(H!==P)}function S(P){var U=P.h;P=P.b.h,U.b.h=P,P.b.h=U}function R(P,U){var H=P.c,Z=H;do Z.a=U,Z=Z.c;while(Z!==H);H=P.f,Z=P.e,Z.f=H,H.e=Z}function w(P,U){var H=P.a,Z=H;do Z.d=U,Z=Z.e;while(Z!==H);H=P.d,Z=P.b,Z.d=H,H.b=Z}function x(P){var U=0;return Math.abs(P[1])>Math.abs(P[0])&&(U=1),Math.abs(P[2])>Math.abs(P[U])&&(U=2),U}var b=4*1e150;function A(P,U){P.f+=U.f,P.b.f+=U.b.f}function k(P,U,H){return P=P.a,U=U.a,H=H.a,U.b.a===P?H.b.a===P?i(U.a,H.a)?0>=o(H.b.a,U.a,H.a):0<=o(U.b.a,H.a,U.a):0>=o(H.b.a,P,H.a):H.b.a===P?0<=o(U.b.a,P,U.a):(U=s(U.b.a,P,U.a),P=s(H.b.a,P,H.a),U>=P)}function N(P){P.a.i=null;var U=P.e;U.a.c=U.c,U.c.a=U.a,P.e=null}function I(P,U){g(P.a),P.c=!1,P.a=U,U.i=P}function j(P){var U=P.a.a;do P=Xt(P);while(P.a.a===U);return P.c&&(U=v(lt(P).a.b,P.a.e),I(P,U),P=Xt(P)),P}function Q(P,U,H){var Z=new Lt;return Z.a=H,Z.e=ce(P.f,U.e,Z),H.i=Z}function le(P,U){switch(P.s){case 100130:return(U&1)!==0;case 100131:return U!==0;case 100132:return 0<U;case 100133:return 0>U;case 100134:return 2<=U||-2>=U}return!1}function fe(P){var U=P.a,H=U.d;H.c=P.d,H.a=U,N(P)}function ne(P,U,H){for(P=U,U=U.a;P!==H;){P.c=!1;var Z=lt(P),se=Z.a;if(se.a!==U.a){if(!Z.c){fe(P);break}se=v(U.c.b,se.b),I(Z,se)}U.c!==se&&(p(z(se),se),p(U,se)),fe(P),U=Z.a,P=Z}return U}function oe(P,U,H,Z,se,Ie){var Ne=!0;do Q(P,U,H.b),H=H.c;while(H!==Z);for(se===null&&(se=lt(U).a.b.c);Z=lt(U),H=Z.a.b,H.a===se.a;)H.c!==se&&(p(z(H),H),p(z(se),H)),Z.f=U.f-H.f,Z.d=le(P,Z.f),U.b=!0,!Ne&&ve(P,U)&&(A(H,se),N(U),g(se)),Ne=!1,U=Z,se=H;U.b=!0,Ie&&we(P,U)}function ie(P,U,H,Z,se){var Ie=[U.g[0],U.g[1],U.g[2]];U.d=null,U.d=P.o&&P.o(Ie,H,Z,P.c)||null,U.d===null&&(se?P.n||(X(P,100156),P.n=!0):U.d=H[0])}function ue(P,U,H){var Z=[null,null,null,null];Z[0]=U.a.d,Z[1]=H.a.d,ie(P,U.a,Z,[.5,.5,0,0],!1),p(U,H)}function ee(P,U,H,Z,se){var Ie=Math.abs(U.b-P.b)+Math.abs(U.a-P.a),Ne=Math.abs(H.b-P.b)+Math.abs(H.a-P.a),He=se+1;Z[se]=.5*Ne/(Ie+Ne),Z[He]=.5*Ie/(Ie+Ne),P.g[0]+=Z[se]*U.g[0]+Z[He]*H.g[0],P.g[1]+=Z[se]*U.g[1]+Z[He]*H.g[1],P.g[2]+=Z[se]*U.g[2]+Z[He]*H.g[2]}function ve(P,U){var H=lt(U),Z=U.a,se=H.a;if(i(Z.a,se.a)){if(0<o(se.b.a,Z.a,se.a))return!1;if(!r(Z.a,se.a))y(se.b),p(Z,z(se)),U.b=H.b=!0;else if(Z.a!==se.a){var H=P.e,Ie=Z.a.h;if(0<=Ie){var H=H.b,Ne=H.d,He=H.e,Ze=H.c,ct=Ze[Ie];Ne[ct]=Ne[H.a],Ze[Ne[ct]]=ct,ct<=--H.a&&(1>=ct||i(He[Ne[ct>>1]],He[Ne[ct]])?Qe(H,ct):kt(H,ct)),He[Ie]=null,Ze[Ie]=H.b,H.b=Ie}else for(H.c[-(Ie+1)]=null;0<H.a&&H.c[H.d[H.a-1]]===null;)--H.a;ue(P,z(se),Z)}}else{if(0>o(Z.b.a,se.a,Z.a))return!1;Xt(U).b=U.b=!0,y(Z.b),p(z(se),Z)}return!0}function ge(P,U){var H=lt(U),Z=U.a,se=H.a,Ie=Z.a,Ne=se.a,He=Z.b.a,Ze=se.b.a,ct=new re;if(o(He,P.a,Ie),o(Ze,P.a,Ne),Ie===Ne||Math.min(Ie.a,He.a)>Math.max(Ne.a,Ze.a))return!1;if(i(Ie,Ne)){if(0<o(Ze,Ie,Ne))return!1}else if(0>o(He,Ne,Ie))return!1;var Gt=He,D=Ie,$=Ze,O=Ne,B,Y;if(i(Gt,D)||(B=Gt,Gt=D,D=B),i($,O)||(B=$,$=O,O=B),i(Gt,$)||(B=Gt,Gt=$,$=B,B=D,D=O,O=B),i($,D)?i(D,O)?(B=s(Gt,$,D),Y=s($,D,O),0>B+Y&&(B=-B,Y=-Y),ct.b=f(B,$.b,Y,D.b)):(B=o(Gt,$,D),Y=-o(Gt,O,D),0>B+Y&&(B=-B,Y=-Y),ct.b=f(B,$.b,Y,O.b)):ct.b=($.b+D.b)/2,a(Gt,D)||(B=Gt,Gt=D,D=B),a($,O)||(B=$,$=O,O=B),a(Gt,$)||(B=Gt,Gt=$,$=B,B=D,D=O,O=B),a($,D)?a(D,O)?(B=u(Gt,$,D),Y=u($,D,O),0>B+Y&&(B=-B,Y=-Y),ct.a=f(B,$.a,Y,D.a)):(B=l(Gt,$,D),Y=-l(Gt,O,D),0>B+Y&&(B=-B,Y=-Y),ct.a=f(B,$.a,Y,O.a)):ct.a=($.a+D.a)/2,i(ct,P.a)&&(ct.b=P.a.b,ct.a=P.a.a),Gt=i(Ie,Ne)?Ie:Ne,i(Gt,ct)&&(ct.b=Gt.b,ct.a=Gt.a),r(ct,Ie)||r(ct,Ne))return ve(P,U),!1;if(!r(He,P.a)&&0<=o(He,P.a,ct)||!r(Ze,P.a)&&0>=o(Ze,P.a,ct)){if(Ze===P.a)return y(Z.b),p(se.b,Z),U=j(U),Z=lt(U).a,ne(P,lt(U),H),oe(P,U,z(Z),Z,Z,!0),!0;if(He===P.a){y(se.b),p(Z.e,z(se)),Ie=H=U,Ne=Ie.a.b.a;do Ie=Xt(Ie);while(Ie.a.b.a===Ne);return U=Ie,Ie=lt(U).a.b.c,H.a=z(se),se=ne(P,H,null),oe(P,U,se.c,Z.b.c,Ie,!0),!0}return 0<=o(He,P.a,ct)&&(Xt(U).b=U.b=!0,y(Z.b),Z.a.b=P.a.b,Z.a.a=P.a.a),0>=o(Ze,P.a,ct)&&(U.b=H.b=!0,y(se.b),se.a.b=P.a.b,se.a.a=P.a.a),!1}return y(Z.b),y(se.b),p(z(se),Z),Z.a.b=ct.b,Z.a.a=ct.a,Z.a.h=Ee(P.e,Z.a),Z=Z.a,se=[0,0,0,0],ct=[Ie.d,He.d,Ne.d,Ze.d],Z.g[0]=Z.g[1]=Z.g[2]=0,ee(Z,Ie,He,se,0),ee(Z,Ne,Ze,se,2),ie(P,Z,ct,se,!0),Xt(U).b=U.b=H.b=!0,!1}function we(P,U){for(var H=lt(U);;){for(;H.b;)U=H,H=lt(H);if(!U.b&&(H=U,U=Xt(U),U===null||!U.b))break;U.b=!1;var Z=U.a,se=H.a,Ie;if(Ie=Z.b.a!==se.b.a)e:{Ie=U;var Ne=lt(Ie),He=Ie.a,Ze=Ne.a,ct=void 0;if(i(He.b.a,Ze.b.a)){if(0>o(He.b.a,Ze.b.a,He.a)){Ie=!1;break e}Xt(Ie).b=Ie.b=!0,ct=y(He),p(Ze.b,ct),ct.d.c=Ie.d}else{if(0<o(Ze.b.a,He.b.a,Ze.a)){Ie=!1;break e}Ie.b=Ne.b=!0,ct=y(Ze),p(He.e,Ze.b),ct.b.d.c=Ie.d}Ie=!0}if(Ie&&(H.c?(N(H),g(se),H=lt(U),se=H.a):U.c&&(N(U),g(Z),U=Xt(H),Z=U.a)),Z.a!==se.a){if(Z.b.a===se.b.a||U.c||H.c||Z.b.a!==P.a&&se.b.a!==P.a)ve(P,U);else if(ge(P,U))break}Z.a===se.a&&Z.b.a===se.b.a&&(A(se,Z),N(U),g(Z),U=Xt(H))}}function Se(P,U){P.a=U;for(var H=U.c;H.i===null;)if(H=H.c,H===U.c){var H=P,Z=U,Ne=new Lt;Ne.a=Z.c.b;var se=H.f,He=se.a;do He=He.a;while(He.b!==null&&!se.c(se.b,Ne,He.b));var se=He.b,Ie=lt(se),Ne=se.a,He=Ie.a;if(o(Ne.b.a,Z,Ne.a)===0)Ne=se.a,r(Ne.a,Z)||r(Ne.b.a,Z)||(y(Ne.b),se.c&&(g(Ne.c),se.c=!1),p(Z.c,Ne),Se(H,Z));else{var Ze=i(He.b.a,Ne.b.a)?se:Ie,Ie=void 0;se.d||Ze.c?(Ze===se?Ie=v(Z.c.b,Ne.e):Ie=v(He.b.c.b,Z.c).b,Ze.c?I(Ze,Ie):(Ne=H,se=Q(H,se,Ie),se.f=Xt(se).f+se.a.f,se.d=le(Ne,se.f)),Se(H,Z)):oe(H,se,Z.c,Z.c,null,!0)}return}if(H=j(H.i),Ne=lt(H),se=Ne.a,Ne=ne(P,Ne,null),Ne.c===se){var se=Ne,Ne=se.c,He=lt(H),Ie=H.a,Ze=He.a,ct=!1;Ie.b.a!==Ze.b.a&&ge(P,H),r(Ie.a,P.a)&&(p(z(Ne),Ie),H=j(H),Ne=lt(H).a,ne(P,lt(H),He),ct=!0),r(Ze.a,P.a)&&(p(se,z(Ze)),se=ne(P,He,null),ct=!0),ct?oe(P,H,se.c,Ne,Ne,!0):(i(Ze.a,Ie.a)?Z=z(Ze):Z=Ie,Z=v(se.c.b,Z),oe(P,H,Z,Z.c,Z.c,!1),Z.b.i.c=!0,we(P,H))}else oe(P,H,Ne.c,se,se,!0)}function ae(P,U){var H=new Lt,Z=d(P.b);Z.a.b=b,Z.a.a=U,Z.b.a.b=-b,Z.b.a.a=U,P.a=Z.b.a,H.a=Z,H.f=0,H.d=!1,H.c=!1,H.h=!0,H.b=!1,Z=P.f,Z=ce(Z,Z.a,H),H.e=Z}function xe(P){this.a=new he,this.b=P,this.c=k}function ce(P,U,H){do U=U.c;while(U.b!==null&&!P.c(P.b,U.b,H));return P=new he(H,U.a,U),U.a.c=P,U.a=P}function he(P,U,H){this.b=P||null,this.a=U||this,this.c=H||this}function ye(){this.d=G,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var G=0;t=ye.prototype,t.x=function(){W(this,G)},t.B=function(P,U){switch(P){case 100142:return;case 100140:switch(U){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=U;return}break;case 100141:this.m=!!U;return;default:X(this,100900);return}X(this,100901)},t.y=function(P){switch(P){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:X(this,100900)}return!1},t.A=function(P,U,H){this.j[0]=P,this.j[1]=U,this.j[2]=H},t.z=function(P,U){var H=U||null;switch(P){case 100100:case 100106:this.h=H;break;case 100104:case 100110:this.l=H;break;case 100101:case 100107:this.k=H;break;case 100102:case 100108:this.i=H;break;case 100103:case 100109:this.p=H;break;case 100105:case 100111:this.o=H;break;case 100112:this.r=H;break;default:X(this,100900)}},t.C=function(P,U){var H=!1,Z=[0,0,0];W(this,2);for(var se=0;3>se;++se){var Ie=P[se];-1e150>Ie&&(Ie=-1e150,H=!0),1e150<Ie&&(Ie=1e150,H=!0),Z[se]=Ie}H&&X(this,100155),H=this.q,H===null?(H=d(this.b),p(H,H.b)):(y(H),H=H.e),H.a.d=U,H.a.g[0]=Z[0],H.a.g[1]=Z[1],H.a.g[2]=Z[2],H.f=1,H.b.f=-1,this.q=H},t.u=function(P){W(this,G),this.d=1,this.b=new J,this.c=P},t.t=function(){W(this,1),this.d=2,this.q=null},t.v=function(){W(this,2),this.d=1},t.w=function(){W(this,1),this.d=G;var P=this.j[0],U=this.j[1],H=this.j[2],Z=!1,se=[P,U,H];if(P===0&&U===0&&H===0){for(var U=[-2*1e150,-2*1e150,-2*1e150],Ie=[2*1e150,2*1e150,2*1e150],H=[],Ne=[],Z=this.b.c,P=Z.e;P!==Z;P=P.e)for(var He=0;3>He;++He){var Ze=P.g[He];Ze<Ie[He]&&(Ie[He]=Ze,Ne[He]=P),Ze>U[He]&&(U[He]=Ze,H[He]=P)}if(P=0,U[1]-Ie[1]>U[0]-Ie[0]&&(P=1),U[2]-Ie[2]>U[P]-Ie[P]&&(P=2),Ie[P]>=U[P])se[0]=0,se[1]=0,se[2]=1;else{for(U=0,Ie=Ne[P],H=H[P],Ne=[0,0,0],Ie=[Ie.g[0]-H.g[0],Ie.g[1]-H.g[1],Ie.g[2]-H.g[2]],He=[0,0,0],P=Z.e;P!==Z;P=P.e)He[0]=P.g[0]-H.g[0],He[1]=P.g[1]-H.g[1],He[2]=P.g[2]-H.g[2],Ne[0]=Ie[1]*He[2]-Ie[2]*He[1],Ne[1]=Ie[2]*He[0]-Ie[0]*He[2],Ne[2]=Ie[0]*He[1]-Ie[1]*He[0],Ze=Ne[0]*Ne[0]+Ne[1]*Ne[1]+Ne[2]*Ne[2],Ze>U&&(U=Ze,se[0]=Ne[0],se[1]=Ne[1],se[2]=Ne[2]);0>=U&&(se[0]=se[1]=se[2]=0,se[x(Ie)]=1)}Z=!0}for(Ne=x(se),P=this.b.c,U=(Ne+1)%3,H=(Ne+2)%3,Ne=0<se[Ne]?1:-1,se=P.e;se!==P;se=se.e)se.b=se.g[U],se.a=Ne*se.g[H];if(Z){for(se=0,Z=this.b.a,P=Z.b;P!==Z;P=P.b)if(U=P.a,!(0>=U.f))do se+=(U.a.b-U.b.a.b)*(U.a.a+U.b.a.a),U=U.e;while(U!==P.a);if(0>se)for(se=this.b.c,Z=se.e;Z!==se;Z=Z.e)Z.a=-Z.a}for(this.n=!1,se=this.b.b,P=se.h;P!==se;P=Z)Z=P.h,U=P.e,r(P.a,P.b.a)&&P.e.e!==P&&(ue(this,U,P),g(P),P=U,U=P.e),U.e===P&&(U!==P&&((U===Z||U===Z.b)&&(Z=Z.h),g(U)),(P===Z||P===Z.b)&&(Z=Z.h),g(P));for(this.e=se=new te,Z=this.b.c,P=Z.e;P!==Z;P=P.e)P.h=Ee(se,P);for(me(se),this.f=new xe(this),ae(this,-b),ae(this,b);(se=Ce(this.e))!==null;){for(;;){e:if(P=this.e,P.a===0)Z=Me(P.b);else if(Z=P.c[P.d[P.a-1]],P.b.a!==0&&(P=Me(P.b),i(P,Z))){Z=P;break e}if(Z===null||!r(Z,se))break;Z=Ce(this.e),ue(this,se.c,Z.c)}Se(this,se)}for(this.a=this.f.a.a.b.a.a,se=0;(Z=this.f.a.a.b)!==null;)Z.h||++se,N(Z);for(this.f=null,se=this.e,se.b=null,se.d=null,this.e=se.c=null,se=this.b,P=se.a.b;P!==se.a;P=Z)Z=P.b,P=P.a,P.e.e===P&&(A(P.c,P),g(P));if(!this.n){if(se=this.b,this.m)for(P=se.b.h;P!==se.b;P=Z)Z=P.h,P.b.d.c!==P.d.c?P.f=P.d.c?1:-1:g(P);else for(P=se.a.b;P!==se.a;P=Z)if(Z=P.b,P.c){for(P=P.a;i(P.b.a,P.a);P=P.c.b);for(;i(P.a,P.b.a);P=P.e);for(U=P.c.b,H=void 0;P.e!==U;)if(i(P.b.a,U.a)){for(;U.e!==P&&(c(U.e)||0>=o(U.a,U.b.a,U.e.b.a));)H=v(U.e,U),U=H.b;U=U.c.b}else{for(;U.e!==P&&(h(P.c.b)||0<=o(P.b.a,P.a,P.c.b.a));)H=v(P,P.c.b),P=H.b;P=P.e}for(;U.e.e!==P;)H=v(U.e,U),U=H.b}if(this.h||this.i||this.k||this.l)if(this.m){for(se=this.b,Z=se.a.b;Z!==se.a;Z=Z.b)if(Z.c){this.h&&this.h(2,this.c),P=Z.a;do this.k&&this.k(P.a.d,this.c),P=P.e;while(P!==Z.a);this.i&&this.i(this.c)}}else{for(se=this.b,Z=!!this.l,P=!1,U=-1,H=se.a.d;H!==se.a;H=H.d)if(H.c){P||(this.h&&this.h(4,this.c),P=!0),Ne=H.a;do Z&&(Ie=Ne.b.d.c?0:1,U!==Ie&&(U=Ie,this.l&&this.l(!!U,this.c))),this.k&&this.k(Ne.a.d,this.c),Ne=Ne.e;while(Ne!==H.a)}P&&this.i&&this.i(this.c)}if(this.r){for(se=this.b,P=se.a.b;P!==se.a;P=Z)if(Z=P.b,!P.c){U=P.a,H=U.e,Ne=void 0;do Ne=H,H=Ne.e,Ne.d=null,Ne.b.d===null&&(Ne.c===Ne?R(Ne.a,null):(Ne.a.c=Ne.c,_(Ne,z(Ne))),Ie=Ne.b,Ie.c===Ie?R(Ie.a,null):(Ie.a.c=Ie.c,_(Ie,z(Ie))),S(Ne));while(Ne!==U);U=P.d,P=P.b,P.d=U,U.b=P}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function W(P,U){if(P.d!==U)for(;P.d!==U;)if(P.d<U)switch(P.d){case G:X(P,100151),P.u(null);break;case 1:X(P,100152),P.t()}else switch(P.d){case 2:X(P,100154),P.v();break;case 1:X(P,100153),P.w()}}function X(P,U){P.p&&P.p(U,P.c)}function V(P,U){this.b=P||this,this.d=U||this,this.a=null,this.c=!1}function L(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function z(P){return P.b.e}function J(){this.c=new re,this.a=new V,this.b=new L,this.d=new L,this.b.b=this.d,this.d.b=this.b}function re(P,U){this.e=P||this,this.f=U||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function te(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Fe}function me(P){P.d=[];for(var U=0;U<P.a;U++)P.d[U]=U;P.d.sort(function(H){return function(Z,se){return i(H[Z],H[se])?1:-1}}(P.c)),P.e=!0,ze(P.b)}function Ee(P,U){if(P.e){var H=P.b,Z=++H.a;2*Z>H.f&&(H.f*=2,H.c=De(H.c,H.f+1));var se;return H.b===0?se=Z:(se=H.b,H.b=H.c[H.b]),H.e[se]=U,H.c[se]=Z,H.d[Z]=se,H.h&&kt(H,Z),se}return H=P.a++,P.c[H]=U,-(H+1)}function Ce(P){if(P.a===0)return Ue(P.b);var U=P.c[P.d[P.a-1]];if(P.b.a!==0&&i(Me(P.b),U))return Ue(P.b);do--P.a;while(0<P.a&&P.c[P.d[P.a-1]]===null);return U}function Fe(){this.d=De([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function De(P,U){for(var H=Array(U),Z=0;Z<P.length;Z++)H[Z]=P[Z];for(;Z<U;Z++)H[Z]=0;return H}function ze(P){for(var U=P.a;1<=U;--U)Qe(P,U);P.h=!0}function Me(P){return P.e[P.d[1]]}function Ue(P){var U=P.d,H=P.e,Z=P.c,se=U[1],Ie=H[se];return 0<P.a&&(U[1]=U[P.a],Z[U[1]]=1,H[se]=null,Z[se]=P.b,P.b=se,0<--P.a&&Qe(P,1)),Ie}function Qe(P,U){for(var H=P.d,Z=P.e,se=P.c,Ie=U,Ne=H[Ie];;){var He=Ie<<1;He<P.a&&i(Z[H[He+1]],Z[H[He]])&&(He+=1);var Ze=H[He];if(He>P.a||i(Z[Ne],Z[Ze])){H[Ie]=Ne,se[Ne]=Ie;break}H[Ie]=Ze,se[Ze]=Ie,Ie=He}}function kt(P,U){for(var H=P.d,Z=P.e,se=P.c,Ie=U,Ne=H[Ie];;){var He=Ie>>1,Ze=H[He];if(He===0||i(Z[Ze],Z[Ne])){H[Ie]=Ne,se[Ne]=Ie;break}H[Ie]=Ze,se[Ze]=Ie,Ie=He}}function Lt(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function lt(P){return P.e.c.b}function Xt(P){return P.e.a.b}cS.libtess={GluTesselator:ye,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},ye.prototype.gluDeleteTess=ye.prototype.x,ye.prototype.gluTessProperty=ye.prototype.B,ye.prototype.gluGetTessProperty=ye.prototype.y,ye.prototype.gluTessNormal=ye.prototype.A,ye.prototype.gluTessCallback=ye.prototype.z,ye.prototype.gluTessVertex=ye.prototype.C,ye.prototype.gluTessBeginPolygon=ye.prototype.u,ye.prototype.gluTessBeginContour=ye.prototype.t,ye.prototype.gluTessEndContour=ye.prototype.v,ye.prototype.gluTessEndPolygon=ye.prototype.w,n.exports=cS.libtess}(wd)),wd.exports}var YG=KG();const rs=ik(YG),Ek={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2},fS=Object.values(Ek).reduce((n,t)=>n+t);class XG{constructor(t){this.renderer=t,this.shapeMode=vi,this.geometry=new Hr(void 0,void 0,void 0,this.renderer),this.geometry.gid="__IMMEDIATE_MODE_GEOMETRY__",this.contourIndices=[],this._useUserVertexProperties=void 0,this._bezierVertex=[],this._quadraticVertex=[],this._curveVertex=[],this.isProcessingVertices=!1,this._tessy=this._initTessy(),this.tessyVertexSize=fS,this.bufferStrides={...Ek}}constructFromContours(t,r){this._useUserVertexProperties&&this._resetUserVertexProperties(),this.geometry.reset(),this.contourIndices=[],this.shapeMode=t.contours[0].kind;const i=!!this.renderer.states.strokeColor,s={};if(t.userVertexProperties){this._useUserVertexProperties=!0;for(const o in t.userVertexProperties){const a=t.vertexPropertyName(o),u=this.geometry._userVertexPropertyHelper(a,[],t.userVertexProperties[o]);s[o]=u,this.tessyVertexSize+=u.getDataSize(),this.bufferStrides[u.getSrcName()]=u.getDataSize(),this.renderer.buffers.user.push(new hn(u.getDataSize(),u.getSrcName(),u.getDstName(),a,this.renderer))}}else this._useUserVertexProperties=!1;for(const o of r){this.contourIndices.push(this.geometry.vertices.length);for(const a of o){if(this.shapeMode===Pc&&this.geometry.vertices.length%6===3)for(const u in this.bufferStrides){const l=this.bufferStrides[u],c=this.geometry[u];c.push(...c.slice(c.length-3*l,c.length-2*l),...c.slice(c.length-l,c.length))}this.geometry.vertices.push(a.position),this.geometry.vertexNormals.push(a.normal||new de(0,0,0)),this.geometry.uvs.push(a.textureCoordinates.x,a.textureCoordinates.y),this.renderer.states.fillColor?this.geometry.vertexColors.push(...a.fill.array()):this.geometry.vertexColors.push(0,0,0,0),this.renderer.states.strokeColor?this.geometry.vertexStrokeColors.push(...a.stroke.array()):this.geometry.vertexStrokeColors.push(0,0,0,0);for(const u in s){const l=s[u];u in a&&l.setCurrentData(a[u]),l.pushCurrentData()}}}i&&(this.geometry.edges=this._calculateEdges(this.shapeMode,this.geometry.vertices)),i&&!this.renderer.geometryBuilder&&this.geometry._edgesToVertices(),this.shapeMode===vi?(this.isProcessingVertices=!0,this._tesselateShape(),this.isProcessingVertices=!1):this.shapeMode===dh?this.shapeMode=fh:this.shapeMode===Pc&&(this.shapeMode=Nu),this.renderer.states.textureMode===Gg&&this.renderer.states._tex!==null&&this.renderer.states._tex.width>0&&this.renderer.states._tex.height>0&&(this.geometry.uvs=this.geometry.uvs.map((o,a)=>a%2===0?o/this.renderer.states._tex.width:o/this.renderer.states._tex.height))}_resetUserVertexProperties(){const t=this.geometry.userVertexProperties;for(const r in t){const i=t[r];delete this.bufferStrides[r],i.delete()}this._useUserVertexProperties=!1,this.tessyVertexSize=fS,this.geometry.userVertexProperties={}}_calculateEdges(t,r){const i=[];let s=0;const o=this.contourIndices.slice();let a=-1;switch(t){case fh:for(s=0;s<r.length-2;s++)i.push([s,s+1]),i.push([s,s+2]);i.push([s,s+1]);break;case Fg:for(s=1;s<r.length-1;s++)i.push([0,s]),i.push([s,s+1]);i.push([0,r.length-1]);break;case Nu:for(s=0;s<r.length-2;s=s+3)i.push([s,s+1]),i.push([s+1,s+2]),i.push([s+2,s]);break;case cl:for(s=0;s<r.length-1;s=s+2)i.push([s,s+1]);break;case Pc:for(s=0;s<r.length-5;s+=6)i.push([s,s+1]),i.push([s+1,s+2]),i.push([s+2,s+5]),i.push([s+5,s]);break;case dh:for(s=0;s<r.length-2;s+=2)i.push([s,s+1]),i.push([s+1,s+3]),i.push([s,s+2]);i.push([s,s+1]);break;default:for(s=0;s<r.length;s++)s===o[0]?a=o.shift():r[a]&&r[s].equals(r[a])?i.push([s-1,a]):i.push([s-1,s]);break}return i}_tesselateShape(){this.shapeMode=Nu;const t=[];for(let o=0;o<this.geometry.vertices.length;o++){this.contourIndices.length>0&&this.contourIndices[0]===o&&(this.contourIndices.shift(),t.push([])),t[t.length-1].push(this.geometry.vertices[o].x,this.geometry.vertices[o].y,this.geometry.vertices[o].z,this.geometry.uvs[o*2],this.geometry.uvs[o*2+1],this.geometry.vertexColors[o*4],this.geometry.vertexColors[o*4+1],this.geometry.vertexColors[o*4+2],this.geometry.vertexColors[o*4+3],this.geometry.vertexNormals[o].x,this.geometry.vertexNormals[o].y,this.geometry.vertexNormals[o].z);for(const a in this.geometry.userVertexProperties){const u=this.geometry.userVertexProperties[a],l=o*u.getDataSize(),c=l+u.getDataSize(),h=u.getSrcArray().slice(l,c);t[t.length-1].push(...h)}}const r=this._triangulate(t),i=this.geometry.vertices;this.geometry.vertices=[],this.geometry.vertexNormals=[],this.geometry.uvs=[];for(const o in this.geometry.userVertexProperties)this.geometry.userVertexProperties[o].resetSrcArray();const s=[];for(let o=0,a=r.length;o<a;o=o+this.tessyVertexSize){s.push(...r.slice(o+5,o+9)),this.geometry.vertexNormals.push(new de(...r.slice(o+9,o+12)));{let u=12;for(const l in this.geometry.userVertexProperties){const c=this.geometry.userVertexProperties[l],h=c.getDataSize(),f=o+u,d=f+h;c.setCurrentData(r.slice(f,d)),c.pushCurrentData(),u+=h}}this.geometry.vertices.push(new de(...r.slice(o,o+3))),this.geometry.uvs.push(...r.slice(o+3,o+5))}if(this.renderer.geometryBuilder){const o=new Map;this.geometry.edges=this.geometry.edges.map(a=>a.map(u=>{if(!o.has(u)){const l=i[u];let c=this.geometry.vertices.findIndex(h=>l.x===h.x&&l.y===h.y&&l.z===h.z);if(c===-1){let h=1/0,f=0;for(let d=0;d<this.geometry.vertices.length;d++){const p=this.geometry.vertices[d],g=l.x-p.x,y=l.y-p.y,v=l.z-p.z,T=g*g+y*y+v*v;T<h&&(h=T,f=d)}c=f}o.set(u,c)}return o.get(u)}))}this.geometry.vertexColors=s}_initTessy(){function t(u,l){for(const c of u)l.push(c)}function r(u){u!==rs.primitiveType.GL_TRIANGLES&&console.log(`expected TRIANGLES but got type: ${u}`)}function i(u){console.log("error callback"),console.log(`error number: ${u}`)}const s=(u,l,c)=>{const h=new Array(this.tessyVertexSize).fill(0);for(let f=0;f<c.length;f++)for(let d=0;d<h.length;d++)c[f]===0||!l[f]||(h[d]+=l[f][d]*c[f]);return h};function o(u){}const a=new rs.GluTesselator;return a.gluTessCallback(rs.gluEnum.GLU_TESS_VERTEX_DATA,t),a.gluTessCallback(rs.gluEnum.GLU_TESS_BEGIN,r),a.gluTessCallback(rs.gluEnum.GLU_TESS_ERROR,i),a.gluTessCallback(rs.gluEnum.GLU_TESS_COMBINE,s),a.gluTessCallback(rs.gluEnum.GLU_TESS_EDGE_FLAG,o),a.gluTessProperty(rs.gluEnum.GLU_TESS_WINDING_RULE,rs.windingRule.GLU_TESS_WINDING_NONZERO),a}_triangulate(t){const r=t[0]?t[0][2]:void 0;let i=!0;for(const o of t)for(let a=0;a<o.length;a+=this.tessyVertexSize)if(o[a+2]!==r){i=!1;break}i?this._tessy.gluTessNormal(0,0,1):this._tessy.gluTessNormal(0,0,0);const s=[];this._tessy.gluTessBeginPolygon(s);for(const o of t){this._tessy.gluTessBeginContour();for(let a=0;a<o.length;a+=this.tessyVertexSize){const u=o.slice(a,a+this.tessyVertexSize);this._tessy.gluTessVertex(u,u)}this._tessy.gluTessEndContour()}return this._tessy.gluTessEndPolygon(),s}}class ZG{constructor(t){this.renderer=t,this.cache={}}numCached(){return Object.keys(this.cache).length}isCached(t){return this.cache[t]!==void 0}getGeometryByID(t){var r;return(r=this.cache[t])==null?void 0:r.geometry}getCached(t){return this.getCachedID(t.gid)}getCachedID(t){return this.cache[t]}ensureCached(t){const r=t.gid;if(!r)throw new Error("The p5.Geometry you passed in has no gid property!");if(this.isCached(t.gid))return this.getCached(t);const i=this.renderer.GL;if(this.freeBuffers(r),Object.keys(this.cache).length>1e3){const a=Object.keys(this.cache)[0];this.freeBuffers(a)}const s={};this.cache[r]=s,s.geometry=t;let o=s.indexBuffer;if(t.faces.length){o||(o=s.indexBuffer=i.createBuffer());const a=t.faces.flat(),u=a.some(c=>c>65535);let l=u?Uint32Array:Uint16Array;this.renderer._bindBuffer(o,i.ELEMENT_ARRAY_BUFFER,a,l),s.indexBufferType=u?i.UNSIGNED_INT:i.UNSIGNED_SHORT}else o&&(i.deleteBuffer(o),s.indexBuffer=null);return s}freeBuffers(t){const r=this.cache[t];if(!r)return;delete this.cache[t];const i=this.renderer.GL;r.indexBuffer&&i.deleteBuffer(r.indexBuffer);function s(o){for(const a of o)r[a.dst]&&(i.deleteBuffer(r[a.dst]),r[a.dst]=null)}s(this.renderer.buffers.stroke),s(this.renderer.buffers.fill),s(this.renderer.buffers.user)}}const vp={[hl]:3,[jg]:4,[$g]:.5};function y_(n,t){const r=t.DEGREES="degrees",i=t.RADIANS="radians";t._angleMode=i,t.acos=function(s){return this._fromRadians(Math.acos(s))},t.asin=function(s){return this._fromRadians(Math.asin(s))},t.atan=function(s){return this._fromRadians(Math.atan(s))},t.atan2=function(s,o){return this._fromRadians(Math.atan2(s,o))},t.cos=function(s){return Math.cos(this._toRadians(s))},t.sin=function(s){return Math.sin(this._toRadians(s))},t.tan=function(s){return Math.tan(this._toRadians(s))},t.degrees=s=>s*Zo,t.radians=s=>s*Xo,t.angleMode=function(s){if(typeof s>"u")return this._angleMode;if(s===r||s===i){const o=this._angleMode;if(s===o)return;s===i?(this.pRotationX=this.pRotationX*Xo,this.pRotationY=this.pRotationY*Xo,this.pRotationZ=this.pRotationZ*Xo):(this.pRotationX=this.pRotationX*Zo,this.pRotationY=this.pRotationY*Zo,this.pRotationZ=this.pRotationZ*Zo),this._angleMode=s}},t._toRadians=function(s){return this._angleMode===r?s*Xo:s},t._toDegrees=function(s){return this._angleMode===i?s*Zo:s},t._fromRadians=function(s){return this._angleMode===r?s*Zo:s},t._fromDegrees=function(s){return this._angleMode===i?s*Xo:s}}typeof p5<"u"&&y_(p5,p5.prototype);function v_(n,t){t.createImage=function(r,i){return new n.Image(r,i)},t.saveCanvas=function(...r){let i,s,o,a;if(r[0]instanceof HTMLCanvasElement)i=r[0],r.shift();else if(r[0]instanceof Lr)i=r[0].elt,r.shift();else if(r[0]instanceof hi){const l=r[0];a=this.createGraphics(l.width,l.height),a.pixelDensity(l.pixelDensity()),l.loadPixels(),a.loadPixels(),a.pixels.set(l.pixels),a.updatePixels(),i=a._renderer.canvas,r.shift()}else i=this._curElement&&this._curElement.elt;r.length>=1&&(s=r[0]),r.length>=2&&(o=r[1]),o=o||t._checkFileExtension(s,o)[1]||"png";let u;switch(o){default:u="image/png";break;case"webp":u="image/webp";break;case"jpeg":case"jpg":u="image/jpeg";break}i.toBlob(l=>{t.downloadFile(l,s,o),a&&a.remove()},u)},t.encodeAndDownloadGif=function(r,i){const s=r.gifProperties;let o=s.loopLimit;o===1?o=null:o===null&&(o=0);const a=new Uint8Array(r.width*r.height*s.numFrames),u=[],l={};for(let E=0;E<s.numFrames;E++){const S=new Set,R=s.frames[E].image.data,w=R.length,x=new Uint32Array(r.width*r.height);for(let A=0,k=0;A<w;A+=4,k++){const N=R[A+0],I=R[A+1],j=R[A+2],Q=N<<16|I<<8|j<<0;S.add(Q),x[k]=Q}const b=[...S].sort().toString();l[b]===void 0?l[b]={freq:1,frames:[E]}:(l[b].freq+=1,l[b].frames.push(E)),u.push(x)}let c=[];const h=Object.keys(l).sort(function(E,S){return l[S].freq-l[E].freq}),f=h[0].split(",").map(E=>parseInt(E));c=c.concat(l[f].frames);const d=new Set(f);for(let E=1;E<h.length;E++){const R=h[E].split(",").map(w=>parseInt(w)).filter(w=>!d.has(w));if(f.length+R.length<=256){for(let w=0;w<R.length;w++)f.push(R[w]),d.add(R[w]);c=c.concat(l[h[E]].frames)}}c=new Set(c);const p={};for(let E=0;E<f.length;E++)p[f[E]]||(p[f[E]]=E);let g=1;for(;g<f.length;)g<<=1;f.length=g;const y={loop:o,palette:new Uint32Array(f)},v=new ak.GifWriter(a,r.width,r.height,y);let T={};for(let E=0;E<s.numFrames;E++){const S=!c.has(E),R=S?[]:f,w=new Uint8Array(r.width*r.height),x={},b=new Set;u[E].forEach((N,I)=>{S?(x[N]===void 0&&(x[N]=R.length,R.push(N)),w[I]=x[N]):w[I]=p[N],E>0&&u[E-1][I]!==N&&b.add(N)});const A={},k=R.filter(N=>!b.has(N));if(k.length>0){const N=k[0],I=S?x[N]:p[N];if(E>0){for(let j=0;j<u[E].length;j++)u[E-1][j]===u[E][j]&&(w[j]=I);A.transparent=I,T.frameOpts.disposal=1}}if(A.delay=s.frames[E].delay/10,S){let N=1;for(;N<R.length;)N<<=1;R.length=N,A.palette=new Uint32Array(R)}E>0&&v.addFrame(0,0,r.width,r.height,T.pixelPaletteIndex,T.frameOpts),T={pixelPaletteIndex:w,frameOpts:A}}T.frameOpts.disposal=1,v.addFrame(0,0,r.width,r.height,T.pixelPaletteIndex,T.frameOpts);const _="gif",C=new Blob([a.slice(0,v.end())],{type:"image/gif"});t.downloadFile(C,i,_)},t.saveFrames=function(r,i,s,o,a){let u=s||3;u=Math.max(Math.min(u,15),0),u=u*1e3;let l=o||15;l=Math.max(Math.min(l,22),0);let c=0;const h=t._makeFrame,f=this._curElement.elt;let d=[];const p=setInterval(()=>{d.push(h(r+c,i,f)),c++},1e3/l);setTimeout(()=>{if(clearInterval(p),a)a(d);else for(const g of d)t.downloadFile(g.imageData,g.filename,g.ext);d=[]},u+.01)},t._makeFrame=function(r,i,s){let o;this?o=this._curElement.elt:o=s;let a;if(!i)i="png",a="image/png";else switch(i.toLowerCase()){case"png":a="image/png";break;case"jpeg":a="image/jpeg";break;case"jpg":a="image/jpeg";break;default:a="image/png";break}const u="image/octet-stream";let l=o.toDataURL(a);l=l.replace(a,u);const c={};return c.imageData=l,c.filename=r,c.ext=i,c}}typeof p5<"u"&&v_(p5,p5.prototype);class dS extends Error{constructor(){super(...arguments);Nt(this,"status");Nt(this,"response");Nt(this,"ok")}}async function Bn(n,t){try{const r=await fetch(n);if(r.ok){let i;switch(t){case"json":i=await r.json();break;case"text":i=await r.text();break;case"arrayBuffer":i=await r.arrayBuffer();break;case"blob":i=await r.blob();break;case"bytes":if(r.bytes)i=await r.bytes();else{const s=await r.arrayBuffer();i=new Uint8Array(s)}break;default:throw new Error("Unsupported response type")}return{data:i,headers:r.headers}}else{const i=new dS(r.statusText);throw i.status=r.status,i.response=r,i.ok=!1,i}}catch(r){throw r instanceof TypeError?console.log("You may have encountered a CORS error"):r instanceof dS?console.log("You have encountered a HTTP error"):r instanceof SyntaxError&&console.log("There is an error parsing the response to requested data structure"),r}}function Sk(n,t){t.loadJSON=async function(i,s,o){try{const{data:a}=await Bn(i,"json");return s?s(a):a}catch(a){if(n._friendlyFileLoadError(5,i),o)return o(a);throw a}},t.loadStrings=async function(i,s,o){try{let{data:a}=await Bn(i,"text");return a=a.split(/\r?\n/),s?s(a):a}catch(a){if(n._friendlyFileLoadError(3,i),o)return o(a);throw a}},t.loadTable=async function(i,s,o,a,u){typeof arguments[arguments.length-1]=="function"&&(typeof arguments[arguments.length-2]=="function"?(a=arguments[arguments.length-2],u=arguments[arguments.length-1]):a=arguments[arguments.length-1]),typeof s!="string"&&(s=","),typeof o=="function"&&(o=!1);try{let{data:l}=await Bn(i,"text"),c=new n.Table;return l=AG(l,{separator:s}),o?c.columns=l.shift():c.columns=Array(l[0].length).fill(null),l.forEach(h=>{const f=new n.TableRow(h);c.addRow(f)}),a?a(c):c}catch(l){if(n._friendlyFileLoadError(2,i),u)return u(l);throw l}},t.loadXML=async function(i,s,o){try{const a=new DOMParser;let{data:u}=await Bn(i,"text");const l=a.parseFromString(u,"application/xml");return u=new n.XML(l),s?s(u):u}catch(a){if(n._friendlyFileLoadError(1,i),o)return o(a);throw a}},t.loadBytes=async function(i,s,o){try{let{data:a}=await Bn(i,"arrayBuffer");return a=new Uint8Array(a),s?s(a):a}catch(a){if(n._friendlyFileLoadError(6,i),o)return o(a);throw a}},t.loadBlob=async function(i,s,o){try{const{data:a}=await Bn(i,"blob");return s?s(a):a}catch(a){if(o)return o(a);throw a}},t.httpGet=async function(i,s="text",o,a){return typeof s=="function"&&(a=o,o=s,s="text"),this.httpDo(i,"GET",s,o,a)},t.httpPost=async function(i,s,o="text",a,u){typeof s=="function"?(a=s,u=o,s=void 0,o="text"):typeof o=="function"&&(u=a,a=o,o="text");let l=s,c="text/plain";s instanceof n.XML?(l=s.serialize(),c="application/xml"):s instanceof n.Image?(l=await s.toBlob(),c="image/png"):typeof s=="object"&&(l=JSON.stringify(s),c="application/json");const h={method:"POST",body:l,headers:{"Content-Type":c}};l&&(h.body=l);const f=new Request(i,h);return this.httpDo(f,"POST",o,a,u)},t.httpDo=async function(i,s,o,a,u){if(typeof o=="function"&&(u=a,a=o,o=void 0),!o)switch(typeof i=="string"?i.split(".").pop():i.url.split(".").pop()){case"json":o="json";break;case"jpg":case"jpeg":case"png":case"webp":case"gif":o="blob";break;case"xml":case"txt":default:o="text"}const l=new Request(i,{method:s});try{const{data:c}=await Bn(l,o);return a?a(c):c}catch(c){if(u)return u(c);throw c}},t._pWriters=[],t.createWriter=function(i,s){let o;for(const a in t._pWriters)if(t._pWriters[a].name===i)return o=new n.PrintWriter(i+this.millis(),s),t._pWriters.push(o),o;return o=new n.PrintWriter(i,s),t._pWriters.push(o),o},n.PrintWriter=function(i,s){let o=this;this.name=i,this.content="",this.write=function(a){this.content+=a},this.print=function(a){this.content+=`${a}
`},this.clear=function(){this.content=""},this.close=function(){const a=[];a.push(this.content),t.writeFile(a,i,s);for(const u in t._pWriters)t._pWriters[u].name===this.name&&t._pWriters.splice(u,1);o.clear(),o={}}},t.save=function(i,s,o){const a=arguments,u=this._curElement?this._curElement.elt:this.elt;if(a.length===0){t.saveCanvas(u);return}else if(a[0]instanceof st||a[0]instanceof pl){t.saveCanvas(a[0].canvas,a[1],a[2]);return}else if(a.length===1&&typeof a[0]=="string")t.saveCanvas(u,a[0]);else switch(yp(a[1],a[2])[1]){case"json":t.saveJSON(a[0],a[1],a[2]);return;case"txt":t.saveStrings(a[0],a[1],a[2]);return;default:a[0]instanceof Array?t.saveStrings(a[0],a[1],a[2]):a[0]instanceof n.Table?t.saveTable(a[0],a[1],a[2]):a[0]instanceof n.Image?t.saveCanvas(a[0].canvas,a[1]):a[0]instanceof n.SoundFile&&t.saveSound(a[0],a[1],a[2],a[3])}},t.saveJSON=function(i,s,o){let a;o?a=JSON.stringify(i):a=JSON.stringify(i,void 0,2),this.saveStrings(a.split(`
`),s,"json")},t.saveStrings=function(i,s,o,a){const u=o||"txt",l=new n.PrintWriter(s,u);for(let c of i)a?l.write(c+`\r
`):l.write(c+`
`);l.close(),l.clear()};function r(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}t.saveTable=function(i,s,o){let a;o===void 0?(a=s.substring(s.lastIndexOf(".")+1,s.length),a===s&&(a="csv")):a=o;const u=this.createWriter(s,a),l=i.columns;let c=",";if(a==="tsv"&&(c="	"),a!=="html"){const h=i.toString(c);u.write(h)}else{u.print("<html>"),u.print("<head>");let h='  <meta http-equiv="content-type" content';if(h+='="text/html;charset=utf-8" />',u.print(h),u.print("</head>"),u.print("<body>"),u.print("  <table>"),l[0]!=="0"){u.print("    <tr>");for(let f=0;f<l.length;f++){const d=r(l[f]);u.print(`      <td>${d}`),u.print("      </td>")}u.print("    </tr>")}for(let f=0;f<i.rows.length;f++){u.print("    <tr>");for(let d=0;d<i.columns.length;d++){const p=i.rows[f].getString(d),g=r(p);u.print(`      <td>${g}`),u.print("      </td>")}u.print("    </tr>")}u.print("  </table>"),u.print("</body>"),u.print("</html>")}u.close(),u.clear()},t.writeFile=function(i,s,o){let a="application/octet-stream";t._isSafari()&&(a="text/plain");const u=new Blob(i,{type:a});t.downloadFile(u,s,o)},t.downloadFile=u_,t._checkFileExtension=yp,t._isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}typeof p5<"u"&&Sk(p5,p5.prototype);function __(n,t){t.loadImage=async function(c,h,f){try{let d=new n.Image(1,1,this);const p=new Request(c,{method:"GET",mode:"cors"}),{data:g,headers:y}=await Bn(p,"bytes"),v=y.get("content-type");if(v===null&&console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset."),v&&v.includes("image/gif"))await s(g,d);else{const T=new Blob([g]),_=await createImageBitmap(T);d.width=d.canvas.width=_.width,d.height=d.canvas.height=_.height,d.drawingContext.drawImage(_,0,0)}return d.modified=!0,h?h(d):d}catch(d){if(n._friendlyFileLoadError(0,c),typeof f=="function")return f(d);throw d}},t.saveGif=async function(c,h,f={delay:0,units:"seconds",silent:!1,notificationDuration:0,notificationID:"progressBar"}){if(typeof c!="string")throw TypeError("fileName parameter must be a string");if(typeof h!="number")throw TypeError("Duration parameter must be a number");const d=f&&f.delay||0,p=f&&f.units||"seconds",g=f&&f.silent||!1,y=f&&f.notificationDuration||0,v=f&&f.notificationID||"progressBar";if(typeof d!="number")throw TypeError("Delay parameter must be a number");if(p!=="seconds"&&p!=="frames")throw TypeError('Units parameter must be either "frames" or "seconds"');if(typeof g!="boolean")throw TypeError("Silent parameter must be a boolean");if(typeof y!="number")throw TypeError("Notification duration parameter must be a number");if(typeof v!="string")throw TypeError("Notification ID parameter must be a string");this._recording=!0;let T=this._targetFrameRate;(T===1/0||T===void 0||T===0)&&(T=60);let _=1/T*1e3;_=_<20?20:_;const C=p==="seconds"?h*T:h,E=p==="seconds"?d*T:d,S=C+E;let R=E;this.frameCount=R;const w=this._renderer._pixelDensity;this.pixelDensity(1);let x=[];document.getElementById(v)!==null&&document.getElementById(v).remove();let b;g||(b=this.createP(""),b.id(v),b.style("font-size","16px"),b.style("font-family","Montserrat"),b.style("background-color","#ffffffa0"),b.style("padding","8px"),b.style("border-radius","10px"),b.position(0,0));let A,k;for(this._renderer instanceof n.RendererGL&&(k=this.drawingContext,A=new Uint8Array(k.drawingBufferWidth*k.drawingBufferHeight*4)),this.noLoop(),await Promise.resolve();R<S;){this.redraw();let ue;this._renderer instanceof n.RendererGL?(A=new Uint8Array(k.drawingBufferWidth*k.drawingBufferHeight*4),k.readPixels(0,0,k.drawingBufferWidth,k.drawingBufferHeight,k.RGBA,k.UNSIGNED_BYTE,A),ue=r(A,this.width,this.height)):ue=this.drawingContext.getImageData(0,0,this.width,this.height).data,x.push(ue),R++,g||b.html("Saved frame <b>"+x.length.toString()+"</b> out of "+C.toString()),await new Promise(ee=>setTimeout(ee,0))}g||b.html("Frames processed, generating color palette..."),this.loop(),this.pixelDensity(w);const N=$G(),I=i(x),j={},Q=ue=>{const ee=ue.length/4,ve=new Uint8Array(ee);for(let ge=0;ge<ee;ge++){const we=ue[ge*4]<<24|ue[ge*4+1]<<16|ue[ge*4+2]<<8|ue[ge*4+3];j[we]===void 0&&(j[we]=UG(I,ue.slice(ge*4,(ge+1)*4))),ve[ge]=j[we]}return ve},le=I.length-1;let fe=[];for(let ue=0;ue<x.length;ue++){const ee=Q(x[ue]),ve=ee.slice();if(ue===0)N.writeFrame(ee,this.width,this.height,{palette:I,delay:_,dispose:1});else{for(let ge=0;ge<ee.length;ge++)ee[ge]===fe[ge]&&(ee[ge]=le);N.writeFrame(ee,this.width,this.height,{delay:_,transparent:!0,transparentIndex:le,dispose:1})}fe=ve,g||b.html("Rendered frame <b>"+ue.toString()+"</b> out of "+C.toString()),await new Promise(ge=>setTimeout(ge,0))}N.finish();const ne=N.bytesView(),oe="gif",ie=new Blob([ne],{type:"image/gif"});x=[],this._recording=!1,this.loop(),g||(b.html("Done. Downloading your gif!"),y>0&&setTimeout(()=>b.remove(),y*1e3)),t.downloadFile(ie,c,oe)};function r(c,h,f){const d=parseInt(f/2),p=h*4,g=new Uint8Array(h*4);for(let y=0;y<d;++y){const v=y*p,T=(f-y-1)*p;g.set(c.subarray(v,v+p)),c.copyWithin(v,T,T+p),c.set(g,T)}return c}function i(c){let h=new Uint8Array(c.length*c[0].length);for(let d=0;d<c.length;d++)h.set(c[d],d*c[0].length);let f=OG(h,256,{format:"rgba4444",oneBitAlpha:!0});return f.length===256?f[f.length-1]=[Math.random()*255,Math.random()*255,Math.random()*255,0]:f.push([Math.random()*255,Math.random()*255,Math.random()*255,0]),f}async function s(c,h){const f=new ak.GifReader(c);h.width=h.canvas.width=f.width,h.height=h.canvas.height=f.height;const d=[],p=f.numFrames();let g=new Uint8ClampedArray(h.width*h.height*4);const y=(T,_)=>{try{_.decodeAndBlitFrameRGBA(T,g)}catch(C){throw n._friendlyFileLoadError(8,h.src),C}};for(let T=0;T<p;T++){const _=f.frameInfo(T),C=h.drawingContext.getImageData(0,0,h.width,h.height);g=C.data.slice(),y(T,f);const E=new ImageData(g,h.width,h.height);h.drawingContext.putImageData(E,0,0);let S=_.delay;S===0&&(S=10),d.push({image:h.drawingContext.getImageData(0,0,h.width,h.height),delay:S*10}),_.disposal===2?h.drawingContext.clearRect(_.x,_.y,_.width,_.height):_.disposal===3&&h.drawingContext.putImageData(C,0,0,_.x,_.y,_.width,_.height)}let v=f.loopCount();return v===null?v=1:v===0&&(v=null),h.drawingContext.putImageData(d[0].image,0,0),d.length>1&&(h.gifProperties={displayIndex:0,loopLimit:v,loopCount:0,frames:d,numFrames:p,playing:!0,timeDisplayed:0,lastChangeTime:0}),h}function o(c,h,f,d,p,g,y,v){const T=Math.max(y/p,v/g),[_,C]=[y/T,v/T];let E=f,S=d;return c===Dn?E+=(p-_)/2:c===ap&&(E+=p-_),h===Dn?S+=(g-C)/2:h===Ty&&(S+=g-C),{x:E,y:S,w:_,h:C}}function a(c,h,f,d,p,g,y,v){const T=Math.max(f/y,d/v),[_,C]=[f/T,d/T];let E=p,S=g;return c===Dn?E+=(y-_)/2:c===ap&&(E+=y-_),h===Dn?S+=(v-C)/2:h===Ty&&(S+=v-C),{x:E,y:S,w:_,h:C}}function u(c,h,f,d,p,g,y,v,T,_,C){if(c===d5){const{x:E,y:S,w:R,h:w}=a(h,f,g,y,v,T,_,C);v=E,T=S,_=R,C=w}if(c===f5){const{x:E,y:S,w:R,h:w}=o(h,f,d,p,g,y,_,C);d=E,p=S,g=R,y=w}return{sx:v,sy:T,sw:_,sh:C,dx:d,dy:p,dw:g,dh:y}}function l(c,h){return c>0&&c<h?c:h}t.image=function(c,h,f,d,p,g,y,v,T,_,C,E){let S=c.width,R=c.height;E=E||Dn,C=C||Dn,c.elt&&(S=S!==void 0?S:c.elt.width,R=R!==void 0?R:c.elt.height),c.elt&&c.elt.videoWidth&&!c.canvas&&(S=S!==void 0?S:c.elt.videoWidth,R=R!==void 0?R:c.elt.videoHeight);let w=h,x=f,b=d||S,A=p||R,k=g||0,N=y||0,I=v!==void 0?v:S,j=T!==void 0?T:R;I=l(I,S),j=l(j,R);let Q=1;c.elt&&!c.canvas&&c.elt.style.width&&(c.elt.videoWidth&&!d?Q=c.elt.videoWidth:Q=c.elt.width,Q/=parseInt(c.elt.style.width,10)),k*=Q,N*=Q,j*=Q,I*=Q;let le=bd.modeAdjust(w,x,b,A,this._renderer.states.imageMode);le=u(_,C,E,le.x,le.y,le.w,le.h,k,N,I,j),this._renderer.image(c,le.sx,le.sy,le.sw,le.sh,le.dx,le.dy,le.dw,le.dh)},t.tint=function(...c){const h=this.color(...c);this._renderer.states.setValue("tint",h._getRGBA([255,255,255,255]))},t.noTint=function(){this._renderer.states.setValue("tint",null)},t.imageMode=function(c){(c===qn||c===ch||c===Dn)&&this._renderer.states.setValue("imageMode",c)}}typeof p5<"u"&&__(p5,p5.prototype);class Ma{constructor(t){this._renderer=t,this.cameraType="default",this.useLinePerspective=!0,this.cameraMatrix=new wr(4),this.projMatrix=new wr(4),this.yScale=1}perspective(t,r,i,s){this.cameraType=arguments.length>0?"custom":"default",typeof t>"u"?(t=this.defaultCameraFOV,this.cameraFOV=t):this.cameraFOV=this._renderer._pInst._toRadians(t),typeof r>"u"&&(r=this.defaultAspectRatio),typeof i>"u"&&(i=this.defaultCameraNear),typeof s>"u"&&(s=this.defaultCameraFar),i<=1e-4&&(i=.01,console.log("Avoid perspective near plane values close to or below 0. Setting value to 0.01.")),s<i&&console.log("Perspective far plane value is less than near plane value. Nothing will be shown."),this.aspectRatio=r,this.cameraNear=i,this.cameraFar=s,this.projMatrix=new wr(4);const o=1/Math.tan(this.cameraFOV/2),a=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(o/r,0,0,0,0,-o*this.yScale,0,0,0,0,(s+i)*a,-1,0,0,2*s*i*a,0),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.set(this.projMatrix))}ortho(t,r,i,s,o,a){const u=this.fbo||this._renderer;t===void 0&&(t=-u.width/2),r===void 0&&(r=+u.width/2),i===void 0&&(i=-u.height/2),s===void 0&&(s=+u.height/2),o===void 0&&(o=0),a===void 0&&(a=Math.max(u.width,u.height)+800),this.cameraNear=o,this.cameraFar=a;const l=r-t,c=s-i,h=a-o,f=2/l,d=2/c*this.yScale,p=-2/h,g=-(r+t)/l,y=-(s+i)/c,v=-(a+o)/h;this.projMatrix=new wr(4),this.projMatrix.set(f,0,0,0,0,-d,0,0,0,0,p,0,g,y,v,1),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.set(this.projMatrix)),this.cameraType="custom"}frustum(t,r,i,s,o,a){t===void 0&&(t=-this._renderer.width*.05),r===void 0&&(r=+this._renderer.width*.05),i===void 0&&(i=+this._renderer.height*.05),s===void 0&&(s=-this._renderer.height*.05),o===void 0&&(o=this.defaultCameraNear),a===void 0&&(a=this.defaultCameraFar),this.cameraNear=o,this.cameraFar=a;const u=r-t,l=s-i,c=a-o,h=+(2*o)/u,f=+(2*o)/l*this.yScale,d=-(2*a*o)/c,p=(r+t)/u,g=(s+i)/l,y=-(a+o)/c;this.projMatrix=new wr(4),this.projMatrix.set(h,0,0,0,0,-f,0,0,p,g,y,-1,0,0,d,0),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.set(this.projMatrix)),this.cameraType="custom"}_rotateView(t,r,i,s){let o=this.centerX,a=this.centerY,u=this.centerZ;o-=this.eyeX,a-=this.eyeY,u-=this.eyeZ;const l=new wr(4);l.rotate4x4(this._renderer._pInst._toRadians(t),r,i,s);const c=[o*l.mat4[0]+a*l.mat4[4]+u*l.mat4[8],o*l.mat4[1]+a*l.mat4[5]+u*l.mat4[9],o*l.mat4[2]+a*l.mat4[6]+u*l.mat4[10]];c[0]+=this.eyeX,c[1]+=this.eyeY,c[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,c[0],c[1],c[2],this.upX,this.upY,this.upZ)}roll(t){const r=this._getLocalAxes(),s=Bu.fromAxisAngle(this._renderer._pInst._toRadians(t),r.z[0],r.z[1],r.z[2]).rotateVector(new de(this.upX,this.upY,this.upZ));this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,s.x,s.y,s.z)}pan(t){const r=this._getLocalAxes();this._rotateView(t,r.y[0],r.y[1],r.y[2])}tilt(t){const r=this._getLocalAxes();this._rotateView(t,r.x[0],r.x[1],r.x[2])}lookAt(t,r,i){this.camera(this.eyeX,this.eyeY,this.eyeZ,t,r,i,this.upX,this.upY,this.upZ)}camera(t,r,i,s,o,a,u,l,c){typeof t>"u"&&(t=this.defaultEyeX,r=this.defaultEyeY,i=this.defaultEyeZ,s=t,o=r,a=0,u=0,l=1,c=0),this.eyeX=t,this.eyeY=r,this.eyeZ=i,typeof s<"u"&&(this.centerX=s,this.centerY=o,this.centerZ=a),typeof u<"u"&&(this.upX=u,this.upY=l,this.upZ=c);const h=this._getLocalAxes();this.cameraMatrix.set(h.x[0],h.y[0],h.z[0],0,h.x[1],h.y[1],h.z[1],0,h.x[2],h.y[2],h.z[2],0,0,0,0,1);const f=-t,d=-r,p=-i;return this.cameraMatrix.translate([f,d,p]),this._isActive()&&(this._renderer.states.setValue("uViewMatrix",this._renderer.states.uViewMatrix.clone()),this._renderer.states.uViewMatrix.set(this.cameraMatrix)),this}move(t,r,i){const s=this._getLocalAxes(),o=[s.x[0]*t,s.x[1]*t,s.x[2]*t],a=[s.y[0]*r,s.y[1]*r,s.y[2]*r],u=[s.z[0]*i,s.z[1]*i,s.z[2]*i];this.camera(this.eyeX+o[0]+a[0]+u[0],this.eyeY+o[1]+a[1]+u[1],this.eyeZ+o[2]+a[2]+u[2],this.centerX+o[0]+a[0]+u[0],this.centerY+o[1]+a[1]+u[1],this.centerZ+o[2]+a[2]+u[2],this.upX,this.upY,this.upZ)}setPosition(t,r,i){const s=t-this.eyeX,o=r-this.eyeY,a=i-this.eyeZ;this.camera(t,r,i,this.centerX+s,this.centerY+o,this.centerZ+a,this.upX,this.upY,this.upZ)}set(t){const r=["eyeX","eyeY","eyeZ","centerX","centerY","centerZ","upX","upY","upZ","cameraFOV","aspectRatio","cameraNear","cameraFar","cameraType","yScale","useLinePerspective"];for(const i of r)this[i]=t[i];this.cameraMatrix=t.cameraMatrix.copy(),this.projMatrix=t.projMatrix.copy(),this._isActive()&&(this._renderer.states.setValue("uModelMatrix",this._renderer.states.uModelMatrix.clone()),this._renderer.states.setValue("uViewMatrix",this._renderer.states.uViewMatrix.clone()),this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uModelMatrix.reset(),this._renderer.states.uViewMatrix.set(this.cameraMatrix),this._renderer.states.uPMatrix.set(this.projMatrix))}slerp(t,r,i){if(i===0){this.set(t);return}else if(i===1){this.set(r);return}this.projMatrix.mat4[15]!==0&&(this.projMatrix.setElement(0,t.projMatrix.mat4[0]*Math.pow(r.projMatrix.mat4[0]/t.projMatrix.mat4[0],i)),this.projMatrix.setElement(5,t.projMatrix.mat4[5]*Math.pow(r.projMatrix.mat4[5]/t.projMatrix.mat4[5],i)),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.mat4=this.projMatrix.mat4.slice()));const s=new de(t.eyeX,t.eyeY,t.eyeZ),o=new de(r.eyeX,r.eyeY,r.eyeZ),a=new de(t.centerX,t.centerY,t.centerZ),u=new de(r.centerX,r.centerY,r.centerZ),l=de.dist(s,a),c=de.dist(o,u),h=l*Math.pow(c/l,i),f=de.sub(s,o),d=s.copy().sub(o).sub(a).add(u),p=d.magSq();let g=1;p>1e-6&&(g=de.dot(f,d)/p,g=Math.max(0,Math.min(g,1)));const y=de.lerp(de.lerp(s,a,g),de.lerp(o,u,g),i),v=t.cameraMatrix.createSubMatrix3x3(),T=r.cameraMatrix.createSubMatrix3x3(),_=v.row(2),C=T.row(2),E=v.row(1),S=T.row(1),R=new de,w=new de,x=new de,b=new de,A=T.mult(v.copy().transpose()),k=A.diagonal();let N=.5*(k[0]+k[1]+k[2]-1);if(1-N<1e-7){R.set(de.lerp(_,C,i)).normalize(),x.set(R).mult(g*h).add(y),b.set(R).mult((g-1)*h).add(y),w.set(de.lerp(E,S,i)).normalize(),this.camera(x.x,x.y,x.z,b.x,b.y,b.z,w.x,w.y,w.z);return}let I,j,Q,le,fe=1/(1-N);const ne=Math.max(k[0],k[1],k[2]),oe=A.mat3[1]+A.mat3[3],ie=A.mat3[2]+A.mat3[6],ue=A.mat3[5]+A.mat3[7];ne===k[0]?(I=Math.sqrt((k[0]-N)*fe),fe/=I,j=.5*oe*fe,Q=.5*ie*fe,le=.5*(A.mat3[7]-A.mat3[5])/I):ne===k[1]?(j=Math.sqrt((k[1]-N)*fe),fe/=j,Q=.5*ue*fe,I=.5*oe*fe,le=.5*(A.mat3[2]-A.mat3[6])/j):(Q=Math.sqrt((k[2]-N)*fe),fe/=Q,I=.5*ie*fe,j=.5*ue*fe,le=.5*(A.mat3[3]-A.mat3[1])/Q);const ee=i*Math.atan2(le,N),ve=Math.cos(ee),ge=Math.sin(ee),we=1-ve,Se=I*j,ae=j*Q,xe=Q*I,ce=new wr([ve+we*I*I,we*Se+ge*Q,we*xe-ge*j,we*Se-ge*Q,ve+we*j*j,we*ae+ge*I,we*xe+ge*j,we*ae-ge*I,ve+we*Q*Q]);ce.multiplyVec(_,R),x.set(R).mult(g*h).add(y),b.set(R).mult((g-1)*h).add(y),ce.multiplyVec(E,w),this.camera(x.x,x.y,x.z,b.x,b.y,b.z,w.x,w.y,w.z)}_computeCameraDefaultSettings(){this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=800,this.defaultCameraFOV=2*Math.atan(this._renderer.height/2/this.defaultEyeZ),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=this.defaultEyeZ*.1,this.defaultCameraFar=this.defaultEyeZ*10}_setDefaultCamera(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"}_resize(){this.cameraType==="default"&&(this._computeCameraDefaultSettings(),this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.perspective())}copy(){const t=new Ma(this._renderer);return t.cameraFOV=this.cameraFOV,t.aspectRatio=this.aspectRatio,t.eyeX=this.eyeX,t.eyeY=this.eyeY,t.eyeZ=this.eyeZ,t.centerX=this.centerX,t.centerY=this.centerY,t.centerZ=this.centerZ,t.upX=this.upX,t.upY=this.upY,t.upZ=this.upZ,t.cameraNear=this.cameraNear,t.cameraFar=this.cameraFar,t.cameraType=this.cameraType,t.useLinePerspective=this.useLinePerspective,t.cameraMatrix=this.cameraMatrix.copy(),t.projMatrix=this.projMatrix.copy(),t.yScale=this.yScale,t}clone(){return this.copy()}_getLocalAxes(){let t=this.eyeX-this.centerX,r=this.eyeY-this.centerY,i=this.eyeZ-this.centerZ;const s=Math.sqrt(t*t+r*r+i*i);s!==0&&(t/=s,r/=s,i/=s);let o=this.upX,a=this.upY,u=this.upZ,l=a*i-u*r,c=-o*i+u*t,h=o*r-a*t;o=r*h-i*c,a=-t*h+i*l,u=t*c-r*l;const f=Math.sqrt(l*l+c*c+h*h);f!==0&&(l/=f,c/=f,h/=f);const d=Math.sqrt(o*o+a*a+u*u);return d!==0&&(o/=d,a/=d,u/=d),{x:[l,c,h],y:[o,a,u],z:[t,r,i]}}_orbit(t,r,i){const s=this.eyeX-this.centerX,o=this.eyeY-this.centerY,a=this.eyeZ-this.centerZ;let u=Math.hypot(s,o,a);const l=new de(s,o,a).normalize(),c=new de(this.upX,this.upY,this.upZ).normalize(),h=de.cross(c,l).normalize(),f=de.cross(h,c);u*=Math.pow(10,i),u<this.cameraNear&&(u=this.cameraNear),u>this.cameraFar&&(u=this.cameraFar);const d=Math.acos(Math.max(-1,Math.min(1,de.dot(l,c))))+r,p=t;(d<=0||d>=Math.PI)&&(this.upX*=-1,this.upY*=-1,this.upZ*=-1),c.mult(Math.cos(d)),f.mult(Math.cos(p)*Math.sin(d)),h.mult(Math.sin(p)*Math.sin(d)),l.set(c).add(f).add(h),this.eyeX=u*l.x+this.centerX,this.eyeY=u*l.y+this.centerY,this.eyeZ=u*l.z+this.centerZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,this.upX,this.upY,this.upZ)}_orbitFree(t,r,i){const s=this.eyeX-this.centerX,o=this.eyeY-this.centerY,a=this.eyeZ-this.centerZ;let u=Math.hypot(s,o,a);const l=new de(s,o,a).normalize(),c=new de(this.upX,this.upY,this.upZ),h=de.cross(c,l).normalize(),f=de.cross(l,h),d=Math.atan2(r,t);f.mult(Math.sin(d)),h.mult(Math.cos(d)).add(f);const p=Math.sqrt(t*t+r*r),g=de.cross(l,h);u*=Math.pow(10,i),u<this.cameraNear&&(u=this.cameraNear),u>this.cameraFar&&(u=this.cameraFar);const y=Math.cos(p),v=Math.sin(p),T=c.dot(l),_=c.dot(h),C=T*y+_*v,E=-T*v+_*y,S=c.dot(g);c.x=C*l.x+E*h.x+S*g.x,c.y=C*l.y+E*h.y+S*g.y,c.z=C*l.z+E*h.z+S*g.z,h.mult(-v),l.mult(y).add(h).mult(u),this.camera(l.x+this.centerX,l.y+this.centerY,l.z+this.centerZ,this.centerX,this.centerY,this.centerZ,c.x,c.y,c.z)}_isActive(){return this===this._renderer.states.curCamera}}function Ck(n,t){t.camera=function(...r){return this._assert3d("camera"),this._renderer.camera(...r),this},t.perspective=function(...r){return this._assert3d("perspective"),this._renderer.perspective(...r),this},t.linePerspective=function(r){if(!(this._renderer instanceof at))throw new Error("linePerspective() must be called in WebGL mode.");return this._renderer.linePerspective(r)},t.ortho=function(...r){return this._assert3d("ortho"),this._renderer.ortho(...r),this},t.frustum=function(...r){return this._assert3d("frustum"),this._renderer.frustum(...r),this},t.createCamera=function(){return this._assert3d("createCamera"),this._renderer.createCamera()},t.setCamera=function(r){this._renderer.setCamera(r)},n.Camera=Ma,at.prototype.camera=function(...r){this.states.curCamera.camera(...r)},at.prototype.perspective=function(...r){this.states.curCamera.perspective(...r)},at.prototype.linePerspective=function(r){if(r!==void 0)this.states.curCamera.useLinePerspective=r;else return this.states.curCamera.useLinePerspective},at.prototype.ortho=function(...r){this.states.curCamera.ortho(...r)},at.prototype.frustum=function(...r){this.states.curCamera.frustum(...r)},at.prototype.createCamera=function(){const r=new Ma(this);return r._computeCameraDefaultSettings(),r._setDefaultCamera(),r},at.prototype.setCamera=function(r){this.states.setValue("curCamera",r),this.states.setValue("uPMatrix",this.states.uPMatrix.clone()),this.states.uPMatrix.set(r.projMatrix),this.states.setValue("uViewMatrix",this.states.uViewMatrix.clone()),this.states.uViewMatrix.set(r.cameraMatrix)}}typeof p5<"u"&&Ck(p5,p5.prototype);class Wr{constructor(t,r,i,s={}){this._renderer=t,this._vertSrc=r,this._fragSrc=i,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[],this.hooks={uniforms:s.uniforms||{},declarations:s.declarations,helpers:s.helpers||{},vertex:s.vertex||{},fragment:s.fragment||{},modified:{vertex:s.modified&&s.modified.vertex||{},fragment:s.modified&&s.modified.fragment||{}}}}hookTypes(t){let r=this._vertSrc,i=this.hooks.vertex[t];if(i||(i=this.hooks.fragment[t],r=this._fragSrc),!i)throw new Error(`Can't find hook ${t}!`);const s=t.split(/\s+/g),o=s.pop(),a=s.pop(),u=[...s],l=/\(([^\)]*)\)/.exec(i);if(!l)throw new Error(`Couldn't find function parameters in hook body:
${i}`);const c=f=>{const d=new RegExp(`struct\\s+${f}\\s*{([^}]*)}`).exec(r);if(!d)return;const p=[];for(const g of d[1].split(";")){const y=g.trim().split(/\s+|,/g),v=y.shift(),T=[...y],_=c(v);for(const C of T)p.push({name:C,type:{typeName:v,qualifiers:[],properties:_}})}return p},h=l[1].split(",").map(f=>{const d=f.trim().split(/\s+/g),p=d.pop(),g=d.pop(),y=[...d],v=c(g);return{name:p,type:{typeName:g,qualifiers:y,properties:v}}});return{name:o,returnType:{typeName:a,qualifiers:u,properties:c(a)},parameters:h}}shaderSrc(t,r){const i="void main";let[s,o]=t.split(i),a="",u="";for(const l in this.hooks.uniforms)a+=`uniform ${l};
`;this.hooks.declarations&&(a+=this.hooks.declarations+`
`),this.hooks[r].declarations&&(a+=this.hooks[r].declarations+`
`);for(const l in this.hooks.helpers)a+=`${l}${this.hooks.helpers[l]}
`;for(const l in this.hooks[r]){if(l==="declarations")continue;const[c,h]=l.split(" ");this.hooks.modified[r][l]&&(u+="#define AUGMENTED_HOOK_"+h+`
`),a+=c+" HOOK_"+h+this.hooks[r][l]+`
`}return s.indexOf("#define HOOK_DEFINES")!==-1&&(s=s.replace("#define HOOK_DEFINES",`
`+u+`
`),u=""),s+`
`+u+a+i+o}version(){const t=/#version (.+)$/.exec(this.vertSrc());return t?t[1]:"100 es"}vertSrc(){return this.shaderSrc(this._vertSrc,"vertex")}fragSrc(){return this.shaderSrc(this._fragSrc,"fragment")}inspectHooks(){console.log("==== Vertex shader hooks: ====");for(const t in this.hooks.vertex)console.log((this.hooks.modified.vertex[t]?"[MODIFIED] ":"")+t+this.hooks.vertex[t]);console.log(""),console.log("==== Fragment shader hooks: ====");for(const t in this.hooks.fragment)console.log((this.hooks.modified.fragment[t]?"[MODIFIED] ":"")+t+this.hooks.fragment[t]);console.log(""),console.log("==== Helper functions: ====");for(const t in this.hooks.helpers)console.log(t+this.hooks.helpers[t])}modify(t){const r={vertex:{},fragment:{},helpers:{}};for(const o in t)o!=="declarations"&&o!=="uniforms"&&(o==="vertexDeclarations"?r.vertex.declarations=(r.vertex.declarations||"")+`
`+t[o]:o==="fragmentDeclarations"?r.fragment.declarations=(r.fragment.declarations||"")+`
`+t[o]:this.hooks.vertex[o]?r.vertex[o]=t[o]:this.hooks.fragment[o]?r.fragment[o]=t[o]:r.helpers[o]=t[o]);const i=Object.assign({},this.hooks.modified.vertex),s=Object.assign({},this.hooks.modified.fragment);for(const o in r.vertex||{})o!=="declarations"&&(i[o]=!0);for(const o in r.fragment||{})o!=="declarations"&&(s[o]=!0);return new Wr(this._renderer,this._vertSrc,this._fragSrc,{declarations:(this.hooks.declarations||"")+`
`+(t.declarations||""),uniforms:Object.assign({},this.hooks.uniforms,t.uniforms||{}),fragment:Object.assign({},this.hooks.fragment,r.fragment||{}),vertex:Object.assign({},this.hooks.vertex,r.vertex||{}),helpers:Object.assign({},this.hooks.helpers,r.helpers||{}),modified:{vertex:i,fragment:s}})}init(){if(this._glProgram===0){const t=this._renderer.GL;if(this._vertShader=t.createShader(t.VERTEX_SHADER),t.shaderSource(this._vertShader,this.vertSrc()),t.compileShader(this._vertShader),!t.getShaderParameter(this._vertShader,t.COMPILE_STATUS)){const r=t.getShaderInfoLog(this._vertShader);if(typeof IS_MINIFIED<"u")console.error(r);else throw r;return null}if(this._fragShader=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(this._fragShader,this.fragSrc()),t.compileShader(this._fragShader),!t.getShaderParameter(this._fragShader,t.COMPILE_STATUS)){const r=t.getShaderInfoLog(this._fragShader);if(typeof IS_MINIFIED<"u")console.error(r);else throw r;return null}this._glProgram=t.createProgram(),t.attachShader(this._glProgram,this._vertShader),t.attachShader(this._glProgram,this._fragShader),t.linkProgram(this._glProgram),t.getProgramParameter(this._glProgram,t.LINK_STATUS)||p5._friendlyError(`Snap! Error linking shader program: ${t.getProgramInfoLog(this._glProgram)}`),this._loadAttributes(),this._loadUniforms()}return this}setDefaultUniforms(){for(const t in this.hooks.uniforms){const[,r]=t.split(" "),i=this.hooks.uniforms[t];let s;i instanceof Function?s=i():s=i,s!=null&&this.setUniform(r,s)}}copyToContext(t){const r=new Wr(t._renderer,this._vertSrc,this._fragSrc);return r.ensureCompiledOnContext(t._renderer),r}ensureCompiledOnContext(t){var r,i;if(this._glProgram!==0&&this._renderer!==t)throw new Error("The shader being run is attached to a different context. Do you need to copy it to this context first with .copyToContext()?");this._glProgram===0&&(this._renderer=((i=(r=t==null?void 0:t._renderer)==null?void 0:r.filterRenderer)==null?void 0:i._renderer)||t,this.init())}_loadAttributes(){if(this._loadedAttributes)return;this.attributes={};const t=this._renderer.GL,r=t.getProgramParameter(this._glProgram,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;++i){const s=t.getActiveAttrib(this._glProgram,i),o=s.name,a=t.getAttribLocation(this._glProgram,o),u={};u.name=o,u.location=a,u.index=i,u.type=s.type,u.size=s.size,this.attributes[o]=u}this._loadedAttributes=!0}_loadUniforms(){if(this._loadedUniforms)return;const t=this._renderer.GL,r=t.getProgramParameter(this._glProgram,t.ACTIVE_UNIFORMS);let i=0;for(let s=0;s<r;++s){const o=t.getActiveUniform(this._glProgram,s),a={};a.location=t.getUniformLocation(this._glProgram,o.name),a.size=o.size;let u=o.name;o.size>1&&(u=u.substring(0,u.indexOf("[0]"))),a.name=u,a.type=o.type,a._cachedData=void 0,a.type===t.SAMPLER_2D&&(a.samplerIndex=i,i++,this.samplers.push(a)),a.isArray=o.size>1||a.type===t.FLOAT_MAT3||a.type===t.FLOAT_MAT4||a.type===t.FLOAT_VEC2||a.type===t.FLOAT_VEC3||a.type===t.FLOAT_VEC4||a.type===t.INT_VEC2||a.type===t.INT_VEC4||a.type===t.INT_VEC3,this.uniforms[u]=a}this._loadedUniforms=!0}compile(){}bindShader(){this.init(),this._bound||(this.useProgram(),this._bound=!0)}unbindShader(){return this._bound&&(this.unbindTextures(),this._bound=!1),this}bindTextures(){const t=this._renderer.GL,r=this._renderer._getEmptyTexture();for(const i of this.samplers){let s=i.texture;s===void 0&&(i.texture=s=r),t.activeTexture(t.TEXTURE0+i.samplerIndex),s.bindTexture(),s.update(),t.uniform1i(i.location,i.samplerIndex)}}updateTextures(){for(const t of this.samplers){const r=t.texture;r&&r.update()}}unbindTextures(){var i;const t=this._renderer.GL,r=this._renderer._getEmptyTexture();for(const s of this.samplers)(i=s.texture)!=null&&i.isFramebufferTexture&&(t.activeTexture(t.TEXTURE0+s.samplerIndex),r.bindTexture(),t.uniform1i(s.location,s.samplerIndex))}useProgram(){const t=this._renderer.GL;return this._renderer._curShader!==this&&(t.useProgram(this._glProgram),this._renderer._curShader=this),this}setUniform(t,r){this.init();const i=this.uniforms[t];if(!i)return;const s=this._renderer.GL;if(i.isArray){if(i._cachedData&&this._renderer._arraysEqual(i._cachedData,r))return;i._cachedData=r.slice(0)}else{if(i._cachedData&&i._cachedData===r)return;Array.isArray(r)?i._cachedData=r.slice(0):i._cachedData=r}const o=i.location;switch(this.useProgram(),i.type){case s.BOOL:r===!0?s.uniform1i(o,1):s.uniform1i(o,0);break;case s.INT:i.size>1?r.length&&s.uniform1iv(o,r):s.uniform1i(o,r);break;case s.FLOAT:i.size>1?r.length&&s.uniform1fv(o,r):s.uniform1f(o,r);break;case s.FLOAT_MAT3:s.uniformMatrix3fv(o,!1,r);break;case s.FLOAT_MAT4:s.uniformMatrix4fv(o,!1,r);break;case s.FLOAT_VEC2:i.size>1?r.length&&s.uniform2fv(o,r):s.uniform2f(o,r[0],r[1]);break;case s.FLOAT_VEC3:i.size>1?r.length&&s.uniform3fv(o,r):s.uniform3f(o,r[0],r[1],r[2]);break;case s.FLOAT_VEC4:i.size>1?r.length&&s.uniform4fv(o,r):s.uniform4f(o,r[0],r[1],r[2],r[3]);break;case s.INT_VEC2:i.size>1?r.length&&s.uniform2iv(o,r):s.uniform2i(o,r[0],r[1]);break;case s.INT_VEC3:i.size>1?r.length&&s.uniform3iv(o,r):s.uniform3i(o,r[0],r[1],r[2]);break;case s.INT_VEC4:i.size>1?r.length&&s.uniform4iv(o,r):s.uniform4i(o,r[0],r[1],r[2],r[3]);break;case s.SAMPLER_2D:if(typeof r=="number"){if(r<s.TEXTURE0||r>s.TEXTURE31||r!==Math.ceil(r))return console.log(" p5.js says: You're trying to use a number as the data for a texture.Please use a texture."),this;s.activeTexture(r),s.uniform1i(o,r)}else s.activeTexture(s.TEXTURE0+i.samplerIndex),i.texture=r instanceof Ss?r:this._renderer.getTexture(r),s.uniform1i(o,i.samplerIndex),i.texture.src.gifProperties&&i.texture.src._animateGif(this._renderer._pInst);break;case s.SAMPLER_CUBE:case s.SAMPLER_3D:case s.SAMPLER_2D_SHADOW:case s.SAMPLER_2D_ARRAY:case s.SAMPLER_2D_ARRAY_SHADOW:case s.SAMPLER_CUBE_SHADOW:case s.INT_SAMPLER_2D:case s.INT_SAMPLER_3D:case s.INT_SAMPLER_CUBE:case s.INT_SAMPLER_2D_ARRAY:case s.UNSIGNED_INT_SAMPLER_2D:case s.UNSIGNED_INT_SAMPLER_3D:case s.UNSIGNED_INT_SAMPLER_CUBE:case s.UNSIGNED_INT_SAMPLER_2D_ARRAY:if(typeof r!="number")break;if(r<s.TEXTURE0||r>s.TEXTURE31||r!==Math.ceil(r)){console.log(" p5.js says: You're trying to use a number as the data for a texture.Please use a texture.");break}s.activeTexture(r),s.uniform1i(o,r);break}return this}enableAttrib(t,r,i,s,o,a){if(t){typeof IS_MINIFIED>"u"&&this.attributes[t.name]!==t&&console.warn(`The attribute "${t.name}"passed to enableAttrib does not belong to this shader.`);const u=t.location;if(u!==-1){const l=this._renderer.GL;this._renderer.registerEnabled.has(u)||(l.enableVertexAttribArray(u),this._renderer.registerEnabled.add(u)),this._renderer.GL.vertexAttribPointer(u,r,i||l.FLOAT,s||!1,o||0,a||0)}}return this}disableRemainingAttributes(){for(const t of this._renderer.registerEnabled.values())Object.keys(this.attributes).some(r=>this.attributes[r].location===t)||(this._renderer.GL.disableVertexAttribArray(t),this._renderer.registerEnabled.delete(t))}}function b_(n,t){n.Shader=Wr}typeof p5<"u"&&b_(p5,p5.prototype);var Ak=`precision highp int;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

IN vec3 aPosition;
IN vec2 aTexCoord;
OUT vec2 vTexCoord;

void main() {
  // transferring texcoords for the frag shader
  vTexCoord = aTexCoord;

  // copy position with a fourth coordinate for projection (1.0 is normal)
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // project to 3D space
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
}
`,pS=`#define PI 3.141592

precision highp float;
precision highp int;

uniform mat4 uViewMatrix;

uniform bool uUseLighting;

uniform int uAmbientLightCount;
uniform vec3 uAmbientColor[5];
uniform mat3 uCameraRotation;
uniform int uDirectionalLightCount;
uniform vec3 uLightingDirection[5];
uniform vec3 uDirectionalDiffuseColors[5];
uniform vec3 uDirectionalSpecularColors[5];

uniform int uPointLightCount;
uniform vec3 uPointLightLocation[5];
uniform vec3 uPointLightDiffuseColors[5];	
uniform vec3 uPointLightSpecularColors[5];

uniform int uSpotLightCount;
uniform float uSpotLightAngle[5];
uniform float uSpotLightConc[5];
uniform vec3 uSpotLightDiffuseColors[5];
uniform vec3 uSpotLightSpecularColors[5];
uniform vec3 uSpotLightLocation[5];
uniform vec3 uSpotLightDirection[5];

uniform bool uSpecular;
uniform float uShininess;
uniform float uMetallic;

uniform float uConstantAttenuation;
uniform float uLinearAttenuation;
uniform float uQuadraticAttenuation;

// setting from  _setImageLightUniforms()
// boolean to initiate the calculateImageDiffuse and calculateImageSpecular
uniform bool uUseImageLight;
// texture for use in calculateImageDiffuse
uniform sampler2D environmentMapDiffused;
// texture for use in calculateImageSpecular
uniform sampler2D environmentMapSpecular;

const float specularFactor = 2.0;
const float diffuseFactor = 0.73;

struct LightResult {
  float specular;
  float diffuse;
};

float _phongSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float shininess) {

  vec3 R = reflect(lightDirection, surfaceNormal);
  return pow(max(0.0, dot(R, viewDirection)), shininess);
}

float _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {
  return max(0.0, dot(-lightDirection, surfaceNormal));
}

LightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector, float shininess, float metallic) {

  vec3 lightDir = normalize(lightVector);

  //compute our diffuse & specular terms
  LightResult lr;
  float specularIntensity = mix(1.0, 0.4, metallic);
  float diffuseIntensity = mix(1.0, 0.1, metallic);
  if (uSpecular)
    lr.specular = (_phongSpecular(lightDir, viewDirection, normal, shininess)) * specularIntensity;
    lr.diffuse = _lambertDiffuse(lightDir, normal) * diffuseIntensity;
  return lr;
}

// converts the range of "value" from [min1 to max1] to [min2 to max2]
float map(float value, float min1, float max1, float min2, float max2) {
  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
}

vec2 mapTextureToNormal( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( fract(theta + 0.25), 1.0 - phi );
  return angles;
}


vec3 calculateImageDiffuse(vec3 vNormal, vec3 vViewPosition, float metallic){
  // make 2 seperate builds 
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);  // hardcoded world camera position
  vec3 worldNormal = normalize(vNormal * uCameraRotation);
  vec2 newTexCoor = mapTextureToNormal( worldNormal );
  vec4 texture = TEXTURE( environmentMapDiffused, newTexCoor );
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(smoothstep(vec3(0.0), vec3(1.0), texture.xyz), vec3(0.0), metallic);
}

vec3 calculateImageSpecular(vec3 vNormal, vec3 vViewPosition, float shininess, float metallic){
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);
  vec3 worldNormal = normalize(vNormal);
  vec3 lightDirection = normalize( vViewPosition - worldCameraPosition );
  vec3 R = reflect(lightDirection, worldNormal) * uCameraRotation;
  vec2 newTexCoor = mapTextureToNormal( R );
#ifdef WEBGL2
  // In p5js the range of shininess is >= 1,
  // Therefore roughness range will be ([0,1]*8)*20 or [0, 160]
  // The factor of 8 is because currently the getSpecularTexture
  // only calculated 8 different levels of roughness
  // The factor of 20 is just to spread up this range so that,
  // [1, max] of shininess is converted to [0,160] of roughness
  float roughness = 20. / shininess;
  vec4 outColor = textureLod(environmentMapSpecular, newTexCoor, roughness * 8.);
#else
  vec4 outColor = TEXTURE(environmentMapSpecular, newTexCoor);
#endif
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(
    pow(outColor.xyz, vec3(10)),
    pow(outColor.xyz, vec3(1.2)),
    metallic 
  );
}

void totalLight(
  vec3 modelPosition,
  vec3 normal,
  float shininess,
  float metallic,
  out vec3 totalDiffuse,
  out vec3 totalSpecular
) {

  totalSpecular = vec3(0.0);

  if (!uUseLighting) {
    totalDiffuse = vec3(1.0);
    return;
  }

  totalDiffuse = vec3(0.0);

  vec3 viewDirection = normalize(-modelPosition);

  for (int j = 0; j < 5; j++) {
    if (j < uDirectionalLightCount) {
      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;
      vec3 lightColor = uDirectionalDiffuseColors[j];
      vec3 specularColor = uDirectionalSpecularColors[j];
      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if (j < uPointLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
      //calculate attenuation
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);
      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];
      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];

      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if(j < uSpotLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
    
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);

      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;
      float spotDot = dot(normalize(lightVector), normalize(lightDirection));
      float spotFalloff;
      if(spotDot < uSpotLightAngle[j]) {
        spotFalloff = 0.0;
      }
      else {
        spotFalloff = pow(spotDot, uSpotLightConc[j]);
      }
      lightFalloff *= spotFalloff;

      vec3 lightColor = uSpotLightDiffuseColors[j];
      vec3 specularColor = uSpotLightSpecularColors[j];
     
      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);
      
      totalDiffuse += result.diffuse * lightColor * lightFalloff;
      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;
    }
  }

  if( uUseImageLight ){
    totalDiffuse += calculateImageDiffuse(normal, modelPosition, metallic);
    totalSpecular += calculateImageSpecular(normal, modelPosition, shininess, metallic);
  }

  totalDiffuse *= diffuseFactor;
  totalSpecular *= specularFactor;
}
`,Gy=`#ifdef WEBGL2

#define IN in
#define OUT out

#ifdef FRAGMENT_SHADER
out vec4 outColor;
#define OUT_COLOR outColor
#endif
#define TEXTURE texture

#else

#ifdef FRAGMENT_SHADER
#define IN varying
#else
#define IN attribute
#endif
#define OUT varying
#define TEXTURE texture2D

#ifdef FRAGMENT_SHADER
#define OUT_COLOR gl_FragColor
#endif

#endif

#ifdef FRAGMENT_SHADER
vec4 getTexture(in sampler2D content, vec2 coord) {
  vec4 color = TEXTURE(content, coord);
  color.rgb /= color.a;
  return color;
}
#endif
`,QG=`IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

#define HOOK_DEFINES

#ifdef AUGMENTED_HOOK_getWorldInputs
uniform mat4 uModelMatrix;
uniform mat4 uViewMatrix;
uniform mat3 uModelNormalMatrix;
uniform mat3 uCameraNormalMatrix;
#else
uniform mat4 uModelViewMatrix;
uniform mat3 uNormalMatrix;
#endif
uniform mat4 uProjectionMatrix;

uniform vec4 uMaterialColor;
uniform bool uUseVertexColor;

OUT vec3 vVertexNormal;
OUT highp vec2 vVertTexCoord;
OUT vec4 vColor;

struct Vertex {
  vec3 position;
  vec3 normal;
  vec2 texCoord;
  vec4 color;
};

void main(void) {
  HOOK_beforeVertex();

  Vertex inputs;
  inputs.position = aPosition;
  inputs.normal = aNormal;
  inputs.texCoord = aTexCoord;
  inputs.color = (uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor;
#ifdef AUGMENTED_HOOK_getObjectInputs
  inputs = HOOK_getObjectInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uModelNormalMatrix * inputs.normal;
  inputs = HOOK_getWorldInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  // Already multiplied by the model matrix, just apply view
  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uCameraNormalMatrix * inputs.normal;
#else
  // Apply both at once
  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uNormalMatrix * inputs.normal;
#endif
#ifdef AUGMENTED_HOOK_getCameraInputs
  inputs = HOOK_getCameraInputs(inputs);
#endif

  // Pass varyings to fragment shader
  vVertTexCoord = inputs.texCoord;
  vVertexNormal = normalize(inputs.normal);
  vColor = inputs.color;

  gl_Position = uProjectionMatrix * vec4(inputs.position, 1.);

  HOOK_afterVertex();
}
`,JG=`IN vec3 vVertexNormal;
void main(void) {
  HOOK_beforeFragment();
  OUT_COLOR = HOOK_getFinalColor(vec4(vVertexNormal, 1.0));
  HOOK_afterFragment();
}
`,ez=`IN vec4 vColor;
void main(void) {
  HOOK_beforeFragment();
  OUT_COLOR = HOOK_getFinalColor(vec4(vColor.rgb, 1.) * vColor.a);
  HOOK_afterFragment();
}
`,tz=`#define PI 3.141592

precision highp float;
  
uniform sampler2D uEnvMap;
uniform mat3 uNewNormalMatrix;
uniform float uFovY;
uniform float uAspect;

varying vec2 vTexCoord;
  
void main() {
    float uFovX = uFovY * uAspect; 
    float angleY = mix(uFovY/2.0,  -uFovY/2.0, vTexCoord.y);
    float angleX = mix(uFovX/2.0, -uFovX/2.0, vTexCoord.x);
    vec3 rotatedNormal = vec3( angleX, angleY, 1.0 );
    rotatedNormal = uNewNormalMatrix * normalize(rotatedNormal);
    float temp = rotatedNormal.z;
    rotatedNormal.z = rotatedNormal.x;
    rotatedNormal.x = -temp;
    vec2 suv;
    suv.y = 0.5 + 0.5 * (-rotatedNormal.y);
    suv.x = atan(rotatedNormal.z, rotatedNormal.x) / (2.0 * PI) + 0.5;
    vec4 newTexColor = texture2D(uEnvMap, suv.xy);
    gl_FragColor = newTexColor;
}
`,rz=`// include lighting.glgl

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT highp vec2 vVertTexCoord;
OUT vec3 vDiffuseColor;
OUT vec3 vSpecularColor;
OUT vec4 vColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;

  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);
  vVertTexCoord = aTexCoord;

  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);

  for (int i = 0; i < 8; i++) {
    if (i < uAmbientLightCount) {
      vDiffuseColor += uAmbientColor[i];
    }
  }
  
  vColor = ((uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor);
}
`,nz=`uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;
uniform bool uEmissive;

IN highp vec2 vVertTexCoord;
IN vec3 vDiffuseColor;
IN vec3 vSpecularColor;
IN vec4 vColor;

void main(void) {
  if(uEmissive && !isTexture) {
    OUT_COLOR = vColor;
  }
  else {
    vec4 baseColor = isTexture
      // Textures come in with premultiplied alpha. To apply tint and still have
      // premultiplied alpha output, we need to multiply the RGB channels by the
      // tint RGB, and all channels by the tint alpha.
      ? TEXTURE(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)
      // Colors come in with unmultiplied alpha, so we need to multiply the RGB
      // channels by alpha to convert it to premultiplied alpha.
      : vec4(vColor.rgb * vColor.a, vColor.a);
    OUT_COLOR = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);
  }
}
`,iz=`precision highp int;

#define HOOK_DEFINES

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform vec3 uAmbientColor[5];

#ifdef AUGMENTED_HOOK_getWorldInputs
uniform mat4 uModelMatrix;
uniform mat4 uViewMatrix;
uniform mat3 uModelNormalMatrix;
uniform mat3 uCameraNormalMatrix;
#else
uniform mat4 uModelViewMatrix;
uniform mat3 uNormalMatrix;
#endif
uniform mat4 uProjectionMatrix;
uniform int uAmbientLightCount;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT vec3 vNormal;
OUT vec2 vTexCoord;
OUT vec3 vViewPosition;
OUT vec3 vAmbientColor;
OUT vec4 vColor;

struct Vertex {
  vec3 position;
  vec3 normal;
  vec2 texCoord;
  vec4 color;
};

void main(void) {
  HOOK_beforeVertex();

  Vertex inputs;
  inputs.position = aPosition;
  inputs.normal = aNormal;
  inputs.texCoord = aTexCoord;
  inputs.color = (uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor;
#ifdef AUGMENTED_HOOK_getObjectInputs
  inputs = HOOK_getObjectInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uModelNormalMatrix * inputs.normal;
  inputs = HOOK_getWorldInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  // Already multiplied by the model matrix, just apply view
  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uCameraNormalMatrix * inputs.normal;
#else
  // Apply both at once
  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uNormalMatrix * inputs.normal;
#endif
#ifdef AUGMENTED_HOOK_getCameraInputs
  inputs = HOOK_getCameraInputs(inputs);
#endif

  // Pass varyings to fragment shader
  vViewPosition = inputs.position;
  vTexCoord = inputs.texCoord;
  vNormal = inputs.normal;
  vColor = inputs.color;

  // TODO: this should be a uniform
  vAmbientColor = vec3(0.0);
  for (int i = 0; i < 5; i++) {
    if (i < uAmbientLightCount) {
      vAmbientColor += uAmbientColor[i];
    }
  }

  gl_Position = uProjectionMatrix * vec4(inputs.position, 1.);
  HOOK_afterVertex();
}
`,sz=`// include lighting.glsl
precision highp int;

uniform bool uHasSetAmbient;
uniform vec4 uSpecularMatColor;
uniform vec4 uAmbientMatColor;
uniform vec4 uEmissiveMatColor;

uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;

IN vec3 vNormal;
IN vec2 vTexCoord;
IN vec3 vViewPosition;
IN vec3 vAmbientColor;
IN vec4 vColor;

struct ColorComponents {
  vec3 baseColor;
  float opacity;
  vec3 ambientColor;
  vec3 specularColor;
  vec3 diffuse;
  vec3 ambient;
  vec3 specular;
  vec3 emissive;
};

struct Inputs {
  vec3 normal;
  vec2 texCoord;
  vec3 ambientLight;
  vec3 ambientMaterial;
  vec3 specularMaterial;
  vec3 emissiveMaterial;
  vec4 color;
  float shininess;
  float metalness;
};

void main(void) {
  HOOK_beforeFragment();

  Inputs inputs;
  inputs.normal = normalize(vNormal);
  inputs.texCoord = vTexCoord;
  inputs.ambientLight = vAmbientColor;
  inputs.color = isTexture
      ? TEXTURE(uSampler, vTexCoord) * (vec4(uTint.rgb/255., 1.) * uTint.a/255.)
      : vColor;
  if (isTexture && inputs.color.a > 0.0) {
    // Textures come in with premultiplied alpha. Temporarily unpremultiply it
    // so hooks users don't have to think about premultiplied alpha.
    inputs.color.rgb /= inputs.color.a;
  }
  inputs.shininess = uShininess;
  inputs.metalness = uMetallic;
  inputs.ambientMaterial = uHasSetAmbient ? uAmbientMatColor.rgb : inputs.color.rgb;
  inputs.specularMaterial = uSpecularMatColor.rgb;
  inputs.emissiveMaterial = uEmissiveMatColor.rgb;
  inputs = HOOK_getPixelInputs(inputs);

  vec3 diffuse;
  vec3 specular;
  totalLight(vViewPosition, inputs.normal, inputs.shininess, inputs.metalness, diffuse, specular);

  // Calculating final color as result of all lights (plus emissive term).

  vec2 texCoord = inputs.texCoord;
  vec4 baseColor = inputs.color;
  ColorComponents c;
  c.opacity = baseColor.a;
  c.baseColor = baseColor.rgb;
  c.ambientColor = inputs.ambientMaterial;
  c.specularColor = inputs.specularMaterial;
  c.diffuse = diffuse;
  c.ambient = inputs.ambientLight;
  c.specular = specular;
  c.emissive = inputs.emissiveMaterial;
  OUT_COLOR = HOOK_getFinalColor(HOOK_combineColors(c));
  OUT_COLOR.rgb *= OUT_COLOR.a; // Premultiply alpha before rendering
  HOOK_afterFragment();
}
`,oz=`IN vec3 aPosition;
IN vec2 aTexCoord;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

uniform vec4 uGlyphRect;
uniform float uGlyphOffset;

OUT vec2 vTexCoord;
OUT float w;

void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // scale by the size of the glyph's rectangle
  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;

  // Expand glyph bounding boxes by 1px on each side to give a bit of room
  // for antialiasing
  vec3 newOrigin = (uModelViewMatrix * vec4(0., 0., 0., 1.)).xyz;
  vec3 newDX = (uModelViewMatrix * vec4(1., 0., 0., 1.)).xyz;
  vec3 newDY = (uModelViewMatrix * vec4(0., 1., 0., 1.)).xyz;
  vec2 pixelScale = vec2(
    1. / length(newOrigin - newDX),
    1. / length(newOrigin - newDY)
  );
  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5));
  vec2 textureOffset = offset * (1. / vec2(
    uGlyphRect.z - uGlyphRect.x,
    uGlyphRect.w - uGlyphRect.y
  ));

  // move to the corner of the glyph
  positionVec4.xy += uGlyphRect.xy;

  // move to the letter's line offset
  positionVec4.x += uGlyphOffset;

  positionVec4.xy += offset;
  
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vTexCoord = aTexCoord + textureOffset;
  w = gl_Position.w;
}
`,az=`#ifndef WEBGL2
#extension GL_OES_standard_derivatives : enable
#endif

#if 0
  // simulate integer math using floats
	#define int float
	#define ivec2 vec2
	#define INT(x) float(x)

	int ifloor(float v) { return floor(v); }
	ivec2 ifloor(vec2 v) { return floor(v); }

#else
  // use native integer math
	precision highp int;
	#define INT(x) x

	int ifloor(float v) { return int(v); }
	int ifloor(int v) { return v; }
	ivec2 ifloor(vec2 v) { return ivec2(v); }

#endif

uniform sampler2D uSamplerStrokes;
uniform sampler2D uSamplerRowStrokes;
uniform sampler2D uSamplerRows;
uniform sampler2D uSamplerColStrokes;
uniform sampler2D uSamplerCols;

uniform ivec2 uStrokeImageSize;
uniform ivec2 uCellsImageSize;
uniform ivec2 uGridImageSize;

uniform ivec2 uGridOffset;
uniform ivec2 uGridSize;
uniform vec4 uMaterialColor;

IN vec2 vTexCoord;

// some helper functions
int ROUND(float v) { return ifloor(v + 0.5); }
ivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }
float saturate(float v) { return clamp(v, 0.0, 1.0); }
vec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }

int mul(float v1, int v2) {
  return ifloor(v1 * float(v2));
}

ivec2 mul(vec2 v1, ivec2 v2) {
  return ifloor(v1 * vec2(v2) + 0.5);
}

// unpack a 16-bit integer from a float vec2
int getInt16(vec2 v) {
  ivec2 iv = ROUND(v * 255.0);
  return iv.x * INT(128) + iv.y;
}

vec2 pixelScale;
vec2 coverage = vec2(0.0);
vec2 weight = vec2(0.5);
const float minDistance = 1.0/8192.0;
const float hardness = 1.05; // amount of antialias

// the maximum number of curves in a glyph
const int N = INT(250);

// retrieves an indexed pixel from a sampler
vec4 getTexel(sampler2D sampler, int pos, ivec2 size) {
  int width = size.x;
  int y = ifloor(pos / width);
  int x = pos - y * width;  // pos % width

  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));
}

void calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {

  // get the coefficients of the quadratic in t
  vec2 a = p0 - p1 * 2.0 + p2;
  vec2 b = p0 - p1;
  vec2 c = p0 - vTexCoord;

  // found out which values of 't' it crosses the axes
  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));
  vec2 t1 = ((b - surd) / a).yx;
  vec2 t2 = ((b + surd) / a).yx;

  // approximate straight lines to avoid rounding errors
  if (abs(a.y) < 0.001)
    t1.x = t2.x = c.y / (2.0 * b.y);

  if (abs(a.x) < 0.001)
    t1.y = t2.y = c.x / (2.0 * b.x);

  // plug into quadratic formula to find the corrdinates of the crossings
  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;
  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;
}

void coverageX(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  // determine on which side of the x-axis the points lie
  bool y0 = p0.y > vTexCoord.y;
  bool y1 = p1.y > vTexCoord.y;
  bool y2 = p2.y > vTexCoord.y;

  // could web be under the curve (after t1)?
  if (y1 ? !y2 : y0) {
    // add the coverage for t1
    coverage.x += saturate(C1.x + 0.5);
    // calculate the anti-aliasing for t1
    weight.x = min(weight.x, abs(C1.x));
  }

  // are we outside the curve (after t2)?
  if (y1 ? !y0 : y2) {
    // subtract the coverage for t2
    coverage.x -= saturate(C2.x + 0.5);
    // calculate the anti-aliasing for t2
    weight.x = min(weight.x, abs(C2.x));
  }
}

// this is essentially the same as coverageX, but with the axes swapped
void coverageY(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  bool x0 = p0.x > vTexCoord.x;
  bool x1 = p1.x > vTexCoord.x;
  bool x2 = p2.x > vTexCoord.x;

  if (x1 ? !x2 : x0) {
    coverage.y -= saturate(C1.y + 0.5);
    weight.y = min(weight.y, abs(C1.y));
  }

  if (x1 ? !x0 : x2) {
    coverage.y += saturate(C2.y + 0.5);
    weight.y = min(weight.y, abs(C2.y));
  }
}

void main() {

  // calculate the pixel scale based on screen-coordinates
  pixelScale = hardness / fwidth(vTexCoord);

  // which grid cell is this pixel in?
  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));

  // intersect curves in this row
  {
    // the index into the row info bitmap
    int rowIndex = gridCoord.y + uGridOffset.y;
    // fetch the info texel
    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);
    // unpack the rowInfo
    int rowStrokeIndex = getInt16(rowInfo.xy);
    int rowStrokeCount = getInt16(rowInfo.zw);

    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {
      if (iRowStroke >= rowStrokeCount)
        break;

      // each stroke is made up of 3 points: the start and control point
      // and the start of the next curve.
      // fetch the indices of this pair of strokes:
      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);

      // unpack the stroke index
      int strokePos = getInt16(strokeIndices.xy);

      // fetch the two strokes
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);

      // calculate the coverage
      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  // intersect curves in this column
  {
    int colIndex = gridCoord.x + uGridOffset.x;
    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);
    int colStrokeIndex = getInt16(colInfo.xy);
    int colStrokeCount = getInt16(colInfo.zw);
    
    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {
      if (iColStroke >= colStrokeCount)
        break;

      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);

      int strokePos = getInt16(strokeIndices.xy);
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);
      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  weight = saturate(1.0 - weight * 2.0);
  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.
  float antialias = abs(dot(coverage, weight) / distance);
  float cover = min(abs(coverage.x), abs(coverage.y));
  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;
  OUT_COLOR *= saturate(max(antialias, cover));
}
`,uz=`/*
  Part of the Processing project - http://processing.org
  Copyright (c) 2012-15 The Processing Foundation
  Copyright (c) 2004-12 Ben Fry and Casey Reas
  Copyright (c) 2001-04 Massachusetts Institute of Technology
  This library is free software; you can redistribute it and/or
  modify it under the terms of the GNU Lesser General Public
  License as published by the Free Software Foundation, version 2.1.
  This library is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  Lesser General Public License for more details.
  You should have received a copy of the GNU Lesser General
  Public License along with this library; if not, write to the
  Free Software Foundation, Inc., 59 Temple Place, Suite 330,
  Boston, MA  02111-1307  USA
*/

#define PROCESSING_LINE_SHADER

#define HOOK_DEFINES

precision highp int;
precision highp float;

#ifdef AUGMENTED_HOOK_getWorldInputs
uniform mat4 uModelMatrix;
uniform mat4 uViewMatrix;
#else
uniform mat4 uModelViewMatrix;
#endif

uniform mat4 uProjectionMatrix;
uniform float uStrokeWeight;

uniform bool uUseLineColor;
uniform bool uSimpleLines;
uniform vec4 uMaterialColor;

uniform vec4 uViewport;
uniform int uPerspective;
uniform int uStrokeJoin;

IN vec3 aPosition;
IN vec3 aTangentIn;
IN vec3 aTangentOut;
IN float aSide;
IN vec4 aVertexColor;

OUT vec4 vColor;
OUT vec2 vTangent;
OUT vec2 vCenter;
OUT vec2 vPosition;
OUT float vMaxDist;
OUT float vCap;
OUT float vJoin;
OUT float vStrokeWeight;

vec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {
  // Rotate and translate so a starts at the origin and goes out to the right
  bPoint -= aPoint;
  vec2 rotatedBFrom = vec2(
    bPoint.x*aDir.x + bPoint.y*aDir.y,
    bPoint.y*aDir.x - bPoint.x*aDir.y
  );
  vec2 bTo = bPoint + bDir;
  vec2 rotatedBTo = vec2(
    bTo.x*aDir.x + bTo.y*aDir.y,
    bTo.y*aDir.x - bTo.x*aDir.y
  );
  float intersectionDistance =
    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /
    (rotatedBTo.y - rotatedBFrom.y);
  return aPoint + aDir * intersectionDistance;
}

struct StrokeVertex {
  vec3 position;
  vec3 tangentIn;
  vec3 tangentOut;
  vec4 color;
  float weight;
};

void main() {
  HOOK_beforeVertex();

  if (!uSimpleLines) {
      // Caps have one of either the in or out tangent set to 0
      vCap = (aTangentIn == vec3(0.)) != (aTangentOut == vec3(0.)) ? 1. : 0.;

      // Joins have two unique, defined tangents
      vJoin = (
          aTangentIn != vec3(0.) &&
          aTangentOut != vec3(0.) &&
          aTangentIn != aTangentOut
      ) ? 1. : 0.;
  }

  StrokeVertex inputs;
  inputs.position = aPosition.xyz;
  inputs.color = uUseLineColor ? aVertexColor : uMaterialColor;
  inputs.weight = uStrokeWeight;
  inputs.tangentIn = aTangentIn;
  inputs.tangentOut = aTangentOut;

#ifdef AUGMENTED_HOOK_getObjectInputs
  inputs = HOOK_getObjectInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.tangentIn = (uModelMatrix * vec4(aTangentIn, 0.)).xyz;
  inputs.tangentOut = (uModelMatrix * vec4(aTangentOut, 0.)).xyz;
  inputs = HOOK_getWorldInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  // Already multiplied by the model matrix, just apply view
  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.tangentIn = (uViewMatrix * vec4(aTangentIn, 0.)).xyz;
  inputs.tangentOut = (uViewMatrix * vec4(aTangentOut, 0.)).xyz;
#else
  // Apply both at once
  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.tangentIn = (uModelViewMatrix * vec4(aTangentIn, 0.)).xyz;
  inputs.tangentOut = (uModelViewMatrix * vec4(aTangentOut, 0.)).xyz;
#endif
#ifdef AUGMENTED_HOOK_getCameraInputs
  inputs = hook_getCameraInputs(inputs);
#endif

  vec4 posp = vec4(inputs.position, 1.);
  vec4 posqIn = vec4(inputs.position + inputs.tangentIn, 1.);
  vec4 posqOut = vec4(inputs.position + inputs.tangentOut, 1.);
  vStrokeWeight = inputs.weight;

  float facingCamera = pow(
    // The word space tangent's z value is 0 if it's facing the camera
    abs(normalize(posqIn-posp).z),

    // Using pow() here to ramp \`facingCamera\` up from 0 to 1 really quickly
    // so most lines get scaled and don't get clipped
    0.25
  );

  // Moving vertices slightly toward the camera
  // to avoid depth-fighting with the fill triangles.
  // A mix of scaling and offsetting is used based on distance
  // Discussion here:
  // https://github.com/processing/p5.js/issues/7200 

  // using a scale <1 moves the lines towards nearby camera
  // in order to prevent popping effects due to half of
  // the line disappearing behind the geometry faces.
  float zDistance = -posp.z; 
  float distanceFactor = smoothstep(0.0, 800.0, zDistance); 
  
  // Discussed here:
  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  
  float scale = mix(1., 0.995, facingCamera);
  float dynamicScale = mix(scale, 1.0, distanceFactor); // Closer = more scale, farther = less

  posp.xyz = posp.xyz * dynamicScale;
  posqIn.xyz = posqIn.xyz * dynamicScale;
  posqOut.xyz = posqOut.xyz * dynamicScale;

  // Moving vertices slightly toward camera when far away 
  // https://github.com/processing/p5.js/issues/6956 
  float zOffset = mix(0., -1., facingCamera);
  float dynamicZAdjustment = mix(0.0, zOffset, distanceFactor); // Closer = less zAdjustment, farther = more

  posp.z -= dynamicZAdjustment;
  posqIn.z -= dynamicZAdjustment;
  posqOut.z -= dynamicZAdjustment;
  
  vec4 p = uProjectionMatrix * posp;
  vec4 qIn = uProjectionMatrix * posqIn;
  vec4 qOut = uProjectionMatrix * posqOut;

  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])
  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw

  // prevent division by W by transforming the tangent formula (div by 0 causes
  // the line to disappear, see https://github.com/processing/processing/issues/5183)
  // t = screen_q - screen_p
  //
  // tangent is normalized and we don't care which aDirection it points to (+-)
  // t = +- normalize( screen_q - screen_p )
  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )
  //
  // extract common factor, <1,1> - <1,1> cancels out
  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )
  //
  // convert to common divisor
  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )
  //
  // remove the common scalar divisor/factor, not needed due to normalize and +-
  // (keep uViewport - can't remove because it has different components for x and y
  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)
  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )

  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);
  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);

  vec2 curPerspScale;
  if(uPerspective == 1) {
    // Perspective ---
    // convert from world to clip by multiplying with projection scaling factor
    // to get the right thickness (see https://github.com/processing/processing/issues/5182)

    // The y value of the projection matrix may be flipped if rendering to a Framebuffer.
    // Multiplying again by its sign here negates the flip to get just the scale.
    curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;
  } else {
    // No Perspective ---
    // multiply by W (to cancel out division by W later in the pipeline) and
    // convert from screen to clip (derived from clip to screen above)
    curPerspScale = p.w / (0.5 * uViewport.zw);
  }

  vec2 offset;
  if (vJoin == 1. && !uSimpleLines) {
    vTangent = normalize(tangentIn + tangentOut);
    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);
    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);
    float side = sign(aSide);
    float sideEnum = abs(aSide);

    // We generate vertices for joins on either side of the centerline, but
    // the "elbow" side is the only one needing a join. By not setting the
    // offset for the other side, all its vertices will end up in the same
    // spot and not render, effectively discarding it.
    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {
      // Side enums:
      //   1: the side going into the join
      //   2: the middle of the join
      //   3: the side going out of the join
      if (sideEnum == 2.) {
        // Calculate the position + tangent on either side of the join, and
        // find where the lines intersect to find the elbow of the join
        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;
        vec2 intersection = lineIntersection(
          c + (side * normalIn * inputs.weight / 2.),
          tangentIn,
          c + (side * normalOut * inputs.weight / 2.),
          tangentOut
        );
        offset = (intersection - c);

        // When lines are thick and the angle of the join approaches 180, the
        // elbow might be really far from the center. We'll apply a limit to
        // the magnitude to avoid lines going across the whole screen when this
        // happens.
        float mag = length(offset);
        float maxMag = 3. * inputs.weight;
        if (mag > maxMag) {
          offset *= maxMag / mag;
        }
      } else if (sideEnum == 1.) {
        offset = side * normalIn * inputs.weight / 2.;
      } else if (sideEnum == 3.) {
        offset = side * normalOut * inputs.weight / 2.;
      }
    }
    if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);
      vMaxDist = abs(dot(avgNormal, normalIn * inputs.weight / 2.));
    } else {
      vMaxDist = inputs.weight / 2.;
    }
  } else {
    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;
    vTangent = tangent;
    vec2 normal = vec2(-tangent.y, tangent.x);

    float normalOffset = sign(aSide);
    // Caps will have side values of -2 or 2 on the edge of the cap that
    // extends out from the line
    float tangentOffset = abs(aSide) - 1.;
    offset = (normal * normalOffset + tangent * tangentOffset) *
      inputs.weight * 0.5;
    vMaxDist = inputs.weight / 2.;
  }

  vCenter = p.xy;
  vPosition = vCenter + offset;
  vColor = inputs.color;

  gl_Position.xy = p.xy + offset.xy * curPerspScale;
  gl_Position.zw = p.zw;
  
  HOOK_afterVertex();
}
`,lz=`precision highp int;
precision highp float;

uniform vec4 uMaterialColor;
uniform int uStrokeCap;
uniform int uStrokeJoin;

IN vec4 vColor;
IN vec2 vTangent;
IN vec2 vCenter;
IN vec2 vPosition;
IN float vStrokeWeight;
IN float vMaxDist;
IN float vCap;
IN float vJoin;

float distSquared(vec2 a, vec2 b) {
  vec2 aToB = b - a;
  return dot(aToB, aToB);
}

struct Inputs {
  vec4 color;
  vec2 tangent;
  vec2 center;
  vec2 position;
  float strokeWeight;
};

void main() {
  HOOK_beforeFragment();

  Inputs inputs;
  inputs.color = vColor;
  inputs.tangent = vTangent;
  inputs.center = vCenter;
  inputs.position = vPosition;
  inputs.strokeWeight = vStrokeWeight;
  inputs = HOOK_getPixelInputs(inputs);

  if (vCap > 0.) {
    if (
      uStrokeCap == STROKE_CAP_ROUND &&
      HOOK_shouldDiscard(distSquared(inputs.position, inputs.center) > inputs.strokeWeight * inputs.strokeWeight * 0.25)
    ) {
      discard;
    } else if (
      uStrokeCap == STROKE_CAP_SQUARE &&
      HOOK_shouldDiscard(dot(inputs.position - inputs.center, inputs.tangent) > 0.)
    ) {
      discard;
    // Use full area for PROJECT
    } else if (HOOK_shouldDiscard(false)) {
      discard;
    }
  } else if (vJoin > 0.) {
    if (
      uStrokeJoin == STROKE_JOIN_ROUND &&
      HOOK_shouldDiscard(distSquared(inputs.position, inputs.center) > inputs.strokeWeight * inputs.strokeWeight * 0.25)
    ) {
      discard;
    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 normal = vec2(-inputs.tangent.y, inputs.tangent.x);
      if (HOOK_shouldDiscard(abs(dot(inputs.position - inputs.center, normal)) > vMaxDist)) {
        discard;
      }
    // Use full area for MITER
    } else if (HOOK_shouldDiscard(false)) {
      discard;
    }
  }
  OUT_COLOR = HOOK_getFinalColor(vec4(inputs.color.rgb, 1.) * inputs.color.a);
  HOOK_afterFragment();
}
`,cz=`IN vec3 aPosition;
uniform float uPointSize;
OUT float vStrokeWeight;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

void main() {
  HOOK_beforeVertex();
  vec4 viewModelPosition = vec4(HOOK_getWorldPosition(
    (uModelViewMatrix * vec4(HOOK_getLocalPosition(aPosition), 1.0)).xyz
  ), 1.);
  gl_Position = uProjectionMatrix * viewModelPosition;  

  float pointSize = HOOK_getPointSize(uPointSize);

	gl_PointSize = pointSize;
	vStrokeWeight = pointSize;
  HOOK_afterVertex();
}
`,hz=`precision mediump int;
uniform vec4 uMaterialColor;
IN float vStrokeWeight;

void main(){
  HOOK_beforeFragment();
  float mask = 0.0;

  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)
  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant

  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));

  // if strokeWeight is 1 or less lets just draw a square
  // this prevents weird artifacting from carving circles when our points are really small
  // if strokeWeight is larger than 1, we just use it as is

  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));

  // throw away the borders of the mask
  // otherwise we get weird alpha blending issues

  if(HOOK_shouldDiscard(mask > 0.98)){
    discard;
  }

  OUT_COLOR = HOOK_getFinalColor(vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a);
  HOOK_afterFragment();
}
`,fz=`precision highp float;
attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

varying vec3 localPos;
varying vec3 vWorldNormal;
varying vec3 vWorldPosition;
varying vec2 vTexCoord;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

void main() {
  // Multiply the position by the matrix.
  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;  
  
  // orient the normals and pass to the fragment shader
  vWorldNormal = uNormalMatrix * aNormal;
  
  // send the view position to the fragment shader
  vWorldPosition = (uModelViewMatrix * vec4(aPosition, 1.0)).xyz;
  
  localPos = vWorldPosition;
  vTexCoord = aTexCoord;
}


/*
in the vertex shader we'll compute the world position and world oriented normal of the vertices and pass those to the fragment shader as varyings.
*/
`,dz=`precision highp float;
varying vec3 localPos;

// the HDR cubemap converted (can be from an equirectangular environment map.)
uniform sampler2D environmentMap;
varying vec2 vTexCoord;

const float PI = 3.14159265359;

vec2 nTOE( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( phi, theta );
  return angles;
}

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

void main()
{   	 
	// the sample direction equals the hemisphere's orientation
  float phi = vTexCoord.x * 2.0 * PI;
  float theta = vTexCoord.y * PI;
  float x = sin(theta) * cos(phi);
  float y = sin(theta) * sin(phi);
  float z = cos(theta);
  vec3 normal = vec3( x, y, z);

	// Discretely sampling the hemisphere given the integral's
  // spherical coordinates translates to the following fragment code:
	vec3 irradiance = vec3(0.0);  
	vec3 up	= vec3(0.0, 1.0, 0.0);
	vec3 right = normalize(cross(up, normal));
	up = normalize(cross(normal, right));

	//  We specify a fixed sampleDelta delta value to traverse
  // the hemisphere; decreasing or increasing the sample delta
  // will increase or decrease the accuracy respectively.
	const float sampleDelta = 0.100;
	float nrSamples = 0.0;
  float randomOffset = random(gl_FragCoord.xy) * sampleDelta;
	for(float rawPhi = 0.0; rawPhi < 2.0 * PI; rawPhi += sampleDelta)
	{
    float phi = rawPhi + randomOffset;
    for(float rawTheta = 0.0; rawTheta < ( 0.5 ) * PI; rawTheta += sampleDelta)
    {
      float theta = rawTheta + randomOffset;
      // spherical to cartesian (in tangent space) // tangent space to world // add each sample result to irradiance
      float x = sin(theta) * cos(phi);
      float y = sin(theta) * sin(phi);
      float z = cos(theta);
      vec3 tangentSample = vec3( x, y, z);
      
      vec3 sampleVec = tangentSample.x * right + tangentSample.y * up + tangentSample.z * normal;
        irradiance += (texture2D(environmentMap, nTOE(sampleVec)).xyz) * cos(theta) * sin(theta);
      nrSamples++;
    }
	}
	// divide by the total number of samples taken, giving us the average sampled irradiance.
	irradiance = PI * irradiance * (1.0 / float(nrSamples )) ;
  
 
	gl_FragColor = vec4(irradiance, 1.0);
}`,pz=`precision highp float;\r
varying vec3 localPos;\r
varying vec2 vTexCoord;\r
\r
// our texture\r
uniform sampler2D environmentMap;\r
uniform float roughness;\r
\r
const float PI = 3.14159265359;\r
\r
float VanDerCorput(int bits);\r
vec2 HammersleyNoBitOps(int i, int N);\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness);\r
\r
\r
vec2 nTOE( vec3 v ){\r
  // x = r sin(phi) cos(theta)   \r
  // y = r cos(phi)  \r
  // z = r sin(phi) sin(theta)\r
  float phi = acos( v.y );\r
  // if phi is 0, then there are no x, z components\r
  float theta = 0.0;\r
  // else \r
  theta = acos(v.x / sin(phi));\r
  float sinTheta = v.z / sin(phi);\r
  if (sinTheta < 0.0) {\r
    // Turn it into -theta, but in the 0-2PI range\r
    theta = 2.0 * PI - theta;\r
  }\r
  theta = theta / (2.0 * 3.14159);\r
  phi = phi / 3.14159 ;\r
  \r
  vec2 angles = vec2( phi, theta );\r
  return angles;\r
}\r
\r
\r
void main(){\r
  const int SAMPLE_COUNT = 400; // 4096\r
  int lowRoughnessLimit = int(pow(2.0,(roughness+0.1)*20.0));\r
  float totalWeight = 0.0;\r
  vec3 prefilteredColor = vec3(0.0);\r
  float phi = vTexCoord.x * 2.0 * PI;\r
  float theta = vTexCoord.y * PI;\r
  float x = sin(theta) * cos(phi);\r
  float y = sin(theta) * sin(phi);\r
  float z = cos(theta);\r
  vec3 N = vec3(x,y,z);\r
  vec3 V = N;\r
  for (int i = 0; i < SAMPLE_COUNT; ++i)\r
  {\r
    // break at smaller sample numbers for low roughness levels\r
    if(i == lowRoughnessLimit)\r
    {\r
      break;\r
    }\r
    vec2 Xi = HammersleyNoBitOps(i, SAMPLE_COUNT);\r
    vec3 H = ImportanceSampleGGX(Xi, N, roughness);\r
    vec3 L = normalize(2.0 * dot(V, H) * H - V);\r
\r
    float NdotL = max(dot(N, L), 0.0);\r
    if (NdotL > 0.0)\r
    {\r
      prefilteredColor += texture2D(environmentMap, nTOE(L)).xyz * NdotL;\r
      totalWeight += NdotL;\r
    }\r
  }\r
  prefilteredColor = prefilteredColor / totalWeight;\r
\r
  gl_FragColor = vec4(prefilteredColor, 1.0);\r
}\r
\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness){\r
  float a = roughness * roughness;\r
\r
  float phi = 2.0 * PI * Xi.x;\r
  float cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\r
  float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\r
  // from spherical coordinates to cartesian coordinates\r
  vec3 H;\r
  H.x = cos(phi) * sinTheta;\r
  H.y = sin(phi) * sinTheta;\r
  H.z = cosTheta;\r
\r
  // from tangent-space vector to world-space sample vector\r
  vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\r
  vec3 tangent = normalize(cross(up, N));\r
  vec3 bitangent = cross(N, tangent);\r
\r
  vec3 sampleVec = tangent * H.x + bitangent * H.y + N * H.z;\r
  return normalize(sampleVec);\r
}\r
\r
\r
float VanDerCorput(int n, int base)\r
{\r
#ifdef WEBGL2\r
\r
    uint bits = uint(n);\r
    bits = (bits << 16u) | (bits >> 16u);\r
    bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\r
    bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\r
    bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\r
    bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\r
    return float(bits) * 2.3283064365386963e-10; // / 0x100000000\r
\r
#else\r
\r
  float invBase = 1.0 / float(base);\r
  float denom = 1.0;\r
  float result = 0.0;\r
\r
\r
  for (int i = 0; i < 32; ++i)\r
  {\r
        if (n > 0)\r
        {\r
        denom = mod(float(n), 2.0);\r
        result += denom * invBase;\r
        invBase = invBase / 2.0;\r
        n = int(float(n) / 2.0);\r
        }\r
  }\r
\r
\r
  return result;\r
\r
#endif\r
}\r
\r
vec2 HammersleyNoBitOps(int i, int N)\r
{\r
  return vec2(float(i) / float(N), VanDerCorput(i, 2));\r
}\r
`,Tk=`precision highp float;

uniform sampler2D tex0;
uniform vec2 canvasSize;
uniform vec2 texelSize;

IN vec2 vTexCoord;

struct FilterInputs {
  vec2 texCoord;
  vec2 canvasSize;
  vec2 texelSize;
};

void main(void) {
  FilterInputs inputs;
  inputs.texCoord = vTexCoord;
  inputs.canvasSize = canvasSize;
  inputs.texelSize = texelSize;
  OUT_COLOR = HOOK_getColor(inputs, tex0);
  OUT_COLOR.rgb *= outColor.a;
}
`,Ik=`precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 tex = texture2D(tex0, vTexCoord);
  float gray = luma(tex.rgb);
  gl_FragColor = vec4(gray, gray, gray, tex.a);
}
`,Dk=`// Reduces the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the darkest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum < lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`,kk=`// Increase the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the brightest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum > lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`,Nk=`precision highp float;

// Two-pass blur filter, unweighted kernel.
// See also a similar blur at Adam Ferriss' repo of shader examples:
// https://github.com/aferriss/p5jsShaderExamples/blob/gh-pages/4_image-effects/4-9_single-pass-blur/effect.frag


uniform sampler2D tex0;
varying vec2 vTexCoord;
uniform vec2 direction;
uniform vec2 canvasSize;
uniform float radius;

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

// This isn't a real Gaussian weight, it's a quadratic weight. It's what the
// CPU mode's blur uses though, so we also use it here to match.
float quadWeight(float x, float e) {
  return pow(e-abs(x), 2.);
}

void main(){
  vec2 uv = vTexCoord;

  // A reasonable maximum number of samples
  const float maxSamples = 64.0;

  float numSamples = floor(7. * radius);
  if (fract(numSamples / 2.) == 0.) {
    numSamples++;
  }
  vec4 avg = vec4(0.0);
  float total = 0.0;

  // Calculate the spacing to avoid skewing if numSamples > maxSamples
  float spacing = 1.0;
  if (numSamples > maxSamples) {
    spacing = numSamples / maxSamples;
    numSamples = maxSamples;
  }

  float randomOffset = (spacing - 1.0) * mix(-0.5, 0.5, random(gl_FragCoord.xy));
  for (float i = 0.0; i < maxSamples; i++) {
    if (i >= numSamples) break;

    float sample = i * spacing - (numSamples - 1.0) * 0.5 * spacing + randomOffset;
    vec2 sampleCoord = uv + vec2(sample, sample) / canvasSize * direction;
    float weight = quadWeight(sample, (numSamples - 1.0) * 0.5 * spacing);

    avg += weight * texture2D(tex0, sampleCoord);
    total += weight;
  }

  avg /= total;
  gl_FragColor = avg;
}
`,Rk=`// Limit color space for a stylized cartoon / poster effect

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

vec3 quantize(vec3 color, float n) {
  // restrict values to N options/bins
  // and floor each channel to nearest value
  //
  // eg. when N = 5, values = 0.0, 0.25, 0.50, 0.75, 1.0
  // then quantize (0.1, 0.7, 0.9) -> (0.0, 0.5, 1.0)

  color = color * n;
  color = floor(color);
  color = color / (n - 1.0);
  return color;
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);

  vec3 restrictedColor = quantize(color.rgb / color.a, filterParameter);

  gl_FragColor = vec4(restrictedColor.rgb * color.a, color.a);
}
`,Fk=`// Set alpha channel to entirely opaque

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  gl_FragColor = vec4(color.rgb / color.a, 1.0);
}
`,Pk=`// Set each pixel to inverse value
// Note that original INVERT does not change the opacity, so this follows suit

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
vec4 color = texture2D(tex0, vTexCoord);
vec3 origColor = color.rgb / color.a;
vec3 invertedColor = vec3(1.0) - origColor;
gl_FragColor = vec4(invertedColor * color.a, color.a);
}
`,Mk=`// Convert pixels to either white or black, 
// depending on if their luma is above or below filterParameter

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float gray = luma(color.rgb / color.a);
  // floor() used to match src/image/filters.js
  float threshold = floor(filterParameter * 255.0) / 255.0;
  float blackOrWhite = step(threshold, gray);
  gl_FragColor = vec4(vec3(blackOrWhite) * color.a, color.a);
}
`,Lk=`uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

attribute vec3 aPosition;
// texcoords only come from p5 to vertex shader
// so pass texcoords on to the fragment shader in a varying variable
attribute vec2 aTexCoord;
varying vec2 vTexCoord;

void main() {
  // transferring texcoords for the frag shader
  vTexCoord = aTexCoord;

  // copy position with a fourth coordinate for projection (1.0 is normal)
  vec4 positionVec4 = vec4(aPosition, 1.0);

  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
}
`;const Ok={},Vk={};let _p="";const x_=function(n,t){_p+=`#define STROKE_CAP_${n} ${t}
`,Ok[ka[n]]=t},w_=function(n,t){_p+=`#define STROKE_JOIN_${n} ${t}
`,Vk[ka[n]]=t};x_("ROUND",0);x_("PROJECT",1);x_("SQUARE",2);w_("ROUND",0);w_("MITER",1);w_("BEVEL",2);const lr={normalVert:QG,normalFrag:JG,basicFrag:ez,sphereMappingFrag:tz,lightVert:pS+rz,lightTextureFrag:nz,phongVert:iz,phongFrag:pS+sz,fontVert:oz,fontFrag:az,lineVert:_p+uz,lineFrag:_p+lz,pointVert:cz,pointFrag:hz,imageLightVert:fz,imageLightDiffusedFrag:dz,imageLightSpecularFrag:pz,filterBaseVert:Ak,filterBaseFrag:Tk};let gz=lr.sphereMappingFrag;for(const n in lr)lr[n]=Gy+lr[n];const mz={[Q1]:Ik,[r_]:Dk,[t_]:kk,[hl]:Nk,[jg]:Rk,[J1]:Fk,[e_]:Pk,[$g]:Mk};class at extends st{constructor(t,r,i,s,o,a){super(t,r,i,s),this.canvas=this.elt=o||document.createElement("canvas"),this._setAttributeDefaults(t),this._initContext(),this.GL=this.drawingContext,this._isMainCanvas?(this._pInst._curElement=this,this._pInst.canvas=this.canvas):this.canvas.style.display="none",this.elt.id="defaultCanvas0",this.elt.classList.add("p5Canvas"),this.wrappedElt=new Lr(this.elt,this._pInst);for(const l of Object.getOwnPropertyNames(Lr.prototype))l!=="constructor"&&l[0]!=="_"&&Object.defineProperty(this,l,{get(){return this.wrappedElt[l]}});const u=this._adjustDimensions(r,i);if(r=u.adjustedWidth,i=u.adjustedHeight,this.width=r,this.height=i,this.elt.width=r*this._pixelDensity,this.elt.height=i*this._pixelDensity,this.elt.style.width=`${r}px`,this.elt.style.height=`${i}px`,this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight},this.viewport(this._origViewport.width,this._origViewport.height),this._pInst._userNode)this._pInst._userNode.appendChild(this.elt);else{if(document.getElementsByTagName("main").length===0){let l=document.createElement("main");document.body.appendChild(l)}document.getElementsByTagName("main")[0].appendChild(this.elt)}this.isP3D=!0,this.geometryBuilder=void 0,this.states.uModelMatrix=new wr(4),this.states.uViewMatrix=new wr(4),this.states.uPMatrix=new wr(4),this.states.curCamera=new Ma(this),this.states.uPMatrix.set(this.states.curCamera.projMatrix),this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix),this.states.enableLighting=!1,this.states.ambientLightColors=[],this.states.specularColors=[1,1,1],this.states.directionalLightDirections=[],this.states.directionalLightDiffuseColors=[],this.states.directionalLightSpecularColors=[],this.states.pointLightPositions=[],this.states.pointLightDiffuseColors=[],this.states.pointLightSpecularColors=[],this.states.spotLightPositions=[],this.states.spotLightDirections=[],this.states.spotLightDiffuseColors=[],this.states.spotLightSpecularColors=[],this.states.spotLightAngle=[],this.states.spotLightConc=[],this.states.activeImageLight=null,this.states.curFillColor=[1,1,1,1],this.states.curAmbientColor=[1,1,1,1],this.states.curSpecularColor=[0,0,0,0],this.states.curEmissiveColor=[0,0,0,0],this.states.curStrokeColor=[0,0,0,1],this.states.curBlendMode=vn,this.states._hasSetAmbient=!1,this.states._useSpecularMaterial=!1,this.states._useEmissiveMaterial=!1,this.states._useNormalMaterial=!1,this.states._useShininess=1,this.states._useMetalness=0,this.states.tint=[255,255,255,255],this.states.constantAttenuation=1,this.states.linearAttenuation=0,this.states.quadraticAttenuation=0,this.states._currentNormal=new de(0,0,1),this.states.drawMode=cp,this.states._tex=null,this.states.textureMode=Gg,this.states.textureWrapX=ky,this.states.textureWrapY=ky,this._isErasing=!1,this._simpleLines=!1,this._clipDepths=[],this._isClipApplied=!1,this._stencilTestOn=!1,this.mixedAmbientLight=[],this.mixedSpecularColor=[],this.diffusedTextures=new Map,this.specularTextures=new Map,this.preEraseBlend=void 0,this._cachedBlendMode=void 0,this._cachedFillStyle=[1,1,1,1],this._cachedStrokeStyle=[0,0,0,1],this.webglVersion===Ir?this.blendExt=this.GL:this.blendExt=this.GL.getExtension("EXT_blend_minmax"),this._isBlending=!1,this._useLineColor=!1,this._useVertexColor=!1,this.registerEnabled=new Set,this.states.curCamera._computeCameraDefaultSettings(),this.states.curCamera._setDefaultCamera(),this.filterCamera=new Ma(this),this.filterCamera._computeCameraDefaultSettings(),this.filterCamera._setDefaultCamera(),this.prevTouches=[],this.zoomVelocity=0,this.rotateVelocity=new de(0,0),this.moveVelocity=new de(0,0),this.executeZoom=!1,this.executeRotateAndMove=!1,this._drawingFilter=!1,this._drawingImage=!1,this.specularShader=void 0,this.sphereMapping=void 0,this.diffusedShader=void 0,this._baseFilterShader=void 0,this._defaultLightShader=void 0,this._defaultImmediateModeShader=void 0,this._defaultNormalShader=void 0,this._defaultColorShader=void 0,this._defaultPointShader=void 0,this.states.userFillShader=void 0,this.states.userStrokeShader=void 0,this.states.userPointShader=void 0,this.states.userImageShader=void 0,this.states.curveDetail=1/4,this.shapeBuilder=new XG(this),this.buffers={fill:[new hn(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new hn(3,"vertexNormals","normalBuffer","aNormal",this,this._vToNArray),new hn(4,"vertexColors","colorBuffer","aVertexColor",this),new hn(3,"vertexAmbients","ambientBuffer","aAmbientColor",this),new hn(2,"uvs","uvBuffer","aTexCoord",this,l=>l.flat())],stroke:[new hn(4,"lineVertexColors","lineColorBuffer","aVertexColor",this),new hn(3,"lineVertices","lineVerticesBuffer","aPosition",this),new hn(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",this),new hn(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",this),new hn(1,"lineSides","lineSidesBuffer","aSide",this)],text:[new hn(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new hn(2,"uvs","uvBuffer","aTexCoord",this,l=>l.flat())],point:this.GL.createBuffer(),user:[]},this.geometryBufferCache=new ZG(this),this.curStrokeCap=yo,this.curStrokeJoin=yo,this.textures=new Map,this.framebuffers=new Set,this.activeFramebuffers=[],this.states.filterShader=void 0,this.filterLayer=void 0,this.filterLayerTemp=void 0,this.defaultFilterShaders={},this.fontInfos={},this._curShader=void 0,this.drawShapeCount=1,this.scratchMat3=new wr(3),this._userEnabledStencil=!1,this._internalEnable=this.drawingContext.enable,this._internalDisable=this.drawingContext.disable,this.drawingContext.enable=l=>(l===this.drawingContext.STENCIL_TEST&&(this._clipping||(this._userEnabledStencil=!0)),this._internalEnable.call(this.drawingContext,l)),this.drawingContext.disable=l=>(l===this.drawingContext.STENCIL_TEST&&(this._userEnabledStencil=!1),this._internalDisable.call(this.drawingContext,l))}remove(){this.wrappedElt.remove(),this.wrappedElt=null,this.canvas=null,this.elt=null}beginGeometry(){if(this.geometryBuilder)throw new Error("It looks like `beginGeometry()` is being called while another p5.Geometry is already being build.");this.geometryBuilder=new wh(this),this.geometryBuilder.prevFillColor=this.states.fillColor,this.fill(new ir([-1,-1,-1,-1]))}endGeometry(){if(!this.geometryBuilder)throw new Error("Make sure you call beginGeometry() before endGeometry()!");const t=this.geometryBuilder.finish();return this.fill(this.geometryBuilder.prevFillColor),this.geometryBuilder=void 0,t}buildGeometry(t){return this.beginGeometry(),t(),this.endGeometry()}beginShape(...t){super.beginShape(...t)}curveDetail(t){if(t===void 0)return this.states.curveDetail;this.states.setValue("curveDetail",t)}drawShape(t){const r=new nk({curveDetail:this.states.curveDetail});t.accept(r),this.shapeBuilder.constructFromContours(t,r.contours),this.geometryBuilder?this.geometryBuilder.addImmediate(this.shapeBuilder.geometry,this.shapeBuilder.shapeMode):(this.states.fillColor||this.states.strokeColor)&&(this.shapeBuilder.shapeMode===up?this._drawPoints(this.shapeBuilder.geometry.vertices,this.buffers.point):this._drawGeometry(this.shapeBuilder.geometry,{mode:this.shapeBuilder.shapeMode,count:this.drawShapeCount})),this.drawShapeCount=1}endShape(t,r){this.drawShapeCount=r,super.endShape(t,r)}vertexProperty(...t){this.currentShape.vertexProperty(...t)}normal(t,r,i){t instanceof de?this.states.setValue("_currentNormal",t):this.states.setValue("_currentNormal",new de(t,r,i)),this.updateShapeVertexProperties()}model(t,r=1){t.vertices.length>0&&(this.geometryBuilder?this.geometryBuilder.addRetained(t):(this.geometryInHash(t.gid)||(t._edgesToVertices(),this._getOrMakeCachedBuffers(t)),this._drawGeometry(t,{count:r})))}_drawGeometry(t,{mode:r=Nu,count:i=1}={}){for(const s in t.userVertexProperties){const o=t.userVertexProperties[s];this.buffers.user.push(new hn(o.getDataSize(),o.getSrcName(),o.getDstName(),o.getName(),this))}this.states.fillColor&&t.vertices.length>=3&&![cl,up].includes(r)&&this._drawFills(t,{mode:r,count:i}),this.states.strokeColor&&t.lineVertices.length>=1&&this._drawStrokes(t,{count:i}),this.buffers.user=[]}_drawGeometryScaled(t,r,i,s){let o=this.states.uModelMatrix;this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone());try{this.states.uModelMatrix.scale(r,i,s),this.geometryBuilder?this.geometryBuilder.addRetained(t):this._drawGeometry(t)}finally{this.states.setValue("uModelMatrix",o)}}_drawFills(t,{count:r,mode:i}={}){this._useVertexColor=t.vertexColors.length>0;const s=!this._drawingFilter&&this.states.userFillShader?this.states.userFillShader:this._getFillShader();s.bindShader(),this._setGlobalUniforms(s),this._setFillUniforms(s),s.bindTextures();for(const o of this.buffers.fill)o._prepareBuffer(t,s);this._prepareUserAttributes(t,s),s.disableRemainingAttributes(),this._applyColorBlend(this.states.curFillColor,t.hasFillTransparency()),this._drawBuffers(t,{mode:i,count:r}),s.unbindShader()}_drawStrokes(t,{count:r}={}){const i=this.GL;this._useLineColor=t.vertexStrokeColors.length>0;const s=this._getStrokeShader();s.bindShader(),this._setGlobalUniforms(s),this._setStrokeUniforms(s),s.bindTextures();for(const o of this.buffers.stroke)o._prepareBuffer(t,s);if(this._prepareUserAttributes(t,s),s.disableRemainingAttributes(),this._applyColorBlend(this.states.curStrokeColor,t.hasStrokeTransparency()),r===1)i.drawArrays(i.TRIANGLES,0,t.lineVertices.length/3);else try{i.drawArraysInstanced(i.TRIANGLES,0,t.lineVertices.length/3,r)}catch{console.log(" p5.js says: Instancing is only supported in WebGL2 mode")}s.unbindShader()}_drawPoints(t,r){const i=this.GL,s=this._getPointShader();s.bindShader(),this._setGlobalUniforms(s),this._setPointUniforms(s),s.bindTextures(),this._bindBuffer(r,i.ARRAY_BUFFER,this._vToNArray(t),Float32Array,i.STATIC_DRAW),s.enableAttrib(s.attributes.aPosition,3),this._applyColorBlend(this.states.curStrokeColor),i.drawArrays(i.Points,0,t.length),s.unbindShader()}_prepareUserAttributes(t,r){for(const i of this.buffers.user){if(!this._pInst.constructor.disableFriendleErrors){const s=t.userVertexProperties[i.attr];if(s){const o=s.getSrcArray().length/s.getDataSize();o>t.vertices.length?this._pInst.constructor._friendlyError(`One of the geometries has a custom vertex property '${s.getName()}' with more values than vertices. This is probably caused by directly using the Geometry.vertexProperty() method.`,"vertexProperty()"):o<t.vertices.length&&this._pInst.constructor._friendlyError(`One of the geometries has a custom vertex property '${s.getName()}' with fewer values than vertices. This is probably caused by directly using the Geometry.vertexProperty() method.`,"vertexProperty()")}}i._prepareBuffer(t,r)}}_drawBuffers(t,{mode:r=this.GL.TRIANGLES,count:i}){const s=this.GL,o=this.geometryBufferCache.getCached(t);if(o)if(o.indexBuffer){if(this._bindBuffer(o.indexBuffer,s.ELEMENT_ARRAY_BUFFER),this._pInst.webglVersion!==Ir&&o.indexBufferType===s.UNSIGNED_INT&&!s.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");if(i===1)s.drawElements(s.TRIANGLES,t.faces.length*3,o.indexBufferType,0);else try{s.drawElementsInstanced(s.TRIANGLES,t.faces.length*3,o.indexBufferType,0,i)}catch{console.log(" p5.js says: Instancing is only supported in WebGL2 mode")}}else if(i===1)s.drawArrays(r,0,t.vertices.length);else try{s.drawArraysInstanced(r,0,t.vertices.length,i)}catch{console.log(" p5.js says: Instancing is only supported in WebGL2 mode")}}_getOrMakeCachedBuffers(t){return this.geometryBufferCache.ensureCached(t)}_setAttributeDefaults(t){const i={alpha:!0,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!0,preserveDrawingBuffer:!0,perPixelLighting:!0,version:2};t._glAttributes===null?t._glAttributes=i:t._glAttributes=Object.assign(i,t._glAttributes)}_initContext(){var t;if(((t=this._pInst._glAttributes)==null?void 0:t.version)!==1&&(this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)),this.webglVersion=this.drawingContext?Ir:To,this._pInst.webglVersion=this.webglVersion,this.drawingContext||(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes)),this.drawingContext===null)throw new Error("Error creating webgl context");{const r=this.drawingContext;r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}}_getMaxTextureSize(){const t=this.drawingContext;return t.getParameter(t.MAX_TEXTURE_SIZE)}_adjustDimensions(t,r){this._maxTextureSize||(this._maxTextureSize=this._getMaxTextureSize());let i=this._maxTextureSize,s=Math.floor(i/this._pixelDensity),o=Math.min(t,s),a=Math.min(r,s);return(o!==t||a!==r)&&console.warn(`Warning: The requested width/height exceeds hardware limits. Adjusting dimensions to width: ${o}, height: ${a}.`),{adjustedWidth:o,adjustedHeight:a}}_resetContext(t,r){const i=this.width,s=this.height,o=this.canvas.id,a=this._pInst instanceof pl,u={position:this.canvas.style.position,top:this.canvas.style.top,left:this.canvas.style.left};if(a){const c=this._pInst;c.canvas.parentNode.removeChild(c.canvas),c.canvas=document.createElement("canvas"),(c._pInst._userNode||document.body).appendChild(c.canvas),Lr.call(c,c.canvas,c._pInst),c.width=i,c.height=s}else{let c=this.canvas;c&&c.parentNode.removeChild(c),c=document.createElement("canvas"),c.id=o,this._pInst._userNode?this._pInst._userNode.appendChild(c):document.body.appendChild(c),this._pInst.canvas=c,this.canvas=c,this.canvas.style.position=u.position,this.canvas.style.top=u.top,this.canvas.style.left=u.left}const l=new at(this._pInst,i,s,!a,this._pInst.canvas);this._pInst._renderer=l,l._applyDefaults(),typeof r=="function"&&setTimeout(()=>{r.apply(window._renderer,t)},0)}_update(){this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.reset(),this.states.setValue("uViewMatrix",this.states.uViewMatrix.clone()),this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix),this.states.setValue("ambientLightColors",[]),this.states.setValue("specularColors",[1,1,1]),this.states.setValue("directionalLightDirections",[]),this.states.setValue("directionalLightDiffuseColors",[]),this.states.setValue("directionalLightSpecularColors",[]),this.states.setValue("pointLightPositions",[]),this.states.setValue("pointLightDiffuseColors",[]),this.states.setValue("pointLightSpecularColors",[]),this.states.setValue("spotLightPositions",[]),this.states.setValue("spotLightDirections",[]),this.states.setValue("spotLightDiffuseColors",[]),this.states.setValue("spotLightSpecularColors",[]),this.states.setValue("spotLightAngle",[]),this.states.setValue("spotLightConc",[]),this.states.setValue("enableLighting",!1),this.states.setValue("tint",[255,255,255,255]),this.GL.clearStencil(0),this.GL.clear(this.GL.DEPTH_BUFFER_BIT|this.GL.STENCIL_BUFFER_BIT),this._userEnabledStencil||this._internalDisable.call(this.GL,this.GL.STENCIL_TEST)}background(...t){const r=this._pInst.color(...t);this.clear(...r._getRGBA())}get uModelMatrix(){return this.states.uModelMatrix}get uViewMatrix(){return this.states.uViewMatrix}get uPMatrix(){return this.states.uPMatrix}get uMVMatrix(){const t=this.uModelMatrix.copy();return t.mult(this.uViewMatrix),t}getWorldToScreenMatrix(){const t=this.states.uModelMatrix,r=this.states.uViewMatrix,i=this.states.uPMatrix,s=new wr(4);return s.scale(this.width,this.height,1),s.translate([.5,.5,.5]),s.scale(.5,-.5,.5),t.copy().mult(r).mult(i).mult(s)}fill(...t){super.fill(...t);const r=this.states.fillColor;this.states.setValue("curFillColor",r._array),this.states.setValue("drawMode",cp),this.states.setValue("_useNormalMaterial",!1),this.states.setValue("_tex",null)}stroke(...t){super.stroke(...t),this.states.setValue("curStrokeColor",this.states.strokeColor._array)}getCommonVertexProperties(){return{...super.getCommonVertexProperties(),stroke:this.states.strokeColor,fill:this.states.fillColor,normal:this.states._currentNormal}}getSupportedIndividualVertexProperties(){return{textureCoordinates:!0}}strokeCap(t){this.curStrokeCap=t}strokeJoin(t){this.curStrokeJoin=t}getFilterLayer(){return this.filterLayer||(this.filterLayer=new hi(this)),this.filterLayer}getFilterLayerTemp(){return this.filterLayerTemp||(this.filterLayerTemp=new hi(this)),this.filterLayerTemp}matchSize(t,r){(t.width!==r.width||t.height!==r.height)&&t.resize(r.width,r.height),t.pixelDensity()!==r.pixelDensity()&&t.pixelDensity(r.pixelDensity())}filter(...t){let r=this.getFilterLayer(),i,s;typeof t[0]=="string"?(s=t[0],i=s in vp&&t[1]===void 0?vp[s]:t[1],s in this.defaultFilterShaders||(this.defaultFilterShaders[s]=new Wr(r.renderer,Lk,mz[s])),this.states.setValue("filterShader",this.defaultFilterShaders[s])):this.states.setValue("filterShader",t[0]);const o=this.activeFramebuffer()||this;this.matchSize(r,o),r.draw(()=>this.clear());let a=[1/(o.width*o.pixelDensity()),1/(o.height*o.pixelDensity())];if(s===hl){const u=this.getFilterLayerTemp();this.matchSize(u,o),this.push(),this.states.setValue("strokeColor",null),this.blendMode(vn),this.shader(this.states.filterShader),this.states.filterShader.setUniform("texelSize",a),this.states.filterShader.setUniform("canvasSize",[o.width,o.height]),this.states.filterShader.setUniform("radius",Math.max(1,i)),u.draw(()=>{this.states.filterShader.setUniform("direction",[1,0]),this.states.filterShader.setUniform("tex0",o),this.clear(),this.shader(this.states.filterShader),this.noLights(),this.plane(o.width,o.height)}),r.draw(()=>{this.states.filterShader.setUniform("direction",[0,1]),this.states.filterShader.setUniform("tex0",u),this.clear(),this.shader(this.states.filterShader),this.noLights(),this.plane(o.width,o.height)}),this.pop()}else r.draw(()=>{this.states.setValue("strokeColor",null),this.blendMode(vn),this.shader(this.states.filterShader),this.states.filterShader.setUniform("tex0",o),this.states.filterShader.setUniform("texelSize",a),this.states.filterShader.setUniform("canvasSize",[o.width,o.height]),this.states.filterShader.setUniform("filterParameter",i),this.noLights(),this.plane(o.width,o.height)});this.push(),this.states.setValue("strokeColor",null),this.clear(),this.push(),this.states.setValue("imageMode",qn),this.blendMode(vn),o.filterCamera._resize(),this.setCamera(o.filterCamera),this.resetMatrix(),this._drawingFilter=!0,this.image(r,0,0,this.width,this.height,-o.width/2,-o.height/2,o.width,o.height),this._drawingFilter=!1,this.clearDepth(),this.pop(),this.pop()}pixelDensity(t){return t?this._pInst.pixelDensity(t):this._pInst.pixelDensity()}blendMode(t){t===Pg||t===Mg||t===mh||t===vn||t===Lg||t===Bg||t===Og||t===Ug||t===Vg||t===Da?this.states.setValue("curBlendMode",t):(t===Z1||t===W1||t===K1||t===Y1||t===X1)&&console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")}erase(t,r){this._isErasing||(this.preEraseBlend=this.states.curBlendMode,this._isErasing=!0,this.blendMode(Da),this._cachedFillStyle=this.states.curFillColor.slice(),this.states.setValue("curFillColor",[1,1,1,t/255]),this._cachedStrokeStyle=this.states.curStrokeColor.slice(),this.states.setValue("curStrokeColor",[1,1,1,r/255]))}noErase(){this._isErasing&&(this.states.setValue("curFillColor",this._cachedFillStyle.slice()),this.states.setValue("curStrokeColor",this._cachedStrokeStyle.slice()),this.states.setValue("curBlendMode",this.preEraseBlend),this.blendMode(this.preEraseBlend),this._isErasing=!1,this._applyBlendMode())}drawTarget(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||this}beginClip(t={}){super.beginClip(t),this.drawTarget()._isClipApplied=!0;const r=this.GL;r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),this._internalEnable.call(r,r.STENCIL_TEST),this._stencilTestOn=!0,r.stencilFunc(r.ALWAYS,1,255),r.stencilOp(r.KEEP,r.KEEP,r.REPLACE),r.disable(r.DEPTH_TEST),this.push(),this.resetShader(),this.states.fillColor&&this.fill(0,0),this.states.strokeColor&&this.stroke(0,0)}endClip(){this.pop();const t=this.GL;t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(this._clipInvert?t.EQUAL:t.NOTEQUAL,0,255),t.enable(t.DEPTH_TEST),this._clipDepths.push(this._pushPopDepth),super.endClip()}_clearClip(){this.GL.clearStencil(1),this.GL.clear(this.GL.STENCIL_BUFFER_BIT),this._clipDepths.length>0&&this._clipDepths.pop(),this.drawTarget()._isClipApplied=!1}_getPixel(t,r){const i=this.GL;return Uk(i,null,t,r,i.RGBA,i.UNSIGNED_BYTE,this._pInst.height*this._pInst.pixelDensity())}loadPixels(){if(this._pInst._glAttributes.preserveDrawingBuffer!==!0){console.log("loadPixels only works in WebGL when preserveDrawingBuffer is true.");return}const t=this._pixelDensity,r=this.GL;this.pixels=zy(this.pixels,r,null,0,0,this.width*t,this.height*t,r.RGBA,r.UNSIGNED_BYTE,this.height*t)}updatePixels(){const t=this._getTempFramebuffer();t.pixels=this.pixels,t.updatePixels(),this.push(),this.resetMatrix(),this.clear(),this.states.setValue("imageMode",qn),this.image(t,0,0,t.width,t.height,-t.width/2,-t.height/2,t.width,t.height),this.pop(),this.GL.clearDepth(1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}_getTempFramebuffer(){return this._tempFramebuffer||(this._tempFramebuffer=new hi(this,{format:Qs,useDepth:this._pInst._glAttributes.depth,depthFormat:Mc,antialias:this._pInst._glAttributes.antialias})),this._tempFramebuffer}geometryInHash(t){return this.geometryBufferCache.isCached(t)}viewport(t,r){this._viewport=[0,0,t,r],this.GL.viewport(0,0,t,r)}resize(t,r){super.resize(t,r);const i={};for(const o in this.drawingContext){const a=this.drawingContext[o];typeof a!="object"&&typeof a!="function"&&(i[o]=a)}const s=this._adjustDimensions(t,r);t=s.adjustedWidth,r=s.adjustedHeight,this.width=t,this.height=r,this.canvas.width=t*this._pixelDensity,this.canvas.height=r*this._pixelDensity,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${r}px`,this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight},this.viewport(this._origViewport.width,this._origViewport.height),this.states.curCamera._resize(),typeof this.pixels<"u"&&(this.pixels=new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4));for(const o of this.framebuffers)o._canvasSizeChanged();for(const o in i)try{this.drawingContext[o]=i[o]}catch{}}clear(...t){const r=t[0]||0,i=t[1]||0,s=t[2]||0;let o=t[3]||0;const a=this.activeFramebuffer();a&&a.format===Qs&&!a.antialias&&o===0&&(o=1e-10),this.GL.clearColor(r*o,i*o,s*o,o),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)}clearDepth(t=1){this.GL.clearDepth(t),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}applyMatrix(t,r,i,s,o,a){this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),arguments.length===16?wr.prototype.apply.apply(this.states.uModelMatrix,arguments):this.states.uModelMatrix.apply([t,r,0,0,i,s,0,0,0,0,1,0,o,a,0,1])}translate(t,r,i){return t instanceof de&&(i=t.z,r=t.y,t=t.x),this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.translate([t,r,i]),this}scale(t,r,i){return this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.scale(t,r,i),this}rotate(t,r){return typeof r>"u"?this.rotateZ(t):(this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),wr.prototype.rotate4x4.apply(this.states.uModelMatrix,arguments),this)}rotateX(t){return this.rotate(t,1,0,0),this}rotateY(t){return this.rotate(t,0,1,0),this}rotateZ(t){return this.rotate(t,0,0,1),this}pop(...t){this._clipDepths.length>0&&this._pushPopDepth===this._clipDepths[this._clipDepths.length-1]&&(this._clearClip(),this._userEnabledStencil||this._internalDisable.call(this.GL,this.GL.STENCIL_TEST)),super.pop(...t),this._applyStencilTestIfClipping()}_applyStencilTestIfClipping(){const t=this.drawTarget();t._isClipApplied!==this._stencilTestOn&&(t._isClipApplied?(this._internalEnable.call(this.GL,this.GL.STENCIL_TEST),this._stencilTestOn=!0):(this._userEnabledStencil||this._internalDisable.call(this.GL,this.GL.STENCIL_TEST),this._stencilTestOn=!1))}resetMatrix(){return this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.reset(),this.states.setValue("uViewMatrix",this.states.uViewMatrix.clone()),this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix),this}_getStrokeShader(){const t=this.states.userStrokeShader;return t||this._getLineShader()}_getSphereMapping(t){return this.sphereMapping||(this.sphereMapping=this._pInst.createFilterShader(gz)),this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix),this.scratchMat3.invert(this.scratchMat3),this.sphereMapping.setUniform("uFovY",this.states.curCamera.cameraFOV),this.sphereMapping.setUniform("uAspect",this.states.curCamera.aspectRatio),this.sphereMapping.setUniform("uNewNormalMatrix",this.scratchMat3.mat3),this.sphereMapping.setUniform("uEnvMap",t),this.sphereMapping}_getFillShader(){return this._drawingImage?this.states.userImageShader&&!this._drawingFilter?this.states.userImageShader:this._getLightShader():this.states.userFillShader?this.states.userFillShader:this.states._useNormalMaterial?this._getNormalShader():this.states.enableLighting||this.states._tex?this._getLightShader():this._getColorShader()}_getPointShader(){const t=this.states.userPointShader;return!t||!t.isPointShader()?this._getPointShader():t}baseMaterialShader(){if(!this._pInst._glAttributes.perPixelLighting)throw new Error("The material shader does not support hooks without perPixelLighting. Try turning it back on.");return this._getLightShader()}_getLightShader(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","highp")+lr.phongVert,this._webGL2CompatibilityPrefix("frag","highp")+lr.phongFrag,{vertex:{"void beforeVertex":"() {}","Vertex getObjectInputs":"(Vertex inputs) { return inputs; }","Vertex getWorldInputs":"(Vertex inputs) { return inputs; }","Vertex getCameraInputs":"(Vertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","Inputs getPixelInputs":"(Inputs inputs) { return inputs; }","vec4 combineColors":`(ColorComponents components) {
                vec4 color = vec4(0.);
                color.rgb += components.diffuse * components.baseColor;
                color.rgb += components.ambient * components.ambientColor;
                color.rgb += components.specular * components.specularColor;
                color.rgb += components.emissive;
                color.a = components.opacity;
                return color;
              }`,"vec4 getFinalColor":"(vec4 color) { return color; }","void afterFragment":"() {}"}}):this._defaultLightShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","highp")+lr.lightVert,this._webGL2CompatibilityPrefix("frag","highp")+lr.lightTextureFrag)),this._defaultLightShader}baseNormalShader(){return this._getNormalShader()}_getNormalShader(){return this._defaultNormalShader||(this._defaultNormalShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","mediump")+lr.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+lr.normalFrag,{vertex:{"void beforeVertex":"() {}","Vertex getObjectInputs":"(Vertex inputs) { return inputs; }","Vertex getWorldInputs":"(Vertex inputs) { return inputs; }","Vertex getCameraInputs":"(Vertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","vec4 getFinalColor":"(vec4 color) { return color; }","void afterFragment":"() {}"}})),this._defaultNormalShader}baseColorShader(){return this._getColorShader()}_getColorShader(){return this._defaultColorShader||(this._defaultColorShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","mediump")+lr.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+lr.basicFrag,{vertex:{"void beforeVertex":"() {}","Vertex getObjectInputs":"(Vertex inputs) { return inputs; }","Vertex getWorldInputs":"(Vertex inputs) { return inputs; }","Vertex getCameraInputs":"(Vertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","vec4 getFinalColor":"(vec4 color) { return color; }","void afterFragment":"() {}"}})),this._defaultColorShader}pointShader(){return this._getPointShader()}_getPointShader(){return this._defaultPointShader||(this._defaultPointShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","mediump")+lr.pointVert,this._webGL2CompatibilityPrefix("frag","mediump")+lr.pointFrag,{vertex:{"void beforeVertex":"() {}","vec3 getLocalPosition":"(vec3 position) { return position; }","vec3 getWorldPosition":"(vec3 position) { return position; }","float getPointSize":"(float size) { return size; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","vec4 getFinalColor":"(vec4 color) { return color; }","bool shouldDiscard":"(bool outside) { return outside; }","void afterFragment":"() {}"}})),this._defaultPointShader}baseStrokeShader(){return this._getLineShader()}_getLineShader(){return this._defaultLineShader||(this._defaultLineShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","mediump")+lr.lineVert,this._webGL2CompatibilityPrefix("frag","mediump")+lr.lineFrag,{vertex:{"void beforeVertex":"() {}","StrokeVertex getObjectInputs":"(StrokeVertex inputs) { return inputs; }","StrokeVertex getWorldInputs":"(StrokeVertex inputs) { return inputs; }","StrokeVertex getCameraInputs":"(StrokeVertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","Inputs getPixelInputs":"(Inputs inputs) { return inputs; }","vec4 getFinalColor":"(vec4 color) { return color; }","bool shouldDiscard":"(bool outside) { return outside; }","void afterFragment":"() {}"}})),this._defaultLineShader}_getFontShader(){return this._defaultFontShader||(this.webglVersion===To&&this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","highp")+lr.fontVert,this._webGL2CompatibilityPrefix("frag","highp")+lr.fontFrag)),this._defaultFontShader}baseFilterShader(){return this._baseFilterShader||(this._baseFilterShader=new Wr(this,this._webGL2CompatibilityPrefix("vert","highp")+lr.filterBaseVert,this._webGL2CompatibilityPrefix("frag","highp")+lr.filterBaseFrag,{vertex:{},fragment:{"vec4 getColor":`(FilterInputs inputs, in sampler2D canvasContent) {
                return getTexture(canvasContent, inputs.texCoord);
              }`}})),this._baseFilterShader}_webGL2CompatibilityPrefix(t,r){let i="";return this.webglVersion===Ir&&(i+=`#version 300 es
#define WEBGL2
`),t==="vert"?i+=`#define VERTEX_SHADER
`:t==="frag"&&(i+=`#define FRAGMENT_SHADER
`),r&&(i+=`precision ${r} float;
`),i}_getEmptyTexture(){if(!this._emptyTexture){const t=new Io(1,1);t.set(0,0,255),this._emptyTexture=new Ss(this,t)}return this._emptyTexture}getTexture(t){let r=t;r instanceof hi&&(r=r.color);const i=this.textures.get(r);if(i)return i;const s=new Ss(this,r);return this.textures.set(r,s),s}getDiffusedTexture(t){if(this.diffusedTextures.get(t)!=null)return this.diffusedTextures.get(t);let r,i=200,s=i,o=Math.floor(i*(t.height/t.width));return r=new hi(this,{width:s,height:o,density:1}),this.diffusedShader||(this.diffusedShader=this._pInst.createShader(lr.imageLightVert,lr.imageLightDiffusedFrag)),r.draw(()=>{this.shader(this.diffusedShader),this.diffusedShader.setUniform("environmentMap",t),this.states.setValue("strokeColor",null),this.noLights(),this.plane(s,o)}),this.diffusedTextures.set(t,r),r}getSpecularTexture(t){if(this.specularTextures.get(t)!=null)return this.specularTextures.get(t);const r=512;let i;const s=[],o=new hi(this,{width:r,height:r,density:1});let a=Math.log(r)/Math.log(2);this.specularShader||(this.specularShader=this._pInst.createShader(lr.imageLightVert,lr.imageLightSpecularFrag));for(let u=r;u>=1;u/=2){o.resize(u,u);let c=1-Math.log(u)/Math.log(2)/a;o.draw(()=>{this.shader(this.specularShader),this.clear(),this.specularShader.setUniform("environmentMap",t),this.specularShader.setUniform("roughness",c),this.states.setValue("strokeColor",null),this.noLights(),this.plane(u,u)}),s.push(o.get().drawingContext.getImageData(0,0,u,u))}return o.remove(),i=new jk(this,s,{}),this.specularTextures.set(t,i),i}activeFramebuffer(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||null}createFramebuffer(t){return new hi(this,t)}_setGlobalUniforms(t){const r=this.states.uModelMatrix,i=this.states.uViewMatrix,s=this.states.uPMatrix,o=r.copy().mult(i);if(t.setUniform("uPerspective",this.states.curCamera.useLinePerspective?1:0),t.setUniform("uViewMatrix",i.mat4),t.setUniform("uProjectionMatrix",s.mat4),t.setUniform("uModelMatrix",r.mat4),t.setUniform("uModelViewMatrix",o.mat4),t.uniforms.uModelViewProjectionMatrix){const a=o.copy();a.mult(s),t.setUniform("uModelViewProjectionMatrix",a.mat4)}t.uniforms.uNormalMatrix&&(this.scratchMat3.inverseTranspose4x4(o),t.setUniform("uNormalMatrix",this.scratchMat3.mat3)),t.uniforms.uModelNormalMatrix&&(this.scratchMat3.inverseTranspose4x4(this.states.uModelMatrix),t.setUniform("uModelNormalMatrix",this.scratchMat3.mat3)),t.uniforms.uCameraNormalMatrix&&(this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix),t.setUniform("uCameraNormalMatrix",this.scratchMat3.mat3)),t.uniforms.uCameraRotation&&(this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix),t.setUniform("uCameraRotation",this.scratchMat3.mat3)),t.setUniform("uViewport",this._viewport)}_setStrokeUniforms(t){t.setUniform("uSimpleLines",this._simpleLines),t.setUniform("uUseLineColor",this._useLineColor),t.setUniform("uMaterialColor",this.states.curStrokeColor),t.setUniform("uStrokeWeight",this.states.strokeWeight),t.setUniform("uStrokeCap",Ok[this.curStrokeCap]),t.setUniform("uStrokeJoin",Vk[this.curStrokeJoin])}_setFillUniforms(t){this.mixedSpecularColor=[...this.states.curSpecularColor];const r=this._getEmptyTexture();this.states._useMetalness>0&&(this.mixedSpecularColor=this.mixedSpecularColor.map((u,l)=>this.states.curFillColor[l]*this.states._useMetalness+u*(1-this.states._useMetalness))),t.setUniform("uUseVertexColor",this._useVertexColor),t.setUniform("uMaterialColor",this.states.curFillColor),t.setUniform("isTexture",!!this.states._tex),t.setUniform("uSampler",this.states._tex||r),t.setUniform("uTint",this.states.tint),t.setUniform("uHasSetAmbient",this.states._hasSetAmbient),t.setUniform("uAmbientMatColor",this.states.curAmbientColor),t.setUniform("uSpecularMatColor",this.mixedSpecularColor),t.setUniform("uEmissiveMatColor",this.states.curEmissiveColor),t.setUniform("uSpecular",this.states._useSpecularMaterial),t.setUniform("uEmissive",this.states._useEmissiveMaterial),t.setUniform("uShininess",this.states._useShininess),t.setUniform("uMetallic",this.states._useMetalness),this._setImageLightUniforms(t),t.setUniform("uUseLighting",this.states.enableLighting);const i=this.states.pointLightDiffuseColors.length/3;t.setUniform("uPointLightCount",i),t.setUniform("uPointLightLocation",this.states.pointLightPositions),t.setUniform("uPointLightDiffuseColors",this.states.pointLightDiffuseColors),t.setUniform("uPointLightSpecularColors",this.states.pointLightSpecularColors);const s=this.states.directionalLightDiffuseColors.length/3;t.setUniform("uDirectionalLightCount",s),t.setUniform("uLightingDirection",this.states.directionalLightDirections),t.setUniform("uDirectionalDiffuseColors",this.states.directionalLightDiffuseColors),t.setUniform("uDirectionalSpecularColors",this.states.directionalLightSpecularColors);const o=this.states.ambientLightColors.length/3;this.mixedAmbientLight=[...this.states.ambientLightColors],this.states._useMetalness>0&&(this.mixedAmbientLight=this.mixedAmbientLight.map(u=>{let l=u-this.states._useMetalness;return Math.max(0,l)})),t.setUniform("uAmbientLightCount",o),t.setUniform("uAmbientColor",this.mixedAmbientLight);const a=this.states.spotLightDiffuseColors.length/3;t.setUniform("uSpotLightCount",a),t.setUniform("uSpotLightAngle",this.states.spotLightAngle),t.setUniform("uSpotLightConc",this.states.spotLightConc),t.setUniform("uSpotLightDiffuseColors",this.states.spotLightDiffuseColors),t.setUniform("uSpotLightSpecularColors",this.states.spotLightSpecularColors),t.setUniform("uSpotLightLocation",this.states.spotLightPositions),t.setUniform("uSpotLightDirection",this.states.spotLightDirections),t.setUniform("uConstantAttenuation",this.states.constantAttenuation),t.setUniform("uLinearAttenuation",this.states.linearAttenuation),t.setUniform("uQuadraticAttenuation",this.states.quadraticAttenuation)}_setImageLightUniforms(t){if(t.setUniform("uUseImageLight",this.states.activeImageLight!=null),this.states.activeImageLight){let r=this.getDiffusedTexture(this.states.activeImageLight);t.setUniform("environmentMapDiffused",r);let i=this.getSpecularTexture(this.states.activeImageLight);t.setUniform("environmentMapSpecular",i)}}_setPointUniforms(t){t.setUniform("uMaterialColor",this.states.curStrokeColor),t.setUniform("uPointSize",this.states.strokeWeight*this._pixelDensity)}_bindBuffer(t,r,i,s,o){if(r||(r=this.GL.ARRAY_BUFFER),this.GL.bindBuffer(r,t),i!==void 0){let a=i;i instanceof oa?a=i.dataArray():a instanceof(s||Float32Array)||(a=new(s||Float32Array)(a)),this.GL.bufferData(r,a,o||this.GL.STATIC_DRAW)}}_arraysEqual(t,r){return t.length!==r.length?!1:t.every((s,o)=>s===r[o])}_isTypedArray(t){return[Float32Array,Float64Array,Int16Array,Uint16Array,Uint32Array].some(r=>t instanceof r)}_vToNArray(t){return t.flatMap(r=>[r.x,r.y,r.z])}}function Bk(n,t){n.RendererGL=at,t.setAttributes=function(r,i){if(typeof this._glAttributes>"u"){console.log("You are trying to use setAttributes on a p5.Graphics object that does not use a WEBGL renderer.");return}let s=!0;if(typeof i<"u"?(this._glAttributes===null&&(this._glAttributes={}),this._glAttributes[r]!==i&&(this._glAttributes[r]=i,s=!1)):r instanceof Object&&this._glAttributes!==r&&(this._glAttributes=r,s=!1),!(!this._renderer.isP3D||s)){if(!this._setupDone&&this._renderer.geometryBufferCache.numCached()>0){n._friendlyError("Sorry, Could not set the attributes, you need to call setAttributes() before calling the other drawing methods in setup()");return}this._renderer._resetContext(),this._renderer.states.curCamera&&(this._renderer.states.curCamera._renderer=this._renderer)}},t._assert3d=function(r){if(!this._renderer.isP3D)throw new Error(`${r}() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information.`)},n.renderers[To]=n.RendererGL,n.renderers[Ir]=n.RendererGL}function zy(n,t,r,i,s,o,a,u,l,c){const h=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,r);const f=u===t.RGBA?4:3,d=o*a*f,p=l===t.UNSIGNED_BYTE?Uint8Array:Float32Array;if((!(n instanceof p)||n.length!==d)&&(n=new p(d)),t.readPixels(i,c?c-s-a:s,o,a,u,l,n),t.bindFramebuffer(t.FRAMEBUFFER,h),c){const g=Math.floor(a/2),y=new p(o*f);for(let v=0;v<g;v++){const T=v*o*4,_=(a-v-1)*o*4;y.set(n.subarray(T,T+o*4)),n.copyWithin(T,_,_+o*4),n.set(y,_)}}return n}function Uk(n,t,r,i,s,o,a){const u=n.getParameter(n.FRAMEBUFFER_BINDING);n.bindFramebuffer(n.FRAMEBUFFER,t);const l=s===n.RGBA?4:3,c=o===n.UNSIGNED_BYTE?Uint8Array:Float32Array,h=new c(l);return n.readPixels(r,a?a-i-1:i,1,1,s,o,h),n.bindFramebuffer(n.FRAMEBUFFER,u),Array.from(h)}typeof p5<"u"&&Bk(p5,p5.prototype);function E_(n,t){t.strokeMode=function(i){if(i===void 0)return this._renderer._simpleLines?Sy:Cy;if(i===Sy)this._renderer._simpleLines=!0;else if(i===Cy)this._renderer._simpleLines=!1;else throw Error("no such parameter")},t.buildGeometry=function(i){return this._renderer.buildGeometry(i)},t.freeGeometry=function(i){this._renderer.geometryBufferCache.freeBuffers(i.gid)},t.plane=function(i=50,s=i,o=1,a=1){return this._assert3d("plane"),this._renderer.plane(i,s,o,a),this},t.box=function(i,s,o,a,u){return this._assert3d("box"),this._renderer.box(i,s,o,a,u),this},t.sphere=function(i=50,s=24,o=16){return this._assert3d("sphere"),this._renderer.sphere(i,s,o),this},t.cylinder=function(i=50,s=i,o=24,a=1,u=!0,l=!0){return this._assert3d("cylinder"),this._renderer.cylinder(i,s,o,a,u,l),this},t.cone=function(i=50,s=i,o=24,a=1,u=!0){return this._assert3d("cone"),this._renderer.cone(i,s,o,a,u),this},t.ellipsoid=function(i=50,s=i,o=i,a=24,u=16){return this._assert3d("ellipsoid"),this._renderer.ellipsoid(i,s,o,a,u),this},t.torus=function(i,s,o,a){return this._assert3d("torus"),this._renderer.torus(i,s,o,a),this},at.prototype.point=function(i,s,o=0){const a=[];return a.push(new de(i,s,o)),this._drawPoints(a,this.buffers.point),this},at.prototype.triangle=function(i){const s=i[0],o=i[1],a=i[2],u=i[3],l=i[4],c=i[5],h="tri";if(!this.geometryInHash(h)){const d=function(){const g=[];g.push(new de(0,0,0)),g.push(new de(1,0,0)),g.push(new de(0,1,0)),this.edges=[[0,1],[1,2],[2,0]],this.vertices=g,this.faces=[[0,1,2]],this.uvs=[0,0,1,0,1,1]},p=new Hr(1,1,d,this);p._edgesToVertices(),p.computeNormals(),p.gid=h,this.geometryBufferCache.ensureCached(p)}const f=this.states.uModelMatrix.copy();try{const d=Math.sign(s*u-a*o+a*c-l*u+l*o-s*c),p=new wr([a-s,u-o,0,0,l-s,c-o,0,0,0,0,d,0,s,o,0,1]).mult(this.states.uModelMatrix);this.states.setValue("uModelMatrix",p),this._drawGeometry(this.geometryBufferCache.getGeometryByID(h))}finally{this.states.setValue("uModelMatrix",f)}return this},at.prototype.ellipse=function(i){this.arc(i[0],i[1],i[2],i[3],0,pn,Ia,i[4])},at.prototype.arc=function(...i){const s=i[0],o=i[1],a=i[2],u=i[3],l=i[4],c=i[5],h=i[6],f=i[7]||25;let d,p;if(Math.abs(c-l)>=pn?(d="ellipse",p=`${d}|${f}|`):(d="arc",p=`${d}|${l}|${c}|${h}|${f}|`),!this.geometryInHash(p)){const y=function(){if(l.toFixed(10)!==c.toFixed(10)){(h===gh||typeof h>"u")&&(this.vertices.push(new de(.5,.5,0)),this.uvs.push([.5,.5]));for(let T=0;T<=f;T++){const _=T/f,C=(c-l)*_+l,E=.5+Math.cos(C)/2,S=.5+Math.sin(C)/2;this.vertices.push(new de(E,S,0)),this.uvs.push([E,S]),T<f-1&&(this.faces.push([0,T+1,T+2]),this.edges.push([T+1,T+2]))}switch(h){case gh:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,1]),this.edges.push([this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,this.vertices.length-1]);break;case lp:this.edges.push([0,1]),this.edges.push([0,this.vertices.length-1]);break;case Ia:this.edges.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([this.vertices.length-2,this.vertices.length-1])}}},v=new Hr(f,1,y,this);v.computeNormals(),f<=50?v._edgesToVertices(v):this.states.strokeColor&&console.log(`Cannot apply a stroke to an ${d} with more than 50 detail`),v.gid=p,this.geometryBufferCache.ensureCached(v)}const g=this.states.uModelMatrix;this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone());try{this.states.uModelMatrix.translate([s,o,0]),this.states.uModelMatrix.scale(a,u,1),this._drawGeometry(this.geometryBufferCache.getGeometryByID(p))}finally{this.states.setValue("uModelMatrix",g)}return this},at.prototype.rect=function(i){const s=i[0],o=i[1],a=i[2],u=i[3];if(typeof i[4]>"u"){const l=this._pInst._glAttributes.perPixelLighting,c=i[4]||(l?1:24),h=i[5]||(l?1:16),f=`rect|${c}|${h}`;if(!this.geometryInHash(f)){const p=function(){for(let y=0;y<=this.detailY;y++){const v=y/this.detailY;for(let T=0;T<=this.detailX;T++){const _=T/this.detailX,C=new de(_,v,0);this.vertices.push(C),this.uvs.push(_,v)}}c>0&&h>0&&(this.edges=[[0,c],[c,(c+1)*(h+1)-1],[(c+1)*(h+1)-1,(c+1)*h],[(c+1)*h,0]])},g=new Hr(c,h,p,this);g.computeFaces().computeNormals()._edgesToVertices(),g.gid=f,this.geometryBufferCache.ensureCached(g)}const d=this.states.uModelMatrix;this.states.setValue("uModelMatrix",this.states.uModelMatrix.copy());try{this.states.uModelMatrix.translate([s,o,0]),this.states.uModelMatrix.scale(a,u,1),this._drawGeometry(this.geometryBufferCache.getGeometryByID(f))}finally{this.states.setValue("uModelMatrix",d)}}else{let l=i[4],c=typeof i[5]>"u"?l:i[5],h=typeof i[6]>"u"?c:i[6],f=typeof i[7]>"u"?h:i[7],d=s,p=o,g=a,y=u;if(g+=d,y+=p,d>g){const x=d;d=g,g=x}if(p>y){const x=p;p=y,y=x}const v=Math.min((g-d)/2,(y-p)/2);l>v&&(l=v),c>v&&(c=v),h>v&&(h=v),f>v&&(f=v);let T=d,_=p,C=g,E=y;const S=this.states.textureMode;this.states.setValue("textureMode",Ri);const R=this.bezierOrder();this.bezierOrder(2),this.beginShape();const w=(x,b)=>[x,b,(x-T)/a,(b-_)/u];c!==0?(this.vertex(...w(C-c,_)),this.bezierVertex(...w(C,_)),this.bezierVertex(...w(C,_+c))):this.vertex(...w(C,_)),h!==0?(this.vertex(...w(C,E-h)),this.bezierVertex(...w(C,E)),this.bezierVertex(...w(C-h,E))):this.vertex(...w(C,E)),f!==0?(this.vertex(...w(T+f,E)),this.bezierVertex(...w(T,E)),this.bezierVertex(...w(T,E-f))):this.vertex(...w(T,E)),l!==0?(this.vertex(...w(T,_+l)),this.bezierVertex(...w(T,_)),this.bezierVertex(...w(T+l,_))):this.vertex(...w(T,_)),this.endShape(ph),this.states.setValue("textureMode",S),this.bezierOrder(R)}return this},at.prototype.quad=function(i,s,o,a,u,l,c,h,f,d,p,g,y=2,v=2){const T=`quad|${i}|${s}|${o}|${a}|${u}|${l}|${c}|${h}|${f}|${d}|${p}|${g}|${y}|${v}`;if(!this.geometryInHash(T)){const _=new Hr(y,v,function(){let E=1/(this.detailX-1),S=1/(this.detailY-1);for(let R=0;R<this.detailY;R++)for(let w=0;w<this.detailX;w++){let x=w*E,b=R*S,A=(1-b)*i+b*d,k=(1-b)*s+b*p,N=(1-b)*o+b*g,I=(1-b)*a+b*c,j=(1-b)*u+b*h,Q=(1-b)*l+b*f,le=(1-x)*A+x*I,fe=(1-x)*k+x*j,ne=(1-x)*N+x*Q;this.vertices.push(new de(le,fe,ne)),this.uvs.push([x,b])}},this);_.faces=[];for(let E=0;E<v-1;E++)for(let S=0;S<y-1;S++){let R=S+E*y,w=S+1+E*y,x=S+1+(E+1)*y,b=S+(E+1)*y;_.faces.push([R,w,x]),_.faces.push([R,x,b])}_.computeNormals(),_.edges.length=0;const C=[0,2,3,1];for(let E=0;E<C.length;E++){const S=C[E],R=C[(E+1)%C.length];_.edges.push([S,R])}_._edgesToVertices(),_.gid=T,this.geometryBufferCache.ensureCached(_)}return this._drawGeometry(this.geometryBufferCache.getGeometryByID(T)),this},at.prototype.bezier=function(i,s,o,a,u,l,c,h,f,d,p,g){arguments.length===8&&(p=h,d=c,h=l,c=u,u=a,a=o,o=l=f=g=0),this.bezierOrder(),this.bezierOrder(3),this.beginShape(),this.vertex(i,s,o),this.bezierVertex(a,u,l),this.bezierVertex(c,h,f),this.bezierVertex(d,p,g),this.endShape()},at.prototype.curve=function(i,s,o,a,u,l,c,h,f,d,p,g){arguments.length===8&&(d=c,p=h,c=u,h=a,a=o,u=a,o=l=f=g=0),this.beginShape(),this.splineVertex(i,s,o),this.splineVertex(a,u,l),this.splineVertex(c,h,f),this.splineVertex(d,p,g),this.endShape()},at.prototype.line=function(...i){return i.length===6?(this.beginShape(cl),this.vertex(i[0],i[1],i[2]),this.vertex(i[3],i[4],i[5]),this.endShape()):i.length===4&&(this.beginShape(cl),this.vertex(i[0],i[1],0),this.vertex(i[2],i[3],0),this.endShape()),this},at.prototype.image=function(i,s,o,a,u,l,c,h,f){this._isErasing&&this.blendMode(this._cachedBlendMode),this.push(),this.noLights(),this.states.setValue("strokeColor",null),this.texture(i),this.states.setValue("textureMode",Ri);let d=0;s<=i.width&&(d=s/i.width);let p=1;s+a<=i.width&&(p=(s+a)/i.width);let g=0;o<=i.height&&(g=o/i.height);let y=1;o+u<=i.height&&(y=(o+u)/i.height),this._drawingImage=!0,this.beginShape(),this.vertex(l,c,0,d,g),this.vertex(l+h,c,0,p,g),this.vertex(l+h,c+f,0,p,y),this.vertex(l,c+f,0,d,y),this.endShape(ph),this._drawingImage=!1,this.pop(),this._isErasing&&this.blendMode(Da)};const r=function(i,s,o,a,u,l,c){i=i<=0?1:i,s=s<0?0:s,o=o<=0?i:o,a=a<3?3:a,u=u<1?1:u,l=l===void 0?!0:l,c=c===void 0?s!==0:c;const h=l?-2:0,f=u+(c?2:0),d=Math.atan2(i-s,o),p=Math.sin(d),g=Math.cos(d);let y,v,T;for(y=h;y<=f;++y){let C=y/u,E=o*C,S;for(y<0?(E=0,C=0,S=i):y>u?(E=o,C=1,S=s):S=i+(s-i)*C,(y===-2||y===u+2)&&(S=0),E-=o/2,v=0;v<a;++v){const R=v/(a-1),w=2*Math.PI*R,x=Math.sin(w),b=Math.cos(w);this.vertices.push(new de(x*S,E,b*S));let A;y<0?A=new de(0,-1,0):y>u&&s?A=new de(0,1,0):A=new de(x*g,p,b*g),this.vertexNormals.push(A),this.uvs.push(R,C)}}let _=0;if(l){for(T=0;T<a;++T){const C=(T+1)%a;this.faces.push([_+T,_+a+C,_+a+T])}_+=a*2}for(y=0;y<u;++y){for(v=0;v<a;++v){const C=(v+1)%a;this.faces.push([_+v,_+C,_+a+C]),this.faces.push([_+v,_+a+C,_+a+v])}_+=a}if(c)for(_+=a,v=0;v<a;++v)this.faces.push([_+v,_+(v+1)%a,_+a])};at.prototype.plane=function(i=50,s=i,o=1,a=1){const u=`plane|${o}|${a}`;if(!this.geometryInHash(u)){const l=function(){let h,f,d;for(let p=0;p<=this.detailY;p++){f=p/this.detailY;for(let g=0;g<=this.detailX;g++)h=g/this.detailX,d=new de(h-.5,f-.5,0),this.vertices.push(d),this.uvs.push(h,f)}},c=new Hr(o,a,l,this);c.computeFaces().computeNormals(),o<=1&&a<=1?c._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on plane objects with more than 1 detailX or 1 detailY"),c.gid=u,this.geometryBufferCache.ensureCached(c)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(u),i,s,1)},at.prototype.box=function(i=50,s=i,o=s,a,u){const l=this.attributes&&this.attributes.perPixelLighting;typeof a>"u"&&(a=l?1:4),typeof u>"u"&&(u=l?1:4);const c=`box|${a}|${u}`;if(!this.geometryInHash(c)){const h=function(){const d=[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]];this.edges=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]],d.forEach((p,g)=>{const y=g*4;for(let v=0;v<4;v++){const T=p[v],_=new de(((T&1)*2-1)/2,((T&2)-1)/2,((T&4)/2-1)/2);this.vertices.push(_),this.uvs.push(v&1,(v&2)/2)}this.faces.push([y,y+1,y+2]),this.faces.push([y+2,y+1,y+3])})},f=new Hr(a,u,h,this);f.computeNormals(),a<=4&&u<=4?f._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on box objects with more than 4 detailX or 4 detailY"),f.gid=c,this.geometryBufferCache.ensureCached(f)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(c),i,s,o)},at.prototype.sphere=function(i=50,s=24,o=16){this.ellipsoid(i,i,i,s,o)},at.prototype.ellipsoid=function(i=50,s=i,o=i,a=24,u=16){const l=`ellipsoid|${a}|${u}`;if(!this.geometryInHash(l)){const c=function(){for(let f=0;f<=this.detailY;f++){const d=f/this.detailY,p=Math.PI*d-Math.PI/2,g=Math.cos(p),y=Math.sin(p);for(let v=0;v<=this.detailX;v++){const T=v/this.detailX,_=2*Math.PI*T,C=Math.cos(_),E=Math.sin(_),S=new n.Vector(g*E,y,g*C);this.vertices.push(S),this.vertexNormals.push(S),this.uvs.push(T,d)}}},h=new Hr(a,u,c,this);h.computeFaces(),a<=24&&u<=24?h._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on ellipsoids with more than 24 detailX or 24 detailY"),h.gid=l,this.geometryBufferCache.ensureCached(h)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(l),i,s,o)},at.prototype.cylinder=function(i=50,s=i,o=24,a=1,u=!0,l=!0){const c=`cylinder|${o}|${a}|${u}|${l}`;if(!this.geometryInHash(c)){const h=new n.Geometry(o,a,function(){r.call(this,1,1,1,o,a,u,l)},this);o<=24&&a<=16?h._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on cylinder objects with more than 24 detailX or 16 detailY"),h.gid=c,this.geometryBufferCache.ensureCached(h)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(c),i,s,i)},at.prototype.cone=function(i=50,s=i,o=24,a=1,u=!0){const l=`cone|${o}|${a}|${u}`;if(!this.geometryInHash(l)){const c=new Hr(o,a,function(){r.call(this,1,0,1,o,a,u,!1)},this);o<=24&&a<=16?c._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on cone objects with more than 24 detailX or 16 detailY"),c.gid=l,this.geometryBufferCache.ensureCached(c)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(l),i,s,i)},at.prototype.torus=function(i=50,s=10,o=24,a=16){if(i===0||s===0)return;const u=(s/i).toPrecision(4),l=`torus|${u}|${o}|${a}`;if(!this.geometryInHash(l)){const c=function(){for(let f=0;f<=this.detailY;f++){const d=f/this.detailY,p=2*Math.PI*d,g=Math.cos(p),y=Math.sin(p),v=1+u*g;for(let T=0;T<=this.detailX;T++){const _=T/this.detailX,C=2*Math.PI*_,E=Math.cos(C),S=Math.sin(C),R=new de(v*E,v*S,u*y),w=new de(g*E,g*S,y);this.vertices.push(R),this.vertexNormals.push(w),this.uvs.push(_,d)}}},h=new Hr(o,a,c,this);h.computeFaces(),o<=24&&a<=16?h._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw strokes on torus object with more than 24 detailX or 16 detailY"),h.gid=l,this.geometryBufferCache.ensureCached(h)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(l),i,i,i)},t.curveDetail=function(i){if(!(this._renderer instanceof at))throw new Error("curveDetail() only works in WebGL mode. Did you mean to call createCanvas(width, height, WEBGL)?");return this._renderer.curveDetail(i)}}typeof p5<"u"&&E_(p5,p5.prototype);function S_(n,t){t.ambientLight=function(r,i,s,o){return this._assert3d("ambientLight"),this._renderer.ambientLight(...arguments),this},t.specularColor=function(r,i,s){return this._assert3d("specularColor"),this._renderer.specularColor(...arguments),this},t.directionalLight=function(r,i,s,o,a,u){return this._assert3d("directionalLight"),this._renderer.directionalLight(...arguments),this},t.pointLight=function(r,i,s,o,a,u){return this._assert3d("pointLight"),this._renderer.pointLight(...arguments),this},t.imageLight=function(r){this._renderer.imageLight(r)},t.panorama=function(r){this.filter(this._renderer._getSphereMapping(r))},t.lights=function(){return this._assert3d("lights"),this._renderer.lights(),this},t.lightFalloff=function(r,i,s){return this._assert3d("lightFalloff"),this._renderer.lightFalloff(r,i,s),this},t.spotLight=function(r,i,s,o,a,u,l,c,h,f,d){return this._assert3d("spotLight"),this._renderer.spotLight(...arguments),this},t.noLights=function(...r){return this._assert3d("noLights"),this._renderer.noLights(),this},at.prototype.ambientLight=function(r,i,s,o){const a=this._pInst.color(...arguments);this.states.setValue("ambientLightColors",[...this.states.ambientLightColors]),this.states.ambientLightColors.push(a._array[0],a._array[1],a._array[2]),this.states.setValue("enableLighting",!0)},at.prototype.specularColor=function(r,i,s){const o=this._pInst.color(...arguments);this.states.setValue("specularColors",[o._array[0],o._array[1],o._array[2]])},at.prototype.directionalLight=function(r,i,s,o,a,u){let l;r instanceof ir?l=r:l=this._pInst.color(r,i,s);let c,h,f;const d=arguments[arguments.length-1];typeof d=="number"?(c=arguments[arguments.length-3],h=arguments[arguments.length-2],f=arguments[arguments.length-1]):(c=d.x,h=d.y,f=d.z);const p=Math.sqrt(c*c+h*h+f*f);this.states.setValue("directionalLightDirections",[...this.states.directionalLightDirections]),this.states.directionalLightDirections.push(c/p,h/p,f/p),this.states.setValue("directionalLightDiffuseColors",[...this.states.directionalLightDiffuseColors]),this.states.directionalLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),this.states.setValue("directionalLightSpecularColors",[...this.states.directionalLightSpecularColors]),Array.prototype.push.apply(this.states.directionalLightSpecularColors,this.states.specularColors),this.states.setValue("enableLighting",!0)},at.prototype.pointLight=function(r,i,s,o,a,u){let l;r instanceof ir?l=r:l=this._pInst.color(r,i,s);let c,h,f;const d=arguments[arguments.length-1];typeof d=="number"?(c=arguments[arguments.length-3],h=arguments[arguments.length-2],f=arguments[arguments.length-1]):(c=d.x,h=d.y,f=d.z),this.states.setValue("pointLightPositions",[...this.states.pointLightPositions]),this.states.pointLightPositions.push(c,h,f),this.states.setValue("pointLightDiffuseColors",[...this.states.pointLightDiffuseColors]),this.states.pointLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),this.states.setValue("pointLightSpecularColors",[...this.states.pointLightSpecularColors]),Array.prototype.push.apply(this.states.pointLightSpecularColors,this.states.specularColors),this.states.setValue("enableLighting",!0)},at.prototype.imageLight=function(r){this.states.setValue("activeImageLight",r),this.states.setValue("enableLighting",!0)},at.prototype.lights=function(){const r=this._pInst.color("rgb(128,128,128)");this.ambientLight(r),this.directionalLight(r,0,0,-1)},at.prototype.lightFalloff=function(r,i,s){r<0&&(r=0,console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")),i<0&&(i=0,console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")),s<0&&(s=0,console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")),r===0&&i===0&&s===0&&(r=1,console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")),this.states.setValue("constantAttenuation",r),this.states.setValue("linearAttenuation",i),this.states.setValue("quadraticAttenuation",s)},at.prototype.spotLight=function(r,i,s,o,a,u,l,c,h,f,d){let p,g,y;const v=arguments.length;switch(v){case 11:case 10:p=this._pInst.color(r,i,s),g=new de(o,a,u),y=new de(l,c,h);break;case 9:r instanceof ir?(p=r,g=new de(i,s,o),y=new de(a,u,l),f=c,d=h):o instanceof de?(p=this._pInst.color(r,i,s),g=o,y=new de(a,u,l),f=c,d=h):l instanceof de?(p=this._pInst.color(r,i,s),g=new de(o,a,u),y=l,f=c,d=h):(p=this._pInst.color(r,i,s),g=new de(o,a,u),y=new de(l,c,h));break;case 8:r instanceof ir?(p=r,g=new de(i,s,o),y=new de(a,u,l),f=c):o instanceof de?(p=this._pInst.color(r,i,s),g=o,y=new de(a,u,l),f=c):(p=this._pInst.color(r,i,s),g=new de(o,a,u),y=l,f=c);break;case 7:r instanceof ir&&i instanceof de?(p=r,g=i,y=new de(s,o,a),f=u,d=l):r instanceof ir&&a instanceof de?(p=r,g=new de(i,s,o),y=a,f=u,d=l):o instanceof de&&a instanceof de?(p=this._pInst.color(r,i,s),g=o,y=a,f=u,d=l):r instanceof ir?(p=r,g=new de(i,s,o),y=new de(a,u,l)):o instanceof de?(p=this._pInst.color(r,i,s),g=o,y=new de(a,u,l)):(p=this._pInst.color(r,i,s),g=new de(o,a,u),y=l);break;case 6:o instanceof de&&a instanceof de?(p=this._pInst.color(r,i,s),g=o,y=a,f=u):r instanceof ir&&a instanceof de?(p=r,g=new de(i,s,o),y=a,f=u):r instanceof ir&&i instanceof de&&(p=r,g=i,y=new de(s,o,a),f=u);break;case 5:r instanceof ir&&i instanceof de&&s instanceof de?(p=r,g=i,y=s,f=o,d=a):o instanceof de&&a instanceof de?(p=this._pInst.color(r,i,s),g=o,y=a):r instanceof ir&&a instanceof de?(p=r,g=new de(i,s,o),y=a):r instanceof ir&&i instanceof de&&(p=r,g=i,y=new de(s,o,a));break;case 4:p=r,g=i,y=s,f=o;break;case 3:p=r,g=i,y=s;break;default:console.warn(`Sorry, input for spotlight() is not in prescribed format. Too ${v<3?"few":"many"} arguments were provided`);return}this.states.setValue("spotLightDiffuseColors",[p._array[0],p._array[1],p._array[2]]),this.states.setValue("spotLightSpecularColors",[...this.states.specularColors]),this.states.setValue("spotLightPositions",[g.x,g.y,g.z]),y.normalize(),this.states.setValue("spotLightDirections",[y.x,y.y,y.z]),f===void 0&&(f=Math.PI/3),d!==void 0&&d<1?(d=1,console.warn("Value of concentration needs to be greater than 1. Setting it to 1")):d===void 0&&(d=100),f=this._pInst._toRadians(f),this.states.setValue("spotLightAngle",[Math.cos(f)]),this.states.setValue("spotLightConc",[d]),this.states.setValue("enableLighting",!0)},at.prototype.noLights=function(){this.states.setValue("activeImageLight",null),this.states.setValue("enableLighting",!1),this.states.setValue("ambientLightColors",[]),this.states.setValue("specularColors",[1,1,1]),this.states.setValue("directionalLightDirections",[]),this.states.setValue("directionalLightDiffuseColors",[]),this.states.setValue("directionalLightSpecularColors",[]),this.states.setValue("pointLightPositions",[]),this.states.setValue("pointLightDiffuseColors",[]),this.states.setValue("pointLightSpecularColors",[]),this.states.setValue("spotLightPositions",[]),this.states.setValue("spotLightDirections",[]),this.states.setValue("spotLightDiffuseColors",[]),this.states.setValue("spotLightSpecularColors",[]),this.states.setValue("spotLightAngle",[]),this.states.setValue("spotLightConc",[]),this.states.setValue("constantAttenuation",1),this.states.setValue("linearAttenuation",0),this.states.setValue("quadraticAttenuation",0),this.states.setValue("_useShininess",1),this.states.setValue("_useMetalness",0)}}typeof p5<"u"&&S_(p5,p5.prototype);function $k(n,t){t.loadShader=async function(r,i,s,o){const a=new Wr;try{return a._vertSrc=(await Bn(r,"text")).data,a._fragSrc=(await Bn(i,"text")).data,s?s(a):a}catch(u){if(o)return o(u);throw u}},t.createShader=function(r,i,s){return new Wr(this._renderer,r,i,s)},t.loadFilterShader=async function(r,i,s){try{const a=await(await this.loadStrings(r)).join(`
`),u=this.createFilterShader(a,!0);return i&&i(u),u}catch(o){s?s(o):console.error(o)}},t.createFilterShader=function(r,i=!1){let a=r.includes("#version 300 es")?`#version 300 es
      uniform mat4 uModelViewMatrix;
      uniform mat4 uProjectionMatrix;

      in vec3 aPosition;
      in vec2 aTexCoord;
      out vec2 vTexCoord;

      void main() {
        // transferring texcoords for the frag shader
        vTexCoord = aTexCoord;

        // copy position with a fourth coordinate for projection (1.0 is normal)
        vec4 positionVec4 = vec4(aPosition, 1.0);

        // project to 3D space
        gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
      }
    `:`
      uniform mat4 uModelViewMatrix;
      uniform mat4 uProjectionMatrix;

      attribute vec3 aPosition;
      // texcoords only come from p5 to vertex shader
      // so pass texcoords on to the fragment shader in a varying variable
      attribute vec2 aTexCoord;
      varying vec2 vTexCoord;

      void main() {
        // transferring texcoords for the frag shader
        vTexCoord = aTexCoord;

        // copy position with a fourth coordinate for projection (1.0 is normal)
        vec4 positionVec4 = vec4(aPosition, 1.0);

        // project to 3D space
        gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
      }
    `;const u=new Wr(this._renderer,a,r);return i||(this._renderer.GL?u.ensureCompiledOnContext(this._renderer):u.ensureCompiledOnContext(this)),u},t.shader=function(r){return this._assert3d("shader"),this._renderer.shader(r),this},t.strokeShader=function(r){return this._assert3d("strokeShader"),this._renderer.strokeShader(r),this},t.imageShader=function(r){return this._assert3d("imageShader"),this._renderer.imageShader(r),this},t.baseMaterialShader=function(){return this._assert3d("baseMaterialShader"),this._renderer.baseMaterialShader()},t.baseFilterShader=function(){return(this._renderer.filterRenderer||this._renderer).baseFilterShader()},t.baseNormalShader=function(){return this._assert3d("baseNormalShader"),this._renderer.baseNormalShader()},t.baseColorShader=function(){return this._assert3d("baseColorShader"),this._renderer.baseColorShader()},t.baseStrokeShader=function(){return this._assert3d("baseStrokeShader"),this._renderer.baseStrokeShader()},t.resetShader=function(){return this._renderer.resetShader(),this},t.texture=function(r){return this._assert3d("texture"),r.gifProperties&&r._animateGif(this),this._renderer.texture(r),this},t.textureMode=function(r){r!==Gg&&r!==Ri?console.warn(`You tried to set ${r} textureMode only supports IMAGE & NORMAL `):this._renderer.states.setValue("textureMode",r)},t.textureWrap=function(r,i=r){this._renderer.states.setValue("textureWrapX",r),this._renderer.states.setValue("textureWrapY",i);for(const s of this._renderer.textures.values())s.setWrapMode(r,i)},t.normalMaterial=function(...r){return this._assert3d("normalMaterial"),this._renderer.normalMaterial(...r),this},t.ambientMaterial=function(r,i,s){this._assert3d("ambientMaterial");const o=t.color.apply(this,arguments);return this._renderer.states.setValue("_hasSetAmbient",!0),this._renderer.states.setValue("curAmbientColor",o._array),this._renderer.states.setValue("_useNormalMaterial",!1),this._renderer.states.setValue("enableLighting",!0),this._renderer.states.fillColor||this._renderer.states.setValue("fillColor",new ir([1,1,1])),this},t.emissiveMaterial=function(r,i,s,o){this._assert3d("emissiveMaterial");const a=t.color.apply(this,arguments);return this._renderer.states.setValue("curEmissiveColor",a._array),this._renderer.states.setValue("_useEmissiveMaterial",!0),this._renderer.states.setValue("_useNormalMaterial",!1),this._renderer.states.setValue("enableLighting",!0),this},t.specularMaterial=function(r,i,s,o){this._assert3d("specularMaterial");const a=t.color.apply(this,arguments);return this._renderer.states.setValue("curSpecularColor",a._array),this._renderer.states.setValue("_useSpecularMaterial",!0),this._renderer.states.setValue("_useNormalMaterial",!1),this._renderer.states.setValue("enableLighting",!0),this},t.shininess=function(r){return this._assert3d("shininess"),this._renderer.shininess(r),this},t.metalness=function(r){return this._assert3d("metalness"),this._renderer.metalness(r),this},at.prototype._applyColorBlend=function(r,i){const s=this.GL,o=this.states.drawMode===hp,a=i||this.states.userFillShader||this.states.userStrokeShader||this.states.userPointShader||o||this.states.curBlendMode!==vn||r[r.length-1]<1||this._isErasing;return a!==this._isBlending&&(a||this.states.curBlendMode!==vn&&this.states.curBlendMode!==mh?s.enable(s.BLEND):s.disable(s.BLEND),s.depthMask(!0),this._isBlending=a),this._applyBlendMode(),r},at.prototype._applyBlendMode=function(){if(this._cachedBlendMode===this.states.curBlendMode)return;const r=this.GL;switch(this.states.curBlendMode){case vn:r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case mh:r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE);break;case Da:r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.ONE_MINUS_SRC_ALPHA);break;case Vg:r.blendEquation(r.FUNC_ADD),r.blendFunc(r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA);break;case Bg:r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_COLOR);break;case Og:r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.ONE_MINUS_DST_COLOR,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE);break;case Ug:r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO);break;case Lg:r.blendEquationSeparate(r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD),r.blendFuncSeparate(r.ONE,r.ONE,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case Pg:this.blendExt?(r.blendEquationSeparate(this.blendExt.MIN||this.blendExt.MIN_EXT,r.FUNC_ADD),r.blendFuncSeparate(r.ONE,r.ONE,r.ONE,r.ONE)):console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.");break;case Mg:this.blendExt?(r.blendEquationSeparate(this.blendExt.MAX||this.blendExt.MAX_EXT,r.FUNC_ADD),r.blendFuncSeparate(r.ONE,r.ONE,r.ONE,r.ONE)):console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.");break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.");break}this._cachedBlendMode=this.states.curBlendMode},at.prototype.shader=function(r){this.states.setValue("userFillShader",r),this.states.setValue("_useNormalMaterial",!1),r.ensureCompiledOnContext(this),r.setDefaultUniforms()},at.prototype.strokeShader=function(r){this.states.setValue("userStrokeShader",r),r.ensureCompiledOnContext(this),r.setDefaultUniforms()},at.prototype.imageShader=function(r){this.states.setValue("userImageShader",r),r.ensureCompiledOnContext(this),r.setDefaultUniforms()},at.prototype.resetShader=function(){this.states.setValue("userFillShader",null),this.states.setValue("userStrokeShader",null),this.states.setValue("userImageShader",null)},at.prototype.texture=function(r){this.states.setValue("drawMode",hp),this.states.setValue("_useNormalMaterial",!1),this.states.setValue("_tex",r),this.states.setValue("fillColor",new ir([1,1,1]))},at.prototype.normalMaterial=function(...r){this.states.setValue("drawMode",cp),this.states.setValue("_useSpecularMaterial",!1),this.states.setValue("_useEmissiveMaterial",!1),this.states.setValue("_useNormalMaterial",!0),this.states.setValue("curFillColor",[1,1,1,1]),this.states.setValue("fillColor",new ir([1,1,1])),this.states.setValue("strokeColor",null)},at.prototype.shininess=function(r){r<1&&(r=1),this.states.setValue("_useShininess",r)},at.prototype.metalness=function(r){const i=1-Math.exp(-r/100);this.states.setValue("_useMetalness",i)}}typeof p5<"u"&&loading(p5,p5.prototype);class pl{constructor(t,r,i,s,o){const a=i||Ta;return this._pInst=s,this._renderer=new Ed[a](this._pInst,t,r,!1,o),this._initializeInstanceVariables(this),this._renderer._applyDefaults(),this}get deltaTime(){return this._pInst.deltaTime}get canvas(){var t;return(t=this._renderer)==null?void 0:t.canvas}get drawingContext(){return this._renderer.drawingContext}get width(){var t;return(t=this._renderer)==null?void 0:t.width}get height(){var t;return(t=this._renderer)==null?void 0:t.height}get pixels(){var t;return(t=this._renderer)==null?void 0:t.pixels}pixelDensity(t){let r;return typeof t=="number"?(t!==this._renderer._pixelDensity&&(this._renderer._pixelDensity=t),r=this,this.resizeCanvas(this.width,this.height,!0)):r=this._renderer._pixelDensity,r}resizeCanvas(t,r){this._renderer.resize(t,r)}reset(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()}remove(){this._renderer.remove(),this._renderer=void 0}createFramebuffer(t){return new hi(this._renderer,t)}_assert3d(t){if(!this._renderer.isP3D)throw new Error(`${t}() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information.`)}_initializeInstanceVariables(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._downKeys={}}}function yz(n,t){n.Graphics=pl,c_(n,n.Graphics.prototype),h_(n,n.Graphics.prototype),f_(n,n.Graphics.prototype),d_(n,n.Graphics.prototype),a_(n,n.Graphics.prototype),p_(n,n.Graphics.prototype),__(n,n.Graphics.prototype),v_(n,n.Graphics.prototype),m_(n,n.Graphics.prototype),n_(n,n.Graphics.prototype),E_(n,n.Graphics.prototype),S_(n,n.Graphics.prototype),$k(n,n.Graphics.prototype),o_(n,n.Graphics.prototype),y_(n,n.Graphics.prototype)}class Ss{constructor(t,r,i){this._renderer=t;const s=this._renderer.GL;i=i||{},this.src=r,this.glTex=void 0,this.glTarget=s.TEXTURE_2D,this.glFormat=i.format||s.RGBA,this.mipmaps=!1,this.glMinFilter=i.minFilter||s.LINEAR,this.glMagFilter=i.magFilter||s.LINEAR,this.glWrapS=i.wrapS||s.CLAMP_TO_EDGE,this.glWrapT=i.wrapT||s.CLAMP_TO_EDGE,this.glDataType=i.dataType||s.UNSIGNED_BYTE;const o=Gk(t);this.glFormat===s.HALF_FLOAT&&!o.halfFloat&&(console.log("This device does not support dataType HALF_FLOAT. Falling back to FLOAT."),this.glDataType=s.FLOAT),this.glFormat===s.HALF_FLOAT&&(this.glMinFilter===s.LINEAR||this.glMagFilter===s.LINEAR)&&!o.halfFloatLinear&&(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===s.LINEAR&&(this.glMinFilter=s.NEAREST),this.glMagFilter===s.LINEAR&&(this.glMagFilter=s.NEAREST)),this.glFormat===s.FLOAT&&!o.float&&(console.log("This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE."),this.glDataType=s.UNSIGNED_BYTE),this.glFormat===s.FLOAT&&(this.glMinFilter===s.LINEAR||this.glMagFilter===s.LINEAR)&&!o.floatLinear&&(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===s.LINEAR&&(this.glMinFilter=s.NEAREST),this.glMagFilter===s.LINEAR&&(this.glMagFilter=s.NEAREST)),this.isSrcMediaElement=!1,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=typeof Lr<"u"&&r instanceof Lr&&!(r instanceof pl)&&!(r instanceof st),this.isSrcP5Image=r instanceof Io,this.isSrcP5Graphics=r instanceof pl,this.isSrcP5Renderer=r instanceof st,this.isImageData=typeof ImageData<"u"&&r instanceof ImageData,this.isFramebufferTexture=r instanceof bp;const a=this._getTextureDataFromSource();return this.width=a.width,this.height=a.height,this.init(a),this}remove(){this.glTex&&(this._renderer.GL.deleteTexture(this.glTex),this.glTex=void 0)}_getTextureDataFromSource(){let t;return this.isFramebufferTexture?t=this.src.rawTexture():this.isSrcP5Image?t=this.src.canvas:this.isSrcMediaElement||this.isSrcHTMLElement?(this.src._ensureCanvas&&this.src._ensureCanvas(),t=this.src.elt):this.isSrcP5Graphics||this.isSrcP5Renderer?t=this.src.canvas:this.isImageData&&(t=this.src),t}init(t){const r=this._renderer.GL;if(this.isFramebufferTexture||(this.glTex=r.createTexture()),this.glWrapS=this._renderer.states.textureWrapX,this.glWrapT=this._renderer.states.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.glMagFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.glMinFilter),!this.isFramebufferTexture)if(this.width===0||this.height===0||this.isSrcMediaElement&&!this.src.loadedmetadata){const i=new Uint8Array([1,1,1,1]);r.texImage2D(this.glTarget,0,r.RGBA,1,1,0,this.glFormat,this.glDataType,i)}else r.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,t)}update(){const t=this.src;if(t.width===0||t.height===0)return!1;if(this.isFramebufferTexture)return this.src.update(),!1;const r=this._getTextureDataFromSource();let i=!1;const s=this._renderer.GL;return r.width!==this.width||r.height!==this.height?(i=!0,this.width=r.width||t.width,this.height=r.height||t.height,this.isSrcP5Image?t.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&t.setModified&&t.setModified(!0)):this.isSrcP5Image?t.isModified()&&(i=!0,t.setModified(!1)):this.isSrcMediaElement?t.isModified()?(i=!0,t.setModified(!1)):t.loadedmetadata&&this._videoPrevUpdateTime!==t.time()&&(this._videoPrevUpdateTime=t.time(),i=!0):this.isImageData?t._dirty&&(t._dirty=!1,i=!0):i=!0,i&&(this.bindTexture(),s.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,r)),i}bindTexture(){return this._renderer.GL.bindTexture(this.glTarget,this.getTexture()),this}unbindTexture(){this._renderer.GL.bindTexture(this.glTarget,null)}getTexture(){return this.isFramebufferTexture?this.src.rawTexture():this.glTex}setInterpolation(t,r){const i=this._renderer.GL;this.glMinFilter=this.glFilter(t),this.glMagFilter=this.glFilter(r),this.bindTexture(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.glMinFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()}glFilter(t){const r=this._renderer.GL;return t===s5?r.NEAREST:r.LINEAR}setWrapMode(t,r){const i=this._renderer.GL,s=h=>(h&h-1)===0,o=this._getTextureDataFromSource();let a,u;o.naturalWidth&&o.naturalHeight?(a=o.naturalWidth,u=o.naturalHeight):(a=this.width,u=this.height);const l=s(a),c=s(u);t===Dy?this._renderer.webglVersion===Ir||l&&c?this.glWrapS=i.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=i.CLAMP_TO_EDGE):t===Ny?this._renderer.webglVersion===Ir||l&&c?this.glWrapS=i.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=i.CLAMP_TO_EDGE):this.glWrapS=i.CLAMP_TO_EDGE,r===Dy?this._renderer.webglVersion===Ir||l&&c?this.glWrapT=i.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=i.CLAMP_TO_EDGE):r===Ny?this._renderer.webglVersion===Ir||l&&c?this.glWrapT=i.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=i.CLAMP_TO_EDGE):this.glWrapT=i.CLAMP_TO_EDGE,this.bindTexture(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,this.glWrapS),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()}}class jk extends Ss{constructor(t,r,i){super(t,r,i);const s=this._renderer.GL;this.glMinFilter===s.LINEAR&&(this.glMinFilter=s.LINEAR_MIPMAP_LINEAR)}glFilter(t){return this._renderer.GL.LINEAR_MIPMAP_LINEAR}_getTextureDataFromSource(){return this.src}init(t){const r=this._renderer.GL;this.glTex=r.createTexture(),this.bindTexture();for(let i=0;i<t.length;i++)r.texImage2D(this.glTarget,i,this.glFormat,this.glFormat,this.glDataType,t[i]);this.glMinFilter=r.LINEAR_MIPMAP_LINEAR,r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.glMagFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.glMinFilter),this.unbindTexture()}update(){}}function C_(n,t){n.Texture=Ss,n.MipmapTexture=jk}function Gk({GL:n,webglVersion:t}){const r=n,i=t===Ir?r.getExtension("EXT_color_buffer_float")&&r.getExtension("EXT_float_blend"):r.getExtension("OES_texture_float"),s=i&&r.getExtension("OES_texture_float_linear"),o=t===Ir?r.getExtension("EXT_color_buffer_float"):r.getExtension("OES_texture_half_float"),a=o&&r.getExtension("OES_texture_half_float_linear");return{float:i,floatLinear:s,halfFloat:o,halfFloatLinear:a}}typeof p5<"u"&&C_(p5,p5.prototype);const iu=(n,t,r)=>Math.max(Math.min(n,r),t);class zk extends Ma{constructor(t){super(t.renderer),this.fbo=t,this.yScale=-1}_computeCameraDefaultSettings(){super._computeCameraDefaultSettings(),this.defaultAspectRatio=this.fbo.width/this.fbo.height,this.defaultCameraFOV=2*Math.atan(this.fbo.height/2/this.defaultEyeZ)}}class bp{constructor(t,r){this.framebuffer=t,this.property=r}get width(){return this.framebuffer.width*this.framebuffer.density}get height(){return this.framebuffer.height*this.framebuffer.density}update(){this.framebuffer._update(this.property)}rawTexture(){return this.framebuffer[this.property]}}class hi{constructor(t,r={}){this.renderer=t,this.renderer.framebuffers.add(this),this._isClipApplied=!1,this.dirty={colorTexture:!1,depthTexture:!1},this.pixels=[],this.format=r.format||Qs,this.channels=r.channels||(this.renderer._pInst._glAttributes.alpha?yd:nr),this.useDepth=r.depth===void 0?!0:r.depth,this.depthFormat=r.depthFormat||An,this.textureFiltering=r.textureFiltering||Iy,r.antialias===void 0?this.antialiasSamples=this.renderer._pInst._glAttributes.antialias?2:0:typeof r.antialias=="number"?this.antialiasSamples=r.antialias:this.antialiasSamples=r.antialias?2:0,this.antialias=this.antialiasSamples>0,this.antialias&&this.renderer.webglVersion!==Ir&&(console.warn("Antialiasing is unsupported in a WebGL 1 context"),this.antialias=!1),this.density=r.density||this.renderer._pixelDensity;const i=this.renderer.GL;if(this.gl=i,r.width&&r.height){const o=this.renderer._adjustDimensions(r.width,r.height);this.width=o.adjustedWidth,this.height=o.adjustedHeight,this._autoSized=!1}else r.width===void 0!=(r.height===void 0)&&console.warn("Please supply both width and height for a framebuffer to give it a size. Only one was given, so the framebuffer will match the size of its canvas."),this.width=this.renderer.width,this.height=this.renderer.height,this._autoSized=!0;if(this._checkIfFormatsAvailable(),r.stencil&&!this.useDepth&&console.warn("A stencil buffer can only be used if also using depth. Since the framebuffer has no depth buffer, the stencil buffer will be ignored."),this.useStencil=this.useDepth&&(r.stencil===void 0?!0:r.stencil),this.framebuffer=i.createFramebuffer(),!this.framebuffer)throw new Error("Unable to create a framebuffer");if(this.antialias&&(this.aaFramebuffer=i.createFramebuffer(),!this.aaFramebuffer))throw new Error("Unable to create a framebuffer for antialiasing");this._recreateTextures();const s=this.renderer.states.curCamera;this.defaultCamera=this.createCamera(),this.filterCamera=this.createCamera(),this.renderer.states.setValue("curCamera",s),this.draw(()=>this.renderer.clear())}resize(t,r){this._autoSized=!1;const i=this.renderer._adjustDimensions(t,r);t=i.adjustedWidth,r=i.adjustedHeight,this.width=t,this.height=r,this._handleResize()}pixelDensity(t){if(t)this._autoSized=!1,this.density=t,this._handleResize();else return this.density}autoSized(t){if(t===void 0)return this._autoSized;this._autoSized=t,this._handleResize()}_checkIfFormatsAvailable(){const t=this.gl;this.useDepth&&this.renderer.webglVersion===To&&!t.getExtension("WEBGL_depth_texture")&&(console.warn("Unable to create depth textures in this environment. Falling back to a framebuffer without depth."),this.useDepth=!1),this.useDepth&&this.renderer.webglVersion===To&&this.depthFormat===An&&(console.warn("FLOAT depth format is unavailable in WebGL 1. Defaulting to UNSIGNED_INT."),this.depthFormat=Mc),[Qs,An,pu].includes(this.format)||(console.warn("Unknown Framebuffer format. Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. Defaulting to UNSIGNED_BYTE."),this.format=Qs),this.useDepth&&![Mc,An].includes(this.depthFormat)&&(console.warn("Unknown Framebuffer depth format. Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT."),this.depthFormat=An);const r=Gk(this.renderer);!r.float&&this.format===An&&(console.warn("This environment does not support FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=Qs),this.useDepth&&!r.float&&this.depthFormat===An&&(console.warn("This environment does not support FLOAT depth textures. Falling back to UNSIGNED_INT."),this.depthFormat=Mc),!r.halfFloat&&this.format===pu&&(console.warn("This environment does not support HALF_FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=Qs),this.channels===nr&&[An,pu].includes(this.format)&&(console.warn("FLOAT and HALF_FLOAT formats do not work cross-platform with only RGB channels. Falling back to RGBA."),this.channels=yd)}_recreateTextures(){const t=this.gl;this._updateSize();const r=t.getParameter(t.TEXTURE_BINDING_2D),i=t.getParameter(t.FRAMEBUFFER_BINDING),s=t.createTexture();if(!s)throw new Error("Unable to create color texture");t.bindTexture(t.TEXTURE_2D,s);const o=this._glColorFormat();if(t.texImage2D(t.TEXTURE_2D,0,o.internalFormat,this.width*this.density,this.height*this.density,0,o.format,o.type,null),this.colorTexture=s,t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),this.useDepth){const u=t.createTexture();if(!u)throw new Error("Unable to create depth texture");const l=this._glDepthFormat();t.bindTexture(t.TEXTURE_2D,u),t.texImage2D(t.TEXTURE_2D,0,l.internalFormat,this.width*this.density,this.height*this.density,0,l.format,l.type,null),t.framebufferTexture2D(t.FRAMEBUFFER,this.useStencil?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,t.TEXTURE_2D,u,0),this.depthTexture=u}if(this.antialias){if(this.colorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.colorRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,t.getParameter(t.MAX_SAMPLES))),o.internalFormat,this.width*this.density,this.height*this.density),this.useDepth){const u=this._glDepthFormat();this.depthRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,t.getParameter(t.MAX_SAMPLES))),u.internalFormat,this.width*this.density,this.height*this.density)}t.bindFramebuffer(t.FRAMEBUFFER,this.aaFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this.colorRenderbuffer),this.useDepth&&t.framebufferRenderbuffer(t.FRAMEBUFFER,this.useStencil?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthRenderbuffer)}if(this.useDepth){this.depth=new bp(this,"depthTexture");const u=t.NEAREST;this.depthP5Texture=new Ss(this.renderer,this.depth,{minFilter:u,magFilter:u}),this.renderer.textures.set(this.depth,this.depthP5Texture)}this.color=new bp(this,"colorTexture");const a=this.textureFiltering===Iy?t.LINEAR:t.NEAREST;this.colorP5Texture=new Ss(this.renderer,this.color,{minFilter:a,magFilter:a}),this.renderer.textures.set(this.color,this.colorP5Texture),t.bindTexture(t.TEXTURE_2D,r),t.bindFramebuffer(t.FRAMEBUFFER,i)}_glColorFormat(){let t,r,i;const s=this.gl;return this.format===An?t=s.FLOAT:this.format===pu?t=this.renderer.webglVersion===Ir?s.HALF_FLOAT:s.getExtension("OES_texture_half_float").HALF_FLOAT_OES:t=s.UNSIGNED_BYTE,this.channels===yd?r=s.RGBA:r=s.RGB,this.renderer.webglVersion===Ir?i={[s.FLOAT]:{[s.RGBA]:s.RGBA32F},[s.HALF_FLOAT]:{[s.RGBA]:s.RGBA16F},[s.UNSIGNED_BYTE]:{[s.RGBA]:s.RGBA8,[s.RGB]:s.RGB8}}[t][r]:this.format===pu?i=s.RGBA:i=r,{internalFormat:i,format:r,type:t}}_glDepthFormat(){let t,r,i;const s=this.gl;return this.useStencil?this.depthFormat===An?t=s.FLOAT_32_UNSIGNED_INT_24_8_REV:this.renderer.webglVersion===Ir?t=s.UNSIGNED_INT_24_8:t=s.getExtension("WEBGL_depth_texture").UNSIGNED_INT_24_8_WEBGL:this.depthFormat===An?t=s.FLOAT:t=s.UNSIGNED_INT,this.useStencil?r=s.DEPTH_STENCIL:r=s.DEPTH_COMPONENT,this.useStencil?this.depthFormat===An?i=s.DEPTH32F_STENCIL8:this.renderer.webglVersion===Ir?i=s.DEPTH24_STENCIL8:i=s.DEPTH_STENCIL:this.renderer.webglVersion===Ir?this.depthFormat===An?i=s.DEPTH_COMPONENT32F:i=s.DEPTH_COMPONENT24:i=s.DEPTH_COMPONENT,{internalFormat:i,format:r,type:t}}_updateSize(){this._autoSized&&(this.width=this.renderer.width,this.height=this.renderer.height,this.density=this.renderer._pixelDensity)}_canvasSizeChanged(){this._autoSized&&this._handleResize()}_handleResize(){const t=this.color,r=this.depth,i=this.colorRenderbuffer,s=this.depthRenderbuffer;this._deleteTexture(t),r&&this._deleteTexture(r);const o=this.gl;i&&o.deleteRenderbuffer(i),s&&o.deleteRenderbuffer(s),this._recreateTextures(),this.defaultCamera._resize()}createCamera(){const t=new zk(this);return t._computeCameraDefaultSettings(),t._setDefaultCamera(),t}_deleteTexture(t){this.gl.deleteTexture(t.rawTexture()),this.renderer.textures.delete(t)}remove(){const t=this.gl;this._deleteTexture(this.color),this.depth&&this._deleteTexture(this.depth),t.deleteFramebuffer(this.framebuffer),this.aaFramebuffer&&t.deleteFramebuffer(this.aaFramebuffer),this.depthRenderbuffer&&t.deleteRenderbuffer(this.depthRenderbuffer),this.colorRenderbuffer&&t.deleteRenderbuffer(this.colorRenderbuffer),this.renderer.framebuffers.delete(this)}begin(){this.prevFramebuffer=this.renderer.activeFramebuffer(),this.prevFramebuffer&&this.prevFramebuffer._beforeEnd(),this.renderer.activeFramebuffers.push(this),this._beforeBegin(),this.renderer.push(),this.renderer.states.setValue("curCamera",this.defaultCamera),this.renderer.states.setValue("uPMatrix",this.renderer.states.uPMatrix.clone()),this.renderer.states.uPMatrix.set(this.defaultCamera.projMatrix),this.renderer.states.setValue("uViewMatrix",this.renderer.states.uViewMatrix.clone()),this.renderer.states.uViewMatrix.set(this.defaultCamera.cameraMatrix),this.renderer.resetMatrix(),this.renderer.states.uViewMatrix.set(this.renderer.states.curCamera.cameraMatrix),this.renderer.states.uModelMatrix.reset(),this.renderer._applyStencilTestIfClipping()}_framebufferToBind(){return this.antialias?this.aaFramebuffer:this.framebuffer}_update(t){if(this.dirty[t]&&this.antialias){const r=this.gl;r.bindFramebuffer(r.READ_FRAMEBUFFER,this.aaFramebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.framebuffer);const i={colorTexture:[r.COLOR_BUFFER_BIT,this.colorP5Texture.glMagFilter]};this.useDepth&&(i.depthTexture=[r.DEPTH_BUFFER_BIT,this.depthP5Texture.glMagFilter]);const[s,o]=i[t];r.blitFramebuffer(0,0,this.width*this.density,this.height*this.density,0,0,this.width*this.density,this.height*this.density,s,o),this.dirty[t]=!1;const a=this.renderer.activeFramebuffer();a?r.bindFramebuffer(r.FRAMEBUFFER,a._framebufferToBind()):r.bindFramebuffer(r.FRAMEBUFFER,null)}}_beforeBegin(){const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebufferToBind()),this.renderer.viewport(this.width*this.density,this.height*this.density)}_beforeEnd(){this.antialias&&(this.dirty={colorTexture:!0,depthTexture:!0})}end(){const t=this.gl;if(this.renderer.pop(),this.renderer.activeFramebuffers.pop()!==this)throw new Error("It looks like you've called end() while another Framebuffer is active.");this._beforeEnd(),this.prevFramebuffer?this.prevFramebuffer._beforeBegin():(t.bindFramebuffer(t.FRAMEBUFFER,null),this.renderer.viewport(this.renderer._origViewport.width,this.renderer._origViewport.height)),this.renderer._applyStencilTestIfClipping()}draw(t){this.begin(),t(),this.end()}loadPixels(){this._update("colorTexture");const t=this.gl,r=this.renderer.activeFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer);const i=this._glColorFormat();this.pixels=zy(this.pixels,t,this.framebuffer,0,0,this.width*this.density,this.height*this.density,i.format,i.type),r?t.bindFramebuffer(t.FRAMEBUFFER,r._framebufferToBind()):t.bindFramebuffer(t.FRAMEBUFFER,null)}get(t,r,i,s){this._update("colorTexture");const o=this._glColorFormat();if(t===void 0&&r===void 0)t=0,r=0,i=this.width,s=this.height;else if(i===void 0&&s===void 0)return(t<0||r<0||t>=this.width||r>=this.height)&&(console.warn("The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped."),t=iu(t,0,this.width-1),r=iu(r,0,this.height-1)),Uk(this.gl,this.framebuffer,t*this.density,r*this.density,o.format,o.type);t=iu(t,0,this.width-1),r=iu(r,0,this.height-1),i=iu(i,1,this.width-t),s=iu(s,1,this.height-r);const a=zy(void 0,this.gl,this.framebuffer,t*this.density,r*this.density,i*this.density,s*this.density,o.format,o.type),u=new Uint8ClampedArray(i*s*this.density*this.density*4);u.fill(255);const l=o.type===this.gl.RGB?3:4;for(let h=0;h<s*this.density;h++)for(let f=0;f<i*this.density;f++)for(let d=0;d<4;d++){const p=(h*i*this.density+f)*4+d;if(d<l){const g=l===4?p:(h*i*this.density+f)*l+d;u[p]=a[g]}}const c=new Io(i*this.density,s*this.density);return c.imageData=c.canvas.getContext("2d").createImageData(c.width,c.height),c.imageData.data.set(u),c.pixels=c.imageData.data,c.updatePixels(),this.density!==1&&c.resize(i,s),c}updatePixels(){const t=this.gl;this.colorP5Texture.bindTexture();const r=this._glColorFormat(),i=r.format===t.RGBA?4:3,s=this.width*this.height*this.density*this.density*i,o=r.type===t.UNSIGNED_BYTE?Uint8Array:Float32Array;if(!(this.pixels instanceof o)||this.pixels.length!==s)throw new Error("The pixels array has not been set correctly. Please call loadPixels() before updatePixels().");t.texImage2D(t.TEXTURE_2D,0,r.internalFormat,this.width*this.density,this.height*this.density,0,r.format,r.type,this.pixels),this.colorP5Texture.unbindTexture(),this.dirty.colorTexture=!1;const a=this.renderer.activeFramebuffer();this.antialias?(this.begin(),this.renderer.push(),this.renderer.states.setValue("imageMode",qn),this.renderer.setCamera(this.filterCamera),this.renderer.resetMatrix(),this.renderer.states.setValue("strokeColor",null),this.renderer.clear(),this.renderer._drawingFilter=!0,this.renderer.image(this,0,0,this.width,this.height,-this.renderer.width/2,-this.renderer.height/2,this.renderer.width,this.renderer.height),this.renderer._drawingFilter=!1,this.renderer.pop(),this.useDepth&&(t.clearDepth(1),t.clear(t.DEPTH_BUFFER_BIT)),this.end()):(t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),this.useDepth&&(t.clearDepth(1),t.clear(t.DEPTH_BUFFER_BIT)),a?t.bindFramebuffer(t.FRAMEBUFFER,a._framebufferToBind()):t.bindFramebuffer(t.FRAMEBUFFER,null))}}function qk(n,t){n.FramebufferCamera=zk,n.FramebufferTexture=bp,n.Framebuffer=hi}typeof p5<"u"&&qk(p5,p5.prototype);let Ed;function Hk(n,t){Ed=n.renderers={},t.createCanvas=function(r,i,s,...o){let a=Ta;return Reflect.ownKeys(Ed).includes(s)?a=s:o.unshift(s),this._renderer&&this._renderer.remove(),this._renderer=new Ed[a](this,r,i,!0,...o),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer),this._renderer._applyDefaults(),Object.hasOwn(this,"pixels")||Object.defineProperty(this,"pixels",{get(){var u;return(u=this._renderer)==null?void 0:u.pixels}}),this._renderer},t.resizeCanvas=function(r,i,s){this._renderer&&(this._renderer.resize(r,i),s||this.redraw()),this._addAccsOutput()&&this._updateAccsOutput()},t.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},t.createGraphics=function(r,i,...s){return s[0]instanceof HTMLCanvasElement&&(s[1]=s[0],s[0]=Ta),new n.Graphics(r,i,s[0],this,s[1])},t.createFramebuffer=function(r){return new hi(this._renderer,r)},t.clearDepth=function(r){this._assert3d("clearDepth"),this._renderer.clearDepth(r)}}typeof p5<"u"&&Hk(p5,p5.prototype);class vz{constructor(t){this.pInst=t,this.canvas=document.createElement("canvas"),this.canvas.width=t.width,this.canvas.height=t.height;let r=Ir;if(this.gl=this.canvas.getContext("webgl2"),this.gl||(r=To,this.gl=this.canvas.getContext("webgl")),!this.gl){console.error("WebGL not supported, cannot apply filter.");return}this._renderer={GL:this.gl,registerEnabled:new Set,_curShader:null,_emptyTexture:null,webglVersion:r,states:{textureWrapX:this.gl.CLAMP_TO_EDGE,textureWrapY:this.gl.CLAMP_TO_EDGE},_arraysEqual:(i,s)=>JSON.stringify(i)===JSON.stringify(s),_getEmptyTexture:()=>{if(!this._emptyTexture){const i=new Io(1,1);i.set(0,0,255),this._emptyTexture=new Ss(this._renderer,i)}return this._emptyTexture}},this._baseFilterShader=void 0,this.filterShaderSources={[hl]:Nk,[e_]:Pk,[$g]:Mk,[r_]:Dk,[Q1]:Ik,[t_]:kk,[jg]:Rk,[J1]:Fk},this.filterShaders={},this.operation=null,this.filterParameter=1,this.customShader=null,this._shader=null,this.vertexBuffer=this.gl.createBuffer(),this.texcoordBuffer=this.gl.createBuffer(),this.vertices=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.texcoords=new Float32Array([0,1,1,1,0,0,1,0]),this._bindBufferData(this.vertexBuffer,this.gl.ARRAY_BUFFER,this.vertices),this._bindBufferData(this.texcoordBuffer,this.gl.ARRAY_BUFFER,this.texcoords)}_webGL2CompatibilityPrefix(t,r){let i="";return this._renderer.webglVersion===Ir&&(i+=`#version 300 es
#define WEBGL2
`),t==="vert"?i+=`#define VERTEX_SHADER
`:t==="frag"&&(i+=`#define FRAGMENT_SHADER
`),r&&(i+=`precision ${r} float;
`),i}baseFilterShader(){return this._baseFilterShader||(this._baseFilterShader=new Wr(this._renderer,this._webGL2CompatibilityPrefix("vert","highp")+Gy+Ak,this._webGL2CompatibilityPrefix("frag","highp")+Gy+Tk,{vertex:{},fragment:{"vec4 getColor":`(FilterInputs inputs, in sampler2D canvasContent) {
                return getTexture(canvasContent, inputs.texCoord);
              }`}})),this._baseFilterShader}setOperation(t,r,i=null){this.operation=t,this.filterParameter=r,t in vp&&r===void 0&&(this.filterParameter=vp[t]),this.customShader=i,this._initializeShader()}_initializeShader(){if(this.customShader){this._shader=this.customShader;return}if(!this.operation){console.error("No operation set for FilterRenderer2D, cannot initialize shader.");return}if(this.filterShaders[this.operation]){this._shader=this.filterShaders[this.operation];return}const t=this.filterShaderSources[this.operation];if(!t){console.error("No shader available for this operation:",this.operation);return}const r=new Wr(this._renderer,Lk,t);this.filterShaders[this.operation]=r,this._shader=r}_bindBufferData(t,r,i){const s=this.gl;s.bindBuffer(r,t),s.bufferData(r,i,s.STATIC_DRAW)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new Ss(this._renderer,this.pInst.wrappedElt)),this._canvasTexture}_renderPass(){const t=this.gl;this._shader.bindShader();const r=this.pInst.pixelDensity?this.pInst.pixelDensity():1,i=[1/(this.pInst.width*r),1/(this.pInst.height*r)],s=this.canvasTexture;this._shader.setUniform("tex0",s),this._shader.setUniform("texelSize",i),this._shader.setUniform("canvasSize",[this.pInst.width,this.pInst.height]),this._shader.setUniform("radius",Math.max(1,this.filterParameter)),this._shader.setUniform("filterParameter",this.filterParameter),this._shader.setDefaultUniforms(),this.pInst.states.setValue("rectMode",qn),this.pInst.states.setValue("imageMode",qn),this.pInst.blendMode(vn),this.pInst.resetMatrix();const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this._shader.setUniform("uModelViewMatrix",o),this._shader.setUniform("uProjectionMatrix",o),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this._shader.enableAttrib(this._shader.attributes.aPosition,2),t.bindBuffer(t.ARRAY_BUFFER,this.texcoordBuffer),this._shader.enableAttrib(this._shader.attributes.aTexCoord,2),this._shader.bindTextures(),this._shader.disableRemainingAttributes(),t.drawArrays(t.TRIANGLE_STRIP,0,4),this._shader.unbindShader()}applyFilter(){if(!this._shader){console.error("Cannot apply filter: shader not initialized.");return}this.pInst.push(),this.pInst.resetMatrix(),this.operation===hl&&!this.customShader?(this._shader.setUniform("direction",[1,0]),this._renderPass(),this.pInst.clear(),this.pInst.drawingContext.drawImage(this.canvas,0,0,this.pInst.width,this.pInst.height),this._shader.setUniform("direction",[0,1]),this._renderPass(),this.pInst.clear(),this.pInst.drawingContext.drawImage(this.canvas,0,0,this.pInst.width,this.pInst.height)):(this._renderPass(),this.pInst.clear(),this.pInst.blendMode(vn),this.pInst.drawingContext.drawImage(this.canvas,0,0,this.pInst.width,this.pInst.height)),this.pInst.pop()}}const Ai="rgba(0,0,0,0)";class Qm extends st{constructor(t,r,i,s,o,a={}){super(t,r,i,s),this.canvas=this.elt=o||document.createElement("canvas"),s?(this._pInst._curElement=this,this._pInst.canvas=this.canvas):this.canvas.style.display="none",this.elt.id="defaultCanvas0",this.elt.classList.add("p5Canvas");for(const u of Object.getOwnPropertyNames(Lr.prototype))u!=="constructor"&&u[0]!=="_"&&Object.defineProperty(this,u,{get(){return this.wrappedElt[u]}});if(this.elt.width=r*this._pixelDensity,this.elt.height=i*this._pixelDensity,this.elt.style.width=`${r}px`,this.elt.style.height=`${i}px`,this._pInst._userNode)this._pInst._userNode.appendChild(this.elt);else{if(document.getElementsByTagName("main").length===0){let u=document.createElement("main");document.body.appendChild(u)}document.getElementsByTagName("main")[0].appendChild(this.elt)}this.drawingContext=this.canvas.getContext("2d",a),a.colorSpace==="display-p3"&&(this.states.colorMode=mn),this.scale(this._pixelDensity,this._pixelDensity),this.filterRenderer||(this.filterRenderer=new vz(this)),this.wrappedElt=new Lr(this.elt,this._pInst),this.clipPath=null}remove(){this.wrappedElt.remove(),this.wrappedElt=null,this.canvas=null,this.elt=null}getFilterGraphicsLayer(){if(!this.filterGraphicsLayer){const t=this._pInst;this.filterGraphicsLayer=new pl(this.width,this.height,To,t)}return(this.filterGraphicsLayer.width!==this.width||this.filterGraphicsLayer.height!==this.height)&&this.filterGraphicsLayer.resizeCanvas(this.width,this.height),this.filterGraphicsLayer.pixelDensity()!==this._pInst.pixelDensity()&&this.filterGraphicsLayer.pixelDensity(this._pInst.pixelDensity()),this.filterGraphicsLayer}_applyDefaults(){this.states.setValue("_cachedFillStyle",void 0),this.states.setValue("_cachedStrokeStyle",void 0),this._cachedBlendMode=vn,this._setFill(l5),this._setStroke(u5),this.drawingContext.lineCap=yo,this.drawingContext.font="normal 12px sans-serif"}resize(t,r){super.resize(t,r);const i={};for(const s in this.drawingContext){const o=this.drawingContext[s];typeof o!="object"&&typeof o!="function"&&(i[s]=o)}this.canvas.width=t*this._pixelDensity,this.canvas.height=r*this._pixelDensity,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${r}px`,this.drawingContext.scale(this._pixelDensity,this._pixelDensity);for(const s in i)try{this.drawingContext[s]=i[s]}catch{}}background(...t){if(this.push(),this.resetMatrix(),t[0]instanceof Io)if(t[1]>=0){const r=t[0];this.drawingContext.globalAlpha=t[1]/255,this._pInst.image(r,0,0,this.width,this.height)}else this._pInst.image(t[0],0,0,this.width,this.height);else{const r=this._pInst.color(...t);this._pInst._addAccsOutput()&&this._pInst._accsBackground(r._getRGBA([255,255,255,255]));const i=r.toString();this._setFill(i),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._isErasing&&this._pInst.erase()}this.pop()}clear(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()}fill(...t){super.fill(...t);const r=this.states.fillColor;this._setFill(r.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",r._getRGBA([255,255,255,255]))}stroke(...t){super.stroke(...t);const r=this.states.strokeColor;this._setStroke(r.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",r._getRGBA([255,255,255,255]))}erase(t,r){if(!this._isErasing){this.states.setValue("_cachedFillStyle",this.drawingContext.fillStyle);const i=this._pInst.color(255,t).toString();this.drawingContext.fillStyle=i,this.states.setValue("_cachedStrokeStyle",this.drawingContext.strokeStyle);const s=this._pInst.color(255,r).toString();this.drawingContext.strokeStyle=s;const o=this._cachedBlendMode;this.blendMode(Da),this._cachedBlendMode=o,this._isErasing=!0}}noErase(){this._isErasing&&(this.drawingContext.fillStyle=this.states._cachedFillStyle,this.drawingContext.strokeStyle=this.states._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)}drawShape(t){const r=new rk({strokeWeight:this.states.strokeWeight});t.accept(r),this._clipping?(this.clipPath.addPath(r.path),this.clipPath.closePath()):(this.states.fillColor&&this.drawingContext.fill(r.path),this.states.strokeColor&&this.drawingContext.stroke(r.path))}beginClip(t={}){super.beginClip(t),this.states.setValue("_cachedFillStyle",this.drawingContext.fillStyle);const r=this._pInst.color(255,0).toString();this.drawingContext.fillStyle=r,this.states.setValue("_cachedStrokeStyle",this.drawingContext.strokeStyle);const i=this._pInst.color(255,0).toString();this.drawingContext.strokeStyle=i;const s=this._cachedBlendMode;this.blendMode(vn),this._cachedBlendMode=s,this.clipPath=new Path2D,this._clipInvert&&(this.clipPath.moveTo(-2*this.width,-2*this.height),this.clipPath.lineTo(-2*this.width,2*this.height),this.clipPath.lineTo(2*this.width,2*this.height),this.clipPath.lineTo(2*this.width,-2*this.height),this.clipPath.closePath())}endClip(){this.drawingContext.clip(this.clipPath),this.clipPath=null,super.endClip(),this.drawingContext.fillStyle=this.states._cachedFillStyle,this.drawingContext.strokeStyle=this.states._cachedStrokeStyle,this.blendMode(this._cachedBlendMode)}image(t,r,i,s,o,a,u,l,c){let h;t.gifProperties&&t._animateGif(this._pInst);try{t instanceof xh&&t._ensureCanvas(),this.states.tint&&t.canvas&&(h=this._getTintedImageCanvas(t)),h||(h=t.canvas||t.elt);let f=1;t.width&&t.width>0&&(f=h.width/t.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(h,f*r,f*i,f*s,f*o,a,u,l,c),this._isErasing&&this._pInst.erase()}catch(f){if(f.name!=="NS_ERROR_NOT_AVAILABLE")throw f}}_getTintedImageCanvas(t){if(!t.canvas)return t;t.tintCanvas||(t.tintCanvas=document.createElement("canvas")),t.tintCanvas.width!==t.canvas.width&&(t.tintCanvas.width=t.canvas.width),t.tintCanvas.height!==t.canvas.height&&(t.tintCanvas.height=t.canvas.height);const r=t.tintCanvas.getContext("2d");return r.save(),r.clearRect(0,0,t.canvas.width,t.canvas.height),this.states.tint[0]<255||this.states.tint[1]<255||this.states.tint[2]<255?(r.drawImage(t.canvas,0,0),r.globalCompositeOperation="luminosity",r.drawImage(t.canvas,0,0),r.globalCompositeOperation="color",r.drawImage(t.canvas,0,0),r.globalCompositeOperation="multiply",r.fillStyle=`rgb(${this.states.tint.slice(0,3).join(", ")})`,r.fillRect(0,0,t.canvas.width,t.canvas.height),r.globalCompositeOperation="destination-in",r.globalAlpha=this.states.tint[3]/255,r.drawImage(t.canvas,0,0)):(r.globalAlpha=this.states.tint[3]/255,r.drawImage(t.canvas,0,0)),r.restore(),t.tintCanvas}blendMode(t){if(t===Lg)console.warn("blendMode(SUBTRACT) only works in WEBGL mode.");else if(t===vn||t===Da||t===Pg||t===Mg||t===n5||t===Vg||t===Og||t===Bg||t===Ug||t===W1||t===K1||t===Y1||t===X1||t===Z1||t===mh)this._cachedBlendMode=t,this.drawingContext.globalCompositeOperation=t;else throw new Error(`Mode ${t} not recognized.`)}blend(...t){const r=this.drawingContext.globalCompositeOperation,i=t[t.length-1],s=Array.prototype.slice.call(t,0,t.length-1);this.drawingContext.globalCompositeOperation=i,jt.prototype.copy.apply(this,s),this.drawingContext.globalCompositeOperation=r}_getPixel(t,r){let i,s;return i=this.drawingContext.getImageData(t,r,1,1).data,s=0,[i[s+0],i[s+1],i[s+2],i[s+3]]}loadPixels(){const t=this._pixelDensity,r=this.width*t,i=this.height*t,s=this.drawingContext.getImageData(0,0,r,i);this.imageData=s,this.pixels=s.data}set(t,r,i){if(t=Math.floor(t),r=Math.floor(r),i instanceof Io)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this.drawingContext.clearRect(t,r,i.width,i.height),this.drawingContext.drawImage(i.canvas,t,r),this.drawingContext.restore();else{let s=0,o=0,a=0,u=0,l=4*(r*this._pixelDensity*(this.width*this._pixelDensity)+t*this._pixelDensity);if(this.imageData||this.loadPixels(),typeof i=="number")l<this.pixels.length&&(s=i,o=i,a=i,u=255);else if(Array.isArray(i)){if(i.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");l<this.pixels.length&&(s=i[0],o=i[1],a=i[2],u=i[3])}else i instanceof jt.Color&&l<this.pixels.length&&([s,o,a,u]=i._getRGBA([255,255,255,255]));for(let c=0;c<this._pixelDensity;c++)for(let h=0;h<this._pixelDensity;h++)l=4*((r*this._pixelDensity+h)*this.width*this._pixelDensity+(t*this._pixelDensity+c)),this.pixels[l]=s,this.pixels[l+1]=o,this.pixels[l+2]=a,this.pixels[l+3]=u}}updatePixels(t,r,i,s){const o=this._pixelDensity;t===void 0&&r===void 0&&i===void 0&&s===void 0&&(t=0,r=0,i=this.width,s=this.height),t*=o,r*=o,i*=o,s*=o,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=this.imageData),this.drawingContext.putImageData(this.imageData,0,0,t,r,i,s)}arc(t,r,i,s,o,a,u){const l=this.clipPa||this.drawingContext,c=t+i/2,h=r+s/2,f=i/2,d=s/2,p=!(u===lp||u===Ia||(a-o)%pn===0);return this.states.fillColor&&(this._clipping||l.beginPath(),l.ellipse(c,h,f,d,0,o,a),p&&l.lineTo(c,h),l.closePath(),this._clipping||l.fill()),this.states.strokeColor&&(this._clipping||l.beginPath(),l.ellipse(c,h,f,d,0,o,a),u===gh&&p&&l.lineTo(c,h),(u===gh||u===lp)&&l.closePath(),this._clipping||l.stroke()),this}ellipse(t){const r=this.clipPath||this.drawingContext,i=!!this.states.fillColor,s=this.states.strokeColor,o=parseFloat(t[0]),a=parseFloat(t[1]),u=parseFloat(t[2]),l=parseFloat(t[3]);if(i&&!s){if(this._getFill()===Ai)return this}else if(!i&&s&&this._getStroke()===Ai)return this;const c=o+u/2,h=a+l/2,f=u/2,d=l/2;this._clipping||r.beginPath(),r.ellipse(c,h,f,d,0,0,2*Math.PI),r.closePath(),!this._clipping&&i&&r.fill(),!this._clipping&&s&&r.stroke()}line(t,r,i,s){const o=this.clipPath||this.drawingContext;if(this.states.strokeColor){if(this._getStroke()===Ai)return this}else return this;return this._clipping||o.beginPath(),o.moveTo(t,r),o.lineTo(i,s),o.stroke(),this}point(t,r){const i=this.clipPath||this.drawingContext;if(this.states.strokeColor){if(this._getStroke()===Ai)return this}else return this;const s=this._getStroke(),o=this._getFill();this._clipping||this._setFill(s),this._clipping||i.beginPath(),i.arc(t,r,i.lineWidth/2,0,pn,!1),this._clipping||(i.fill(),this._setFill(o))}quad(t,r,i,s,o,a,u,l){const c=this.clipPath||this.drawingContext,h=!!this.states.fillColor,f=this.states.strokeColor;if(h&&!f){if(this._getFill()===Ai)return this}else if(!h&&f&&this._getStroke()===Ai)return this;return this._clipping||c.beginPath(),c.moveTo(t,r),c.lineTo(i,s),c.lineTo(o,a),c.lineTo(u,l),c.closePath(),!this._clipping&&h&&c.fill(),!this._clipping&&f&&c.stroke(),this}rect(t){const r=t[0],i=t[1],s=t[2],o=t[3];let a=t[4],u=t[5],l=t[6],c=t[7];const h=this.clipPath||this.drawingContext,f=!!this.states.fillColor,d=this.states.strokeColor;if(f&&!d){if(this._getFill()===Ai)return this}else if(!f&&d&&this._getStroke()===Ai)return this;if(this._clipping||h.beginPath(),typeof a>"u")h.rect(r,i,s,o);else{typeof u>"u"&&(u=a),typeof l>"u"&&(l=u),typeof c>"u"&&(c=l);const p=Math.abs(s),g=Math.abs(o),y=p/2,v=g/2;p<2*a&&(a=y),g<2*a&&(a=v),p<2*u&&(u=y),g<2*u&&(u=v),p<2*l&&(l=y),g<2*l&&(l=v),p<2*c&&(c=y),g<2*c&&(c=v),h.roundRect(r,i,s,o,[a,u,l,c])}return!this._clipping&&this.states.fillColor&&h.fill(),!this._clipping&&this.states.strokeColor&&h.stroke(),this}triangle(t){const r=this.clipPath||this.drawingContext,i=!!this.states.fillColor,s=this.states.strokeColor,o=t[0],a=t[1],u=t[2],l=t[3],c=t[4],h=t[5];if(i&&!s){if(this._getFill()===Ai)return this}else if(!i&&s&&this._getStroke()===Ai)return this;this._clipping||r.beginPath(),r.moveTo(o,a),r.lineTo(u,l),r.lineTo(c,h),r.closePath(),!this._clipping&&i&&r.fill(),!this._clipping&&s&&r.stroke()}strokeCap(t){return(t===yo||t===z1||t===G1)&&(this.drawingContext.lineCap=t),this}strokeJoin(t){return(t===yo||t===q1||t===H1)&&(this.drawingContext.lineJoin=t),this}strokeWeight(t){return super.strokeWeight(t),typeof t>"u"||t===0?this.drawingContext.lineWidth=1e-4:this.drawingContext.lineWidth=t,this}_getFill(){return this.states._cachedFillStyle||this.states.setValue("_cachedFillStyle",this.drawingContext.fillStyle),this.states._cachedFillStyle}_setFill(t){t!==this.states._cachedFillStyle&&(this.drawingContext.fillStyle=t,this.states.setValue("_cachedFillStyle",t))}_getStroke(){return this.states._cachedStrokeStyle||this.states.setValue("_cachedStrokeStyle",this.drawingContext.strokeStyle),this.states._cachedStrokeStyle}_setStroke(t){t!==this.states._cachedStrokeStyle&&(this.drawingContext.strokeStyle=t,this.states.setValue("_cachedStrokeStyle",t))}applyMatrix(t,r,i,s,o,a){this.drawingContext.transform(t,r,i,s,o,a)}getWorldToScreenMatrix(){let t=new DOMMatrix().scale(1/this._pixelDensity).multiply(this.drawingContext.getTransform());return new wr(t.toFloat32Array())}resetMatrix(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this}rotate(t){this.drawingContext.rotate(t)}scale(t,r){return this.drawingContext.scale(t,r),this}translate(t,r){return t instanceof jt.Vector&&(r=t.y,t=t.x),this.drawingContext.translate(t,r),this}push(){return this.drawingContext.save(),super.push()}pop(t){this.drawingContext.restore(),super.pop(t)}}function _z(n,t){n.Renderer2D=Qm,n.renderers[Ta]=Qm,n.renderers["p2d-hdr"]=new Proxy(Qm,{construct(r,[i,s,o,a,u]){return new r(i,s,o,a,u,{colorSpace:"display-p3"})}})}var vr,Va,qy,Wk;let jt=(vr=class{constructor(t,r){Zt(this,Va);this.hitCriticalError=!1,this._setupDone=!1,this._userNode=r,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._isGlobal=!1,this._loop=!0,this._startListener=null,this._initializeInstanceVariables(),this._events={pointerdown:null,pointerup:null,pointermove:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,wheel:null,resize:null,blur:null},this._millisStart=-1,this._recording=!1,this._lcg_random_state=null,this._gaussian_previous=!1,window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),this._updateWindowSize();const i=a=>{Object.defineProperty(window,a,{configurable:!0,enumerable:!0,get:()=>typeof this[a]=="function"?this[a].bind(this):this[a],set:u=>{Object.defineProperty(window,a,{configurable:!0,enumerable:!0,value:u,writable:!0}),vr.disableFriendlyErrors||console.log(`You just changed the value of "${a}", which was a p5 global value. This could cause problems later if you're not careful.`)}})};if(t)t(this),vr._checkForUserDefinedFunctions(this);else{if(this._isGlobal=!0,window.hitCriticalError)return;vr.instance=this;for(const u of Object.getOwnPropertyNames(vr.prototype))u[0]!=="_"&&i(u);const a=["constructor","length"];for(const u in this)if(this.hasOwnProperty(u)){if(u[0]==="_"||a.includes(u))continue;i(u)}}for(const a in this._events){const u=this[`_on${a}`];if(u){const l=u.bind(this);window.addEventListener(a,l,{passive:!1}),this._events[a]=l}}const s=()=>{this.focused=!0},o=()=>{this.focused=!1};window.addEventListener("focus",s),window.addEventListener("blur",o),vr.lifecycleHooks.remove.push(function(){window.removeEventListener("focus",s),window.removeEventListener("blur",o)}),document.readyState==="complete"?Cr(this,Va,qy).call(this):(this._startListener=Cr(this,Va,qy).bind(this),window.addEventListener("load",this._startListener,!1))}get pixels(){return this._renderer.pixels}get drawingContext(){return this._renderer.drawingContext}static registerAddon(t){const r={};t(vr,vr.prototype,r);const i=Object.keys(vr.lifecycleHooks);for(const s of i)typeof r[s]=="function"&&vr.lifecycleHooks[s].push(r[s])}async _draw(t){if(this.hitCriticalError)return;const r=t||window.performance.now(),i=r-this._lastTargetFrameTime,s=1e3/this._targetFrameRate;(!this._loop||i>=s-5)&&(this.deltaTime=r-this._lastRealFrameTime,this._frameRate=1e3/this.deltaTime,await this.redraw(),this._lastTargetFrameTime=Math.max(this._lastTargetFrameTime+s,r),this._lastRealFrameTime=r,typeof this._updateMouseCoords<"u"&&(this._updateMouseCoords(),this.movedX=0,this.movedY=0)),this._loop&&(this._requestAnimId=window.requestAnimationFrame(this._draw.bind(this)))}async remove(){if(this._startListener&&window.removeEventListener("load",this._startListener,!1),this._curElement){this._loop=!1,this._requestAnimId&&window.cancelAnimationFrame(this._requestAnimId);for(const t in this._events)window.removeEventListener(t,this._events[t]);for(const t of this._elements){t.elt&&t.elt.parentNode&&t.elt.parentNode.removeChild(t.elt);for(const r in t._events)t.elt.removeEventListener(r,t._events[r])}await this._runLifecycleHook("remove")}if(this._isGlobal){for(const t in vr.prototype)try{delete window[t]}catch{window[t]=void 0}for(const t in this)if(this.hasOwnProperty(t))try{delete window[t]}catch{window[t]=void 0}vr.instance=null}}async _runLifecycleHook(t){for(const r of vr.lifecycleHooks[t])await r.call(this)}_initializeInstanceVariables(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._downKeys={},this._downKeyCodes={}}},Va=new WeakSet,qy=async function(){this.hitCriticalError||(this._userNode&&typeof this._userNode=="string"&&(this._userNode=document.getElementById(this._userNode)),await Cr(this,Va,Wk).call(this),!this.hitCriticalError&&(this._recording||this._draw()))},Wk=async function(){if(await this._runLifecycleHook("presetup"),this.hitCriticalError)return;this.createCanvas(100,100,Ta),this._millisStart=window.performance.now();const t=this._isGlobal?window:this;if(typeof t.setup=="function"&&await t.setup(),this.hitCriticalError)return;const r=document.getElementsByTagName("canvas");if(Object.keys(this._events).some(i=>i.startsWith("pointer")))for(const i of r)i.style.touchAction="none";for(const i of r)i.dataset.hidden==="true"&&(i.style.visibility="",delete i.dataset.hidden);this._lastTargetFrameTime=window.performance.now(),this._lastRealFrameTime=window.performance.now(),this._setupDone=!0,(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),await this._runLifecycleHook("postsetup")},Nt(vr,"VERSION",WD),Nt(vr,"instance",null),Nt(vr,"lifecycleHooks",{presetup:[],postsetup:[],predraw:[],postdraw:[],remove:[]}),Nt(vr,"_checkForUserDefinedFunctions",()=>{}),Nt(vr,"_friendlyFileLoadError",()=>{}),vr);for(const n in ka)jt.prototype[n]=ka[n];jt.disableFriendlyErrors=!1;jt.registerAddon(n_);jt.registerAddon(g5);jt.registerAddon(y5);jt.registerAddon(Hk);jt.registerAddon(wG);jt.registerAddon(_z);jt.registerAddon(yz);function bz(n){n.registerAddon(c_),n.registerAddon(h_),n.registerAddon(f_),n.registerAddon(d_),n.registerAddon(a_)}function Kk(n,t){const r="_Description",i="_fallbackDesc",s="_fallbackTable",o="_fte_",a="_Label",u="_labelDesc",l="_labelTable",c="_lte_";t.describe=function(d,p){if(typeof d!="string")return;const g=this.canvas.id;d=h(d),this.dummyDOM||(this.dummyDOM=document.getElementById(g).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==d&&(this.descriptions.fallback.innerHTML=d):this._describeHTML("fallback",d),p===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==d&&(this.descriptions.label.innerHTML=d):this._describeHTML("label",d))},t.describeElement=function(d,p,g){if(typeof p!="string"||typeof d!="string")return;const y=this.canvas.id;p=h(p);let v=f(d);d=d.replace(/[^a-zA-Z0-9]/g,"");let T=`<th scope="row">${v}</th><td>${p}</td>`;this.dummyDOM||(this.dummyDOM=document.getElementById(y).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[d]?this.descriptions.fallbackElements[d].innerHTML!==T&&(this.descriptions.fallbackElements[d].innerHTML=T):this._describeElementHTML("fallback",d,T),g===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[d]?this.descriptions.labelElements[d].innerHTML!==T&&(this.descriptions.labelElements[d].innerHTML=T):this._describeElementHTML("label",d,T))};function h(d){if(d==="label"||d==="fallback")throw new Error("description should not be LABEL or FALLBACK");return!d.endsWith(".")&&!d.endsWith(";")&&!d.endsWith(",")&&!d.endsWith("?")&&!d.endsWith("!")&&(d=d+"."),d}t._describeHTML=function(d,p){const g=this.canvas.id;if(d==="fallback"){if(this.dummyDOM.querySelector(`#${g+r}`))this.dummyDOM.querySelector("#"+g+s).insertAdjacentHTML("beforebegin",`<p id="${g+i}"></p>`);else{let y=`<div id="${g}${r}" role="region" aria-label="Canvas Description"><p id="${g}${i}"></p></div>`;this.dummyDOM.querySelector(`#${g}accessibleOutput`)?this.dummyDOM.querySelector(`#${g}accessibleOutput`).insertAdjacentHTML("beforebegin",y):this.dummyDOM.querySelector(`#${g}`).innerHTML=y}this.descriptions.fallback=this.dummyDOM.querySelector(`#${g}${i}`),this.descriptions.fallback.innerHTML=p;return}else if(d==="label"){if(this.dummyDOM.querySelector(`#${g+a}`))this.dummyDOM.querySelector(`#${g+l}`)&&this.dummyDOM.querySelector(`#${g+l}`).insertAdjacentHTML("beforebegin",`<p id="${g}${u}"></p>`);else{let y=`<div id="${g}${a}" class="p5Label"><p id="${g}${u}"></p></div>`;this.dummyDOM.querySelector(`#${g}accessibleOutputLabel`)?this.dummyDOM.querySelector(`#${g}accessibleOutputLabel`).insertAdjacentHTML("beforebegin",y):this.dummyDOM.querySelector("#"+g).insertAdjacentHTML("afterend",y)}this.descriptions.label=this.dummyDOM.querySelector("#"+g+u),this.descriptions.label.innerHTML=p;return}};function f(d){if(d==="label"||d==="fallback")throw new Error("element name should not be LABEL or FALLBACK");return d.endsWith(".")||d.endsWith(";")||d.endsWith(",")?d=d.replace(/.$/,":"):d.endsWith(":")||(d=d+":"),d}t._describeElementHTML=function(d,p,g){const y=this.canvas.id;if(d==="fallback"){if(this.dummyDOM.querySelector(`#${y+r}`))this.dummyDOM.querySelector("#"+y+s)||this.dummyDOM.querySelector("#"+y+i).insertAdjacentHTML("afterend",`<table id="${y}${s}"><caption>Canvas elements and their descriptions</caption></table>`);else{let T=`<div id="${y}${r}" role="region" aria-label="Canvas Description"><table id="${y}${s}"><caption>Canvas elements and their descriptions</caption></table></div>`;this.dummyDOM.querySelector(`#${y}accessibleOutput`)?this.dummyDOM.querySelector(`#${y}accessibleOutput`).insertAdjacentHTML("beforebegin",T):this.dummyDOM.querySelector("#"+y).innerHTML=T}let v=document.createElement("tr");v.id=y+o+p,this.dummyDOM.querySelector("#"+y+s).appendChild(v),this.descriptions.fallbackElements[p]=this.dummyDOM.querySelector(`#${y}${o}${p}`),this.descriptions.fallbackElements[p].innerHTML=g;return}else if(d==="label"){if(this.dummyDOM.querySelector(`#${y+a}`))this.dummyDOM.querySelector(`#${y+l}`)||this.dummyDOM.querySelector("#"+y+u).insertAdjacentHTML("afterend",`<table id="${y+l}"></table>`);else{let T=`<div id="${y}${a}" class="p5Label"><table id="${y}${l}"></table></div>`;this.dummyDOM.querySelector(`#${y}accessibleOutputLabel`)?this.dummyDOM.querySelector(`#${y}accessibleOutputLabel`).insertAdjacentHTML("beforebegin",T):this.dummyDOM.querySelector("#"+y).insertAdjacentHTML("afterend",T)}let v=document.createElement("tr");v.id=y+c+p,this.dummyDOM.querySelector("#"+y+l).appendChild(v),this.descriptions.labelElements[p]=this.dummyDOM.querySelector(`#${y}${c}${p}`),this.descriptions.labelElements[p].innerHTML=g}}}typeof p5<"u"&&Kk(p5,p5.prototype);function Yk(n,t){t._updateGridOutput=function(o){if(!this.dummyDOM.querySelector(`#${o}_summary`))return;let a=this._accessibleOutputs[o],u=s(o,this.ingredients.shapes),l=i(u.numShapes,this.ingredients.colors.background,this.width,this.height),c=r(o,this.ingredients.shapes);l!==a.summary.innerHTML&&(a.summary.innerHTML=l),c!==a.map.innerHTML&&(a.map.innerHTML=c),u.details!==a.shapeDetails.innerHTML&&(a.shapeDetails.innerHTML=u.details),this._accessibleOutputs[o]=a};function r(o,a){let u=0,l="",c=Array.from(Array(10),()=>Array(10));for(let h in a)for(let f in a[h]){let d;h!=="line"?d=`<a href="#${o}shape${u}">${a[h][f].color} ${h}</a>`:d=`<a href="#${o}shape${u}">${a[h][f].color} ${h} midpoint</a>`,a[h][f].loc.locY<c.length&&a[h][f].loc.locX<c[a[h][f].loc.locY].length&&(c[a[h][f].loc.locY][a[h][f].loc.locX]?c[a[h][f].loc.locY][a[h][f].loc.locX]=c[a[h][f].loc.locY][a[h][f].loc.locX]+"  "+d:c[a[h][f].loc.locY][a[h][f].loc.locX]=d,u++)}for(let h in c){let f="<tr>";for(let d in c[h])f=f+"<td>",c[h][d]!==void 0&&(f=f+c[h][d]),f=f+"</td>";l=l+f+"</tr>"}return l}function i(o,a,u,l){let c=`${a} canvas, ${u} by ${l} pixels, contains ${o[0]}`;return o[0]===1?c=`${c} shape: ${o[1]}`:c=`${c} shapes: ${o[1]}`,c}function s(o,a){let u="",l="",c=0;for(let h in a){let f=0;for(let d in a[h]){let p=`<li id="${o}shape${c}">${a[h][d].color} ${h},`;h==="line"?p=p+` location = ${a[h][d].pos}, length = ${a[h][d].length} pixels`:(p=p+` location = ${a[h][d].pos}`,h!=="point"&&(p=p+`, area = ${a[h][d].area} %`),p=p+"</li>"),u=u+p,f++,c++}f>1?l=`${l} ${f} ${h}s`:l=`${l} ${f} ${h}`}return{numShapes:[c,l],details:u}}}typeof p5<"u"&&Yk(p5,p5.prototype);function Xk(n,t){t._updateTextOutput=function(o){if(!this.dummyDOM.querySelector(`#${o}_summary`))return;let a=this._accessibleOutputs[o],u=s(o,this.ingredients.shapes),l=r(u.numShapes,this.ingredients.colors.background,this.width,this.height),c=i(o,this.ingredients.shapes);l!==a.summary.innerHTML&&(a.summary.innerHTML=l),u.listShapes!==a.list.innerHTML&&(a.list.innerHTML=u.listShapes),c!==a.shapeDetails.innerHTML&&(a.shapeDetails.innerHTML=c),this._accessibleOutputs[o]=a};function r(o,a,u,l){let c=`Your output is a, ${u} by ${l} pixels, ${a} canvas containing the following`;return o===1?c=`${c} shape:`:c=`${c} ${o} shapes:`,c}function i(o,a){let u="",l=0;for(let c in a)for(let h in a[c]){let f=`<tr id="${o}shape${l}"><th>${a[c][h].color} ${c}</th>`;c==="line"?f=f+`<td>location = ${a[c][h].pos}</td><td>length = ${a[c][h].length} pixels</td></tr>`:(f=f+`<td>location = ${a[c][h].pos}</td>`,c!=="point"&&(f=f+`<td> area = ${a[c][h].area}%</td>`),f=f+"</tr>"),u=u+f,l++}return u}function s(o,a){let u="",l=0;for(let c in a)for(let h in a[c]){let f=`<li><a href="#${o}shape${l}">${a[c][h].color} ${c}</a>`;c==="line"?f=f+`, ${a[c][h].pos}, ${a[c][h].length} pixels long.</li>`:(f=f+`, at ${a[c][h].pos}`,c!=="point"&&(f=f+`, covering ${a[c][h].area}% of the canvas`),f=f+".</li>"),u=u+f,l++}return{numShapes:l,listShapes:u}}}typeof p5<"u"&&Xk(p5,p5.prototype);function Zk(n,t){t.textOutput=function(s){this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),s===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},t.gridOutput=function(s){this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),s===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},t._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},t._createOutput=function(s,o){let a=this.canvas.id;this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:"",pBackground:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(a).parentNode);let u,l,c,h="";o==="Fallback"?(u=a+s,l=a+"accessibleOutput",this.dummyDOM.querySelector(`#${l}`)||(this.dummyDOM.querySelector(`#${a}_Description`)?this.dummyDOM.querySelector(`#${a}_Description`).insertAdjacentHTML("afterend",`<div id="${l}" role="region" aria-label="Canvas Outputs"></div>`):this.dummyDOM.querySelector(`#${a}`).innerHTML=`<div id="${l}" role="region" aria-label="Canvas Outputs"></div>`)):o==="Label"&&(h=o,u=a+s+o,l=a+"accessibleOutput"+o,this.dummyDOM.querySelector(`#${l}`)||(this.dummyDOM.querySelector(`#${a}_Label`)?this.dummyDOM.querySelector(`#${a}_Label`).insertAdjacentHTML("afterend",`<div id="${l}"></div>`):this.dummyDOM.querySelector(`#${a}`).insertAdjacentHTML("afterend",`<div id="${l}"></div>`))),this._accessibleOutputs[u]={},s==="textOutput"?(h=`#${a}gridOutput${h}`,c=`<div id="${u}">Text Output<div id="${u}Summary" aria-label="text output summary"><p id="${u}_summary"></p><ul id="${u}_list"></ul></div><table id="${u}_shapeDetails" summary="text output shape details"></table></div>`,this.dummyDOM.querySelector(h)?this.dummyDOM.querySelector(h).insertAdjacentHTML("beforebegin",c):this.dummyDOM.querySelector(`#${l}`).innerHTML=c,this._accessibleOutputs[u].list=this.dummyDOM.querySelector(`#${u}_list`)):s==="gridOutput"&&(h=`#${a}textOutput${h}`,c=`<div id="${u}">Grid Output<p id="${u}_summary" aria-label="grid output summary"><table id="${u}_map" summary="grid output content"></table><ul id="${u}_shapeDetails" aria-label="grid output shape details"></ul></div>`,this.dummyDOM.querySelector(h)?this.dummyDOM.querySelector(h).insertAdjacentHTML("afterend",c):this.dummyDOM.querySelector(`#${l}`).innerHTML=c,this._accessibleOutputs[u].map=this.dummyDOM.querySelector(`#${u}_map`)),this._accessibleOutputs[u].shapeDetails=this.dummyDOM.querySelector(`#${u}_shapeDetails`),this._accessibleOutputs[u].summary=this.dummyDOM.querySelector(`#${u}_summary`)},t._updateAccsOutput=function(){let s=this.canvas.id;(JSON.stringify(this.ingredients.shapes)!==this.ingredients.pShapes||this.ingredients.colors.background!==this.ingredients.pBackground)&&(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(s+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(s+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(s+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(s+"gridOutputLabel"))},t._accsBackground=function(s){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.pBackground=this.ingredients.colors.background,this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==s&&(this.ingredients.colors.backgroundRGBA=s,this.ingredients.colors.background=this._rgbColorName(s))},t._accsCanvasColors=function(s,o){s==="fill"?this.ingredients.colors.fillRGBA!==o&&(this.ingredients.colors.fillRGBA=o,this.ingredients.colors.fill=this._rgbColorName(o)):s==="stroke"&&this.ingredients.colors.strokeRGBA!==o&&(this.ingredients.colors.strokeRGBA=o,this.ingredients.colors.stroke=this._rgbColorName(o))},t._accsOutput=function(s,o){s==="ellipse"&&o[2]===o[3]?s="circle":s==="rectangle"&&o[2]===o[3]&&(s="square");let a={},u=!0,l=r(s,o);if(s==="line"){a.color=this.ingredients.colors.stroke,a.length=Math.round(Math.hypot(o[2]-o[0],o[3]-o[1]));let c=this._getPos(o[0],[1]),h=this._getPos(o[2],[3]);a.loc=i(l,this.width,this.height),c===h?a.pos=`at ${c}`:a.pos=`from ${c} to ${h}`}else s==="point"?a.color=this.ingredients.colors.stroke:(a.color=this.ingredients.colors.fill,a.area=this._getArea(s,o)),a.pos=this._getPos(...l),a.loc=i(l,this.width,this.height);if(!this.ingredients.shapes[s])this.ingredients.shapes[s]=[a];else if(this.ingredients.shapes[s]!==[a]){for(let c in this.ingredients.shapes[s])JSON.stringify(this.ingredients.shapes[s][c])===JSON.stringify(a)&&(u=!1);u===!0&&this.ingredients.shapes[s].push(a)}};function r(s,o){let a,u;return s==="rectangle"||s==="ellipse"||s==="arc"||s==="circle"||s==="square"?(a=Math.round(o[0]+o[2]/2),u=Math.round(o[1]+o[3]/2)):s==="triangle"?(a=(o[0]+o[2]+o[4])/3,u=(o[1]+o[3]+o[5])/3):s==="quadrilateral"?(a=(o[0]+o[2]+o[4]+o[6])/4,u=(o[1]+o[3]+o[5]+o[7])/4):s==="line"?(a=(o[0]+o[2])/2,u=(o[1]+o[3])/2):(a=o[0],u=o[1]),[a,u]}t._getPos=function(s,o){const{x:a,y:u}=this.worldToScreen(new n.Vector(s,o)),l=this.width,c=this.height;return a<.4*l?u<.4*c?"top left":u>.6*c?"bottom left":"mid left":a>.6*l?u<.4*c?"top right":u>.6*c?"bottom right":"mid right":u<.4*c?"top middle":u>.6*c?"bottom middle":"middle"};function i(s,o,a){let c=Math.floor(s[0]/o*10),h=Math.floor(s[1]/a*10);return c===10&&(c=c-1),h===10&&(h=h-1),{locX:c,locY:h}}t._getArea=function(s,o){let a=0;if(s==="arc"){const y=((o[5]-o[4])%(Math.PI*2)+Math.PI*2)%(Math.PI*2);if(a=y*o[2]*o[3]/8,o[6]==="open"||o[6]==="chord"){const v=o[0],T=o[1],_=o[0]+o[2]/2*Math.cos(o[4]).toFixed(2),C=o[1]+o[3]/2*Math.sin(o[4]).toFixed(2),E=o[0]+o[2]/2*Math.cos(o[5]).toFixed(2),S=o[1]+o[3]/2*Math.sin(o[5]).toFixed(2),R=Math.abs(v*(C-S)+_*(S-T)+E*(T-C))/2;y>Math.PI?a=a+R:a=a-R}}else s==="ellipse"||s==="circle"?a=3.14*o[2]/2*o[3]/2:s==="line"||s==="point"?a=0:s==="quadrilateral"?a=Math.abs((o[6]+o[0])*(o[7]-o[1])+(o[0]+o[2])*(o[1]-o[3])+(o[2]+o[4])*(o[3]-o[5])+(o[4]+o[6])*(o[5]-o[7]))/2:s==="rectangle"||s==="square"?a=o[2]*o[3]:s==="triangle"&&(a=Math.abs(o[0]*(o[3]-o[5])+o[2]*(o[5]-o[1])+o[4]*(o[1]-o[3]))/2);const u=this.width*this._renderer._pixelDensity,l=this.height*this._renderer._pixelDensity,c=[new DOMPoint(0,0),new DOMPoint(u,0),new DOMPoint(u,l),new DOMPoint(0,l)],f=(this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform()).inverse(),d=c.map(y=>y.matrixTransform(f)),p=Math.abs((d[3].x+d[0].x)*(d[3].y-d[0].y)+(d[0].x+d[1].x)*(d[0].y-d[1].y)+(d[1].x+d[2].x)*(d[1].y-d[2].y)+(d[2].x+d[3].x)*(d[2].y-d[3].y))/2;return Math.round(a*100/p)}}typeof p5<"u"&&Zk(p5,p5.prototype);jt.ColorConversion={_hsbaToHSLA(n){const t=n[0];let r=n[1];const i=n[2],s=(2-r)*i/2;return s!==0&&(s===1?r=0:s<.5?r=r/(2-r):r=r*i/(2-s*2)),[t,r,s,n[3]]},_hsbaToRGBA(n){const t=n[0]*6,r=n[1],i=n[2];let s=[];if(r===0)s=[i,i,i,n[3]];else{const o=Math.floor(t),a=i*(1-r),u=i*(1-r*(t-o)),l=i*(1-r*(1+o-t));let c,h,f;o===1?(c=u,h=i,f=a):o===2?(c=a,h=i,f=l):o===3?(c=a,h=u,f=i):o===4?(c=l,h=a,f=i):o===5?(c=i,h=a,f=u):(c=i,h=l,f=a),s=[c,h,f,n[3]]}return s},_hslaToHSBA(n){const t=n[0];let r=n[1];const i=n[2];let s;return i<.5?s=(1+r)*i:s=i+r-i*r,r=2*(s-i)/s,[t,r,s,n[3]]},_hslaToRGBA(n){const t=n[0]*6,r=n[1],i=n[2];let s=[];if(r===0)s=[i,i,i,n[3]];else{let o;i<.5?o=(1+r)*i:o=i+r-i*r;const a=2*i-o,u=(l,c,h)=>(l<0?l+=6:l>=6&&(l-=6),l<1?c+(h-c)*l:l<3?h:l<4?c+(h-c)*(4-l):c);s=[u(t+2,a,o),u(t,a,o),u(t-2,a,o),n[3]]}return s},_rgbaToHSBA(n){const t=n[0],r=n[1],i=n[2],s=Math.max(t,r,i),o=s-Math.min(t,r,i);let a,u;return o===0?(a=0,u=0):(u=o/s,t===s?a=(r-i)/o:r===s?a=2+(i-t)/o:i===s&&(a=4+(t-r)/o),a<0?a+=6:a>=6&&(a-=6)),[a/6,u,s,n[3]]},_rgbaToHSLA(n){const t=n[0],r=n[1],i=n[2],s=Math.max(t,r,i),o=Math.min(t,r,i),a=s+o,u=s-o;let l,c;return u===0?(l=0,c=0):(a<1?c=u/a:c=u/(2-a),t===s?l=(r-i)/u:r===s?l=2+(i-t)/u:i===s&&(l=4+(t-r)/u),l<0?l+=6:l>=6&&(l-=6)),[l/6,c,a/2,n[3]]}};var xz=jt.ColorConversion;function Qk(n,t){let r;const i=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],s=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];function o(a){let u;if(a[0]!==0){a[0]=Math.round(a[0]*100);let l=a[0].toString().split("");const c=l.length-1;l[c]=parseInt(l[c]),l[c]<2.5?l[c]=0:l[c]>=2.5&&l[c]<7.5&&(l[c]=5),l.length===2?(l[0]=parseInt(l[0]),l[c]>=7.5&&(l[c]=0,l[0]=l[0]+1),a[0]=l[0]*10+l[1]):l[c]>=7.5?a[0]=10:a[0]=l[c]}a[2]=a[2]/255;for(let l=a.length-1;l>=1;l--)a[l]<=.25?a[l]=0:a[l]>.25&&a[l]<.75?a[l]=.5:a[l]=1;if(a[0]===0&&a[1]===0&&a[2]===1){for(let l=2;l>=0;l--)r[l]=Math.round(r[l]*1e4)/1e4;for(let l=0;l<i.length;l++)if(i[l].h===r[0]&&i[l].s===r[1]&&i[l].b===r[2]){u=i[l].name;break}else u="white"}else for(let l=0;l<s.length;l++)if(s[l].h===a[0]&&s[l].s===a[1]&&s[l].b===a[2]){u=s[l].name;break}return u}t._rgbColorName=function(a){let u=xz._rgbaToHSBA(a);return r=u,o([u[0],u[1],u[2]])}}typeof p5<"u"&&Qk(p5,p5.prototype);function wz(n){n.registerAddon(Kk),n.registerAddon(Yk),n.registerAddon(Xk),n.registerAddon(Zk),n.registerAddon(Qk)}function Ez(n){n.registerAddon(o_),n.registerAddon(L5),n.registerAddon(p_)}function _i(n){"@babel/helpers - typeof";return _i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_i(n)}function Sz(n,t){if(_i(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var i=r.call(n,t);if(_i(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function Jk(n){var t=Sz(n,"string");return _i(t)=="symbol"?t:t+""}function Cz(n,t,r){return(t=Jk(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function rn(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?Object(arguments[t]):{},i=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&i.push.apply(i,Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),i.forEach(function(s){Cz(n,s,r[s])})}return n}function Yi(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function gS(n,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,Jk(i.key),i)}}function Xi(n,t,r){return t&&gS(n.prototype,t),r&&gS(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function La(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Eh(n,t){if(t&&(_i(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return La(n)}function gl(n){return gl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gl(n)}function Hy(n,t){return Hy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Hy(n,t)}function qg(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&Hy(n,t)}var Az={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,r){console&&console[t]&&console[t].apply(console,r)}},Tz=function(){function n(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yi(this,n),this.init(t,r)}return Xi(n,[{key:"init",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=i.prefix||"i18next:",this.logger=r||Az,this.options=i,this.debug=i.debug}},{key:"setDebug",value:function(r){this.debug=r}},{key:"log",value:function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return this.forward(i,"log","",!0)}},{key:"warn",value:function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return this.forward(i,"warn","",!0)}},{key:"error",value:function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return this.forward(i,"error","")}},{key:"deprecate",value:function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return this.forward(i,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(r,i,s,o){return o&&!this.debug?null:(typeof r[0]=="string"&&(r[0]="".concat(s).concat(this.prefix," ").concat(r[0])),this.logger[i](r))}},{key:"create",value:function(r){return new n(this.logger,rn({},{prefix:"".concat(this.prefix,":").concat(r,":")},this.options))}}]),n}(),gs=new Tz,Do=function(){function n(){Yi(this,n),this.observers={}}return Xi(n,[{key:"on",value:function(r,i){var s=this;return r.split(" ").forEach(function(o){s.observers[o]=s.observers[o]||[],s.observers[o].push(i)}),this}},{key:"off",value:function(r,i){if(this.observers[r]){if(!i){delete this.observers[r];return}this.observers[r]=this.observers[r].filter(function(s){return s!==i})}}},{key:"emit",value:function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(this.observers[r]){var a=[].concat(this.observers[r]);a.forEach(function(l){l.apply(void 0,s)})}if(this.observers["*"]){var u=[].concat(this.observers["*"]);u.forEach(function(l){l.apply(l,[r].concat(s))})}}}]),n}();function tc(){var n,t,r=new Promise(function(i,s){n=i,t=s});return r.resolve=n,r.reject=t,r}function mS(n){return n==null?"":""+n}function Iz(n,t,r){n.forEach(function(i){t[i]&&(r[i]=t[i])})}function A_(n,t,r){function i(u){return u&&u.indexOf("###")>-1?u.replace(/###/g,"."):u}function s(){return!n||typeof n=="string"}for(var o=typeof t!="string"?[].concat(t):t.split(".");o.length>1;){if(s())return{};var a=i(o.shift());!n[a]&&r&&(n[a]=new r),Object.prototype.hasOwnProperty.call(n,a)?n=n[a]:n={}}return s()?{}:{obj:n,k:i(o.shift())}}function yS(n,t,r){var i=A_(n,t,Object),s=i.obj,o=i.k;s[o]=r}function Dz(n,t,r,i){var s=A_(n,t,Object),o=s.obj,a=s.k;o[a]=o[a]||[],o[a].push(r)}function xp(n,t){var r=A_(n,t),i=r.obj,s=r.k;if(i)return i[s]}function vS(n,t,r){var i=xp(n,r);return i!==void 0?i:xp(t,r)}function eN(n,t,r){for(var i in t)i!=="__proto__"&&i!=="constructor"&&(i in n?typeof n[i]=="string"||n[i]instanceof String||typeof t[i]=="string"||t[i]instanceof String?r&&(n[i]=t[i]):eN(n[i],t[i],r):n[i]=t[i]);return n}function su(n){return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var kz={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Nz(n){return typeof n=="string"?n.replace(/[&<>"'\/]/g,function(t){return kz[t]}):n}var Hg=typeof window<"u"&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,Rz=function(n){qg(t,n);function t(r){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return Yi(this,t),i=Eh(this,gl(t).call(this)),Hg&&Do.call(La(i)),i.data=r||{},i.options=s,i.options.keySeparator===void 0&&(i.options.keySeparator="."),i}return Xi(t,[{key:"addNamespaces",value:function(i){this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}},{key:"removeNamespaces",value:function(i){var s=this.options.ns.indexOf(i);s>-1&&this.options.ns.splice(s,1)}},{key:"getResource",value:function(i,s,o){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},u=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,l=[i,s];return o&&typeof o!="string"&&(l=l.concat(o)),o&&typeof o=="string"&&(l=l.concat(u?o.split(u):o)),i.indexOf(".")>-1&&(l=i.split(".")),xp(this.data,l)}},{key:"addResource",value:function(i,s,o,a){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},l=this.options.keySeparator;l===void 0&&(l=".");var c=[i,s];o&&(c=c.concat(l?o.split(l):o)),i.indexOf(".")>-1&&(c=i.split("."),a=s,s=c[1]),this.addNamespaces(s),yS(this.data,c,a),u.silent||this.emit("added",i,s,o,a)}},{key:"addResources",value:function(i,s,o){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var u in o)(typeof o[u]=="string"||Object.prototype.toString.apply(o[u])==="[object Array]")&&this.addResource(i,s,u,o[u],{silent:!0});a.silent||this.emit("added",i,s,o)}},{key:"addResourceBundle",value:function(i,s,o,a,u){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},c=[i,s];i.indexOf(".")>-1&&(c=i.split("."),a=o,o=s,s=c[1]),this.addNamespaces(s);var h=xp(this.data,c)||{};a?eN(h,o,u):h=rn({},h,o),yS(this.data,c,h),l.silent||this.emit("added",i,s,o)}},{key:"removeResourceBundle",value:function(i,s){this.hasResourceBundle(i,s)&&delete this.data[i][s],this.removeNamespaces(s),this.emit("removed",i,s)}},{key:"hasResourceBundle",value:function(i,s){return this.getResource(i,s)!==void 0}},{key:"getResourceBundle",value:function(i,s){return s||(s=this.options.defaultNS),this.options.compatibilityAPI==="v1"?rn({},{},this.getResource(i,s)):this.getResource(i,s)}},{key:"getDataByLanguage",value:function(i){return this.data[i]}},{key:"toJSON",value:function(){return this.data}}]),t}(Do),tN={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,r,i,s,o){var a=this;return t.forEach(function(u){a.processors[u]&&(r=a.processors[u].process(r,i,s,o))}),r}},_S={},bS=function(n){qg(t,n);function t(r){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yi(this,t),i=Eh(this,gl(t).call(this)),Hg&&Do.call(La(i)),Iz(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],r,La(i)),i.options=s,i.options.keySeparator===void 0&&(i.options.keySeparator="."),i.logger=gs.create("translator"),i}return Xi(t,[{key:"changeLanguage",value:function(i){i&&(this.language=i)}},{key:"exists",value:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},o=this.resolve(i,s);return o&&o.res!==void 0}},{key:"extractFromKey",value:function(i,s){var o=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;o===void 0&&(o=":");var a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,u=s.ns||this.options.defaultNS;if(o&&i.indexOf(o)>-1){var l=i.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:i,namespaces:u};var c=i.split(o);(o!==a||o===a&&this.options.ns.indexOf(c[0])>-1)&&(u=c.shift()),i=c.join(a)}return typeof u=="string"&&(u=[u]),{key:i,namespaces:u}}},{key:"translate",value:function(i,s,o){var a=this;if(_i(s)!=="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),s||(s={}),i==null)return"";Array.isArray(i)||(i=[String(i)]);var u=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,l=this.extractFromKey(i[i.length-1],s),c=l.key,h=l.namespaces,f=h[h.length-1],d=s.lng||this.language,p=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&d.toLowerCase()==="cimode"){if(p){var g=s.nsSeparator||this.options.nsSeparator;return f+g+c}return c}var y=this.resolve(i,s),v=y&&y.res,T=y&&y.usedKey||c,_=y&&y.exactUsedKey||c,C=Object.prototype.toString.apply(v),E=["[object Number]","[object Function]","[object RegExp]"],S=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,R=!this.i18nFormat||this.i18nFormat.handleAsObject,w=typeof v!="string"&&typeof v!="boolean"&&typeof v!="number";if(R&&v&&w&&E.indexOf(C)<0&&!(typeof S=="string"&&C==="[object Array]")){if(!s.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(T,v,s):"key '".concat(c," (").concat(this.language,")' returned an object instead of string.");if(u){var x=C==="[object Array]",b=x?[]:{},A=x?_:T;for(var k in v)if(Object.prototype.hasOwnProperty.call(v,k)){var N="".concat(A).concat(u).concat(k);b[k]=this.translate(N,rn({},s,{joinArrays:!1,ns:h})),b[k]===N&&(b[k]=v[k])}v=b}}else if(R&&typeof S=="string"&&C==="[object Array]")v=v.join(S),v&&(v=this.extendTranslation(v,i,s,o));else{var I=!1,j=!1,Q=s.count!==void 0&&typeof s.count!="string",le=t.hasDefaultValue(s),fe=Q?this.pluralResolver.getSuffix(d,s.count):"",ne=s["defaultValue".concat(fe)]||s.defaultValue;!this.isValidLookup(v)&&le&&(I=!0,v=ne),this.isValidLookup(v)||(j=!0,v=c);var oe=le&&ne!==v&&this.options.updateMissing;if(j||I||oe){if(this.logger.log(oe?"updateKey":"missingKey",d,f,c,oe?ne:v),u){var ie=this.resolve(c,rn({},s,{keySeparator:!1}));ie&&ie.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var ue=[],ee=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ee&&ee[0])for(var ve=0;ve<ee.length;ve++)ue.push(ee[ve]);else this.options.saveMissingTo==="all"?ue=this.languageUtils.toResolveHierarchy(s.lng||this.language):ue.push(s.lng||this.language);var ge=function(Se,ae,xe){a.options.missingKeyHandler?a.options.missingKeyHandler(Se,f,ae,oe?xe:v,oe,s):a.backendConnector&&a.backendConnector.saveMissing&&a.backendConnector.saveMissing(Se,f,ae,oe?xe:v,oe,s),a.emit("missingKey",Se,f,ae,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&Q?ue.forEach(function(we){a.pluralResolver.getSuffixes(we).forEach(function(Se){ge([we],c+Se,s["defaultValue".concat(Se)]||ne)})}):ge(ue,c,ne))}v=this.extendTranslation(v,i,s,y,o),j&&v===c&&this.options.appendNamespaceToMissingKey&&(v="".concat(f,":").concat(c)),j&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(v))}return v}},{key:"extendTranslation",value:function(i,s,o,a,u){var l=this;if(this.i18nFormat&&this.i18nFormat.parse)i=this.i18nFormat.parse(i,o,a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!o.skipInterpolation){o.interpolation&&this.interpolator.init(rn({},o,{interpolation:rn({},this.options.interpolation,o.interpolation)}));var c=o.interpolation&&o.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables,h;if(c){var f=i.match(this.interpolator.nestingRegexp);h=f&&f.length}var d=o.replace&&typeof o.replace!="string"?o.replace:o;if(this.options.interpolation.defaultVariables&&(d=rn({},this.options.interpolation.defaultVariables,d)),i=this.interpolator.interpolate(i,d,o.lng||this.language,o),c){var p=i.match(this.interpolator.nestingRegexp),g=p&&p.length;h<g&&(o.nest=!1)}o.nest!==!1&&(i=this.interpolator.nest(i,function(){for(var T=arguments.length,_=new Array(T),C=0;C<T;C++)_[C]=arguments[C];return u&&u[0]===_[0]&&!o.context?(l.logger.warn("It seems you are nesting recursively key: ".concat(_[0]," in key: ").concat(s[0])),null):l.translate.apply(l,_.concat([s]))},o)),o.interpolation&&this.interpolator.reset()}var y=o.postProcess||this.options.postProcess,v=typeof y=="string"?[y]:y;return i!=null&&v&&v.length&&o.applyPostProcessor!==!1&&(i=tN.handle(v,i,s,this.options&&this.options.postProcessPassResolved?rn({i18nResolved:a},o):o,this)),i}},{key:"resolve",value:function(i){var s=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a,u,l,c,h;return typeof i=="string"&&(i=[i]),i.forEach(function(f){if(!s.isValidLookup(a)){var d=s.extractFromKey(f,o),p=d.key;u=p;var g=d.namespaces;s.options.fallbackNS&&(g=g.concat(s.options.fallbackNS));var y=o.count!==void 0&&typeof o.count!="string",v=o.context!==void 0&&typeof o.context=="string"&&o.context!=="",T=o.lngs?o.lngs:s.languageUtils.toResolveHierarchy(o.lng||s.language,o.fallbackLng);g.forEach(function(_){s.isValidLookup(a)||(h=_,!_S["".concat(T[0],"-").concat(_)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(h)&&(_S["".concat(T[0],"-").concat(_)]=!0,s.logger.warn('key "'.concat(u,'" for languages "').concat(T.join(", "),`" won't get resolved as namespace "`).concat(h,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),T.forEach(function(C){if(!s.isValidLookup(a)){c=C;var E=p,S=[E];if(s.i18nFormat&&s.i18nFormat.addLookupKeys)s.i18nFormat.addLookupKeys(S,p,C,_,o);else{var R;y&&(R=s.pluralResolver.getSuffix(C,o.count)),y&&v&&S.push(E+R),v&&S.push(E+="".concat(s.options.contextSeparator).concat(o.context)),y&&S.push(E+=R)}for(var w;w=S.pop();)s.isValidLookup(a)||(l=w,a=s.getResource(C,_,w,o))}}))})}}),{res:a,usedKey:u,exactUsedKey:l,usedLng:c,usedNS:h}}},{key:"isValidLookup",value:function(i){return i!==void 0&&!(!this.options.returnNull&&i===null)&&!(!this.options.returnEmptyString&&i==="")}},{key:"getResource",value:function(i,s,o){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(i,s,o,a):this.resourceStore.getResource(i,s,o,a)}}],[{key:"hasDefaultValue",value:function(i){var s="defaultValue";for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)&&s===o.substring(0,s.length)&&i[o]!==void 0)return!0;return!1}}]),t}(Do);function Jm(n){return n.charAt(0).toUpperCase()+n.slice(1)}var Fz=function(){function n(t){Yi(this,n),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=gs.create("languageUtils")}return Xi(n,[{key:"getScriptPartFromCode",value:function(r){if(!r||r.indexOf("-")<0)return null;var i=r.split("-");return i.length===2||(i.pop(),i[i.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(i.join("-"))}},{key:"getLanguagePartFromCode",value:function(r){if(!r||r.indexOf("-")<0)return r;var i=r.split("-");return this.formatLanguageCode(i[0])}},{key:"formatLanguageCode",value:function(r){if(typeof r=="string"&&r.indexOf("-")>-1){var i=["hans","hant","latn","cyrl","cans","mong","arab"],s=r.split("-");return this.options.lowerCaseLng?s=s.map(function(o){return o.toLowerCase()}):s.length===2?(s[0]=s[0].toLowerCase(),s[1]=s[1].toUpperCase(),i.indexOf(s[1].toLowerCase())>-1&&(s[1]=Jm(s[1].toLowerCase()))):s.length===3&&(s[0]=s[0].toLowerCase(),s[1].length===2&&(s[1]=s[1].toUpperCase()),s[0]!=="sgn"&&s[2].length===2&&(s[2]=s[2].toUpperCase()),i.indexOf(s[1].toLowerCase())>-1&&(s[1]=Jm(s[1].toLowerCase())),i.indexOf(s[2].toLowerCase())>-1&&(s[2]=Jm(s[2].toLowerCase()))),s.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?r.toLowerCase():r}},{key:"isWhitelisted",value:function(r){return this.logger.deprecate("languageUtils.isWhitelisted",`function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it's usage asap.`),this.isSupportedCode(r)}},{key:"isSupportedCode",value:function(r){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(r=this.getLanguagePartFromCode(r)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(r)>-1}},{key:"getBestMatchFromCodes",value:function(r){var i=this;if(!r)return null;var s;return r.forEach(function(o){if(!s){var a=i.formatLanguageCode(o);(!i.options.supportedLngs||i.isSupportedCode(a))&&(s=a)}}),!s&&this.options.supportedLngs&&r.forEach(function(o){if(!s){var a=i.getLanguagePartFromCode(o);if(i.isSupportedCode(a))return s=a;s=i.options.supportedLngs.find(function(u){if(u.indexOf(a)===0)return u})}}),s||(s=this.getFallbackCodes(this.options.fallbackLng)[0]),s}},{key:"getFallbackCodes",value:function(r,i){if(!r)return[];if(typeof r=="function"&&(r=r(i)),typeof r=="string"&&(r=[r]),Object.prototype.toString.apply(r)==="[object Array]")return r;if(!i)return r.default||[];var s=r[i];return s||(s=r[this.getScriptPartFromCode(i)]),s||(s=r[this.formatLanguageCode(i)]),s||(s=r[this.getLanguagePartFromCode(i)]),s||(s=r.default),s||[]}},{key:"toResolveHierarchy",value:function(r,i){var s=this,o=this.getFallbackCodes(i||this.options.fallbackLng||[],r),a=[],u=function(c){c&&(s.isSupportedCode(c)?a.push(c):s.logger.warn("rejecting language code not found in supportedLngs: ".concat(c)))};return typeof r=="string"&&r.indexOf("-")>-1?(this.options.load!=="languageOnly"&&u(this.formatLanguageCode(r)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&u(this.getScriptPartFromCode(r)),this.options.load!=="currentOnly"&&u(this.getLanguagePartFromCode(r))):typeof r=="string"&&u(this.formatLanguageCode(r)),o.forEach(function(l){a.indexOf(l)<0&&u(s.formatLanguageCode(l))}),a}}]),n}(),Pz=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Mz={1:function(t){return+(t>1)},2:function(t){return+(t!=1)},3:function(t){return 0},4:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},5:function(t){return t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5},6:function(t){return t==1?0:t>=2&&t<=4?1:2},7:function(t){return t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},8:function(t){return t==1?0:t==2?1:t!=8&&t!=11?2:3},9:function(t){return+(t>=2)},10:function(t){return t==1?0:t==2?1:t<7?2:t<11?3:4},11:function(t){return t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3},12:function(t){return+(t%10!=1||t%100==11)},13:function(t){return+(t!==0)},14:function(t){return t==1?0:t==2?1:t==3?2:3},15:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2},16:function(t){return t%10==1&&t%100!=11?0:t!==0?1:2},17:function(t){return t==1||t%10==1&&t%100!=11?0:1},18:function(t){return t==0?0:t==1?1:2},19:function(t){return t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3},20:function(t){return t==1?0:t==0||t%100>0&&t%100<20?1:2},21:function(t){return t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0},22:function(t){return t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3}};function Lz(){var n={};return Pz.forEach(function(t){t.lngs.forEach(function(r){n[r]={numbers:t.nr,plurals:Mz[t.fc]}})}),n}var Oz=function(){function n(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yi(this,n),this.languageUtils=t,this.options=r,this.logger=gs.create("pluralResolver"),this.rules=Lz()}return Xi(n,[{key:"addRule",value:function(r,i){this.rules[r]=i}},{key:"getRule",value:function(r){return this.rules[r]||this.rules[this.languageUtils.getLanguagePartFromCode(r)]}},{key:"needsPlural",value:function(r){var i=this.getRule(r);return i&&i.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(r,i){return this.getSuffixes(r).map(function(s){return i+s})}},{key:"getSuffixes",value:function(r){var i=this,s=this.getRule(r);return s?s.numbers.map(function(o){return i.getSuffix(r,o)}):[]}},{key:"getSuffix",value:function(r,i){var s=this,o=this.getRule(r);if(o){var a=o.noAbs?o.plurals(i):o.plurals(Math.abs(i)),u=o.numbers[a];this.options.simplifyPluralSuffix&&o.numbers.length===2&&o.numbers[0]===1&&(u===2?u="plural":u===1&&(u=""));var l=function(){return s.options.prepend&&u.toString()?s.options.prepend+u.toString():u.toString()};return this.options.compatibilityJSON==="v1"?u===1?"":typeof u=="number"?"_plural_".concat(u.toString()):l():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&o.numbers.length===2&&o.numbers[0]===1?l():this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString()}return this.logger.warn("no plural rule found for: ".concat(r)),""}}]),n}(),Vz=function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yi(this,n),this.logger=gs.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(r){return r},this.init(t)}return Xi(n,[{key:"init",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};r.interpolation||(r.interpolation={escapeValue:!0});var i=r.interpolation;this.escape=i.escape!==void 0?i.escape:Nz,this.escapeValue=i.escapeValue!==void 0?i.escapeValue:!0,this.useRawValueToEscape=i.useRawValueToEscape!==void 0?i.useRawValueToEscape:!1,this.prefix=i.prefix?su(i.prefix):i.prefixEscaped||"{{",this.suffix=i.suffix?su(i.suffix):i.suffixEscaped||"}}",this.formatSeparator=i.formatSeparator?i.formatSeparator:i.formatSeparator||",",this.unescapePrefix=i.unescapeSuffix?"":i.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":i.unescapeSuffix||"",this.nestingPrefix=i.nestingPrefix?su(i.nestingPrefix):i.nestingPrefixEscaped||su("$t("),this.nestingSuffix=i.nestingSuffix?su(i.nestingSuffix):i.nestingSuffixEscaped||su(")"),this.nestingOptionsSeparator=i.nestingOptionsSeparator?i.nestingOptionsSeparator:i.nestingOptionsSeparator||",",this.maxReplaces=i.maxReplaces?i.maxReplaces:1e3,this.alwaysFormat=i.alwaysFormat!==void 0?i.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var r="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(r,"g");var i="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(i,"g");var s="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(s,"g")}},{key:"interpolate",value:function(r,i,s,o){var a=this,u,l,c,h=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function f(v){return v.replace(/\$/g,"$$$$")}var d=function(T){if(T.indexOf(a.formatSeparator)<0){var _=vS(i,h,T);return a.alwaysFormat?a.format(_,void 0,s):_}var C=T.split(a.formatSeparator),E=C.shift().trim(),S=C.join(a.formatSeparator).trim();return a.format(vS(i,h,E),S,s,o)};this.resetRegExp();var p=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,g=o&&o.interpolation&&o.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables,y=[{regex:this.regexpUnescape,safeValue:function(T){return f(T)}},{regex:this.regexp,safeValue:function(T){return a.escapeValue?f(a.escape(T)):f(T)}}];return y.forEach(function(v){for(c=0;u=v.regex.exec(r);){if(l=d(u[1].trim()),l===void 0)if(typeof p=="function"){var T=p(r,u,o);l=typeof T=="string"?T:""}else if(g){l=u[0];continue}else a.logger.warn("missed to pass in variable ".concat(u[1]," for interpolating ").concat(r)),l="";else typeof l!="string"&&!a.useRawValueToEscape&&(l=mS(l));if(r=r.replace(u[0],v.safeValue(l)),v.regex.lastIndex=0,c++,c>=a.maxReplaces)break}}),r}},{key:"nest",value:function(r,i){var s=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,u,l=rn({},o);l.applyPostProcessor=!1,delete l.defaultValue;function c(p,g){var y=this.nestingOptionsSeparator;if(p.indexOf(y)<0)return p;var v=p.split(new RegExp("".concat(y,"[ ]*{"))),T="{".concat(v[1]);p=v[0],T=this.interpolate(T,l),T=T.replace(/'/g,'"');try{l=JSON.parse(T),g&&(l=rn({},g,l))}catch(_){return this.logger.warn("failed parsing options string in nesting for key ".concat(p),_),"".concat(p).concat(y).concat(T)}return delete l.defaultValue,p}for(;a=this.nestingRegexp.exec(r);){var h=[],f=!1;if(a[0].includes(this.formatSeparator)&&!/{.*}/.test(a[1])){var d=a[1].split(this.formatSeparator).map(function(p){return p.trim()});a[1]=d.shift(),h=d,f=!0}if(u=i(c.call(this,a[1].trim(),l),l),u&&a[0]===r&&typeof u!="string")return u;typeof u!="string"&&(u=mS(u)),u||(this.logger.warn("missed to resolve ".concat(a[1]," for nesting ").concat(r)),u=""),f&&(u=h.reduce(function(p,g){return s.format(p,g,o.lng,o)},u.trim())),r=r.replace(a[0],u),this.regexp.lastIndex=0}return r}}]),n}();function Bz(n,t){for(var r=n.indexOf(t);r!==-1;)n.splice(r,1),r=n.indexOf(t)}var Uz=function(n){qg(t,n);function t(r,i,s){var o,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Yi(this,t),o=Eh(this,gl(t).call(this)),Hg&&Do.call(La(o)),o.backend=r,o.store=i,o.services=s,o.languageUtils=s.languageUtils,o.options=a,o.logger=gs.create("backendConnector"),o.state={},o.queue=[],o.backend&&o.backend.init&&o.backend.init(s,a.backend,a),o}return Xi(t,[{key:"queueLoad",value:function(i,s,o,a){var u=this,l=[],c=[],h=[],f=[];return i.forEach(function(d){var p=!0;s.forEach(function(g){var y="".concat(d,"|").concat(g);!o.reload&&u.store.hasResourceBundle(d,g)?u.state[y]=2:u.state[y]<0||(u.state[y]===1?c.indexOf(y)<0&&c.push(y):(u.state[y]=1,p=!1,c.indexOf(y)<0&&c.push(y),l.indexOf(y)<0&&l.push(y),f.indexOf(g)<0&&f.push(g)))}),p||h.push(d)}),(l.length||c.length)&&this.queue.push({pending:c,loaded:{},errors:[],callback:a}),{toLoad:l,pending:c,toLoadLanguages:h,toLoadNamespaces:f}}},{key:"loaded",value:function(i,s,o){var a=i.split("|"),u=a[0],l=a[1];s&&this.emit("failedLoading",u,l,s),o&&this.store.addResourceBundle(u,l,o),this.state[i]=s?-1:2;var c={};this.queue.forEach(function(h){Dz(h.loaded,[u],l),Bz(h.pending,i),s&&h.errors.push(s),h.pending.length===0&&!h.done&&(Object.keys(h.loaded).forEach(function(f){c[f]||(c[f]=[]),h.loaded[f].length&&h.loaded[f].forEach(function(d){c[f].indexOf(d)<0&&c[f].push(d)})}),h.done=!0,h.errors.length?h.callback(h.errors):h.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(function(h){return!h.done})}},{key:"read",value:function(i,s,o){var a=this,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:350,c=arguments.length>5?arguments[5]:void 0;return i.length?this.backend[o](i,s,function(h,f){if(h&&f&&u<5){setTimeout(function(){a.read.call(a,i,s,o,u+1,l*2,c)},l);return}c(h,f)}):c(null,{})}},{key:"prepareLoading",value:function(i,s){var o=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),u&&u();typeof i=="string"&&(i=this.languageUtils.toResolveHierarchy(i)),typeof s=="string"&&(s=[s]);var l=this.queueLoad(i,s,a,u);if(!l.toLoad.length)return l.pending.length||u(),null;l.toLoad.forEach(function(c){o.loadOne(c)})}},{key:"load",value:function(i,s,o){this.prepareLoading(i,s,{},o)}},{key:"reload",value:function(i,s,o){this.prepareLoading(i,s,{reload:!0},o)}},{key:"loadOne",value:function(i){var s=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=i.split("|"),u=a[0],l=a[1];this.read(u,l,"read",void 0,void 0,function(c,h){c&&s.logger.warn("".concat(o,"loading namespace ").concat(l," for language ").concat(u," failed"),c),!c&&h&&s.logger.log("".concat(o,"loaded namespace ").concat(l," for language ").concat(u),h),s.loaded(i,c,h)})}},{key:"saveMissing",value:function(i,s,o,a,u){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(s)){this.logger.warn('did not save key "'.concat(o,'" as the namespace "').concat(s,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}o==null||o===""||(this.backend&&this.backend.create&&this.backend.create(i,s,o,a,null,rn({},l,{isUpdate:u})),!(!i||!i[0])&&this.store.addResource(i[0],s,o,a))}}]),t}(Do);function $z(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var r={};if(_i(t[1])==="object"&&(r=t[1]),typeof t[1]=="string"&&(r.defaultValue=t[1]),typeof t[2]=="string"&&(r.tDescription=t[2]),_i(t[2])==="object"||_i(t[3])==="object"){var i=t[3]||t[2];Object.keys(i).forEach(function(s){r[s]=i[s]})}return r},interpolation:{escapeValue:!0,format:function(t,r,i,s){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function xS(n){return typeof n.ns=="string"&&(n.ns=[n.ns]),typeof n.fallbackLng=="string"&&(n.fallbackLng=[n.fallbackLng]),typeof n.fallbackNS=="string"&&(n.fallbackNS=[n.fallbackNS]),n.whitelist&&(n.whitelist&&n.whitelist.indexOf("cimode")<0&&(n.whitelist=n.whitelist.concat(["cimode"])),n.supportedLngs=n.whitelist),n.nonExplicitWhitelist&&(n.nonExplicitSupportedLngs=n.nonExplicitWhitelist),n.supportedLngs&&n.supportedLngs.indexOf("cimode")<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),n}function jf(){}var jz=function(n){qg(t,n);function t(){var r,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;if(Yi(this,t),r=Eh(this,gl(t).call(this)),Hg&&Do.call(La(r)),r.options=xS(i),r.services={},r.logger=gs,r.modules={external:[]},s&&!r.isInitialized&&!i.isClone){if(!r.options.initImmediate)return r.init(i,s),Eh(r,La(r));setTimeout(function(){r.init(i,s)},0)}return r}return Xi(t,[{key:"init",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;typeof s=="function"&&(o=s,s={}),s.whitelist&&!s.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),s.nonExplicitWhitelist&&!s.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=rn({},$z(),this.options,xS(s)),this.format=this.options.interpolation.format,o||(o=jf);function a(g){return g?typeof g=="function"?new g:g:null}if(!this.options.isClone){this.modules.logger?gs.init(a(this.modules.logger),this.options):gs.init(null,this.options);var u=new Fz(this.options);this.store=new Rz(this.options.resources,this.options);var l=this.services;l.logger=gs,l.resourceStore=this.store,l.languageUtils=u,l.pluralResolver=new Oz(u,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),l.interpolator=new Vz(this.options),l.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},l.backendConnector=new Uz(a(this.modules.backend),l.resourceStore,l,this.options),l.backendConnector.on("*",function(g){for(var y=arguments.length,v=new Array(y>1?y-1:0),T=1;T<y;T++)v[T-1]=arguments[T];i.emit.apply(i,[g].concat(v))}),this.modules.languageDetector&&(l.languageDetector=a(this.modules.languageDetector),l.languageDetector.init(l,this.options.detection,this.options)),this.modules.i18nFormat&&(l.i18nFormat=a(this.modules.i18nFormat),l.i18nFormat.init&&l.i18nFormat.init(this)),this.translator=new bS(this.services,this.options),this.translator.on("*",function(g){for(var y=arguments.length,v=new Array(y>1?y-1:0),T=1;T<y;T++)v[T-1]=arguments[T];i.emit.apply(i,[g].concat(v))}),this.modules.external.forEach(function(g){g.init&&g.init(i)})}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var h=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];h.forEach(function(g){i[g]=function(){var y;return(y=i.store)[g].apply(y,arguments)}});var f=["addResource","addResources","addResourceBundle","removeResourceBundle"];f.forEach(function(g){i[g]=function(){var y;return(y=i.store)[g].apply(y,arguments),i}});var d=tc(),p=function(){var y=function(T,_){i.isInitialized&&i.logger.warn("init: i18next is already initialized. You should call init just once!"),i.isInitialized=!0,i.options.isClone||i.logger.log("initialized",i.options),i.emit("initialized",i.options),d.resolve(_),o(T,_)};if(i.languages&&i.options.compatibilityAPI!=="v1"&&!i.isInitialized)return y(null,i.t.bind(i));i.changeLanguage(i.options.lng,y)};return this.options.resources||!this.options.initImmediate?p():setTimeout(p,0),d}},{key:"loadResources",value:function(i){var s=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jf,a=o,u=typeof i=="string"?i:this.language;if(typeof i=="function"&&(a=i),!this.options.resources||this.options.partialBundledLanguages){if(u&&u.toLowerCase()==="cimode")return a();var l=[],c=function(d){if(d){var p=s.services.languageUtils.toResolveHierarchy(d);p.forEach(function(g){l.indexOf(g)<0&&l.push(g)})}};if(u)c(u);else{var h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.forEach(function(f){return c(f)})}this.options.preload&&this.options.preload.forEach(function(f){return c(f)}),this.services.backendConnector.load(l,this.options.ns,a)}else a(null)}},{key:"reloadResources",value:function(i,s,o){var a=tc();return i||(i=this.languages),s||(s=this.options.ns),o||(o=jf),this.services.backendConnector.reload(i,s,function(u){a.resolve(),o(u)}),a}},{key:"use",value:function(i){if(!i)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!i.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return i.type==="backend"&&(this.modules.backend=i),(i.type==="logger"||i.log&&i.warn&&i.error)&&(this.modules.logger=i),i.type==="languageDetector"&&(this.modules.languageDetector=i),i.type==="i18nFormat"&&(this.modules.i18nFormat=i),i.type==="postProcessor"&&tN.addPostProcessor(i),i.type==="3rdParty"&&this.modules.external.push(i),this}},{key:"changeLanguage",value:function(i,s){var o=this;this.isLanguageChangingTo=i;var a=tc();this.emit("languageChanging",i);var u=function(h,f){f?(o.language=f,o.languages=o.services.languageUtils.toResolveHierarchy(f),o.translator.changeLanguage(f),o.isLanguageChangingTo=void 0,o.emit("languageChanged",f),o.logger.log("languageChanged",f)):o.isLanguageChangingTo=void 0,a.resolve(function(){return o.t.apply(o,arguments)}),s&&s(h,function(){return o.t.apply(o,arguments)})},l=function(h){var f=typeof h=="string"?h:o.services.languageUtils.getBestMatchFromCodes(h);f&&(o.language||(o.language=f,o.languages=o.services.languageUtils.toResolveHierarchy(f)),o.translator.language||o.translator.changeLanguage(f),o.services.languageDetector&&o.services.languageDetector.cacheUserLanguage(f)),o.loadResources(f,function(d){u(d,f)})};return!i&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!i&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(l):l(i),a}},{key:"getFixedT",value:function(i,s){var o=this,a=function u(l,c){var h;if(_i(c)!=="object"){for(var f=arguments.length,d=new Array(f>2?f-2:0),p=2;p<f;p++)d[p-2]=arguments[p];h=o.options.overloadTranslationOptionHandler([l,c].concat(d))}else h=rn({},c);return h.lng=h.lng||u.lng,h.lngs=h.lngs||u.lngs,h.ns=h.ns||u.ns,o.t(l,h)};return typeof i=="string"?a.lng=i:a.lngs=i,a.ns=s,a}},{key:"t",value:function(){var i;return this.translator&&(i=this.translator).translate.apply(i,arguments)}},{key:"exists",value:function(){var i;return this.translator&&(i=this.translator).exists.apply(i,arguments)}},{key:"setDefaultNamespace",value:function(i){this.options.defaultNS=i}},{key:"hasLoadedNamespace",value:function(i){var s=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var a=this.languages[0],u=this.options?this.options.fallbackLng:!1,l=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;var c=function(d,p){var g=s.services.backendConnector.state["".concat(d,"|").concat(p)];return g===-1||g===2};if(o.precheck){var h=o.precheck(this,c);if(h!==void 0)return h}return!!(this.hasResourceBundle(a,i)||!this.services.backendConnector.backend||c(a,i)&&(!u||c(l,i)))}},{key:"loadNamespaces",value:function(i,s){var o=this,a=tc();return this.options.ns?(typeof i=="string"&&(i=[i]),i.forEach(function(u){o.options.ns.indexOf(u)<0&&o.options.ns.push(u)}),this.loadResources(function(u){a.resolve(),s&&s(u)}),a):(s&&s(),Promise.resolve())}},{key:"loadLanguages",value:function(i,s){var o=tc();typeof i=="string"&&(i=[i]);var a=this.options.preload||[],u=i.filter(function(l){return a.indexOf(l)<0});return u.length?(this.options.preload=a.concat(u),this.loadResources(function(l){o.resolve(),s&&s(l)}),o):(s&&s(),Promise.resolve())}},{key:"dir",value:function(i){if(i||(i=this.languages&&this.languages.length>0?this.languages[0]:this.language),!i)return"rtl";var s=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"];return s.indexOf(this.services.languageUtils.getLanguagePartFromCode(i))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;return new t(i,s)}},{key:"cloneInstance",value:function(){var i=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jf,a=rn({},this.options,s,{isClone:!0}),u=new t(a),l=["store","services","language"];return l.forEach(function(c){u[c]=i[c]}),u.services=rn({},this.services),u.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u.translator=new bS(u.services,u.options),u.translator.on("*",function(c){for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];u.emit.apply(u,[c].concat(f))}),u.init(a,o),u.translator.options=u.options,u.translator.backendConnector.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u}}]),t}(Do),rN=new jz,nN=[],Gz=nN.forEach,zz=nN.slice;function qz(n){return Gz.call(zz.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n}var wS={create:function(t,r,i,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/"},a;if(i){var u=new Date;u.setTime(u.getTime()+i*60*1e3),a="; expires="+u.toUTCString()}else a="";s=s?"domain="+s+";":"",o=Object.keys(o).reduce(function(l,c){return l+";"+c.replace(/([A-Z])/g,function(h){return"-"+h.toLowerCase()})+"="+o[c]},""),document.cookie=t+"="+encodeURIComponent(r)+a+";"+s+o},read:function(t){for(var r=t+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var o=i[s];o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(r)===0)return o.substring(r.length,o.length)}return null},remove:function(t){this.create(t,"",-1)}},Hz={name:"cookie",lookup:function(t){var r;if(t.lookupCookie&&typeof document<"u"){var i=wS.read(t.lookupCookie);i&&(r=i)}return r},cacheUserLanguage:function(t,r){r.lookupCookie&&typeof document<"u"&&wS.create(r.lookupCookie,t,r.cookieMinutes,r.cookieDomain,r.cookieOptions)}},Wz={name:"querystring",lookup:function(t){var r;if(typeof window<"u")for(var i=window.location.search.substring(1),s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("=");if(a>0){var u=s[o].substring(0,a);u===t.lookupQuerystring&&(r=s[o].substring(a+1))}}return r}},wp;try{wp=window!=="undefined"&&window.localStorage!==null;var ES="i18next.translate.boo";window.localStorage.setItem(ES,"foo"),window.localStorage.removeItem(ES)}catch{wp=!1}var Kz={name:"localStorage",lookup:function(t){var r;if(t.lookupLocalStorage&&wp){var i=window.localStorage.getItem(t.lookupLocalStorage);i&&(r=i)}return r},cacheUserLanguage:function(t,r){r.lookupLocalStorage&&wp&&window.localStorage.setItem(r.lookupLocalStorage,t)}},Ep;try{Ep=window!=="undefined"&&window.sessionStorage!==null;var SS="i18next.translate.boo";window.sessionStorage.setItem(SS,"foo"),window.sessionStorage.removeItem(SS)}catch{Ep=!1}var Yz={name:"sessionStorage",lookup:function(t){var r;if(t.lookupsessionStorage&&Ep){var i=window.sessionStorage.getItem(t.lookupsessionStorage);i&&(r=i)}return r},cacheUserLanguage:function(t,r){r.lookupsessionStorage&&Ep&&window.sessionStorage.setItem(r.lookupsessionStorage,t)}},Xz={name:"navigator",lookup:function(t){var r=[];if(typeof navigator<"u"){if(navigator.languages)for(var i=0;i<navigator.languages.length;i++)r.push(navigator.languages[i]);navigator.userLanguage&&r.push(navigator.userLanguage),navigator.language&&r.push(navigator.language)}return r.length>0?r:void 0}},Zz={name:"htmlTag",lookup:function(t){var r,i=t.htmlTag||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(r=i.getAttribute("lang")),r}},Qz={name:"path",lookup:function(t){var r;if(typeof window<"u"){var i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(i instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof i[t.lookupFromPathIndex]!="string")return;r=i[t.lookupFromPathIndex].replace("/","")}else r=i[0].replace("/","")}return r}},Jz={name:"subdomain",lookup:function(t){var r;if(typeof window<"u"){var i=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);i instanceof Array&&(typeof t.lookupFromSubdomainIndex=="number"?r=i[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):r=i[0].replace("http://","").replace("https://","").replace(".",""))}return r}};function eq(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],checkWhitelist:!0,checkForSimilarInWhitelist:!1}}var iN=function(){function n(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Yi(this,n),this.type="languageDetector",this.detectors={},this.init(t,r)}return Xi(n,[{key:"init",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=r,this.options=qz(i,this.options||{},eq()),this.options.checkForSimilarInWhitelist&&(this.options.checkWhitelist=!0),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(Hz),this.addDetector(Wz),this.addDetector(Kz),this.addDetector(Yz),this.addDetector(Xz),this.addDetector(Zz),this.addDetector(Qz),this.addDetector(Jz)}},{key:"addDetector",value:function(r){this.detectors[r.name]=r}},{key:"detect",value:function(r){var i=this;r||(r=this.options.order);var s=[];r.forEach(function(u){if(i.detectors[u]){var l=i.detectors[u].lookup(i.options);l&&typeof l=="string"&&(l=[l]),l&&(s=s.concat(l))}});var o;if(s.forEach(function(u){if(!o){var l=i.services.languageUtils.formatLanguageCode(u);(!i.options.checkWhitelist||i.services.languageUtils.isWhitelisted(l))&&(o=l),!o&&i.options.checkForSimilarInWhitelist&&(o=i.getSimilarInWhitelist(l))}}),!o){var a=this.i18nOptions.fallbackLng;typeof a=="string"&&(a=[a]),a||(a=[]),Object.prototype.toString.apply(a)==="[object Array]"?o=a[0]:o=a[0]||a.default&&a.default[0]}return o}},{key:"cacheUserLanguage",value:function(r,i){var s=this;i||(i=this.options.caches),i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(r)>-1||i.forEach(function(o){s.detectors[o]&&s.detectors[o].cacheUserLanguage(r,s.options)}))}},{key:"getSimilarInWhitelist",value:function(r){var i=this;if(this.i18nOptions.whitelist){if(r.includes("-")){var s=r.split("-")[0],o=this.services.languageUtils.formatLanguageCode(s);if(this.services.languageUtils.isWhitelisted(o))return o;r=o}var a=this.i18nOptions.whitelist.find(function(u){var l=i.services.languageUtils.formatLanguageCode(u);if(l.startsWith(r))return l});if(a)return a}}}]),n}();iN.type="languageDetector";var tq={autoplay:`The media that tried to play (with '{{src}}') wasn't allowed to by this browser, most likely due to the browser's autoplay policy.

+ More info: {{url}}`,checkUserDefinedFns:"It seems that you may have accidentally written {{name}} instead of {{actualName}}. Please correct it if it's not intentional.",fileLoadError:{bytes:"It looks like there was a problem loading your file. {{suggestion}}",font:"It looks like there was a problem loading your font. {{suggestion}}",gif:"There was some trouble loading your GIF. Make sure that your GIF is using 87a or 89a encoding.",image:"It looks like there was a problem loading your image. {{suggestion}}",json:"It looks like there was a problem loading your JSON file. {{suggestion}}",large:"If your large file isn't fetched successfully, we recommend splitting the file into smaller segments and fetching those.",strings:"It looks like there was a problem loading your text file. {{suggestion}}",suggestion:`Try checking if the file path ({{filePath}}) is correct, hosting the file online, or running a local server.

+ More info: {{url}}`,table:"It looks like there was a problem loading your table file. {{suggestion}}",xml:"It looks like there was a problem loading your XML file. {{suggestion}}"},friendlyParamError:{type_EMPTY_VAR:`{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received an empty variable instead. If not intentional, this is often a problem with scope.

+ More info: {{url}}`,type_TOO_FEW_ARGUMENTS:"{{location}} {{func}}() was expecting at least {{minParams}} arguments, but received only {{argCount}}.",type_TOO_MANY_ARGUMENTS:"{{location}} {{func}}() was expecting no more than {{maxParams}} arguments, but received {{argCount}}.",type_WRONG_TYPE:"{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received {{argType}} instead."},globalErrors:{reference:{cannotAccess:`
{{location}} "{{symbol}}" is used before declaration. Make sure you have declared the variable before using it.

+ More info: {{url}}`,notDefined:`
{{location}} "{{symbol}}" is not defined in the current scope. If you have defined it in your code, you should check its scope, spelling, and letter-casing (JavaScript is case-sensitive).

+ More info: {{url}}`},stackSubseq:`[{{location}}] 
	 Called from line {{line}} in {{func}}()
`,stackTop:`[{{location}}] 
	 Error at line {{line}} in {{func}}()
`,syntax:{badReturnOrYield:`
Syntax Error - return lies outside of a function. Make sure youre not missing any brackets, so that return lies inside a function.

+ More info: {{url}}`,invalidToken:`
Syntax Error - Found a symbol that JavaScript doesn't recognize or didn't expect at it's place.

+ More info: {{url}}`,missingInitializer:`
Syntax Error - A const variable is declared but not initialized. In JavaScript, an initializer for a const is required. A value must be specified in the same statement in which the variable is declared. Check the line number in the error and assign the const variable a value.

+ More info: {{url}}`,redeclaredVariable:`
Syntax Error - "{{symbol}}" is being redeclared. JavaScript doesn't allow declaring a variable more than once. Check the line number in error for redeclaration of the variable.

+ More info: {{url}}`,unexpectedToken:`
Syntax Error - Symbol present at a place that wasn't expected.
Usually this is due to a typo. Check the line number in the error for anything missing/extra.

+ More info: {{url}}`},type:{constAssign:`
{{location}} A const variable is being re-assigned. In javascript, re-assigning a value to a constant is not allowed. If you want to re-assign new values to a variable, make sure it is declared as var or let.

+ More info: {{url}}`,notfunc:`
{{location}} "{{symbol}}" could not be called as a function.
Check the spelling, letter-casing (JavaScript is case-sensitive) and its type.

+ More info: {{url}}`,notfuncObj:`
{{location}} "{{symbol}}" could not be called as a function.
Verify whether "{{obj}}" has "{{symbol}}" in it and check the spelling, letter-casing (JavaScript is case-sensitive) and its type.

+ More info: {{url}}`,readFromNull:`
{{location}} The property of null can't be read. In javascript the value null indicates that an object has no value.

+ More info: {{url}}`,readFromUndefined:`
{{location}} Cannot read property of undefined. Check the line number in error and make sure the variable which is being operated is not undefined.

 + More info: {{url}}`}},libraryError:'{{location}} An error with message "{{error}}" occurred inside the p5js library when {{func}} was called. If not stated otherwise, it might be an issue with the arguments passed to {{func}}.',location:"[{{file}}, line {{line}}]",misspelling:'{{location}} It seems that you may have accidentally written "{{name}}" instead of "{{actualName}}". Please correct it to {{actualName}} if you wish to use the {{type}} from p5.js.',misspelling_plural:`{{location}} It seems that you may have accidentally written "{{name}}".
You may have meant one of the following: 
{{suggestions}}`,misusedTopLevel:`Did you just try to use p5.js's {{symbolName}} {{symbolType}}? If so, you may want to move it into your sketch's setup() function.

+ More info: {{url}}`,preloadDisabled:"The preload() function has been removed in p5.js 2.0. Please load assets in setup() using async / await keywords or callbacks instead. See https://dev.to/limzykenneth/asynchronous-p5js-20-458f for more information.",positions:{p_1:"first",p_10:"tenth",p_11:"eleventh",p_12:"twelfth",p_2:"second",p_3:"third",p_4:"fourth",p_5:"fifth",p_6:"sixth",p_7:"seventh",p_8:"eighth",p_9:"ninth"},pre:`
 p5.js says: {{message}}`,sketchReaderErrors:{reservedConst:`you have used a p5.js reserved variable "{{symbol}}" make sure you change the variable name to something else.

+ More info: {{url}}`,reservedFunc:`you have used a p5.js reserved function "{{symbol}}" make sure you change the function name to something else.

+ More info: {{url}}`},welcome:"Welcome! This is your friendly debugger. To turn me off, switch to using p5.min.js.",wrongPreload:'{{location}} An error with message "{{error}}" occurred inside the p5js library when "{{func}}" was called. If not stated otherwise, it might be due to "{{func}}" being called from preload. Nothing besides load calls (loadImage, loadJSON, loadFont, loadStrings, etc.) should be inside the preload function.'},rq={fes:tq},Oc={en:{translation:rq}};const nq=["en","es","ko","zh","hi","ja"];if(typeof IS_MINIFIED>"u"&&typeof P5_DEV_BUILD<"u"){let n=require("../../translations/dev");for(const t of Object.keys(n)){const r=t.split("_"),i=r.slice(0,r.length-1).join("-"),s=r[r.length-1];Oc[i]=Oc[i]||{},Oc[i][s]=n[t]}}class sN{constructor(t,r){this.init(t,r)}fetchWithTimeout(t,r,i=2e3){return Promise.race([fetch(t,r),new Promise((s,o)=>setTimeout(()=>o(new Error("timeout")),i))])}init(t,r={}){this.services=t,this.options=r}read(t,r,i){const s=this.options.loadPath;if(t===this.options.fallback)i(null,Oc[t][r]);else if(nq.includes(t)){const o=this.services.interpolator.interpolate(s,{lng:t,ns:r});this.loadUrl(o,i)}else i("Not found",!1)}loadUrl(t,r){this.fetchWithTimeout(t).then(i=>{if(!i.ok)throw new Error(`failed loading ${t}`);return i.json()},()=>{throw new Error(`failed loading ${t}`)}).then(i=>r(null,i)).catch(r)}}sN.type="backend";let pt=(n,t)=>{console.debug("p5.js translator called before translations were loaded"),rN.t(n,t)};const iq=()=>rN.use(iN).use(sN).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:Oc}).then(t=>{pt=t},t=>console.debug(`Translations failed to load (${t})`)),sq={ReferenceError:[{msg:"{{}} is not defined",type:"NOTDEFINED",browser:"all"},{msg:"Can't find variable: {{}}",type:"NOTDEFINED",browser:"Safari"},{msg:"Cannot access '{{.}}' before initialization",type:"CANNOTACCESS",browser:"Chrome"},{msg:"can't access lexical declaration '{{.}}' before initialization",type:"CANNOTACCESS",browser:"Firefox"}],SyntaxError:[{msg:"illegal character",type:"INVALIDTOKEN",browser:"Firefox"},{msg:"Invalid character",type:"INVALIDTOKEN",browser:"Safari"},{msg:"Invalid or unexpected token",type:"INVALIDTOKEN",browser:"Chrome"},{msg:"Unexpected token '{{.}}'",type:"UNEXPECTEDTOKEN",browser:"Chrome"},{msg:"expected {{.}}, got '{{.}}'",type:"UNEXPECTEDTOKEN",browser:"Chrome"},{msg:"Identifier '{{.}}' has already been declared",type:"REDECLAREDVARIABLE",browser:"Chrome"},{msg:"redeclaration of {} {{.}}",type:"REDECLAREDVARIABLE",browser:"Firefox"},{msg:"Missing initializer in const declaration",type:"MISSINGINITIALIZER",browser:"Chrome"},{msg:"missing = in const declaration",type:"MISSINGINITIALIZER",browser:"Firefox"},{msg:"Illegal return statement",type:"BADRETURNORYIELD",browser:"Chrome"},{msg:"return not in function",type:"BADRETURNORYIELD",browser:"Firefox"}],TypeError:[{msg:"{{.}} is not a function",type:"NOTFUNC",browser:"all"},{msg:"Cannot read {{.}} null",type:"READNULL",browser:"Chrome"},{msg:"{{.}} is null",type:"READNULL",browser:"Firefox"},{msg:"Cannot read {{.}} undefined",type:"READUDEFINED",browser:"Chrome"},{msg:"{{.}} is undefined",type:"READUDEFINED",browser:"Firefox"},{msg:"Assignment to constant variable",type:"CONSTASSIGN",browser:"Chrome"},{msg:"invalid assignment to const '{{.}}'",type:"CONSTASSIGN",browser:"Firefox"}]};function oN(n,t){const r=["#2D7BB6","#EE9900","#4DB200","#C83C00"];let i=null,s=null;const o=2;class a extends Error{}if(typeof IS_MINIFIED<"u")n._friendlyError=n._checkForUserDefinedFunctions=n._fesErrorMonitor=()=>{};else{const c={},h=c.toString,f=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(let S=0;S<f.length;S++)c[`[object ${f[S]}]`]=f[S].toLowerCase();const d=S=>S==null?`${S}`:typeof S=="object"||typeof S=="function"?c[h.call(S)]||"object":typeof S,p=["setup","draw","deviceMoved","deviceTurned","deviceShaken","doubleClicked","mousePressed","mouseReleased","mouseMoved","mouseDragged","mouseClicked","mouseWheel","touchStarted","touchMoved","touchEnded","keyPressed","keyReleased","keyTyped","windowResized"],g=(S,R)=>{let w="";if(R==null||R.substring(0,4)==="load")w=S;else{const x=R.split("."),b=x.length>1?`${x[0]}.${x[1]}`:"p5",A=x.length===1?R:x.slice(2).join("/");A.startsWith("p5.")?w=`${S} (https://p5js.org/reference/${b}.${A})`:w=`${S} (https://p5js.org/reference/${b}/${A})`}return w};n._report=(S,R,w)=>{const x=n._fesLogger==null?console.log.bind(console):n._fesLogger;d(w)==="undefined"?w="#B40033":d(w)==="number"&&(w=r[w]),S=g(S,R);const b=pt("fes.pre",{message:S});x(b)},n._error=(S,R,w)=>{throw n._report(R,w),S.hitCriticalError=!0,new a("Stopping sketch to prevent more errors")},n._friendlyError=function(S,R,w){n._report(S,R,w)},n._friendlyAutoplayError=function(S){const R=pt("fes.autoplay",{src:S,url:"https://developer.mozilla.org/docs/Web/Media/Autoplay_guide"});console.log(pt("fes.pre",{message:R}))};const y=(S,R)=>{const w=S.length,x=R.length;if(w===0)return R;if(x===0)return S;let b=[],A=[];for(let k=0;k<x+1;k++)A[k]=k;b=A;for(let k=1;k<w+1;k++){A=[];for(let N=0;N<x+1;N++)if(N===0)A[N]=k;else{let I=S[k-1],j=R[N-1],Q=999999,le=I.toLowerCase()===j.toLowerCase()?0:1;Q=Q>le+b[N-1]?le+b[N-1]:Q,Q=Q>1+A[N-1]?1+A[N-1]:Q,Q=Q>1+b[N]?1+b[N]:Q,A[N]=Q}b=A}return A[x]};n.isPreloadSupported=function(){return!1};const v=S=>{if(n.disableFriendlyErrors)return;S=S instanceof n?S:window;const w=p;S.preload&&!n.isPreloadSupported()&&n._error(S,pt("fes.preloadDisabled"));const x={};w.forEach(b=>{x[b.toLowerCase()]=b});for(const b of Object.keys(S)){const A=b.toLowerCase();if(x.hasOwnProperty(A)&&!S[x[A]]&&typeof S[b]=="function"){const k=pt("fes.checkUserDefinedFns",{name:b,actualName:x[A]});n._friendlyError(k,x[A])}}},T=(S,R)=>{i||s();const w={};let x=999999;if(i.forEach(A=>{let k=y(S,A.name);w[k]?w[k].push(A):w[k]=[A],k<x&&(x=k)}),x>Math.min(o,S.length))return!1;const b=w[x].filter(A=>A.name!==S);if(b.length!==0){const A=n._getErrorStackParser().parse(R);let k;A&&A[0]&&A[0].fileName&&A[0].lineNumber&&A[0].columnNumber&&(k={location:`${A[0].fileName}:${A[0].lineNumber}:${A[0].columnNumber}`,file:A[0].fileName.split("/").slice(-1),line:A[0].lineNumber});let N;if(b.length===1)N=pt("fes.misspelling",{name:S,actualName:b[0].name,type:b[0].type,location:k?pt("fes.location",k):"",count:b.length});else{const I=b.map(j=>{const Q=" "+j.name+(j.type==="function"?"()":"");return g(Q,j.name)}).join(`
`);N=pt("fes.misspelling",{name:S,suggestions:I,location:k?pt("fes.location",k):"",count:b.length})}return n._friendlyError(N,b.length===1?b[0].name:void 0),!0}return!1},_=S=>{const R=n._fesLogger&&typeof n._fesLogger=="function"?n._fesLogger:console.log.bind(console);if(S.length>1){let w="";S.forEach((x,b)=>{const A=`${x.fileName}:${x.lineNumber}:${x.columnNumber}`;let k,N={func:x.functionName,line:x.lineNumber,location:A,file:x.fileName.split("/").slice(-1)};b===0?k=pt("fes.globalErrors.stackTop",N):k=pt("fes.globalErrors.stackSubseq",N),w+=k}),R(w)}},C=(S,R)=>{if(!R)return[!1,null];R.forEach(k=>{k.functionName=k.functionName||""});let w=!1,x,b,A;try{throw new Error}catch(k){x=n._getErrorStackParser().parse(k)[0].fileName}for(let k=R.length-1;k>=0;k--){let N=R[k].functionName.split(".");if(p.includes(N[N.length-1])){if(b=R.slice(0,k+1),A=N[N.length-1],R[0].fileName===x){w=!0;break}break}}if(b||(b=R),w){if(b=b.map((I,j)=>(I.frameIndex=j,I)).filter(I=>I.fileName!==x),b.length===0)return[!0,null];const k=R[b[0].frameIndex-2].functionName.split(".").slice(-1)[0];let N;if(b[0].fileName&&b[0].lineNumber&&b[0].columnNumber&&(N={location:`${b[0].fileName}:${b[0].lineNumber}:${b[0].columnNumber}`,file:b[0].fileName.split("/").slice(-1),line:b[0].lineNumber},n._fesLogCache[N.location]))return[!0,null];A==="preload"&&t._preloadMethods[k]==null?n._friendlyError(pt("fes.wrongPreload",{func:k,location:N?pt("fes.location",N):"",error:S.message}),"preload"):n._friendlyError(pt("fes.libraryError",{func:k,location:N?pt("fes.location",N):"",error:S.message}),k),b&&b.length&&_(b)}return[w,b]},E=S=>{if(n.disableFriendlyErrors||S&&(S instanceof a||S.reason instanceof a))return;let R;if(S instanceof Error)R=S;else if(S instanceof ErrorEvent)R=S.error;else if(S instanceof PromiseRejectionEvent&&(R=S.reason,!(R instanceof Error)))return;if(!R)return;let w=n._getErrorStackParser().parse(R),[x,b]=C(R,w);if(x)return;const A=sq[R.name];if(!A)return;let k;for(const I of A){let j=I.msg;j=j.replace(new RegExp("{{}}","g"),"([a-zA-Z0-9_]+)"),j=j.replace(new RegExp("{{.}}","g"),"(.+)"),j=j.replace(new RegExp("{}","g"),"(?:[a-zA-Z0-9_]+)");let Q=R.message.match(j);if(Q){k=Object.assign({},I),k.match=Q;break}}if(!k)return;let N;switch(w&&w[0].fileName&&w[0].lineNumber&&w[0].columnNumber&&(N={location:`${w[0].fileName}:${w[0].lineNumber}:${w[0].columnNumber}`,file:w[0].fileName.split("/").slice(-1),line:b[0].lineNumber}),R.name){case"SyntaxError":{switch(k.type){case"INVALIDTOKEN":{n._friendlyError(pt("fes.globalErrors.syntax.invalidToken",{url:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Illegal_character#What_went_wrong"}));break}case"UNEXPECTEDTOKEN":{n._friendlyError(pt("fes.globalErrors.syntax.unexpectedToken",{url:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Unexpected_token#What_went_wrong"}));break}case"REDECLAREDVARIABLE":{let I=k.match[1];n._friendlyError(pt("fes.globalErrors.syntax.redeclaredVariable",{symbol:I,url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Redeclared_parameter#what_went_wrong"}));break}case"MISSINGINITIALIZER":{n._friendlyError(pt("fes.globalErrors.syntax.missingInitializer",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Missing_initializer_in_const#what_went_wrong"}));break}case"BADRETURNORYIELD":{n._friendlyError(pt("fes.globalErrors.syntax.badReturnOrYield",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Bad_return_or_yield#what_went_wrong"}));break}}break}case"ReferenceError":{switch(k.type){case"NOTDEFINED":{let I=k.match[1];if(I&&T(I,R))break;n._friendlyError(pt("fes.globalErrors.reference.notDefined",{url:"https://p5js.org/examples/data-variable-scope.html",symbol:I,location:N?pt("fes.location",N):""})),b&&_(b);break}case"CANNOTACCESS":{let I=k.match[1];n._friendlyError(pt("fes.globalErrors.reference.cannotAccess",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_lexical_declaration_before_init#what_went_wrong",symbol:I,location:N?pt("fes.location",N):""})),b&&_(b);break}}break}case"TypeError":switch(k.type){case"NOTFUNC":{let j=k.match[1].split("."),le={url:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Not_a_function#What_went_wrong",symbol:j[j.length-1],obj:j.slice(0,j.length-1).join("."),location:N?pt("fes.location",N):""};j.length>1?n._friendlyError(pt("fes.globalErrors.type.notfuncObj",le)):n._friendlyError(pt("fes.globalErrors.type.notfunc",le)),b&&_(b);break}case"READNULL":{let I=k.match[1];n._friendlyError(pt("fes.globalErrors.type.readFromNull",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong",symbol:I,location:N?pt("fes.location",N):""})),b&&_(b);break}case"READUDEFINED":{let I=k.match[1];n._friendlyError(pt("fes.globalErrors.type.readFromUndefined",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong",symbol:I,location:N?pt("fes.location",N):""})),b&&_(b);break}case"CONSTASSIGN":{n._friendlyError(pt("fes.globalErrors.type.constAssign",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Invalid_const_assignment#what_went_wrong",location:N?pt("fes.location",N):""})),b&&_(b);break}}}};n._fesErrorMonitor=E,n._checkForUserDefinedFunctions=v,n._fesLogger=null,n._fesLogCache={},window.addEventListener("load",v,!1),window.addEventListener("error",n._fesErrorMonitor,!1),window.addEventListener("unhandledrejection",n._fesErrorMonitor,!1)}i=null;const u="https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup";s=()=>{const c={},h=f=>Object.getOwnPropertyNames(f).filter(d=>d[0]==="_"||d in c?!1:(c[d]=!0,!0)).map(d=>{let p;return typeof f[d]=="function"?p="function":d===d.toUpperCase()?p="constant":p="variable",{name:d,type:p}});i=[].concat(h(t),h(ka)),i.sort((f,d)=>d.name.length-f.name.length)};const l=(c,h)=>{h||(h=console.log.bind(console)),i||s(),i.some(f=>{if(c.message&&c.message.match(`\\W?${f.name}\\W`)!==null){const d=f.type==="function"?`${f.name}()`:f.name;return h(typeof IS_MINIFIED<"u"?`Did you just try to use p5.js's ${d} ${f.type}? If so, you may want to move it into your sketch's setup() function.

For more details, see: ${u}`:pt("fes.misusedTopLevel",{symbolName:d,symbolType:f.type,url:u})),!0}})};t._helpForMisusedAtTopLevelCode=l,document.readyState!=="complete"&&(window.addEventListener("error",l,!1),window.addEventListener("load",()=>{window.removeEventListener("error",l,!1)}))}typeof p5<"u"&&oN(p5,p5.prototype);function oq(){let n=/(^|@)\S+:\d+/,t=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(s){if(typeof s.stacktrace<"u"||typeof s["opera#sourceloc"]<"u")return this.parseOpera(s);if(s.stack&&s.stack.match(t))return this.parseV8OrIE(s);if(s.stack)return this.parseFFOrSafari(s)},extractLocation:function(s){if(s.indexOf(":")===-1)return[s];let a=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(s.replace(/[()]/g,""));return[a[1],a[2]||void 0,a[3]||void 0]},parseV8OrIE:function(s){return s.stack.split(`
`).filter(function(a){return!!a.match(t)},this).map(function(a){a.indexOf("(eval ")>-1&&(a=a.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let u=a.replace(/^\s+/,"").replace(/\(eval code/g,"("),l=u.match(/ (\((.+):(\d+):(\d+)\)$)/);u=l?u.replace(l[0],""):u;let c=u.split(/\s+/).slice(1),h=this.extractLocation(l?l[1]:c.pop()),f=c.join(" ")||void 0,d=["eval","<anonymous>"].indexOf(h[0])>-1?void 0:h[0];return{functionName:f,fileName:d,lineNumber:h[1],columnNumber:h[2],source:a}},this)},parseFFOrSafari:function(s){return s.stack.split(`
`).filter(function(a){return!a.match(r)},this).map(function(a){if(a.indexOf(" > eval")>-1&&(a=a.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),a.indexOf("@")===-1&&a.indexOf(":")===-1)return{functionName:a};{let u=/((.*".+"[^@]*)?[^@]*)(?:@)/,l=a.match(u),c=l&&l[1]?l[1]:void 0,h=this.extractLocation(a.replace(u,""));return{functionName:c,fileName:h[0],lineNumber:h[1],columnNumber:h[2],source:a}}},this)},parseOpera:function(s){return!s.stacktrace||s.message.indexOf(`
`)>-1&&s.message.split(`
`).length>s.stacktrace.split(`
`).length?this.parseOpera9(s):s.stack?this.parseOpera11(s):this.parseOpera10(s)},parseOpera9:function(s){let o=/Line (\d+).*script (?:in )?(\S+)/i,a=s.message.split(`
`),u=[];for(let l=2,c=a.length;l<c;l+=2){let h=o.exec(a[l]);h&&u.push({fileName:h[2],lineNumber:h[1],source:a[l]})}return u},parseOpera10:function(s){let o=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,a=s.stacktrace.split(`
`),u=[];for(let l=0,c=a.length;l<c;l+=2){let h=o.exec(a[l]);h&&u.push({functionName:h[3]||void 0,fileName:h[2],lineNumber:h[1],source:a[l]})}return u},parseOpera11:function(s){return s.stack.split(`
`).filter(function(a){return!!a.match(n)&&!a.match(/^Error created at/)},this).map(function(a){let u=a.split("@"),l=this.extractLocation(u.pop()),c=u.shift()||"",h=c.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,f;c.match(/\(([^)]*)\)/)&&(f=c.replace(/^[^(]+\(([^)]*)\)$/,"$1"));let d=f===void 0||f==="[arguments not available]"?void 0:f.split(",");return{functionName:h,args:d,fileName:l[0],lineNumber:l[1],columnNumber:l[2],source:a}},this)}}}function aN(n,t){n._getErrorStackParser=function(){return new oq}}typeof p5<"u"&&aN(p5,p5.prototype);var Vt;(function(n){n.assertEqual=s=>{};function t(s){}n.assertIs=t;function r(s){throw new Error}n.assertNever=r,n.arrayToEnum=s=>{const o={};for(const a of s)o[a]=a;return o},n.getValidEnumValues=s=>{const o=n.objectKeys(s).filter(u=>typeof s[s[u]]!="number"),a={};for(const u of o)a[u]=s[u];return n.objectValues(a)},n.objectValues=s=>n.objectKeys(s).map(function(o){return s[o]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const o=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&o.push(a);return o},n.find=(s,o)=>{for(const a of s)if(o(a))return a},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function i(s,o=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(o)}n.joinValues=i,n.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(Vt||(Vt={}));var CS;(function(n){n.mergeShapes=(t,r)=>({...t,...r})})(CS||(CS={}));const Je=Vt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ws=n=>{switch(typeof n){case"undefined":return Je.undefined;case"string":return Je.string;case"number":return Number.isNaN(n)?Je.nan:Je.number;case"boolean":return Je.boolean;case"function":return Je.function;case"bigint":return Je.bigint;case"symbol":return Je.symbol;case"object":return Array.isArray(n)?Je.array:n===null?Je.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?Je.promise:typeof Map<"u"&&n instanceof Map?Je.map:typeof Set<"u"&&n instanceof Set?Je.set:typeof Date<"u"&&n instanceof Date?Je.date:Je.object;default:return Je.unknown}},Be=Vt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ni extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(o){return o.message},i={_errors:[]},s=o=>{for(const a of o.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)i._errors.push(r(a));else{let u=i,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(r(a))):u[c]=u[c]||{_errors:[]},u=u[c],l++}}};return s(this),i}static assert(t){if(!(t instanceof ni))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Vt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},i=[];for(const s of this.issues)if(s.path.length>0){const o=s.path[0];r[o]=r[o]||[],r[o].push(t(s))}else i.push(t(s));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}}ni.create=n=>new ni(n);const Sh=(n,t)=>{let r;switch(n.code){case Be.invalid_type:n.received===Je.undefined?r="Required":r=`Expected ${n.expected}, received ${n.received}`;break;case Be.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(n.expected,Vt.jsonStringifyReplacer)}`;break;case Be.unrecognized_keys:r=`Unrecognized key(s) in object: ${Vt.joinValues(n.keys,", ")}`;break;case Be.invalid_union:r="Invalid input";break;case Be.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Vt.joinValues(n.options)}`;break;case Be.invalid_enum_value:r=`Invalid enum value. Expected ${Vt.joinValues(n.options)}, received '${n.received}'`;break;case Be.invalid_arguments:r="Invalid function arguments";break;case Be.invalid_return_type:r="Invalid function return type";break;case Be.invalid_date:r="Invalid date";break;case Be.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(r=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?r=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?r=`Invalid input: must end with "${n.validation.endsWith}"`:Vt.assertNever(n.validation):n.validation!=="regex"?r=`Invalid ${n.validation}`:r="Invalid";break;case Be.too_small:n.type==="array"?r=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?r=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?r=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?r=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?r=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:r="Invalid input";break;case Be.too_big:n.type==="array"?r=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?r=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?r=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?r=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?r=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:r="Invalid input";break;case Be.custom:r="Invalid input";break;case Be.invalid_intersection_types:r="Intersection results could not be merged";break;case Be.not_multiple_of:r=`Number must be a multiple of ${n.multipleOf}`;break;case Be.not_finite:r="Number must be finite";break;default:r=t.defaultError,Vt.assertNever(n)}return{message:r}};let aq=Sh;function Wy(){return aq}const Ky=n=>{const{data:t,path:r,errorMaps:i,issueData:s}=n,o=[...r,...s.path||[]],a={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let u="";const l=i.filter(c=>!!c).slice().reverse();for(const c of l)u=c(a,{data:t,defaultError:u}).message;return{...s,path:o,message:u}};function Ye(n,t){const r=Wy(),i=Ky({issueData:t,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,r,r===Sh?void 0:Sh].filter(s=>!!s)});n.common.issues.push(i)}class Hn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const i=[];for(const s of r){if(s.status==="aborted")return mt;s.status==="dirty"&&t.dirty(),i.push(s.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,r){const i=[];for(const s of r){const o=await s.key,a=await s.value;i.push({key:o,value:a})}return Hn.mergeObjectSync(t,i)}static mergeObjectSync(t,r){const i={};for(const s of r){const{key:o,value:a}=s;if(o.status==="aborted"||a.status==="aborted")return mt;o.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),o.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(i[o.value]=a.value)}return{status:t.value,value:i}}}const mt=Object.freeze({status:"aborted"}),hc=n=>({status:"dirty",value:n}),Fn=n=>({status:"valid",value:n}),AS=n=>n.status==="aborted",TS=n=>n.status==="dirty",ml=n=>n.status==="valid",Sp=n=>typeof Promise<"u"&&n instanceof Promise;var nt;(function(n){n.errToObj=t=>typeof t=="string"?{message:t}:t||{},n.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(nt||(nt={}));class ko{constructor(t,r,i,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=i,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const IS=(n,t)=>{if(ml(t))return{success:!0,data:t.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new ni(n.common.issues);return this._error=r,this._error}}};function St(n){if(!n)return{};const{errorMap:t,invalid_type_error:r,required_error:i,description:s}=n;if(t&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,u)=>{const{message:l}=n;return a.code==="invalid_enum_value"?{message:l??u.defaultError}:typeof u.data>"u"?{message:l??i??u.defaultError}:a.code!=="invalid_type"?{message:u.defaultError}:{message:l??r??u.defaultError}},description:s}}class Pt{get description(){return this._def.description}_getType(t){return Ws(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Ws(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Hn,ctx:{common:t.parent.common,data:t.data,parsedType:Ws(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Sp(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const i=this.safeParse(t,r);if(i.success)return i.data;throw i.error}safeParse(t,r){const i={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ws(t)},s=this._parseSync({data:t,path:i.path,parent:i});return IS(i,s)}"~validate"(t){var i,s;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ws(t)};if(!this["~standard"].async)try{const o=this._parseSync({data:t,path:[],parent:r});return ml(o)?{value:o.value}:{issues:r.common.issues}}catch(o){(s=(i=o==null?void 0:o.message)==null?void 0:i.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(o=>ml(o)?{value:o.value}:{issues:r.common.issues})}async parseAsync(t,r){const i=await this.safeParseAsync(t,r);if(i.success)return i.data;throw i.error}async safeParseAsync(t,r){const i={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ws(t)},s=this._parse({data:t,path:i.path,parent:i}),o=await(Sp(s)?s:Promise.resolve(s));return IS(i,o)}refine(t,r){const i=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,o)=>{const a=t(s),u=()=>o.addIssue({code:Be.custom,...i(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(u(),!1)):a?!0:(u(),!1)})}refinement(t,r){return this._refinement((i,s)=>t(i)?!0:(s.addIssue(typeof r=="function"?r(i,s):r),!1))}_refinement(t){return new _l({schema:this,typeName:yt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return _o.create(this,this._def)}nullable(){return bl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Bi.create(this)}promise(){return Dh.create(this,this._def)}or(t){return Th.create([this,t],this._def)}and(t){return Ap.create(this,t,this._def)}transform(t){return new _l({...St(this._def),schema:this,typeName:yt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new Qy({...St(this._def),innerType:this,defaultValue:r,typeName:yt.ZodDefault})}brand(){return new kq({typeName:yt.ZodBranded,type:this,...St(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new Jy({...St(this._def),innerType:this,catchValue:r,typeName:yt.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return T_.create(this,t)}readonly(){return ev.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const uq=/^c[^\s-]{8,}$/i,lq=/^[0-9a-z]+$/,cq=/^[0-9A-HJKMNP-TV-Z]{26}$/i,hq=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,fq=/^[a-z0-9_-]{21}$/i,dq=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,pq=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,gq=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,mq="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let e0;const yq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,vq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,_q=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,bq=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xq=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wq=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,uN="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Eq=new RegExp(`^${uN}$`);function lN(n){let t="[0-5]\\d";n.precision?t=`${t}\\.\\d{${n.precision}}`:n.precision==null&&(t=`${t}(\\.\\d+)?`);const r=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function Sq(n){return new RegExp(`^${lN(n)}$`)}function Cq(n){let t=`${uN}T${lN(n)}`;const r=[];return r.push(n.local?"Z?":"Z"),n.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Aq(n,t){return!!((t==="v4"||!t)&&yq.test(n)||(t==="v6"||!t)&&_q.test(n))}function Tq(n,t){if(!dq.test(n))return!1;try{const[r]=n.split(".");if(!r)return!1;const i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(i));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Iq(n,t){return!!((t==="v4"||!t)&&vq.test(n)||(t==="v6"||!t)&&bq.test(n))}class oo extends Pt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Je.string){const o=this._getOrReturnCtx(t);return Ye(o,{code:Be.invalid_type,expected:Je.string,received:o.parsedType}),mt}const i=new Hn;let s;for(const o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="max")t.data.length>o.value&&(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="length"){const a=t.data.length>o.value,u=t.data.length<o.value;(a||u)&&(s=this._getOrReturnCtx(t,s),a?Ye(s,{code:Be.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):u&&Ye(s,{code:Be.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),i.dirty())}else if(o.kind==="email")gq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"email",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="emoji")e0||(e0=new RegExp(mq,"u")),e0.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"emoji",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="uuid")hq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"uuid",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="nanoid")fq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"nanoid",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid")uq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"cuid",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid2")lq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"cuid2",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="ulid")cq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"ulid",code:Be.invalid_string,message:o.message}),i.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),Ye(s,{validation:"url",code:Be.invalid_string,message:o.message}),i.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"regex",code:Be.invalid_string,message:o.message}),i.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),i.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.invalid_string,validation:{startsWith:o.value},message:o.message}),i.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.invalid_string,validation:{endsWith:o.value},message:o.message}),i.dirty()):o.kind==="datetime"?Cq(o).test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.invalid_string,validation:"datetime",message:o.message}),i.dirty()):o.kind==="date"?Eq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.invalid_string,validation:"date",message:o.message}),i.dirty()):o.kind==="time"?Sq(o).test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.invalid_string,validation:"time",message:o.message}),i.dirty()):o.kind==="duration"?pq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"duration",code:Be.invalid_string,message:o.message}),i.dirty()):o.kind==="ip"?Aq(t.data,o.version)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"ip",code:Be.invalid_string,message:o.message}),i.dirty()):o.kind==="jwt"?Tq(t.data,o.alg)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"jwt",code:Be.invalid_string,message:o.message}),i.dirty()):o.kind==="cidr"?Iq(t.data,o.version)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"cidr",code:Be.invalid_string,message:o.message}),i.dirty()):o.kind==="base64"?xq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"base64",code:Be.invalid_string,message:o.message}),i.dirty()):o.kind==="base64url"?wq.test(t.data)||(s=this._getOrReturnCtx(t,s),Ye(s,{validation:"base64url",code:Be.invalid_string,message:o.message}),i.dirty()):Vt.assertNever(o);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(s=>t.test(s),{validation:r,code:Be.invalid_string,...nt.errToObj(i)})}_addCheck(t){return new oo({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...nt.errToObj(t)})}url(t){return this._addCheck({kind:"url",...nt.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...nt.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...nt.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...nt.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...nt.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...nt.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...nt.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...nt.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...nt.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...nt.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...nt.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...nt.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...nt.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...nt.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...nt.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...nt.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...nt.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...nt.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...nt.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...nt.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...nt.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...nt.errToObj(r)})}nonempty(t){return this.min(1,nt.errToObj(t))}trim(){return new oo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new oo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new oo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}oo.create=n=>new oo({checks:[],typeName:yt.ZodString,coerce:(n==null?void 0:n.coerce)??!1,...St(n)});function Dq(n,t){const r=(n.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,s=r>i?r:i,o=Number.parseInt(n.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return o%a/10**s}class yl extends Pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Je.number){const o=this._getOrReturnCtx(t);return Ye(o,{code:Be.invalid_type,expected:Je.number,received:o.parsedType}),mt}let i;const s=new Hn;for(const o of this._def.checks)o.kind==="int"?Vt.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?Dq(t.data,o.value)!==0&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.not_finite,message:o.message}),s.dirty()):Vt.assertNever(o);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,nt.toString(r))}gt(t,r){return this.setLimit("min",t,!1,nt.toString(r))}lte(t,r){return this.setLimit("max",t,!0,nt.toString(r))}lt(t,r){return this.setLimit("max",t,!1,nt.toString(r))}setLimit(t,r,i,s){return new yl({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:nt.toString(s)}]})}_addCheck(t){return new yl({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:nt.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:nt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:nt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:nt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:nt.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:nt.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:nt.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:nt.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:nt.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Vt.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}}yl.create=n=>new yl({checks:[],typeName:yt.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...St(n)});class Ch extends Pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Je.bigint)return this._getInvalidInput(t);let i;const s=new Hn;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),Ye(i,{code:Be.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):Vt.assertNever(o);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:Je.bigint,received:r.parsedType}),mt}gte(t,r){return this.setLimit("min",t,!0,nt.toString(r))}gt(t,r){return this.setLimit("min",t,!1,nt.toString(r))}lte(t,r){return this.setLimit("max",t,!0,nt.toString(r))}lt(t,r){return this.setLimit("max",t,!1,nt.toString(r))}setLimit(t,r,i,s){return new Ch({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:nt.toString(s)}]})}_addCheck(t){return new Ch({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:nt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:nt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:nt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:nt.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:nt.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ch.create=n=>new Ch({checks:[],typeName:yt.ZodBigInt,coerce:(n==null?void 0:n.coerce)??!1,...St(n)});class Yy extends Pt{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Je.boolean){const i=this._getOrReturnCtx(t);return Ye(i,{code:Be.invalid_type,expected:Je.boolean,received:i.parsedType}),mt}return Fn(t.data)}}Yy.create=n=>new Yy({typeName:yt.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...St(n)});class Cp extends Pt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Je.date){const o=this._getOrReturnCtx(t);return Ye(o,{code:Be.invalid_type,expected:Je.date,received:o.parsedType}),mt}if(Number.isNaN(t.data.getTime())){const o=this._getOrReturnCtx(t);return Ye(o,{code:Be.invalid_date}),mt}const i=new Hn;let s;for(const o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),i.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(s=this._getOrReturnCtx(t,s),Ye(s,{code:Be.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),i.dirty()):Vt.assertNever(o);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Cp({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:nt.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:nt.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Cp.create=n=>new Cp({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:yt.ZodDate,...St(n)});class DS extends Pt{_parse(t){if(this._getType(t)!==Je.symbol){const i=this._getOrReturnCtx(t);return Ye(i,{code:Be.invalid_type,expected:Je.symbol,received:i.parsedType}),mt}return Fn(t.data)}}DS.create=n=>new DS({typeName:yt.ZodSymbol,...St(n)});class kS extends Pt{_parse(t){if(this._getType(t)!==Je.undefined){const i=this._getOrReturnCtx(t);return Ye(i,{code:Be.invalid_type,expected:Je.undefined,received:i.parsedType}),mt}return Fn(t.data)}}kS.create=n=>new kS({typeName:yt.ZodUndefined,...St(n)});class NS extends Pt{_parse(t){if(this._getType(t)!==Je.null){const i=this._getOrReturnCtx(t);return Ye(i,{code:Be.invalid_type,expected:Je.null,received:i.parsedType}),mt}return Fn(t.data)}}NS.create=n=>new NS({typeName:yt.ZodNull,...St(n)});class Ah extends Pt{constructor(){super(...arguments),this._any=!0}_parse(t){return Fn(t.data)}}Ah.create=n=>new Ah({typeName:yt.ZodAny,...St(n)});class Uu extends Pt{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Fn(t.data)}}Uu.create=n=>new Uu({typeName:yt.ZodUnknown,...St(n)});class No extends Pt{_parse(t){const r=this._getOrReturnCtx(t);return Ye(r,{code:Be.invalid_type,expected:Je.never,received:r.parsedType}),mt}}No.create=n=>new No({typeName:yt.ZodNever,...St(n)});class RS extends Pt{_parse(t){if(this._getType(t)!==Je.undefined){const i=this._getOrReturnCtx(t);return Ye(i,{code:Be.invalid_type,expected:Je.void,received:i.parsedType}),mt}return Fn(t.data)}}RS.create=n=>new RS({typeName:yt.ZodVoid,...St(n)});class Bi extends Pt{_parse(t){const{ctx:r,status:i}=this._processInputParams(t),s=this._def;if(r.parsedType!==Je.array)return Ye(r,{code:Be.invalid_type,expected:Je.array,received:r.parsedType}),mt;if(s.exactLength!==null){const a=r.data.length>s.exactLength.value,u=r.data.length<s.exactLength.value;(a||u)&&(Ye(r,{code:a?Be.too_big:Be.too_small,minimum:u?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),i.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(Ye(r,{code:Be.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),i.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(Ye(r,{code:Be.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((a,u)=>s.type._parseAsync(new ko(r,a,r.path,u)))).then(a=>Hn.mergeArray(i,a));const o=[...r.data].map((a,u)=>s.type._parseSync(new ko(r,a,r.path,u)));return Hn.mergeArray(i,o)}get element(){return this._def.type}min(t,r){return new Bi({...this._def,minLength:{value:t,message:nt.toString(r)}})}max(t,r){return new Bi({...this._def,maxLength:{value:t,message:nt.toString(r)}})}length(t,r){return new Bi({...this._def,exactLength:{value:t,message:nt.toString(r)}})}nonempty(t){return this.min(1,t)}}Bi.create=(n,t)=>new Bi({type:n,minLength:null,maxLength:null,exactLength:null,typeName:yt.ZodArray,...St(t)});function gu(n){if(n instanceof Tr){const t={};for(const r in n.shape){const i=n.shape[r];t[r]=_o.create(gu(i))}return new Tr({...n._def,shape:()=>t})}else return n instanceof Bi?new Bi({...n._def,type:gu(n.element)}):n instanceof _o?_o.create(gu(n.unwrap())):n instanceof bl?bl.create(gu(n.unwrap())):n instanceof Hi?Hi.create(n.items.map(t=>gu(t))):n}class Tr extends Pt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Vt.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==Je.object){const c=this._getOrReturnCtx(t);return Ye(c,{code:Be.invalid_type,expected:Je.object,received:c.parsedType}),mt}const{status:i,ctx:s}=this._processInputParams(t),{shape:o,keys:a}=this._getCached(),u=[];if(!(this._def.catchall instanceof No&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||u.push(c);const l=[];for(const c of a){const h=o[c],f=s.data[c];l.push({key:{status:"valid",value:c},value:h._parse(new ko(s,f,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof No){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of u)l.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(c==="strict")u.length>0&&(Ye(s,{code:Be.unrecognized_keys,keys:u}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of u){const f=s.data[h];l.push({key:{status:"valid",value:h},value:c._parse(new ko(s,f,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of l){const f=await h.key,d=await h.value;c.push({key:f,value:d,alwaysSet:h.alwaysSet})}return c}).then(c=>Hn.mergeObjectSync(i,c)):Hn.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(t){return nt.errToObj,new Tr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,i)=>{var o,a;const s=((a=(o=this._def).errorMap)==null?void 0:a.call(o,r,i).message)??i.defaultError;return r.code==="unrecognized_keys"?{message:nt.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Tr({...this._def,unknownKeys:"strip"})}passthrough(){return new Tr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Tr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Tr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:yt.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Tr({...this._def,catchall:t})}pick(t){const r={};for(const i of Vt.objectKeys(t))t[i]&&this.shape[i]&&(r[i]=this.shape[i]);return new Tr({...this._def,shape:()=>r})}omit(t){const r={};for(const i of Vt.objectKeys(this.shape))t[i]||(r[i]=this.shape[i]);return new Tr({...this._def,shape:()=>r})}deepPartial(){return gu(this)}partial(t){const r={};for(const i of Vt.objectKeys(this.shape)){const s=this.shape[i];t&&!t[i]?r[i]=s:r[i]=s.optional()}return new Tr({...this._def,shape:()=>r})}required(t){const r={};for(const i of Vt.objectKeys(this.shape))if(t&&!t[i])r[i]=this.shape[i];else{let o=this.shape[i];for(;o instanceof _o;)o=o._def.innerType;r[i]=o}return new Tr({...this._def,shape:()=>r})}keyof(){return cN(Vt.objectKeys(this.shape))}}Tr.create=(n,t)=>new Tr({shape:()=>n,unknownKeys:"strip",catchall:No.create(),typeName:yt.ZodObject,...St(t)});Tr.strictCreate=(n,t)=>new Tr({shape:()=>n,unknownKeys:"strict",catchall:No.create(),typeName:yt.ZodObject,...St(t)});Tr.lazycreate=(n,t)=>new Tr({shape:n,unknownKeys:"strip",catchall:No.create(),typeName:yt.ZodObject,...St(t)});class Th extends Pt{_parse(t){const{ctx:r}=this._processInputParams(t),i=this._def.options;function s(o){for(const u of o)if(u.result.status==="valid")return u.result;for(const u of o)if(u.result.status==="dirty")return r.common.issues.push(...u.ctx.common.issues),u.result;const a=o.map(u=>new ni(u.ctx.common.issues));return Ye(r,{code:Be.invalid_union,unionErrors:a}),mt}if(r.common.async)return Promise.all(i.map(async o=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(s);{let o;const a=[];for(const l of i){const c={...r,common:{...r.common,issues:[]},parent:null},h=l._parseSync({data:r.data,path:r.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!o&&(o={result:h,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;const u=a.map(l=>new ni(l));return Ye(r,{code:Be.invalid_union,unionErrors:u}),mt}}get options(){return this._def.options}}Th.create=(n,t)=>new Th({options:n,typeName:yt.ZodUnion,...St(t)});function Xy(n,t){const r=Ws(n),i=Ws(t);if(n===t)return{valid:!0,data:n};if(r===Je.object&&i===Je.object){const s=Vt.objectKeys(t),o=Vt.objectKeys(n).filter(u=>s.indexOf(u)!==-1),a={...n,...t};for(const u of o){const l=Xy(n[u],t[u]);if(!l.valid)return{valid:!1};a[u]=l.data}return{valid:!0,data:a}}else if(r===Je.array&&i===Je.array){if(n.length!==t.length)return{valid:!1};const s=[];for(let o=0;o<n.length;o++){const a=n[o],u=t[o],l=Xy(a,u);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return r===Je.date&&i===Je.date&&+n==+t?{valid:!0,data:n}:{valid:!1}}class Ap extends Pt{_parse(t){const{status:r,ctx:i}=this._processInputParams(t),s=(o,a)=>{if(AS(o)||AS(a))return mt;const u=Xy(o.value,a.value);return u.valid?((TS(o)||TS(a))&&r.dirty(),{status:r.value,value:u.data}):(Ye(i,{code:Be.invalid_intersection_types}),mt)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([o,a])=>s(o,a)):s(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}Ap.create=(n,t,r)=>new Ap({left:n,right:t,typeName:yt.ZodIntersection,...St(r)});class Hi extends Pt{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Je.array)return Ye(i,{code:Be.invalid_type,expected:Je.array,received:i.parsedType}),mt;if(i.data.length<this._def.items.length)return Ye(i,{code:Be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),mt;!this._def.rest&&i.data.length>this._def.items.length&&(Ye(i,{code:Be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const o=[...i.data].map((a,u)=>{const l=this._def.items[u]||this._def.rest;return l?l._parse(new ko(i,a,i.path,u)):null}).filter(a=>!!a);return i.common.async?Promise.all(o).then(a=>Hn.mergeArray(r,a)):Hn.mergeArray(r,o)}get items(){return this._def.items}rest(t){return new Hi({...this._def,rest:t})}}Hi.create=(n,t)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Hi({items:n,typeName:yt.ZodTuple,rest:null,...St(t)})};class FS extends Pt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Je.map)return Ye(i,{code:Be.invalid_type,expected:Je.map,received:i.parsedType}),mt;const s=this._def.keyType,o=this._def.valueType,a=[...i.data.entries()].map(([u,l],c)=>({key:s._parse(new ko(i,u,i.path,[c,"key"])),value:o._parse(new ko(i,l,i.path,[c,"value"]))}));if(i.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return mt;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),u.set(c.value,h.value)}return{status:r.value,value:u}})}else{const u=new Map;for(const l of a){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return mt;(c.status==="dirty"||h.status==="dirty")&&r.dirty(),u.set(c.value,h.value)}return{status:r.value,value:u}}}}FS.create=(n,t,r)=>new FS({valueType:t,keyType:n,typeName:yt.ZodMap,...St(r)});class Ih extends Pt{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Je.set)return Ye(i,{code:Be.invalid_type,expected:Je.set,received:i.parsedType}),mt;const s=this._def;s.minSize!==null&&i.data.size<s.minSize.value&&(Ye(i,{code:Be.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&i.data.size>s.maxSize.value&&(Ye(i,{code:Be.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const o=this._def.valueType;function a(l){const c=new Set;for(const h of l){if(h.status==="aborted")return mt;h.status==="dirty"&&r.dirty(),c.add(h.value)}return{status:r.value,value:c}}const u=[...i.data.values()].map((l,c)=>o._parse(new ko(i,l,i.path,c)));return i.common.async?Promise.all(u).then(l=>a(l)):a(u)}min(t,r){return new Ih({...this._def,minSize:{value:t,message:nt.toString(r)}})}max(t,r){return new Ih({...this._def,maxSize:{value:t,message:nt.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Ih.create=(n,t)=>new Ih({valueType:n,minSize:null,maxSize:null,typeName:yt.ZodSet,...St(t)});class Vc extends Pt{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Je.function)return Ye(r,{code:Be.invalid_type,expected:Je.function,received:r.parsedType}),mt;function i(u,l){return Ky({data:u,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Wy(),Sh].filter(c=>!!c),issueData:{code:Be.invalid_arguments,argumentsError:l}})}function s(u,l){return Ky({data:u,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Wy(),Sh].filter(c=>!!c),issueData:{code:Be.invalid_return_type,returnTypeError:l}})}const o={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof Dh){const u=this;return Fn(async function(...l){const c=new ni([]),h=await u._def.args.parseAsync(l,o).catch(p=>{throw c.addIssue(i(l,p)),c}),f=await Reflect.apply(a,this,h);return await u._def.returns._def.type.parseAsync(f,o).catch(p=>{throw c.addIssue(s(f,p)),c})})}else{const u=this;return Fn(function(...l){const c=u._def.args.safeParse(l,o);if(!c.success)throw new ni([i(l,c.error)]);const h=Reflect.apply(a,this,c.data),f=u._def.returns.safeParse(h,o);if(!f.success)throw new ni([s(h,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Vc({...this._def,args:Hi.create(t).rest(Uu.create())})}returns(t){return new Vc({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,i){return new Vc({args:t||Hi.create([]).rest(Uu.create()),returns:r||Uu.create(),typeName:yt.ZodFunction,...St(i)})}}class PS extends Pt{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}PS.create=(n,t)=>new PS({getter:n,typeName:yt.ZodLazy,...St(t)});class Zy extends Pt{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Ye(r,{received:r.data,code:Be.invalid_literal,expected:this._def.value}),mt}return{status:"valid",value:t.data}}get value(){return this._def.value}}Zy.create=(n,t)=>new Zy({value:n,typeName:yt.ZodLiteral,...St(t)});function cN(n,t){return new vl({values:n,typeName:yt.ZodEnum,...St(t)})}class vl extends Pt{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),i=this._def.values;return Ye(r,{expected:Vt.joinValues(i),received:r.parsedType,code:Be.invalid_type}),mt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),i=this._def.values;return Ye(r,{received:r.data,code:Be.invalid_enum_value,options:i}),mt}return Fn(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return vl.create(t,{...this._def,...r})}exclude(t,r=this._def){return vl.create(this.options.filter(i=>!t.includes(i)),{...this._def,...r})}}vl.create=cN;class MS extends Pt{_parse(t){const r=Vt.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==Je.string&&i.parsedType!==Je.number){const s=Vt.objectValues(r);return Ye(i,{expected:Vt.joinValues(s),received:i.parsedType,code:Be.invalid_type}),mt}if(this._cache||(this._cache=new Set(Vt.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Vt.objectValues(r);return Ye(i,{received:i.data,code:Be.invalid_enum_value,options:s}),mt}return Fn(t.data)}get enum(){return this._def.values}}MS.create=(n,t)=>new MS({values:n,typeName:yt.ZodNativeEnum,...St(t)});class Dh extends Pt{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Je.promise&&r.common.async===!1)return Ye(r,{code:Be.invalid_type,expected:Je.promise,received:r.parsedType}),mt;const i=r.parsedType===Je.promise?r.data:Promise.resolve(r.data);return Fn(i.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Dh.create=(n,t)=>new Dh({type:n,typeName:yt.ZodPromise,...St(t)});class _l extends Pt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===yt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:i}=this._processInputParams(t),s=this._def.effect||null,o={addIssue:a=>{Ye(i,a),a.fatal?r.abort():r.dirty()},get path(){return i.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){const a=s.transform(i.data,o);if(i.common.async)return Promise.resolve(a).then(async u=>{if(r.value==="aborted")return mt;const l=await this._def.schema._parseAsync({data:u,path:i.path,parent:i});return l.status==="aborted"?mt:l.status==="dirty"||r.value==="dirty"?hc(l.value):l});{if(r.value==="aborted")return mt;const u=this._def.schema._parseSync({data:a,path:i.path,parent:i});return u.status==="aborted"?mt:u.status==="dirty"||r.value==="dirty"?hc(u.value):u}}if(s.type==="refinement"){const a=u=>{const l=s.refinement(u,o);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(i.common.async===!1){const u=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return u.status==="aborted"?mt:(u.status==="dirty"&&r.dirty(),a(u.value),{status:r.value,value:u.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(u=>u.status==="aborted"?mt:(u.status==="dirty"&&r.dirty(),a(u.value).then(()=>({status:r.value,value:u.value}))))}if(s.type==="transform")if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ml(a))return mt;const u=s.transform(a.value,o);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:u}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>ml(a)?Promise.resolve(s.transform(a.value,o)).then(u=>({status:r.value,value:u})):mt);Vt.assertNever(s)}}_l.create=(n,t,r)=>new _l({schema:n,typeName:yt.ZodEffects,effect:t,...St(r)});_l.createWithPreprocess=(n,t,r)=>new _l({schema:t,effect:{type:"preprocess",transform:n},typeName:yt.ZodEffects,...St(r)});class _o extends Pt{_parse(t){return this._getType(t)===Je.undefined?Fn(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_o.create=(n,t)=>new _o({innerType:n,typeName:yt.ZodOptional,...St(t)});class bl extends Pt{_parse(t){return this._getType(t)===Je.null?Fn(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}bl.create=(n,t)=>new bl({innerType:n,typeName:yt.ZodNullable,...St(t)});class Qy extends Pt{_parse(t){const{ctx:r}=this._processInputParams(t);let i=r.data;return r.parsedType===Je.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Qy.create=(n,t)=>new Qy({innerType:n,typeName:yt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...St(t)});class Jy extends Pt{_parse(t){const{ctx:r}=this._processInputParams(t),i={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return Sp(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new ni(i.common.issues)},input:i.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ni(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}Jy.create=(n,t)=>new Jy({innerType:n,typeName:yt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...St(t)});class LS extends Pt{_parse(t){if(this._getType(t)!==Je.nan){const i=this._getOrReturnCtx(t);return Ye(i,{code:Be.invalid_type,expected:Je.nan,received:i.parsedType}),mt}return{status:"valid",value:t.data}}}LS.create=n=>new LS({typeName:yt.ZodNaN,...St(n)});class kq extends Pt{_parse(t){const{ctx:r}=this._processInputParams(t),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}}class T_ extends Pt{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?mt:o.status==="dirty"?(r.dirty(),hc(o.value)):this._def.out._parseAsync({data:o.value,path:i.path,parent:i})})();{const s=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?mt:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:i.path,parent:i})}}static create(t,r){return new T_({in:t,out:r,typeName:yt.ZodPipeline})}}class ev extends Pt{_parse(t){const r=this._def.innerType._parse(t),i=s=>(ml(s)&&(s.value=Object.freeze(s.value)),s);return Sp(r)?r.then(s=>i(s)):i(r)}unwrap(){return this._def.innerType}}ev.create=(n,t)=>new ev({innerType:n,typeName:yt.ZodReadonly,...St(t)});function OS(n,t){const r=typeof n=="function"?n(t):typeof n=="string"?{message:n}:n;return typeof r=="string"?{message:r}:r}function hN(n,t={},r){return n?Ah.create().superRefine((i,s)=>{const o=n(i);if(o instanceof Promise)return o.then(a=>{if(!a){const u=OS(t,i),l=u.fatal??r??!0;s.addIssue({code:"custom",...u,fatal:l})}});if(!o){const a=OS(t,i),u=a.fatal??r??!0;s.addIssue({code:"custom",...a,fatal:u})}}):Ah.create()}var yt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(yt||(yt={}));const VS=(n,t={message:`Input not instance of ${n.name}`})=>hN(r=>r instanceof n,t),Nq=oo.create,BS=yl.create,Rq=Yy.create,t0=Ah.create;Uu.create;No.create;const US=Bi.create,Fq=Tr.create,$S=Th.create;Ap.create;const jS=Hi.create,GS=Vc.create,zS=Zy.create;vl.create;Dh.create;_o.create;bl.create;var Pq={describe:{overloads:[["String","FALLBACK|LABEL?"]]},describeElement:{overloads:[["String","String","FALLBACK|LABEL?"]]},textOutput:{overloads:[["FALLBACK|LABEL?"]]},gridOutput:{overloads:[["FALLBACK|LABEL?"]]},p5:{overloads:[["Object","String|HTMLElement"]]},color:{overloads:[["Number","Number?"],["Number","Number","Number","Number?"],["String"],["Number[]"],["p5.Color"]]},red:{overloads:[["p5.Color|Number[]|String"]]},green:{overloads:[["p5.Color|Number[]|String"]]},blue:{overloads:[["p5.Color|Number[]|String"]]},alpha:{overloads:[["p5.Color|Number[]|String"]]},hue:{overloads:[["p5.Color|Number[]|String"]]},saturation:{overloads:[["p5.Color|Number[]|String"]]},brightness:{overloads:[["p5.Color|Number[]|String"]]},lightness:{overloads:[["p5.Color|Number[]|String"]]},lerpColor:{overloads:[["p5.Color","p5.Color","Number"]]},paletteLerp:{overloads:[["[p5.Color|String|Number|Number[], Number][]","Number"]]},beginClip:{overloads:[["Object?"]]},endClip:{overloads:[[]]},clip:{overloads:[["Function","Object?"]]},background:{overloads:[["p5.Color"],["String","Number?"],["Number","Number?"],["Number","Number","Number","Number?"],["Number[]"],["p5.Image","Number?"]]},clear:{overloads:[["Number?","Number?","Number?","Number?"],[]]},colorMode:{overloads:[["RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH","Number?"],["RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH","Number","Number","Number","Number?"]]},fill:{overloads:[["Number","Number","Number","Number?"],["String"],["Number","Number?"],["Number[]"],["p5.Color"]]},noFill:{overloads:[[]]},noStroke:{overloads:[[]]},stroke:{overloads:[["Number","Number","Number","Number?"],["String"],["Number","Number?"],["Number[]"],["p5.Color"]]},erase:{overloads:[["Number?","Number?"]]},noErase:{overloads:[[]]},blendMode:{overloads:[["BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|REMOVE|SUBTRACT"]]},print:{overloads:[["Any"],["String|Number|Array"]]},cursor:{overloads:[["ARROW|CROSS|HAND|MOVE|TEXT|WAIT|String","Number?","Number?"]]},frameRate:{overloads:[["Number"],[]]},getTargetFrameRate:{overloads:[[]]},noCursor:{overloads:[[]]},windowResized:{overloads:[["UIEvent?"]]},fullscreen:{overloads:[["Boolean?"]]},pixelDensity:{overloads:[["Number?"],[]]},displayDensity:{overloads:[[]]},getURL:{overloads:[[]]},getURLPath:{overloads:[[]]},getURLParams:{overloads:[[]]},worldToScreen:{overloads:[["Number|p5.Vector","Number","Number?"]]},screenToWorld:{overloads:[["Number|p5.Vector","Number","Number?"]]},setup:{overloads:[[]]},draw:{overloads:[[]]},createCanvas:{overloads:[["Number?","Number?","P2D|WEBGL|P2DHDR?","HTMLCanvasElement?"],["Number?","Number?","HTMLCanvasElement?"]]},resizeCanvas:{overloads:[["Number","Number","Boolean?"]]},noCanvas:{overloads:[[]]},createGraphics:{overloads:[["Number","Number","P2D|WEBGL?","HTMLCanvasElement?"],["Number","Number","HTMLCanvasElement?"]]},createFramebuffer:{overloads:[["Object?"]]},clearDepth:{overloads:[["Number?"]]},noLoop:{overloads:[[]]},loop:{overloads:[[]]},isLooping:{overloads:[[]]},redraw:{overloads:[["Integer?"]]},applyMatrix:{overloads:[["Array"],["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]},resetMatrix:{overloads:[[]]},rotate:{overloads:[["Number","p5.Vector|Number[]?"]]},rotateX:{overloads:[["Number"]]},rotateY:{overloads:[["Number"]]},rotateZ:{overloads:[["Number"]]},scale:{overloads:[["Number|p5.Vector|Number[]","Number?","Number?"],["p5.Vector|Number[]"]]},shearX:{overloads:[["Number"]]},shearY:{overloads:[["Number"]]},translate:{overloads:[["Number","Number","Number?"],["p5.Vector"]]},push:{overloads:[[]]},pop:{overloads:[[]]},storeItem:{overloads:[["String","String|Number|Boolean|Object|Array"]]},getItem:{overloads:[["String"]]},clearStorage:{overloads:[[]]},removeItem:{overloads:[["String"]]},select:{overloads:[["String","String|p5.Element|HTMLElement?"]]},selectAll:{overloads:[["String","String|p5.Element|HTMLElement?"]]},createElement:{overloads:[["String","String?"]]},removeElements:{overloads:[[]]},addElement:{overloads:[[]]},createDiv:{overloads:[["String?"]]},createP:{overloads:[["String?"]]},createSpan:{overloads:[["String?"]]},createImg:{overloads:[["String","String"],["String","String","String?","Function?"]]},createA:{overloads:[["String","String","String?"]]},createSlider:{overloads:[["Number","Number","Number?","Number?"]]},createButton:{overloads:[["String","String?"]]},createCheckbox:{overloads:[["String?","Boolean?"]]},createSelect:{overloads:[["Boolean?"],["Object"]]},createRadio:{overloads:[["Object?"],["String?"],[]]},createColorPicker:{overloads:[["String|p5.Color?"]]},createInput:{overloads:[["String?","String?"],["String?"]]},createFileInput:{overloads:[["Function","Boolean?"]]},setMoveThreshold:{overloads:[["Number"]]},setShakeThreshold:{overloads:[["Number"]]},deviceMoved:{overloads:[[]]},deviceTurned:{overloads:[[]]},deviceShaken:{overloads:[[]]},keyPressed:{overloads:[["KeyboardEvent?"]]},keyReleased:{overloads:[["KeyboardEvent?"]]},keyTyped:{overloads:[["KeyboardEvent?"]]},keyIsDown:{overloads:[["Number|String"]]},mouseMoved:{overloads:[["MouseEvent?"]]},mouseDragged:{overloads:[["MouseEvent?"]]},mousePressed:{overloads:[["MouseEvent?"]]},mouseReleased:{overloads:[["MouseEvent?"]]},mouseClicked:{overloads:[["MouseEvent?"]]},doubleClicked:{overloads:[["MouseEvent?"]]},mouseWheel:{overloads:[["WheelEvent?"]]},requestPointerLock:{overloads:[[]]},exitPointerLock:{overloads:[[]]},createImage:{overloads:[["Integer","Integer"]]},saveCanvas:{overloads:[["p5.Framebuffer|p5.Element|HTMLCanvasElement","String?","String?"],["String?","String?"]]},saveFrames:{overloads:[["String","String","Number","Number","function(Array)?"]]},loadImage:{overloads:[["String|Request","function(p5.Image)?","function(Event)?"]]},saveGif:{overloads:[["String","Number","Object?"]]},image:{overloads:[["p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture|p5.Renderer|p5.Graphics","Number","Number","Number?","Number?"],["p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture","Number","Number","Number","Number","Number","Number","Number?","Number?","CONTAIN|COVER?","LEFT|RIGHT|CENTER?","TOP|BOTTOM|CENTER?"]]},tint:{overloads:[["Number","Number","Number","Number?"],["String"],["Number","Number?"],["Number[]"],["p5.Color"]]},noTint:{overloads:[[]]},imageMode:{overloads:[["CORNER|CORNERS|CENTER"]]},blend:{overloads:[["p5.Image","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"]]},copy:{overloads:[["p5.Image|p5.Element","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"]]},filter:{overloads:[["THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|BLUR|ERODE|DILATE|BLUR","Number?","Boolean?"],["p5.Shader"]]},get:{overloads:[["Number","Number","Number","Number"],[],["Number","Number"]]},loadPixels:{overloads:[[]]},set:{overloads:[["Number","Number","Number|Number[]|Object"]]},updatePixels:{overloads:[["Number?","Number?","Number?","Number?"],[]]},loadJSON:{overloads:[["String|Request","Function?","Function?"]]},loadStrings:{overloads:[["String|Request","Function?","Function?"]]},loadTable:{overloads:[["String|Request","String?","String?","Function?","Function?"]]},loadXML:{overloads:[["String|Request","Function?","Function?"]]},loadBytes:{overloads:[["String|Request","Function?","Function?"]]},loadBlob:{overloads:[["String|Request","Function?","Function?"]]},httpGet:{overloads:[["String|Request","String?","Function?","Function?"],["String|Request","Function","Function?"]]},httpPost:{overloads:[["String|Request","Object|Boolean?","String?","Function?","Function?"],["String|Request","Object|Boolean","Function?","Function?"],["String|Request","Function?","Function?"]]},httpDo:{overloads:[["String|Request","String?","String?","Object?","Function?","Function?"],["String|Request","Function?","Function?"]]},createWriter:{overloads:[["String","String?"]]},write:{overloads:[["String|Number|Array"]]},close:{overloads:[[]]},save:{overloads:[["Object|String?","String?","Boolean|String?"]]},saveJSON:{overloads:[["Array|Object","String","Boolean?"]]},saveStrings:{overloads:[["String[]","String","String?","Boolean?"]]},saveTable:{overloads:[["p5.Table","String","String?"]]},abs:{overloads:[["Number"]]},ceil:{overloads:[["Number"]]},constrain:{overloads:[["Number","Number","Number"]]},dist:{overloads:[["Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number"],["p5.Vector"]]},exp:{overloads:[["Number"]]},floor:{overloads:[["Number"]]},lerp:{overloads:[["Number","Number","Number"]]},log:{overloads:[["Number"]]},mag:{overloads:[["Number","Number"]]},map:{overloads:[["Number","Number","Number","Number","Number","Boolean?"]]},max:{overloads:[["Number","Number"],["Number[]"]]},min:{overloads:[["Number","Number"],["Number[]"]]},norm:{overloads:[["Number","Number","Number"]]},pow:{overloads:[["Number","Number"]]},round:{overloads:[["Number","Number?"]]},sq:{overloads:[["Number"]]},sqrt:{overloads:[["Number"]]},fract:{overloads:[["Number"]]},createVector:{overloads:[["...Number[]"]]},noise:{overloads:[["Number","Number?","Number?"]]},noiseDetail:{overloads:[["Number","Number"]]},noiseSeed:{overloads:[["Number"]]},randomSeed:{overloads:[["Number"]]},random:{overloads:[["Number?","Number?"],["Array"]]},randomGaussian:{overloads:[["Number?","Number?"]]},acos:{overloads:[["Number"]]},asin:{overloads:[["Number"]]},atan:{overloads:[["Number"]]},atan2:{overloads:[["Number","Number"]]},cos:{overloads:[["Number"]]},sin:{overloads:[["Number"]]},tan:{overloads:[["Number"]]},degrees:{overloads:[["Number"]]},radians:{overloads:[["Number"]]},angleMode:{overloads:[["RADIANS|DEGREES"],[]]},arc:{overloads:[["Number","Number","Number","Number","Number","Number","CHORD|PIE|OPEN?","Integer?"]]},ellipse:{overloads:[["Number","Number","Number","Number?"],["Number","Number","Number","Number","Integer?"]]},circle:{overloads:[["Number","Number","Number"]]},line:{overloads:[["Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number"]]},point:{overloads:[["Number","Number","Number?"],["p5.Vector"]]},quad:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number","Integer?","Integer?"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Integer?","Integer?"]]},rect:{overloads:[["Number","Number","Number","Number?","Number?","Number?","Number?","Number?"],["Number","Number","Number","Number","Integer?","Integer?"]]},square:{overloads:[["Number","Number","Number","Number?","Number?","Number?","Number?"]]},triangle:{overloads:[["Number","Number","Number","Number","Number","Number"]]},ellipseMode:{overloads:[["CENTER|RADIUS|CORNER|CORNERS"]]},noSmooth:{overloads:[[]]},rectMode:{overloads:[["CENTER|RADIUS|CORNER|CORNERS"]]},smooth:{overloads:[[]]},strokeCap:{overloads:[["ROUND|SQUARE|PROJECT"]]},strokeJoin:{overloads:[["MITER|BEVEL|ROUND"]]},strokeWeight:{overloads:[["Number"]]},bezier:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]},bezierPoint:{overloads:[["Number","Number","Number","Number","Number"]]},bezierTangent:{overloads:[["Number","Number","Number","Number","Number"]]},spline:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]},splinePoint:{overloads:[["Number","Number","Number","Number","Number"]]},splineTangent:{overloads:[["Number","Number","Number","Number","Number"]]},bezierOrder:{overloads:[["Number"],[]]},splineVertex:{overloads:[["Number","Number"],["Number","Number","Number?"],["Number","Number","Number?","Number?"],["Number","Number","Number","Number?","Number?"]]},splineProperty:{overloads:[["String",null],["String"]]},splineProperties:{overloads:[["Object"],[]]},vertex:{overloads:[["Number","Number"],["Number","Number","Number?","Number?"],["Number","Number","Number","Number?","Number?"]]},beginContour:{overloads:[[]]},endContour:{overloads:[["OPEN|CLOSE?"]]},beginShape:{overloads:[["POINTS|LINES|TRIANGLES|TRIANGLE_FAN|TRIANGLE_STRIP|QUADS|QUAD_STRIP|PATH?"]]},bezierVertex:{overloads:[["Number","Number","Number?","Number?"],["Number","Number","Number","Number?","Number?"]]},endShape:{overloads:[["CLOSE?","Integer?"]]},normal:{overloads:[["p5.Vector"],["Number","Number","Number"]]},vertexProperty:{overloads:[["String","Number|Number[]"]]},loadFont:{overloads:[["String","String?","Object?","Function?","Function?"],["String","Function?","Function?"]]},text:{overloads:[["String|Object|Array|Number|Boolean","Number","Number","Number?","Number?"]]},textAlign:{overloads:[["LEFT|CENTER|RIGHT","TOP|BOTTOM|CENTER|BASELINE?"]]},textAscent:{overloads:[["String?"]]},textDescent:{overloads:[["String?"]]},textLeading:{overloads:[["Number"]]},textFont:{overloads:[["p5.Font|String|Object","Number?"]]},textSize:{overloads:[["Number"],[]]},textStyle:{overloads:[["NORMAL|ITALIC|BOLD|BOLDITALIC"],[]]},textWidth:{overloads:[["String"]]},textWrap:{overloads:[["WORD|CHAR"],[]]},textBounds:{overloads:[["String","Number","Number","Number?","Number?"]]},textDirection:{overloads:[["String"],[]]},textProperty:{overloads:[["String",null],["String"]]},textProperties:{overloads:[["Object"],[]]},fontBounds:{overloads:[["String","Number","Number","Number?","Number?"]]},fontWidth:{overloads:[["String"]]},fontAscent:{overloads:[[]]},fontDescent:{overloads:[[]]},textWeight:{overloads:[["Number"],[]]},float:{overloads:[["String"],["String[]"]]},int:{overloads:[["String|Boolean|Number"],["Array"]]},str:{overloads:[["String|Boolean|Number"]]},boolean:{overloads:[["String|Boolean|Number"],["Array"]]},byte:{overloads:[["String|Boolean|Number"],["Array"]]},char:{overloads:[["String|Number"],["Array"]]},unchar:{overloads:[["String"],["String[]"]]},hex:{overloads:[["Number","Number?"],["Number[]","Number?"]]},unhex:{overloads:[["String"],["String[]"]]},day:{overloads:[[]]},hour:{overloads:[[]]},minute:{overloads:[[]]},millis:{overloads:[[]]},month:{overloads:[[]]},second:{overloads:[[]]},year:{overloads:[[]]},nf:{overloads:[["Number|String","Integer|String?","Integer|String?"],["Number[]","Integer|String?","Integer|String?"]]},nfc:{overloads:[["Number|String","Integer|String?"],["Number[]","Integer|String?"]]},nfp:{overloads:[["Number","Integer?","Integer?"],["Number[]","Integer?","Integer?"]]},nfs:{overloads:[["Number","Integer?","Integer?"],["Array","Integer?","Integer?"]]},splitTokens:{overloads:[["String","String?"]]},shuffle:{overloads:[["Array","Boolean?"]]},strokeMode:{overloads:[["String"]]},buildGeometry:{overloads:[["Function"]]},freeGeometry:{overloads:[["p5.Geometry"]]},plane:{overloads:[["Number?","Number?","Integer?","Integer?"]]},box:{overloads:[["Number?","Number?","Number?","Integer?","Integer?"]]},sphere:{overloads:[["Number?","Integer?","Integer?"]]},cylinder:{overloads:[["Number?","Number?","Integer?","Integer?","Boolean?","Boolean?"]]},cone:{overloads:[["Number?","Number?","Integer?","Integer?","Boolean?"]]},ellipsoid:{overloads:[["Number?","Number?","Number?","Integer?","Integer?"]]},torus:{overloads:[["Number?","Number?","Integer?","Integer?"]]},curveDetail:{overloads:[["Number"]]},orbitControl:{overloads:[["Number?","Number?","Number?","Object?"]]},debugMode:{overloads:[[],["GRID|AXES"],["GRID|AXES","Number?","Number?","Number?","Number?","Number?"],["GRID|AXES","Number?","Number?","Number?","Number?"],["Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?"]]},noDebugMode:{overloads:[[]]},ambientLight:{overloads:[["Number","Number","Number","Number?"],["Number","Number?"],["String"],["Number[]"],["p5.Color"]]},specularColor:{overloads:[["Number","Number","Number"],["Number"],["String"],["Number[]"],["p5.Color"]]},directionalLight:{overloads:[["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","p5.Vector"],["p5.Color|Number[]|String","Number","Number","Number"],["p5.Color|Number[]|String","p5.Vector"]]},pointLight:{overloads:[["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","p5.Vector"],["p5.Color|Number[]|String","Number","Number","Number"],["p5.Color|Number[]|String","p5.Vector"]]},imageLight:{overloads:[["p5.image"]]},panorama:{overloads:[["p5.Image"]]},lights:{overloads:[[]]},lightFalloff:{overloads:[["Number","Number","Number"]]},spotLight:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number?","Number?"],["p5.Color|Number[]|String","p5.Vector","p5.Vector","Number?","Number?"],["Number","Number","Number","p5.Vector","p5.Vector","Number?","Number?"],["p5.Color|Number[]|String","Number","Number","Number","p5.Vector","Number?","Number?"],["p5.Color|Number[]|String","p5.Vector","Number","Number","Number","Number?","Number?"],["Number","Number","Number","Number","Number","Number","p5.Vector","Number?","Number?"],["Number","Number","Number","p5.Vector","Number","Number","Number","Number?","Number?"],["p5.Color|Number[]|String","Number","Number","Number","Number","Number","Number","Number?","Number?"]]},noLights:{overloads:[[]]},loadModel:{overloads:[["String|Request","String?","Boolean","function(p5.Geometry)?","function(Event)?"],["String|Request","String?","function(p5.Geometry)?","function(Event)?"],["String|Request","Object?"]]},model:{overloads:[["p5.Geometry","Number?"]]},createModel:{overloads:[["String","String?","Boolean","function(p5.Geometry)?","function(Event)?"],["String","String?","function(p5.Geometry)?","function(Event)?"],["String","String?","Object?"]]},loadShader:{overloads:[["String|Request","String|Request","Function?","Function?"]]},createShader:{overloads:[["String","String","Object?"]]},loadFilterShader:{overloads:[["String","Function?","Function?"]]},createFilterShader:{overloads:[["String"]]},shader:{overloads:[["p5.Shader"]]},strokeShader:{overloads:[["p5.Shader"]]},imageShader:{overloads:[["p5.Shader"]]},baseMaterialShader:{overloads:[[]]},baseFilterShader:{overloads:[[]]},baseNormalShader:{overloads:[[]]},baseColorShader:{overloads:[[]]},baseStrokeShader:{overloads:[[]]},resetShader:{overloads:[[]]},texture:{overloads:[["p5.Image|p5.MediaElement|p5.Graphics|p5.Texture|p5.Framebuffer|p5.FramebufferTexture"]]},textureMode:{overloads:[["IMAGE|NORMAL"]]},textureWrap:{overloads:[["CLAMP|REPEAT|MIRROR","CLAMP|REPEAT|MIRROR?"]]},normalMaterial:{overloads:[[]]},ambientMaterial:{overloads:[["Number","Number","Number"],["Number"],["p5.Color|Number[]|String"]]},emissiveMaterial:{overloads:[["Number","Number","Number","Number?"],["Number"],["p5.Color|Number[]|String"]]},specularMaterial:{overloads:[["Number","Number?"],["Number","Number","Number","Number?"],["p5.Color|Number[]|String"]]},shininess:{overloads:[["Number"]]},metalness:{overloads:[["Number"]]},camera:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?"]]},perspective:{overloads:[["Number?","Number?","Number?","Number?"]]},linePerspective:{overloads:[["Boolean"],[]]},ortho:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},frustum:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},createCamera:{overloads:[[]]},setCamera:{overloads:[["p5.Camera"]]},saveObj:{overloads:[["String?"]]},saveStl:{overloads:[["String?","Object?"]]},setAttributes:{overloads:[["String","Boolean"],["Object"]]},remove:{overloads:[[]]},createVideo:{overloads:[["String|String[]","Function?"]]},createAudio:{overloads:[[],["String|String[]?","Function?"]]},createCapture:{overloads:[["AUDIO|VIDEO|Object?","Object?","Function?"]]}},Mq={p5:Pq,"p5.Geometry":{flipV:{overloads:[[]]},calculateBoundingBox:{overloads:[[]]},clearColors:{overloads:[[]]},flipU:{overloads:[[]]},computeFaces:{overloads:[[]]},computeNormals:{overloads:[["FLAT|SMOOTH?","Object?"]]},makeEdgesFromFaces:{overloads:[[]]},normalize:{overloads:[[]]},vertexProperty:{overloads:[["String","Number|Number[]","Number?"]]}},"p5.Color":{toString:{overloads:[["String?"]]},setRed:{overloads:[["Number"]]},setGreen:{overloads:[["Number"]]},setBlue:{overloads:[["Number"]]},setAlpha:{overloads:[["Number"]]}},"p5.Graphics":{reset:{overloads:[[]]},remove:{overloads:[[]]},createFramebuffer:{overloads:[["Object?"]]}},"p5.Element":{remove:{overloads:[[]]},parent:{overloads:[["String|p5.Element|Object"],[]]},child:{overloads:[[],["String|p5.Element?"]]},html:{overloads:[[],["String?","Boolean?"]]},id:{overloads:[["String"],[]]},class:{overloads:[["String"],[]]},addClass:{overloads:[["String"]]},removeClass:{overloads:[["String"]]},hasClass:{overloads:[[null]]},toggleClass:{overloads:[[null]]},center:{overloads:[["String?"]]},position:{overloads:[[],["Number?","Number?","String?"]]},show:{overloads:[[]]},hide:{overloads:[[]]},size:{overloads:[[],["Number|AUTO?","Number|AUTO?"]]},style:{overloads:[["String"],["String","String|p5.Color"]]},attribute:{overloads:[[],["String","String"]]},removeAttribute:{overloads:[["String"]]},value:{overloads:[[],["String|Number"]]},mousePressed:{overloads:[["Function|Boolean"]]},doubleClicked:{overloads:[["Function|Boolean"]]},mouseWheel:{overloads:[["Function|Boolean"]]},mouseReleased:{overloads:[["Function|Boolean"]]},mouseClicked:{overloads:[["Function|Boolean"]]},mouseMoved:{overloads:[["Function|Boolean"]]},mouseOver:{overloads:[["Function|Boolean"]]},mouseOut:{overloads:[["Function|Boolean"]]},dragOver:{overloads:[["Function|Boolean"]]},dragLeave:{overloads:[["Function|Boolean"]]},changed:{overloads:[["Function|Boolean"]]},input:{overloads:[["Function|Boolean"]]},drop:{overloads:[["Function","Function?"]]},draggable:{overloads:[["p5.Element?"]]}},"p5.MediaElement":{play:{overloads:[[]]},stop:{overloads:[[]]},pause:{overloads:[[]]},loop:{overloads:[[]]},noLoop:{overloads:[[]]},autoplay:{overloads:[["Boolean?"]]},volume:{overloads:[[],["Number"]]},speed:{overloads:[[],["Number"]]},time:{overloads:[[],["Number"]]},duration:{overloads:[[]]},onended:{overloads:[["Function"]]},connect:{overloads:[["AudioNode|Object"]]},disconnect:{overloads:[[]]},showControls:{overloads:[[]]},hideControls:{overloads:[[]]},addCue:{overloads:[["Number","Function","Object?"]]},removeCue:{overloads:[["Number"]]},clearCues:{overloads:[[]]}},"p5.Image":{pixelDensity:{overloads:[["Number?"]]},loadPixels:{overloads:[[]]},updatePixels:{overloads:[["Integer","Integer","Integer","Integer"]]},get:{overloads:[["Number","Number","Number","Number"],[],["Number","Number"]]},set:{overloads:[["Number","Number","Number|Number[]|Object"]]},resize:{overloads:[["Number","Number"]]},copy:{overloads:[["p5.Image|p5.Element","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"]]},mask:{overloads:[["p5.Image"]]},filter:{overloads:[["THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|ERODE|DILATE|BLUR","Number?"]]},blend:{overloads:[["p5.Image","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"]]},save:{overloads:[["String","String?"]]},reset:{overloads:[[]]},getCurrentFrame:{overloads:[[]]},setFrame:{overloads:[["Number"]]},numFrames:{overloads:[[]]},play:{overloads:[[]]},pause:{overloads:[[]]},delay:{overloads:[["Number","Number?"]]}},"p5.Table":{addRow:{overloads:[["p5.TableRow?"]]},removeRow:{overloads:[["Integer"]]},getRow:{overloads:[["Integer"]]},getRows:{overloads:[[]]},findRow:{overloads:[["String","Integer|String"]]},findRows:{overloads:[["String","Integer|String"]]},matchRow:{overloads:[["String|RegExp","String|Integer"]]},matchRows:{overloads:[["String","String|Integer?"]]},getColumn:{overloads:[["String|Number"]]},clearRows:{overloads:[[]]},addColumn:{overloads:[["String?"]]},getColumnCount:{overloads:[[]]},getRowCount:{overloads:[[]]},removeTokens:{overloads:[["String","String|Integer?"]]},trim:{overloads:[["String|Integer?"]]},removeColumn:{overloads:[["String|Integer"]]},set:{overloads:[["Integer","String|Integer","String|Number"]]},setNum:{overloads:[["Integer","String|Integer","Number"]]},setString:{overloads:[["Integer","String|Integer","String"]]},get:{overloads:[["Integer","String|Integer"]]},getNum:{overloads:[["Integer","String|Integer"]]},getString:{overloads:[["Integer","String|Integer"]]},getObject:{overloads:[["String?"]]},getArray:{overloads:[[]]}},"p5.TableRow":{set:{overloads:[["String|Integer","String|Number"]]},setNum:{overloads:[["String|Integer","Number|String"]]},setString:{overloads:[["String|Integer","String|Number|Boolean|Object"]]},get:{overloads:[["String|Integer"]]},getNum:{overloads:[["String|Integer"]]},getString:{overloads:[["String|Integer"]]}},"p5.XML":{getParent:{overloads:[[]]},getName:{overloads:[[]]},setName:{overloads:[["String"]]},hasChildren:{overloads:[[]]},listChildren:{overloads:[[]]},getChildren:{overloads:[["String?"]]},getChild:{overloads:[["String|Integer"]]},addChild:{overloads:[["p5.XML"]]},removeChild:{overloads:[["String|Integer"]]},getAttributeCount:{overloads:[[]]},listAttributes:{overloads:[[]]},hasAttribute:{overloads:[["String"]]},getNum:{overloads:[["String","Number?"]]},getString:{overloads:[["String","Number?"]]},setAttribute:{overloads:[["String","Number|String|Boolean"]]},getContent:{overloads:[["String?"]]},serialize:{overloads:[[]]}},"p5.Vector":{getValue:{overloads:[["Number"]]},setValue:{overloads:[["Number","Number"]]},set:{overloads:[["Number?","Number?","Number?"],["p5.Vector|Number[]"]]},copy:{overloads:[[],["p5.Vector"]]},add:{overloads:[["Number|Array","Number?","Number?"],["p5.Vector|Number[]"],["p5.Vector","p5.Vector","p5.Vector?"]]},rem:{overloads:[["Number","Number","Number"],["p5.Vector|Number[]"],["p5.Vector","p5.Vector"]]},sub:{overloads:[["Number","Number?","Number?"],["p5.Vector|Number[]"],["p5.Vector","p5.Vector","p5.Vector?"]]},mult:{overloads:[["Number","Number","Number?"],["Number[]"],["p5.Vector"],[],["p5.Vector","Number","p5.Vector?"],["p5.Vector","p5.Vector","p5.Vector?"],["p5.Vector","Number[]","p5.Vector?"]]},div:{overloads:[["Number"],["Number","Number","Number?"],["Number[]"],["p5.Vector"],[],["p5.Vector","Number","p5.Vector?"],["p5.Vector","p5.Vector","p5.Vector?"],["p5.Vector","Number[]","p5.Vector?"]]},mag:{overloads:[[],["p5.Vector"]]},magSq:{overloads:[[],["p5.Vector"]]},dot:{overloads:[["Number","Number?","Number?"],["p5.Vector"],[],["p5.Vector","p5.Vector"]]},cross:{overloads:[["p5.Vector"],[],["p5.Vector","p5.Vector"]]},normalize:{overloads:[[],["p5.Vector","p5.Vector?"]]},limit:{overloads:[["Number"],[],["p5.Vector","Number","p5.Vector?"]]},setMag:{overloads:[["Number"],[],["p5.Vector","Number","p5.Vector?"]]},heading:{overloads:[[],["p5.Vector"]]},setHeading:{overloads:[["Number"]]},rotate:{overloads:[["Number"],[],["p5.Vector","Number","p5.Vector?"]]},angleBetween:{overloads:[["p5.Vector"],[],["p5.Vector","p5.Vector"]]},lerp:{overloads:[["Number","Number","Number","Number"],["p5.Vector","Number"],[],["p5.Vector","p5.Vector","Number","p5.Vector?"]]},slerp:{overloads:[["p5.Vector","Number"],[],["p5.Vector","p5.Vector","Number","p5.Vector?"]]},reflect:{overloads:[["p5.Vector"],[],["p5.Vector","p5.Vector","p5.Vector?"]]},array:{overloads:[[],["p5.Vector"]]},equals:{overloads:[["Number?","Number?","Number?"],["p5.Vector|Array"],[],["p5.Vector|Array","p5.Vector|Array"]]},fromAngle:{overloads:[["Number","Number?"]]},fromAngles:{overloads:[["Number","Number","Number?"]]},random2D:{overloads:[[]]},random3D:{overloads:[[]]},dist:{overloads:[[],["p5.Vector","p5.Vector"]]}},"p5.Font":{textToPaths:{overloads:[["String","Number","Number","Number?","Number?","Object?"]]},textToPoints:{overloads:[["String","Number","Number","Object?"]]},textToContours:{overloads:[["String","Number","Number","Object?"]]},textToModel:{overloads:[["String","Number","Number","Number","Number","Object?"]]}},"p5.Camera":{perspective:{overloads:[["Number?","Number?","Number?","Number?"]]},ortho:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},frustum:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},pan:{overloads:[["Number"]]},tilt:{overloads:[["Number"]]},lookAt:{overloads:[["Number","Number","Number"]]},camera:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?"]]},move:{overloads:[["Number","Number","Number"]]},setPosition:{overloads:[["Number","Number","Number"]]},set:{overloads:[["p5.Camera"]]},slerp:{overloads:[["p5.Camera","p5.Camera","Number"]]}},"p5.Framebuffer":{resize:{overloads:[["Number","Number"]]},pixelDensity:{overloads:[["Number?"]]},autoSized:{overloads:[["Boolean?"]]},createCamera:{overloads:[[]]},remove:{overloads:[[]]},begin:{overloads:[[]]},end:{overloads:[[]]},draw:{overloads:[["Function"]]},get:{overloads:[["Number","Number","Number","Number"],[],["Number","Number"]]}},"p5.Shader":{version:{overloads:[[]]},inspectHooks:{overloads:[[]]},modify:{overloads:[["Object?"]]},copyToContext:{overloads:[["p5|p5.Graphics"]]},setUniform:{overloads:[["String","Boolean|Number|Number[]|p5.Image|p5.Graphics|p5.MediaElement|p5.Texture"]]}}};function fN(n,t,r){let i=new Map;const s=Object.keys(n).reduce((g,y)=>(y.match(/^[A-Z]/)&&!y.match(/^[A-Z][A-Z0-9]*$/)&&n[y]instanceof Function&&(g[y]=n[y]),g),{});function o(){for(let g of Object.keys(n))typeof n[g]=="function"&&g[0]!==g[0].toLowerCase()&&(s[g]=n[g])}const a={};for(const[g,y]of Object.entries(ka))a[g]=y;const u={Any:t0(),Array:US(t0()),Boolean:Rq(),Function:GS(),Integer:BS().int(),Number:BS(),Object:Fq({}),String:Nq()},l=["AudioNode","HTMLCanvasElement","HTMLElement","KeyboardEvent","MouseEvent","RegExp","TouchEvent","UIEvent","WheelEvent"];function c(g){return g.reduce((y,v)=>(y[v]=hN(T=>T instanceof globalThis[v],{message:`Expected a ${v}`}),y),{})}const h=c(l);Object.assign(u,h);const f=["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth"];function d(g){const y=g.lastIndexOf("."),v=g.slice(y+1),T=g.slice(0,y!==-1?y:0)||"p5";return{funcName:v,funcClass:T}}function p(g){let y=0;for(let v=0;v<g.length;v++)if(g[v]==="[")y++;else if(g[v]==="]"&&(y--,y<0))return!1;return y===0}t.generateZodSchemasForFunc=function(g){const{funcName:y,funcClass:v}=d(g);let T=Mq[v][y];if(!T)return;let _=[];T.hasOwnProperty("overloads")&&(_=T.overloads);const C=w=>{if(!w)return t0();let x;if(w in a)x=zS(a[w]);else if(w.match(/^[A-Z][A-Z0-9]*$/)&&w in t)x=zS(t[w]);else if(w.startsWith("function"))x=GS();else if(/^p5\.[a-zA-Z0-9]+$/.exec(w)||w==="p5"){const b=w.substring(w.indexOf(".")+1);x=VS(s[b])}else if(u[w])x=u[w];else if(w.startsWith("[")&&w.endsWith("]")&&p(w.slice(1,-1)))x=jS(w.slice(1,-1).split(/, */g).map(b=>C(b)));else if(w.match(/^[A-Z]/)&&w in window)x=VS(window[w]);else if(w.includes("|")&&w.split("|").every(b=>p(b))){const b=w.split("|");x=$S(b.map(A=>C(A)).filter(A=>A!==void 0))}else if(w.endsWith("[]"))x=US(C(w.slice(0,-2)));else throw new Error(`Unsupported type '${w}' in parameter validation. Please report this issue.`);return x},E=w=>{const x=w==null?void 0:w.endsWith("?");w=w==null?void 0:w.replace(/\?$/,"");const b=(w==null?void 0:w.startsWith("..."))&&(w==null?void 0:w.endsWith("[]"));w=w==null?void 0:w.replace(/^\.\.\.(.+)\[\]$/,"$1");let A=C(w);return x&&(A=A.optional()),{schema:A,rest:b}},S=w=>{if(!w.some(A=>A==null?void 0:A.endsWith("?")))return[w];const x=w.filter(A=>A===null||!A.endsWith("?")).length,b=[];for(let A=x;A<=w.length;A++)b.push(w.slice(0,A));return b},R=_.flatMap(w=>S(w).map(b=>{var I;const A=b.map(j=>E(j)).filter(j=>j.schema!==void 0);let k;(I=A.at(-1))!=null&&I.rest&&(k=A.pop());let N=jS(A.map(j=>j.schema));return k&&(N=N.rest(k.schema)),N}));return R.length===1?R[0]:$S(R)},t.findClosestSchema=function(g,y){if(!(g instanceof Th))return g;const v=E=>{let S=1/0;if(!(E instanceof Hi))return console.warn("Schema below is not a tuple: "),printZodSchema(E),S;const R=y.length,w=E.items,x=w.length,b=w.filter(A=>!A.isOptional()).length;R>=b&&R<=x?S=0:S=Math.abs(R<b?b-R:R-x)*4;for(let A=0;A<Math.min(w.length,y.length);A++){const k=w[A],N=y[A];k.safeParse(N).success||S++}return S};let T=g._def.options[0],_=1/0;return g._def.options.forEach(E=>{const S=v(E);S<_&&(T=E,_=S)}),T},t.friendlyParamError=function(g,y,v){let T=" p5.js says: ",_=!1,C=g.errors[0];const E=(w,x,b)=>{const A=b?`at the ${f[b]} parameter`:"",k=w?`, but received ${w}`:"";return`Expected ${x} ${A}${k}`},S=w=>{var A;const x=new Set;let b;if(w.unionErrors.forEach(k=>{const N=k.issues[0];if(N){if(b||(b=N.received),N.code==="invalid_type")x.add(N.expected);else if(N.code==="invalid_literal")x.add("constant (please refer to documentation for allowed values)");else if(N.code==="custom"){const I=N.message.match(/Input not instance of (\w+)/);I&&x.add(I[1])}}}),x.size>0){((A=w.path)==null?void 0:A.length)>0&&v[w.path[0]]instanceof Promise&&(T+="Did you mean to put `await` before a loading function? An unexpected Promise was found. ",_=!0);const k=Array.from(x).join(" or "),N=w.path.join(".");T+=E(b,k,N)}return T};switch(C.code){case"invalid_union":{S(C);break}case"too_small":{const w=C.minimum;T+=`Expected at least ${w} argument${w>1?"s":""}, but received fewer`;break}case"invalid_type":{T+=E(C.received,C.expected,C.path.join("."));break}case"too_big":{const w=C.maximum;T+=`Expected at most ${w} argument${w>1?"s":""}, but received more`;break}default:console.log("Zod error object",C)}T+=` in ${y}().`;const R=w=>{const{funcName:x,funcClass:b}=d(w);return`https://p5js.org/reference/${b}/${x}`};if(C.code==="too_big"||C.code==="too_small"){const w=R(y);T+=` For more information, see ${w}.`}return _?n._error(this,T):console.log(T),T},t.validate=function(g,y){if(n.disableFriendlyErrors)return;if(Array.isArray(y)||(y=Array.from(y)),Array.isArray(y)&&y.length>0&&y.every(T=>T===void 0))return{success:!1,error:` p5.js says: All arguments for ${g}() are undefined. There is likely an error in the code.`};let v=i.get(g);if(!v){if(v=t.generateZodSchemasForFunc(g),!v)return;i.set(g,v)}try{return{success:!0,data:v.parse(y)}}catch{const C=t.findClosestSchema(v,y).safeParse(y).error;return{success:!1,error:t.friendlyParamError(C,g,y)}}},r.presetup=function(){o();const g=["validate"];for(const y in this)if(!g.includes(y)&&!y.startsWith("_")&&typeof this[y]=="function"){const v=this[y];this[y]=function(...T){return this.validate(y,T),v.call(this,...T)}}}}typeof p5<"u"&&fN(p5,p5.prototype);var Lq=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],dN=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],Oq="-----------------------------------------------------------------------------------------------------------------------------------------------------",pN="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",r0={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},n0="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Vq={5:n0,"5module":n0+" export import",6:n0+" const class extends export import super"},Bq=/^in(stanceof)?$/,Uq=new RegExp("["+pN+"]"),$q=new RegExp("["+pN+Oq+"]");function tv(n,t){for(var r=65536,i=0;i<t.length;i+=2){if(r+=t[i],r>n)return!1;if(r+=t[i+1],r>=n)return!0}return!1}function Wi(n,t){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&Uq.test(String.fromCharCode(n)):t===!1?!1:tv(n,dN)}function Ro(n,t){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&$q.test(String.fromCharCode(n)):t===!1?!1:tv(n,dN)||tv(n,Lq)}var Mt=function(t,r){r===void 0&&(r={}),this.label=t,this.keyword=r.keyword,this.beforeExpr=!!r.beforeExpr,this.startsExpr=!!r.startsExpr,this.isLoop=!!r.isLoop,this.isAssign=!!r.isAssign,this.prefix=!!r.prefix,this.postfix=!!r.postfix,this.binop=r.binop||null,this.updateContext=null};function Wn(n,t){return new Mt(n,{beforeExpr:!0,binop:t})}var Kn={beforeExpr:!0},Cn={startsExpr:!0},I_={};function Rt(n,t){return t===void 0&&(t={}),t.keyword=n,I_[n]=new Mt(n,t)}var q={num:new Mt("num",Cn),regexp:new Mt("regexp",Cn),string:new Mt("string",Cn),name:new Mt("name",Cn),privateId:new Mt("privateId",Cn),eof:new Mt("eof"),bracketL:new Mt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Mt("]"),braceL:new Mt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Mt("}"),parenL:new Mt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Mt(")"),comma:new Mt(",",Kn),semi:new Mt(";",Kn),colon:new Mt(":",Kn),dot:new Mt("."),question:new Mt("?",Kn),questionDot:new Mt("?."),arrow:new Mt("=>",Kn),template:new Mt("template"),invalidTemplate:new Mt("invalidTemplate"),ellipsis:new Mt("...",Kn),backQuote:new Mt("`",Cn),dollarBraceL:new Mt("${",{beforeExpr:!0,startsExpr:!0}),eq:new Mt("=",{beforeExpr:!0,isAssign:!0}),assign:new Mt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Mt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Mt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Wn("||",1),logicalAND:Wn("&&",2),bitwiseOR:Wn("|",3),bitwiseXOR:Wn("^",4),bitwiseAND:Wn("&",5),equality:Wn("==/!=/===/!==",6),relational:Wn("</>/<=/>=",7),bitShift:Wn("<</>>/>>>",8),plusMin:new Mt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Wn("%",10),star:Wn("*",10),slash:Wn("/",10),starstar:new Mt("**",{beforeExpr:!0}),coalesce:Wn("??",1),_break:Rt("break"),_case:Rt("case",Kn),_catch:Rt("catch"),_continue:Rt("continue"),_debugger:Rt("debugger"),_default:Rt("default",Kn),_do:Rt("do",{isLoop:!0,beforeExpr:!0}),_else:Rt("else",Kn),_finally:Rt("finally"),_for:Rt("for",{isLoop:!0}),_function:Rt("function",Cn),_if:Rt("if"),_return:Rt("return",Kn),_switch:Rt("switch"),_throw:Rt("throw",Kn),_try:Rt("try"),_var:Rt("var"),_const:Rt("const"),_while:Rt("while",{isLoop:!0}),_with:Rt("with"),_new:Rt("new",{beforeExpr:!0,startsExpr:!0}),_this:Rt("this",Cn),_super:Rt("super",Cn),_class:Rt("class",Cn),_extends:Rt("extends",Kn),_export:Rt("export"),_import:Rt("import",Cn),_null:Rt("null",Cn),_true:Rt("true",Cn),_false:Rt("false",Cn),_in:Rt("in",{beforeExpr:!0,binop:7}),_instanceof:Rt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Rt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Rt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Rt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Pn=/\r\n?|\n|\u2028|\u2029/,jq=new RegExp(Pn.source,"g");function Dl(n){return n===10||n===13||n===8232||n===8233}function gN(n,t,r){r===void 0&&(r=n.length);for(var i=t;i<r;i++){var s=n.charCodeAt(i);if(Dl(s))return i<r-1&&s===13&&n.charCodeAt(i+1)===10?i+2:i+1}return-1}var mN=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,nn=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,yN=Object.prototype,Gq=yN.hasOwnProperty,zq=yN.toString,kl=Object.hasOwn||function(n,t){return Gq.call(n,t)},qS=Array.isArray||function(n){return zq.call(n)==="[object Array]"},HS=Object.create(null);function ao(n){return HS[n]||(HS[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function Cs(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var qq=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,kh=function(t,r){this.line=t,this.column=r};kh.prototype.offset=function(t){return new kh(this.line,this.column+t)};var Wg=function(t,r,i){this.start=r,this.end=i,t.sourceFile!==null&&(this.source=t.sourceFile)};function vN(n,t){for(var r=1,i=0;;){var s=gN(n,i,t);if(s<0)return new kh(r,t-i);++r,i=s}}var rv={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},WS=!1;function Hq(n){var t={};for(var r in rv)t[r]=n&&kl(n,r)?n[r]:rv[r];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!WS&&typeof console=="object"&&console.warn&&(WS=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!n||n.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),qS(t.onToken)){var i=t.onToken;t.onToken=function(s){return i.push(s)}}return qS(t.onComment)&&(t.onComment=Wq(t,t.onComment)),t}function Wq(n,t){return function(r,i,s,o,a,u){var l={type:r?"Block":"Line",value:i,start:s,end:o};n.locations&&(l.loc=new Wg(this,a,u)),n.ranges&&(l.range=[s,o]),t.push(l)}}var Nh=1,Nl=2,D_=4,_N=8,k_=16,bN=32,Kg=64,xN=128,za=256,lf=512,Yg=Nh|Nl|za;function N_(n,t){return Nl|(n?D_:0)|(t?_N:0)}var Tp=0,R_=1,Rs=2,wN=3,EN=4,SN=5,jr=function(t,r,i){this.options=t=Hq(t),this.sourceFile=t.sourceFile,this.keywords=ao(Vq[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var s="";t.allowReserved!==!0&&(s=r0[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(s+=" await")),this.reservedWords=ao(s);var o=(s?s+" ":"")+r0.strict;this.reservedWordsStrict=ao(o),this.reservedWordsStrictBind=ao(o+" "+r0.strictBind),this.input=String(r),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Pn).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=q.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Nh),this.regexpState=null,this.privateNameStack=[]},Zi={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};jr.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};Zi.inFunction.get=function(){return(this.currentVarScope().flags&Nl)>0};Zi.inGenerator.get=function(){return(this.currentVarScope().flags&_N)>0};Zi.inAsync.get=function(){return(this.currentVarScope().flags&D_)>0};Zi.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var t=this.scopeStack[n],r=t.flags;if(r&(za|lf))return!1;if(r&Nl)return(r&D_)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Zi.allowSuper.get=function(){var n=this.currentThisScope(),t=n.flags;return(t&Kg)>0||this.options.allowSuperOutsideMethod};Zi.allowDirectSuper.get=function(){return(this.currentThisScope().flags&xN)>0};Zi.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Zi.allowNewDotTarget.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var t=this.scopeStack[n],r=t.flags;if(r&(za|lf)||r&Nl&&!(r&k_))return!0}return!1};Zi.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&za)>0};jr.extend=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];for(var i=this,s=0;s<t.length;s++)i=t[s](i);return i};jr.parse=function(t,r){return new this(r,t).parse()};jr.parseExpressionAt=function(t,r,i){var s=new this(i,t,r);return s.nextToken(),s.parseExpression()};jr.tokenizer=function(t,r){return new this(r,t)};Object.defineProperties(jr.prototype,Zi);var En=jr.prototype,Kq=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;En.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){nn.lastIndex=n,n+=nn.exec(this.input)[0].length;var t=Kq.exec(this.input.slice(n));if(!t)return!1;if((t[1]||t[2])==="use strict"){nn.lastIndex=n+t[0].length;var r=nn.exec(this.input),i=r.index+r[0].length,s=this.input.charAt(i);return s===";"||s==="}"||Pn.test(r[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(s)||s==="!"&&this.input.charAt(i+1)==="=")}n+=t[0].length,nn.lastIndex=n,n+=nn.exec(this.input)[0].length,this.input[n]===";"&&n++}};En.eat=function(n){return this.type===n?(this.next(),!0):!1};En.isContextual=function(n){return this.type===q.name&&this.value===n&&!this.containsEsc};En.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1};En.expectContextual=function(n){this.eatContextual(n)||this.unexpected()};En.canInsertSemicolon=function(){return this.type===q.eof||this.type===q.braceR||Pn.test(this.input.slice(this.lastTokEnd,this.start))};En.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};En.semicolon=function(){!this.eat(q.semi)&&!this.insertSemicolon()&&this.unexpected()};En.afterTrailingComma=function(n,t){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};En.expect=function(n){this.eat(n)||this.unexpected()};En.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var Xg=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};En.checkPatternErrors=function(n,t){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var r=t?n.parenthesizedAssign:n.parenthesizedBind;r>-1&&this.raiseRecoverable(r,t?"Assigning to rvalue":"Parenthesized pattern")}};En.checkExpressionErrors=function(n,t){if(!n)return!1;var r=n.shorthandAssign,i=n.doubleProto;if(!t)return r>=0||i>=0;r>=0&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};En.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};En.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var rt=jr.prototype;rt.parseTopLevel=function(n){var t=Object.create(null);for(n.body||(n.body=[]);this.type!==q.eof;){var r=this.parseStatement(null,!0,t);n.body.push(r)}if(this.inModule)for(var i=0,s=Object.keys(this.undefinedExports);i<s.length;i+=1){var o=s[i];this.raiseRecoverable(this.undefinedExports[o].start,"Export '"+o+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType,this.finishNode(n,"Program")};var F_={kind:"loop"},Yq={kind:"switch"};rt.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;nn.lastIndex=this.pos;var t=nn.exec(this.input),r=this.pos+t[0].length,i=this.input.charCodeAt(r);if(i===91||i===92)return!0;if(n)return!1;if(i===123||i>55295&&i<56320)return!0;if(Wi(i,!0)){for(var s=r+1;Ro(i=this.input.charCodeAt(s),!0);)++s;if(i===92||i>55295&&i<56320)return!0;var o=this.input.slice(r,s);if(!Bq.test(o))return!0}return!1};rt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;nn.lastIndex=this.pos;var n=nn.exec(this.input),t=this.pos+n[0].length,r;return!Pn.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(Ro(r=this.input.charCodeAt(t+8))||r>55295&&r<56320))};rt.isUsingKeyword=function(n,t){if(this.options.ecmaVersion<17||!this.isContextual(n?"await":"using"))return!1;nn.lastIndex=this.pos;var r=nn.exec(this.input),i=this.pos+r[0].length;if(Pn.test(this.input.slice(this.pos,i)))return!1;if(n){var s=i+5,o;if(this.input.slice(i,s)!=="using"||s===this.input.length||Ro(o=this.input.charCodeAt(s))||o>55295&&o<56320)return!1;nn.lastIndex=s;var a=nn.exec(this.input);if(a&&Pn.test(this.input.slice(s,s+a[0].length)))return!1}if(t){var u=i+2,l;if(this.input.slice(i,u)==="of"&&(u===this.input.length||!Ro(l=this.input.charCodeAt(u))&&!(l>55295&&l<56320)))return!1}var c=this.input.charCodeAt(i);return Wi(c,!0)||c===92};rt.isAwaitUsing=function(n){return this.isUsingKeyword(!0,n)};rt.isUsing=function(n){return this.isUsingKeyword(!1,n)};rt.parseStatement=function(n,t,r){var i=this.type,s=this.startNode(),o;switch(this.isLet(n)&&(i=q._var,o="let"),i){case q._break:case q._continue:return this.parseBreakContinueStatement(s,i.keyword);case q._debugger:return this.parseDebuggerStatement(s);case q._do:return this.parseDoStatement(s);case q._for:return this.parseForStatement(s);case q._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!n);case q._class:return n&&this.unexpected(),this.parseClass(s,!0);case q._if:return this.parseIfStatement(s);case q._return:return this.parseReturnStatement(s);case q._switch:return this.parseSwitchStatement(s);case q._throw:return this.parseThrowStatement(s);case q._try:return this.parseTryStatement(s);case q._const:case q._var:return o=o||this.value,n&&o!=="var"&&this.unexpected(),this.parseVarStatement(s,o);case q._while:return this.parseWhileStatement(s);case q._with:return this.parseWithStatement(s);case q.braceL:return this.parseBlock(!0,s);case q.semi:return this.parseEmptyStatement(s);case q._export:case q._import:if(this.options.ecmaVersion>10&&i===q._import){nn.lastIndex=this.pos;var a=nn.exec(this.input),u=this.pos+a[0].length,l=this.input.charCodeAt(u);if(l===40||l===46)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===q._import?this.parseImport(s):this.parseExport(s,r);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!n);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),c==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(s,!1,c),this.semicolon(),this.finishNode(s,"VariableDeclaration");var h=this.value,f=this.parseExpression();return i===q.name&&f.type==="Identifier"&&this.eat(q.colon)?this.parseLabeledStatement(s,h,f,n):this.parseExpressionStatement(s,f)}};rt.parseBreakContinueStatement=function(n,t){var r=t==="break";this.next(),this.eat(q.semi)||this.insertSemicolon()?n.label=null:this.type!==q.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var s=this.labels[i];if((n.label==null||s.name===n.label.name)&&(s.kind!=null&&(r||s.kind==="loop")||n.label&&r))break}return i===this.labels.length&&this.raise(n.start,"Unsyntactic "+t),this.finishNode(n,r?"BreakStatement":"ContinueStatement")};rt.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")};rt.parseDoStatement=function(n){return this.next(),this.labels.push(F_),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(q._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(q.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")};rt.parseForStatement=function(n){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(F_),this.enterScope(0),this.expect(q.parenL),this.type===q.semi)return t>-1&&this.unexpected(t),this.parseFor(n,null);var r=this.isLet();if(this.type===q._var||this.type===q._const||r){var i=this.startNode(),s=r?"let":this.value;return this.next(),this.parseVar(i,!0,s),this.finishNode(i,"VariableDeclaration"),this.parseForAfterInit(n,i,t)}var o=this.isContextual("let"),a=!1,u=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(u){var l=this.startNode();return this.next(),u==="await using"&&this.next(),this.parseVar(l,!0,u),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(n,l,t)}var c=this.containsEsc,h=new Xg,f=this.start,d=t>-1?this.parseExprSubscripts(h,"await"):this.parseExpression(!0,h);return this.type===q._in||(a=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===q._in&&this.unexpected(t),n.await=!0):a&&this.options.ecmaVersion>=8&&(d.start===f&&!c&&d.type==="Identifier"&&d.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),o&&a&&this.raise(d.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(d,!1,h),this.checkLValPattern(d),this.parseForIn(n,d)):(this.checkExpressionErrors(h,!0),t>-1&&this.unexpected(t),this.parseFor(n,d))};rt.parseForAfterInit=function(n,t,r){return(this.type===q._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===q._in?r>-1&&this.unexpected(r):n.await=r>-1),this.parseForIn(n,t)):(r>-1&&this.unexpected(r),this.parseFor(n,t))};rt.parseFunctionStatement=function(n,t,r){return this.next(),this.parseFunction(n,Bc|(r?0:nv),!1,t)};rt.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(q._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")};rt.parseReturnStatement=function(n){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(q.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")};rt.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(q.braceL),this.labels.push(Yq),this.enterScope(0);for(var t,r=!1;this.type!==q.braceR;)if(this.type===q._case||this.type===q._default){var i=this.type===q._case;t&&this.finishNode(t,"SwitchCase"),n.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(q.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")};rt.parseThrowStatement=function(n){return this.next(),Pn.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var Xq=[];rt.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),t=n.type==="Identifier";return this.enterScope(t?bN:0),this.checkLValPattern(n,t?EN:Rs),this.expect(q.parenR),n};rt.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===q._catch){var t=this.startNode();this.next(),this.eat(q.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(t,"CatchClause")}return n.finalizer=this.eat(q._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")};rt.parseVarStatement=function(n,t,r){return this.next(),this.parseVar(n,!1,t,r),this.semicolon(),this.finishNode(n,"VariableDeclaration")};rt.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(F_),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")};rt.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")};rt.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")};rt.parseLabeledStatement=function(n,t,r,i){for(var s=0,o=this.labels;s<o.length;s+=1){var a=o[s];a.name===t&&this.raise(r.start,"Label '"+t+"' is already declared")}for(var u=this.type.isLoop?"loop":this.type===q._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===n.start)c.statementStart=this.start,c.kind=u;else break}return this.labels.push({name:t,kind:u,statementStart:this.start}),n.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),n.label=r,this.finishNode(n,"LabeledStatement")};rt.parseExpressionStatement=function(n,t){return n.expression=t,this.semicolon(),this.finishNode(n,"ExpressionStatement")};rt.parseBlock=function(n,t,r){for(n===void 0&&(n=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(q.braceL),n&&this.enterScope(0);this.type!==q.braceR;){var i=this.parseStatement(null);t.body.push(i)}return r&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(t,"BlockStatement")};rt.parseFor=function(n,t){return n.init=t,this.expect(q.semi),n.test=this.type===q.semi?null:this.parseExpression(),this.expect(q.semi),n.update=this.type===q.parenR?null:this.parseExpression(),this.expect(q.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")};rt.parseForIn=function(n,t){var r=this.type===q._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!r||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(r?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=t,n.right=r?this.parseExpression():this.parseMaybeAssign(),this.expect(q.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,r?"ForInStatement":"ForOfStatement")};rt.parseVar=function(n,t,r,i){for(n.declarations=[],n.kind=r;;){var s=this.startNode();if(this.parseVarId(s,r),this.eat(q.eq)?s.init=this.parseMaybeAssign(t):!i&&r==="const"&&!(this.type===q._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&(r==="using"||r==="await using")&&this.options.ecmaVersion>=17&&this.type!==q._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+r+" declaration"):!i&&s.id.type!=="Identifier"&&!(t&&(this.type===q._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):s.init=null,n.declarations.push(this.finishNode(s,"VariableDeclarator")),!this.eat(q.comma))break}return n};rt.parseVarId=function(n,t){n.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(n.id,t==="var"?R_:Rs,!1)};var Bc=1,nv=2,CN=4;rt.parseFunction=function(n,t,r,i,s){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===q.star&&t&nv&&this.unexpected(),n.generator=this.eat(q.star)),this.options.ecmaVersion>=8&&(n.async=!!i),t&Bc&&(n.id=t&CN&&this.type!==q.name?null:this.parseIdent(),n.id&&!(t&nv)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?R_:Rs:wN));var o=this.yieldPos,a=this.awaitPos,u=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(N_(n.async,n.generator)),t&Bc||(n.id=this.type===q.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,r,!1,s),this.yieldPos=o,this.awaitPos=a,this.awaitIdentPos=u,this.finishNode(n,t&Bc?"FunctionDeclaration":"FunctionExpression")};rt.parseFunctionParams=function(n){this.expect(q.parenL),n.params=this.parseBindingList(q.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};rt.parseClass=function(n,t){this.next();var r=this.strict;this.strict=!0,this.parseClassId(n,t),this.parseClassSuper(n);var i=this.enterClassBody(),s=this.startNode(),o=!1;for(s.body=[],this.expect(q.braceL);this.type!==q.braceR;){var a=this.parseClassElement(n.superClass!==null);a&&(s.body.push(a),a.type==="MethodDefinition"&&a.kind==="constructor"?(o&&this.raiseRecoverable(a.start,"Duplicate constructor in the same class"),o=!0):a.key&&a.key.type==="PrivateIdentifier"&&Zq(i,a)&&this.raiseRecoverable(a.key.start,"Identifier '#"+a.key.name+"' has already been declared"))}return this.strict=r,this.next(),n.body=this.finishNode(s,"ClassBody"),this.exitClassBody(),this.finishNode(n,t?"ClassDeclaration":"ClassExpression")};rt.parseClassElement=function(n){if(this.eat(q.semi))return null;var t=this.options.ecmaVersion,r=this.startNode(),i="",s=!1,o=!1,a="method",u=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(q.braceL))return this.parseClassStaticBlock(r),r;this.isClassElementNameStart()||this.type===q.star?u=!0:i="static"}if(r.static=u,!i&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===q.star)&&!this.canInsertSemicolon()?o=!0:i="async"),!i&&(t>=9||!o)&&this.eat(q.star)&&(s=!0),!i&&!o&&!s){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?a=l:i=l)}if(i?(r.computed=!1,r.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),r.key.name=i,this.finishNode(r.key,"Identifier")):this.parseClassElementName(r),t<13||this.type===q.parenL||a!=="method"||s||o){var c=!r.static&&Ip(r,"constructor"),h=c&&n;c&&a!=="method"&&this.raise(r.key.start,"Constructor can't have get/set modifier"),r.kind=c?"constructor":a,this.parseClassMethod(r,s,o,h)}else this.parseClassField(r);return r};rt.isClassElementNameStart=function(){return this.type===q.name||this.type===q.privateId||this.type===q.num||this.type===q.string||this.type===q.bracketL||this.type.keyword};rt.parseClassElementName=function(n){this.type===q.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)};rt.parseClassMethod=function(n,t,r,i){var s=n.key;n.kind==="constructor"?(t&&this.raise(s.start,"Constructor can't be a generator"),r&&this.raise(s.start,"Constructor can't be an async method")):n.static&&Ip(n,"prototype")&&this.raise(s.start,"Classes may not have a static property named prototype");var o=n.value=this.parseMethod(t,r,i);return n.kind==="get"&&o.params.length!==0&&this.raiseRecoverable(o.start,"getter should have no params"),n.kind==="set"&&o.params.length!==1&&this.raiseRecoverable(o.start,"setter should have exactly one param"),n.kind==="set"&&o.params[0].type==="RestElement"&&this.raiseRecoverable(o.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")};rt.parseClassField=function(n){return Ip(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&Ip(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(q.eq)?(this.enterScope(lf|Kg),n.value=this.parseMaybeAssign(),this.exitScope()):n.value=null,this.semicolon(),this.finishNode(n,"PropertyDefinition")};rt.parseClassStaticBlock=function(n){n.body=[];var t=this.labels;for(this.labels=[],this.enterScope(za|Kg);this.type!==q.braceR;){var r=this.parseStatement(null);n.body.push(r)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(n,"StaticBlock")};rt.parseClassId=function(n,t){this.type===q.name?(n.id=this.parseIdent(),t&&this.checkLValSimple(n.id,Rs,!1)):(t===!0&&this.unexpected(),n.id=null)};rt.parseClassSuper=function(n){n.superClass=this.eat(q._extends)?this.parseExprSubscripts(null,!1):null};rt.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared};rt.exitClassBody=function(){var n=this.privateNameStack.pop(),t=n.declared,r=n.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,s=i===0?null:this.privateNameStack[i-1],o=0;o<r.length;++o){var a=r[o];kl(t,a.name)||(s?s.used.push(a):this.raiseRecoverable(a.start,"Private field '#"+a.name+"' must be declared in an enclosing class"))}};function Zq(n,t){var r=t.key.name,i=n[r],s="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(s=(t.static?"s":"i")+t.kind),i==="iget"&&s==="iset"||i==="iset"&&s==="iget"||i==="sget"&&s==="sset"||i==="sset"&&s==="sget"?(n[r]="true",!1):i?!0:(n[r]=s,!1)}function Ip(n,t){var r=n.computed,i=n.key;return!r&&(i.type==="Identifier"&&i.name===t||i.type==="Literal"&&i.value===t)}rt.parseExportAllDeclaration=function(n,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(t,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==q.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")};rt.parseExport=function(n,t){if(this.next(),this.eat(q.star))return this.parseExportAllDeclaration(n,t);if(this.eat(q._default))return this.checkExport(t,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,n.declaration.declarations):this.checkExport(t,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[]);else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==q.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause());else{for(var r=0,i=n.specifiers;r<i.length;r+=1){var s=i[r];this.checkUnreserved(s.local),this.checkLocalExport(s.local),s.local.type==="Literal"&&this.raise(s.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[])}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")};rt.parseExportDeclaration=function(n){return this.parseStatement(null)};rt.parseExportDefaultDeclaration=function(){var n;if(this.type===q._function||(n=this.isAsyncFunction())){var t=this.startNode();return this.next(),n&&this.next(),this.parseFunction(t,Bc|CN,!1,n)}else if(this.type===q._class){var r=this.startNode();return this.parseClass(r,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};rt.checkExport=function(n,t,r){n&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),kl(n,t)&&this.raiseRecoverable(r,"Duplicate export '"+t+"'"),n[t]=!0)};rt.checkPatternExport=function(n,t){var r=t.type;if(r==="Identifier")this.checkExport(n,t,t.start);else if(r==="ObjectPattern")for(var i=0,s=t.properties;i<s.length;i+=1){var o=s[i];this.checkPatternExport(n,o)}else if(r==="ArrayPattern")for(var a=0,u=t.elements;a<u.length;a+=1){var l=u[a];l&&this.checkPatternExport(n,l)}else r==="Property"?this.checkPatternExport(n,t.value):r==="AssignmentPattern"?this.checkPatternExport(n,t.left):r==="RestElement"&&this.checkPatternExport(n,t.argument)};rt.checkVariableExport=function(n,t){if(n)for(var r=0,i=t;r<i.length;r+=1){var s=i[r];this.checkPatternExport(n,s.id)}};rt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};rt.parseExportSpecifier=function(n){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(n,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};rt.parseExportSpecifiers=function(n){var t=[],r=!0;for(this.expect(q.braceL);!this.eat(q.braceR);){if(r)r=!1;else if(this.expect(q.comma),this.afterTrailingComma(q.braceR))break;t.push(this.parseExportSpecifier(n))}return t};rt.parseImport=function(n){return this.next(),this.type===q.string?(n.specifiers=Xq,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===q.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ImportDeclaration")};rt.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,Rs),this.finishNode(n,"ImportSpecifier")};rt.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,Rs),this.finishNode(n,"ImportDefaultSpecifier")};rt.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,Rs),this.finishNode(n,"ImportNamespaceSpecifier")};rt.parseImportSpecifiers=function(){var n=[],t=!0;if(this.type===q.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(q.comma)))return n;if(this.type===q.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(q.braceL);!this.eat(q.braceR);){if(t)t=!1;else if(this.expect(q.comma),this.afterTrailingComma(q.braceR))break;n.push(this.parseImportSpecifier())}return n};rt.parseWithClause=function(){var n=[];if(!this.eat(q._with))return n;this.expect(q.braceL);for(var t={},r=!0;!this.eat(q.braceR);){if(r)r=!1;else if(this.expect(q.comma),this.afterTrailingComma(q.braceR))break;var i=this.parseImportAttribute(),s=i.key.type==="Identifier"?i.key.name:i.key.value;kl(t,s)&&this.raiseRecoverable(i.key.start,"Duplicate attribute key '"+s+"'"),t[s]=!0,n.push(i)}return n};rt.parseImportAttribute=function(){var n=this.startNode();return n.key=this.type===q.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(q.colon),this.type!==q.string&&this.unexpected(),n.value=this.parseExprAtom(),this.finishNode(n,"ImportAttribute")};rt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===q.string){var n=this.parseLiteral(this.value);return qq.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)};rt.adaptDirectivePrologue=function(n){for(var t=0;t<n.length&&this.isDirectiveCandidate(n[t]);++t)n[t].directive=n[t].expression.raw.slice(1,-1)};rt.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var ai=jr.prototype;ai.toAssignable=function(n,t,r){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",r&&this.checkPatternErrors(r,!0);for(var i=0,s=n.properties;i<s.length;i+=1){var o=s[i];this.toAssignable(o,t),o.type==="RestElement"&&(o.argument.type==="ArrayPattern"||o.argument.type==="ObjectPattern")&&this.raise(o.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,t);break;case"ArrayExpression":n.type="ArrayPattern",r&&this.checkPatternErrors(r,!0),this.toAssignableList(n.elements,t);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,t),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,t);break;case"ParenthesizedExpression":this.toAssignable(n.expression,t,r);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(n.start,"Assigning to rvalue")}else r&&this.checkPatternErrors(r,!0);return n};ai.toAssignableList=function(n,t){for(var r=n.length,i=0;i<r;i++){var s=n[i];s&&this.toAssignable(s,t)}if(r){var o=n[r-1];this.options.ecmaVersion===6&&t&&o&&o.type==="RestElement"&&o.argument.type!=="Identifier"&&this.unexpected(o.argument.start)}return n};ai.parseSpread=function(n){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,n),this.finishNode(t,"SpreadElement")};ai.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==q.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")};ai.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case q.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(q.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case q.braceL:return this.parseObj(!0)}return this.parseIdent()};ai.parseBindingList=function(n,t,r,i){for(var s=[],o=!0;!this.eat(n);)if(o?o=!1:this.expect(q.comma),t&&this.type===q.comma)s.push(null);else{if(r&&this.afterTrailingComma(n))break;if(this.type===q.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),s.push(a),this.type===q.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else s.push(this.parseAssignableListItem(i))}return s};ai.parseAssignableListItem=function(n){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};ai.parseBindingListItem=function(n){return n};ai.parseMaybeDefault=function(n,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(q.eq))return r;var i=this.startNodeAt(n,t);return i.left=r,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};ai.checkLValSimple=function(n,t,r){t===void 0&&(t=Tp);var i=t!==Tp;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(i?"Binding ":"Assigning to ")+n.name+" in strict mode"),i&&(t===Rs&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),r&&(kl(r,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),r[n.name]=!0),t!==SN&&this.declareName(n.name,t,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,t,r);default:this.raise(n.start,(i?"Binding":"Assigning to")+" rvalue")}};ai.checkLValPattern=function(n,t,r){switch(t===void 0&&(t=Tp),n.type){case"ObjectPattern":for(var i=0,s=n.properties;i<s.length;i+=1){var o=s[i];this.checkLValInnerPattern(o,t,r)}break;case"ArrayPattern":for(var a=0,u=n.elements;a<u.length;a+=1){var l=u[a];l&&this.checkLValInnerPattern(l,t,r)}break;default:this.checkLValSimple(n,t,r)}};ai.checkLValInnerPattern=function(n,t,r){switch(t===void 0&&(t=Tp),n.type){case"Property":this.checkLValInnerPattern(n.value,t,r);break;case"AssignmentPattern":this.checkLValPattern(n.left,t,r);break;case"RestElement":this.checkLValPattern(n.argument,t,r);break;default:this.checkLValPattern(n,t,r)}};var ui=function(t,r,i,s,o){this.token=t,this.isExpr=!!r,this.preserveSpace=!!i,this.override=s,this.generator=!!o},fr={b_stat:new ui("{",!1),b_expr:new ui("{",!0),b_tmpl:new ui("${",!1),p_stat:new ui("(",!1),p_expr:new ui("(",!0),q_tmpl:new ui("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new ui("function",!1),f_expr:new ui("function",!0),f_expr_gen:new ui("function",!0,!1,null,!0),f_gen:new ui("function",!1,!1,null,!0)},Rl=jr.prototype;Rl.initialContext=function(){return[fr.b_stat]};Rl.curContext=function(){return this.context[this.context.length-1]};Rl.braceIsBlock=function(n){var t=this.curContext();return t===fr.f_expr||t===fr.f_stat?!0:n===q.colon&&(t===fr.b_stat||t===fr.b_expr)?!t.isExpr:n===q._return||n===q.name&&this.exprAllowed?Pn.test(this.input.slice(this.lastTokEnd,this.start)):n===q._else||n===q.semi||n===q.eof||n===q.parenR||n===q.arrow?!0:n===q.braceL?t===fr.b_stat:n===q._var||n===q._const||n===q.name?!1:!this.exprAllowed};Rl.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var t=this.context[n];if(t.token==="function")return t.generator}return!1};Rl.updateContext=function(n){var t,r=this.type;r.keyword&&n===q.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,n):this.exprAllowed=r.beforeExpr};Rl.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)};q.parenR.updateContext=q.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===fr.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr};q.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?fr.b_stat:fr.b_expr),this.exprAllowed=!0};q.dollarBraceL.updateContext=function(){this.context.push(fr.b_tmpl),this.exprAllowed=!0};q.parenL.updateContext=function(n){var t=n===q._if||n===q._for||n===q._with||n===q._while;this.context.push(t?fr.p_stat:fr.p_expr),this.exprAllowed=!0};q.incDec.updateContext=function(){};q._function.updateContext=q._class.updateContext=function(n){n.beforeExpr&&n!==q._else&&!(n===q.semi&&this.curContext()!==fr.p_stat)&&!(n===q._return&&Pn.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===q.colon||n===q.braceL)&&this.curContext()===fr.b_stat)?this.context.push(fr.f_expr):this.context.push(fr.f_stat),this.exprAllowed=!1};q.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};q.backQuote.updateContext=function(){this.curContext()===fr.q_tmpl?this.context.pop():this.context.push(fr.q_tmpl),this.exprAllowed=!1};q.star.updateContext=function(n){if(n===q._function){var t=this.context.length-1;this.context[t]===fr.f_expr?this.context[t]=fr.f_expr_gen:this.context[t]=fr.f_gen}this.exprAllowed=!0};q.name.updateContext=function(n){var t=!1;this.options.ecmaVersion>=6&&n!==q.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var dt=jr.prototype;dt.checkPropClash=function(n,t,r){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var i=n.key,s;switch(i.type){case"Identifier":s=i.name;break;case"Literal":s=String(i.value);break;default:return}var o=n.kind;if(this.options.ecmaVersion>=6){s==="__proto__"&&o==="init"&&(t.proto&&(r?r.doubleProto<0&&(r.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);return}s="$"+s;var a=t[s];if(a){var u;o==="init"?u=this.strict&&a.init||a.get||a.set:u=a.init||a[o],u&&this.raiseRecoverable(i.start,"Redefinition of property")}else a=t[s]={init:!1,get:!1,set:!1};a[o]=!0}};dt.parseExpression=function(n,t){var r=this.start,i=this.startLoc,s=this.parseMaybeAssign(n,t);if(this.type===q.comma){var o=this.startNodeAt(r,i);for(o.expressions=[s];this.eat(q.comma);)o.expressions.push(this.parseMaybeAssign(n,t));return this.finishNode(o,"SequenceExpression")}return s};dt.parseMaybeAssign=function(n,t,r){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var i=!1,s=-1,o=-1,a=-1;t?(s=t.parenthesizedAssign,o=t.trailingComma,a=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new Xg,i=!0);var u=this.start,l=this.startLoc;(this.type===q.parenL||this.type===q.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var c=this.parseMaybeConditional(n,t);if(r&&(c=r.call(this,c,u,l)),this.type.isAssign){var h=this.startNodeAt(u,l);return h.operator=this.value,this.type===q.eq&&(c=this.toAssignable(c,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.start&&(t.shorthandAssign=-1),this.type===q.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(n),a>-1&&(t.doubleProto=a),this.finishNode(h,"AssignmentExpression")}else i&&this.checkExpressionErrors(t,!0);return s>-1&&(t.parenthesizedAssign=s),o>-1&&(t.trailingComma=o),c};dt.parseMaybeConditional=function(n,t){var r=this.start,i=this.startLoc,s=this.parseExprOps(n,t);if(this.checkExpressionErrors(t))return s;if(this.eat(q.question)){var o=this.startNodeAt(r,i);return o.test=s,o.consequent=this.parseMaybeAssign(),this.expect(q.colon),o.alternate=this.parseMaybeAssign(n),this.finishNode(o,"ConditionalExpression")}return s};dt.parseExprOps=function(n,t){var r=this.start,i=this.startLoc,s=this.parseMaybeUnary(t,!1,!1,n);return this.checkExpressionErrors(t)||s.start===r&&s.type==="ArrowFunctionExpression"?s:this.parseExprOp(s,r,i,-1,n)};dt.parseExprOp=function(n,t,r,i,s){var o=this.type.binop;if(o!=null&&(!s||this.type!==q._in)&&o>i){var a=this.type===q.logicalOR||this.type===q.logicalAND,u=this.type===q.coalesce;u&&(o=q.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,f=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,s),c,h,o,s),d=this.buildBinary(t,r,n,f,l,a||u);return(a&&this.type===q.coalesce||u&&(this.type===q.logicalOR||this.type===q.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,t,r,i,s)}return n};dt.buildBinary=function(n,t,r,i,s,o){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var a=this.startNodeAt(n,t);return a.left=r,a.operator=s,a.right=i,this.finishNode(a,o?"LogicalExpression":"BinaryExpression")};dt.parseMaybeUnary=function(n,t,r,i){var s=this.start,o=this.startLoc,a;if(this.isContextual("await")&&this.canAwait)a=this.parseAwait(i),t=!0;else if(this.type.prefix){var u=this.startNode(),l=this.type===q.incDec;u.operator=this.value,u.prefix=!0,this.next(),u.argument=this.parseMaybeUnary(null,!0,l,i),this.checkExpressionErrors(n,!0),l?this.checkLValSimple(u.argument):this.strict&&u.operator==="delete"&&AN(u.argument)?this.raiseRecoverable(u.start,"Deleting local variable in strict mode"):u.operator==="delete"&&iv(u.argument)?this.raiseRecoverable(u.start,"Private fields can not be deleted"):t=!0,a=this.finishNode(u,l?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===q.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),a=this.parsePrivateIdent(),this.type!==q._in&&this.unexpected();else{if(a=this.parseExprSubscripts(n,i),this.checkExpressionErrors(n))return a;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(s,o);c.operator=this.value,c.prefix=!1,c.argument=a,this.checkLValSimple(a),this.next(),a=this.finishNode(c,"UpdateExpression")}}if(!r&&this.eat(q.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(s,o,a,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return a};function AN(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&AN(n.expression)}function iv(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&iv(n.expression)||n.type==="ParenthesizedExpression"&&iv(n.expression)}dt.parseExprSubscripts=function(n,t){var r=this.start,i=this.startLoc,s=this.parseExprAtom(n,t);if(s.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return s;var o=this.parseSubscripts(s,r,i,!1,t);return n&&o.type==="MemberExpression"&&(n.parenthesizedAssign>=o.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=o.start&&(n.parenthesizedBind=-1),n.trailingComma>=o.start&&(n.trailingComma=-1)),o};dt.parseSubscripts=function(n,t,r,i,s){for(var o=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,a=!1;;){var u=this.parseSubscript(n,t,r,i,o,a,s);if(u.optional&&(a=!0),u===n||u.type==="ArrowFunctionExpression"){if(a){var l=this.startNodeAt(t,r);l.expression=u,u=this.finishNode(l,"ChainExpression")}return u}n=u}};dt.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(q.arrow)};dt.parseSubscriptAsyncArrow=function(n,t,r,i){return this.parseArrowExpression(this.startNodeAt(n,t),r,!0,i)};dt.parseSubscript=function(n,t,r,i,s,o,a){var u=this.options.ecmaVersion>=11,l=u&&this.eat(q.questionDot);i&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(q.bracketL);if(c||l&&this.type!==q.parenL&&this.type!==q.backQuote||this.eat(q.dot)){var h=this.startNodeAt(t,r);h.object=n,c?(h.property=this.parseExpression(),this.expect(q.bracketR)):this.type===q.privateId&&n.type!=="Super"?h.property=this.parsePrivateIdent():h.property=this.parseIdent(this.options.allowReserved!=="never"),h.computed=!!c,u&&(h.optional=l),n=this.finishNode(h,"MemberExpression")}else if(!i&&this.eat(q.parenL)){var f=new Xg,d=this.yieldPos,p=this.awaitPos,g=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var y=this.parseExprList(q.parenR,this.options.ecmaVersion>=8,!1,f);if(s&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=p,this.awaitIdentPos=g,this.parseSubscriptAsyncArrow(t,r,y,a);this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=g||this.awaitIdentPos;var v=this.startNodeAt(t,r);v.callee=n,v.arguments=y,u&&(v.optional=l),n=this.finishNode(v,"CallExpression")}else if(this.type===q.backQuote){(l||o)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var T=this.startNodeAt(t,r);T.tag=n,T.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(T,"TaggedTemplateExpression")}return n};dt.parseExprAtom=function(n,t,r){this.type===q.slash&&this.readRegexp();var i,s=this.potentialArrowAt===this.start;switch(this.type){case q._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===q.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==q.dot&&this.type!==q.bracketL&&this.type!==q.parenL&&this.unexpected(),this.finishNode(i,"Super");case q._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case q.name:var o=this.start,a=this.startLoc,u=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!u&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(q._function))return this.overrideContext(fr.f_expr),this.parseFunction(this.startNodeAt(o,a),0,!1,!0,t);if(s&&!this.canInsertSemicolon()){if(this.eat(q.arrow))return this.parseArrowExpression(this.startNodeAt(o,a),[l],!1,t);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===q.name&&!u&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(q.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(o,a),[l],!0,t)}return l;case q.regexp:var c=this.value;return i=this.parseLiteral(c.value),i.regex={pattern:c.pattern,flags:c.flags},i;case q.num:case q.string:return this.parseLiteral(this.value);case q._null:case q._true:case q._false:return i=this.startNode(),i.value=this.type===q._null?null:this.type===q._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case q.parenL:var h=this.start,f=this.parseParenAndDistinguishExpression(s,t);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(f)&&(n.parenthesizedAssign=h),n.parenthesizedBind<0&&(n.parenthesizedBind=h)),f;case q.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(q.bracketR,!0,!0,n),this.finishNode(i,"ArrayExpression");case q.braceL:return this.overrideContext(fr.b_expr),this.parseObj(!1,n);case q._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case q._class:return this.parseClass(this.startNode(),!1);case q._new:return this.parseNew();case q.backQuote:return this.parseTemplate();case q._import:return this.options.ecmaVersion>=11?this.parseExprImport(r):this.unexpected();default:return this.parseExprAtomDefault()}};dt.parseExprAtomDefault=function(){this.unexpected()};dt.parseExprImport=function(n){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===q.parenL&&!n)return this.parseDynamicImport(t);if(this.type===q.dot){var r=this.startNodeAt(t.start,t.loc&&t.loc.start);return r.name="import",t.meta=this.finishNode(r,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};dt.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(q.parenR)?n.options=null:(this.expect(q.comma),this.afterTrailingComma(q.parenR)?n.options=null:(n.options=this.parseMaybeAssign(),this.eat(q.parenR)||(this.expect(q.comma),this.afterTrailingComma(q.parenR)||this.unexpected())));else if(!this.eat(q.parenR)){var t=this.start;this.eat(q.comma)&&this.eat(q.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(n,"ImportExpression")};dt.parseImportMeta=function(n){this.next();var t=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")};dt.parseLiteral=function(n){var t=this.startNode();return t.value=n,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};dt.parseParenExpression=function(){this.expect(q.parenL);var n=this.parseExpression();return this.expect(q.parenR),n};dt.shouldParseArrow=function(n){return!this.canInsertSemicolon()};dt.parseParenAndDistinguishExpression=function(n,t){var r=this.start,i=this.startLoc,s,o=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a=this.start,u=this.startLoc,l=[],c=!0,h=!1,f=new Xg,d=this.yieldPos,p=this.awaitPos,g;for(this.yieldPos=0,this.awaitPos=0;this.type!==q.parenR;)if(c?c=!1:this.expect(q.comma),o&&this.afterTrailingComma(q.parenR,!0)){h=!0;break}else if(this.type===q.ellipsis){g=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===q.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,f,this.parseParenItem));var y=this.lastTokEnd,v=this.lastTokEndLoc;if(this.expect(q.parenR),n&&this.shouldParseArrow(l)&&this.eat(q.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=p,this.parseParenArrowList(r,i,l,t);(!l.length||h)&&this.unexpected(this.lastTokStart),g&&this.unexpected(g),this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,l.length>1?(s=this.startNodeAt(a,u),s.expressions=l,this.finishNodeAt(s,"SequenceExpression",y,v)):s=l[0]}else s=this.parseParenExpression();if(this.options.preserveParens){var T=this.startNodeAt(r,i);return T.expression=s,this.finishNode(T,"ParenthesizedExpression")}else return s};dt.parseParenItem=function(n){return n};dt.parseParenArrowList=function(n,t,r,i){return this.parseArrowExpression(this.startNodeAt(n,t),r,!1,i)};var Qq=[];dt.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===q.dot){var t=this.startNodeAt(n.start,n.loc&&n.loc.start);t.name="new",n.meta=this.finishNode(t,"Identifier"),this.next();var r=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),r&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var i=this.start,s=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,s,!0,!1),this.eat(q.parenL)?n.arguments=this.parseExprList(q.parenR,this.options.ecmaVersion>=8,!1):n.arguments=Qq,this.finishNode(n,"NewExpression")};dt.parseTemplateElement=function(n){var t=n.isTagged,r=this.startNode();return this.type===q.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),r.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):r.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),r.tail=this.type===q.backQuote,this.finishNode(r,"TemplateElement")};dt.parseTemplate=function(n){n===void 0&&(n={});var t=n.isTagged;t===void 0&&(t=!1);var r=this.startNode();this.next(),r.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(r.quasis=[i];!i.tail;)this.type===q.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(q.dollarBraceL),r.expressions.push(this.parseExpression()),this.expect(q.braceR),r.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(r,"TemplateLiteral")};dt.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===q.name||this.type===q.num||this.type===q.string||this.type===q.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===q.star)&&!Pn.test(this.input.slice(this.lastTokEnd,this.start))};dt.parseObj=function(n,t){var r=this.startNode(),i=!0,s={};for(r.properties=[],this.next();!this.eat(q.braceR);){if(i)i=!1;else if(this.expect(q.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(q.braceR))break;var o=this.parseProperty(n,t);n||this.checkPropClash(o,s,t),r.properties.push(o)}return this.finishNode(r,n?"ObjectPattern":"ObjectExpression")};dt.parseProperty=function(n,t){var r=this.startNode(),i,s,o,a;if(this.options.ecmaVersion>=9&&this.eat(q.ellipsis))return n?(r.argument=this.parseIdent(!1),this.type===q.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(r,"RestElement")):(r.argument=this.parseMaybeAssign(!1,t),this.type===q.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(r,"SpreadElement"));this.options.ecmaVersion>=6&&(r.method=!1,r.shorthand=!1,(n||t)&&(o=this.start,a=this.startLoc),n||(i=this.eat(q.star)));var u=this.containsEsc;return this.parsePropertyName(r),!n&&!u&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(r)?(s=!0,i=this.options.ecmaVersion>=9&&this.eat(q.star),this.parsePropertyName(r)):s=!1,this.parsePropertyValue(r,n,i,s,o,a,t,u),this.finishNode(r,"Property")};dt.parseGetterSetter=function(n){var t=n.key.name;this.parsePropertyName(n),n.value=this.parseMethod(!1),n.kind=t;var r=n.kind==="get"?0:1;if(n.value.params.length!==r){var i=n.value.start;n.kind==="get"?this.raiseRecoverable(i,"getter should have no params"):this.raiseRecoverable(i,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")};dt.parsePropertyValue=function(n,t,r,i,s,o,a,u){(r||i)&&this.type===q.colon&&this.unexpected(),this.eat(q.colon)?(n.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),n.kind="init"):this.options.ecmaVersion>=6&&this.type===q.parenL?(t&&this.unexpected(),n.method=!0,n.value=this.parseMethod(r,i),n.kind="init"):!t&&!u&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==q.comma&&this.type!==q.braceR&&this.type!==q.eq?((r||i)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((r||i)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=s),t?n.value=this.parseMaybeDefault(s,o,this.copyNode(n.key)):this.type===q.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),n.value=this.parseMaybeDefault(s,o,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.kind="init",n.shorthand=!0):this.unexpected()};dt.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(q.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(q.bracketR),n.key;n.computed=!1}return n.key=this.type===q.num||this.type===q.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};dt.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)};dt.parseMethod=function(n,t,r){var i=this.startNode(),s=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=n),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(N_(t,i.generator)|Kg|(r?xN:0)),this.expect(q.parenL),i.params=this.parseBindingList(q.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=s,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(i,"FunctionExpression")};dt.parseArrowExpression=function(n,t,r,i){var s=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.enterScope(N_(r,!1)|k_),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(t,!0),this.parseFunctionBody(n,!0,!1,i),this.yieldPos=s,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(n,"ArrowFunctionExpression")};dt.parseFunctionBody=function(n,t,r,i){var s=t&&this.type!==q.braceL,o=this.strict,a=!1;if(s)n.body=this.parseMaybeAssign(i),n.expression=!0,this.checkParams(n,!1);else{var u=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!o||u)&&(a=this.strictDirective(this.end),a&&u&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(n,!o&&!a&&!t&&!r&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,SN),n.body=this.parseBlock(!1,void 0,a&&!o),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=l}this.exitScope()};dt.isSimpleParamList=function(n){for(var t=0,r=n;t<r.length;t+=1){var i=r[t];if(i.type!=="Identifier")return!1}return!0};dt.checkParams=function(n,t){for(var r=Object.create(null),i=0,s=n.params;i<s.length;i+=1){var o=s[i];this.checkLValInnerPattern(o,R_,t?null:r)}};dt.parseExprList=function(n,t,r,i){for(var s=[],o=!0;!this.eat(n);){if(o)o=!1;else if(this.expect(q.comma),t&&this.afterTrailingComma(n))break;var a=void 0;r&&this.type===q.comma?a=null:this.type===q.ellipsis?(a=this.parseSpread(i),i&&this.type===q.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):a=this.parseMaybeAssign(!1,i),s.push(a)}return s};dt.checkUnreserved=function(n){var t=n.start,r=n.end,i=n.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&Yg)&&i==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,r).indexOf("\\")!==-1)){var s=this.strict?this.reservedWordsStrict:this.reservedWords;s.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))}};dt.parseIdent=function(n){var t=this.parseIdentNode();return this.next(!!n),this.finishNode(t,"Identifier"),n||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};dt.parseIdentNode=function(){var n=this.startNode();return this.type===q.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=q.name):this.unexpected(),n};dt.parsePrivateIdent=function(){var n=this.startNode();return this.type===q.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n};dt.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===q.semi||this.canInsertSemicolon()||this.type!==q.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(q.star),t.argument=this.parseMaybeAssign(n)),this.finishNode(t,"YieldExpression")};dt.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(t,"AwaitExpression")};var Dp=jr.prototype;Dp.raise=function(n,t){var r=vN(this.input,n);t+=" ("+r.line+":"+r.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var i=new SyntaxError(t);throw i.pos=n,i.loc=r,i.raisedAt=this.pos,i};Dp.raiseRecoverable=Dp.raise;Dp.curPosition=function(){if(this.options.locations)return new kh(this.curLine,this.pos-this.lineStart)};var Lo=jr.prototype,Jq=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};Lo.enterScope=function(n){this.scopeStack.push(new Jq(n))};Lo.exitScope=function(){this.scopeStack.pop()};Lo.treatFunctionsAsVarInScope=function(n){return n.flags&Nl||!this.inModule&&n.flags&Nh};Lo.declareName=function(n,t,r){var i=!1;if(t===Rs){var s=this.currentScope();i=s.lexical.indexOf(n)>-1||s.functions.indexOf(n)>-1||s.var.indexOf(n)>-1,s.lexical.push(n),this.inModule&&s.flags&Nh&&delete this.undefinedExports[n]}else if(t===EN){var o=this.currentScope();o.lexical.push(n)}else if(t===wN){var a=this.currentScope();this.treatFunctionsAsVar?i=a.lexical.indexOf(n)>-1:i=a.lexical.indexOf(n)>-1||a.var.indexOf(n)>-1,a.functions.push(n)}else for(var u=this.scopeStack.length-1;u>=0;--u){var l=this.scopeStack[u];if(l.lexical.indexOf(n)>-1&&!(l.flags&bN&&l.lexical[0]===n)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(n)>-1){i=!0;break}if(l.var.push(n),this.inModule&&l.flags&Nh&&delete this.undefinedExports[n],l.flags&Yg)break}i&&this.raiseRecoverable(r,"Identifier '"+n+"' has already been declared")};Lo.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)};Lo.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Lo.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var t=this.scopeStack[n];if(t.flags&(Yg|lf|za))return t}};Lo.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var t=this.scopeStack[n];if(t.flags&(Yg|lf|za)&&!(t.flags&k_))return t}};var Zg=function(t,r,i){this.type="",this.start=r,this.end=0,t.options.locations&&(this.loc=new Wg(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[r,0])},cf=jr.prototype;cf.startNode=function(){return new Zg(this,this.start,this.startLoc)};cf.startNodeAt=function(n,t){return new Zg(this,n,t)};function TN(n,t,r,i){return n.type=t,n.end=r,this.options.locations&&(n.loc.end=i),this.options.ranges&&(n.range[1]=r),n}cf.finishNode=function(n,t){return TN.call(this,n,t,this.lastTokEnd,this.lastTokEndLoc)};cf.finishNodeAt=function(n,t,r,i){return TN.call(this,n,t,r,i)};cf.copyNode=function(n){var t=new Zg(this,n.start,this.startLoc);for(var r in n)t[r]=n[r];return t};var eH="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",IN="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",DN=IN+" Extended_Pictographic",kN=DN,NN=kN+" EBase EComp EMod EPres ExtPict",RN=NN,tH=RN,rH={9:IN,10:DN,11:kN,12:NN,13:RN,14:tH},nH="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",iH={9:"",10:"",11:"",12:"",13:"",14:nH},KS="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",FN="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",PN=FN+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",MN=PN+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",LN=MN+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ON=LN+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",sH=ON+" "+eH,oH={9:FN,10:PN,11:MN,12:LN,13:ON,14:sH},VN={};function aH(n){var t=VN[n]={binary:ao(rH[n]+" "+KS),binaryOfStrings:ao(iH[n]),nonBinary:{General_Category:ao(KS),Script:ao(oH[n])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var i0=0,YS=[9,10,11,12,13,14];i0<YS.length;i0+=1){var uH=YS[i0];aH(uH)}var tt=jr.prototype,kp=function(t,r){this.parent=t,this.base=r||this};kp.prototype.separatedFrom=function(t){for(var r=this;r;r=r.parent)for(var i=t;i;i=i.parent)if(r.base===i.base&&r!==i)return!0;return!1};kp.prototype.sibling=function(){return new kp(this.parent,this.base)};var Qi=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=VN[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Qi.prototype.reset=function(t,r,i){var s=i.indexOf("v")!==-1,o=i.indexOf("u")!==-1;this.start=t|0,this.source=r+"",this.flags=i,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=o&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=o&&this.parser.options.ecmaVersion>=9)};Qi.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};Qi.prototype.at=function(t,r){r===void 0&&(r=!1);var i=this.source,s=i.length;if(t>=s)return-1;var o=i.charCodeAt(t);if(!(r||this.switchU)||o<=55295||o>=57344||t+1>=s)return o;var a=i.charCodeAt(t+1);return a>=56320&&a<=57343?(o<<10)+a-56613888:o};Qi.prototype.nextIndex=function(t,r){r===void 0&&(r=!1);var i=this.source,s=i.length;if(t>=s)return s;var o=i.charCodeAt(t),a;return!(r||this.switchU)||o<=55295||o>=57344||t+1>=s||(a=i.charCodeAt(t+1))<56320||a>57343?t+1:t+2};Qi.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};Qi.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};Qi.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};Qi.prototype.eat=function(t,r){return r===void 0&&(r=!1),this.current(r)===t?(this.advance(r),!0):!1};Qi.prototype.eatChars=function(t,r){r===void 0&&(r=!1);for(var i=this.pos,s=0,o=t;s<o.length;s+=1){var a=o[s],u=this.at(i,r);if(u===-1||u!==a)return!1;i=this.nextIndex(i,r)}return this.pos=i,!0};tt.validateRegExpFlags=function(n){for(var t=n.validFlags,r=n.flags,i=!1,s=!1,o=0;o<r.length;o++){var a=r.charAt(o);t.indexOf(a)===-1&&this.raise(n.start,"Invalid regular expression flag"),r.indexOf(a,o+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),a==="u"&&(i=!0),a==="v"&&(s=!0)}this.options.ecmaVersion>=15&&i&&s&&this.raise(n.start,"Invalid regular expression flag")};function lH(n){for(var t in n)return!0;return!1}tt.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&lH(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))};tt.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var t=0,r=n.backReferenceNames;t<r.length;t+=1){var i=r[t];n.groupNames[i]||n.raise("Invalid named capture referenced")}};tt.regexp_disjunction=function(n){var t=this.options.ecmaVersion>=16;for(t&&(n.branchID=new kp(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)t&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);t&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")};tt.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););};tt.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1};tt.regexp_eatAssertion=function(n){var t=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=t}if(n.eat(40)&&n.eat(63)){var r=!1;if(this.options.ecmaVersion>=9&&(r=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!r,!0}return n.pos=t,!1};tt.regexp_eatQuantifier=function(n,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(n,t)?(n.eat(63),!0):!1};tt.regexp_eatQuantifierPrefix=function(n,t){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,t)};tt.regexp_eatBracedQuantifier=function(n,t){var r=n.pos;if(n.eat(123)){var i=0,s=-1;if(this.regexp_eatDecimalDigits(n)&&(i=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(s=n.lastIntValue),n.eat(125)))return s!==-1&&s<i&&!t&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!t&&n.raise("Incomplete quantifier"),n.pos=r}return!1};tt.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)};tt.regexp_eatReverseSolidusAtomEscape=function(n){var t=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=t}return!1};tt.regexp_eatUncapturingGroup=function(n){var t=n.pos;if(n.eat(40)){if(n.eat(63)){if(this.options.ecmaVersion>=16){var r=this.regexp_eatModifiers(n),i=n.eat(45);if(r||i){for(var s=0;s<r.length;s++){var o=r.charAt(s);r.indexOf(o,s+1)>-1&&n.raise("Duplicate regular expression modifiers")}if(i){var a=this.regexp_eatModifiers(n);!r&&!a&&n.current()===58&&n.raise("Invalid regular expression modifiers");for(var u=0;u<a.length;u++){var l=a.charAt(u);(a.indexOf(l,u+1)>-1||r.indexOf(l)>-1)&&n.raise("Duplicate regular expression modifiers")}}}}if(n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}}n.pos=t}return!1};tt.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1};tt.regexp_eatModifiers=function(n){for(var t="",r=0;(r=n.current())!==-1&&cH(r);)t+=Cs(r),n.advance();return t};function cH(n){return n===105||n===109||n===115}tt.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)};tt.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1};tt.regexp_eatSyntaxCharacter=function(n){var t=n.current();return BN(t)?(n.lastIntValue=t,n.advance(),!0):!1};function BN(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}tt.regexp_eatPatternCharacters=function(n){for(var t=n.pos,r=0;(r=n.current())!==-1&&!BN(r);)n.advance();return n.pos!==t};tt.regexp_eatExtendedPatternCharacter=function(n){var t=n.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(n.advance(),!0):!1};tt.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var t=this.options.ecmaVersion>=16,r=n.groupNames[n.lastStringValue];if(r)if(t)for(var i=0,s=r;i<s.length;i+=1){var o=s[i];o.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");t?(r||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}};tt.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1};tt.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=Cs(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=Cs(n.lastIntValue);return!0}return!1};tt.regexp_eatRegExpIdentifierStart=function(n){var t=n.pos,r=this.options.ecmaVersion>=11,i=n.current(r);return n.advance(r),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,r)&&(i=n.lastIntValue),hH(i)?(n.lastIntValue=i,!0):(n.pos=t,!1)};function hH(n){return Wi(n,!0)||n===36||n===95}tt.regexp_eatRegExpIdentifierPart=function(n){var t=n.pos,r=this.options.ecmaVersion>=11,i=n.current(r);return n.advance(r),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,r)&&(i=n.lastIntValue),fH(i)?(n.lastIntValue=i,!0):(n.pos=t,!1)};function fH(n){return Ro(n,!0)||n===36||n===95||n===8204||n===8205}tt.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)};tt.regexp_eatBackReference=function(n){var t=n.pos;if(this.regexp_eatDecimalEscape(n)){var r=n.lastIntValue;if(n.switchU)return r>n.maxBackReference&&(n.maxBackReference=r),!0;if(r<=n.numCapturingParens)return!0;n.pos=t}return!1};tt.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1};tt.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)};tt.regexp_eatCControlLetter=function(n){var t=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=t}return!1};tt.regexp_eatZero=function(n){return n.current()===48&&!Qg(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1};tt.regexp_eatControlEscape=function(n){var t=n.current();return t===116?(n.lastIntValue=9,n.advance(),!0):t===110?(n.lastIntValue=10,n.advance(),!0):t===118?(n.lastIntValue=11,n.advance(),!0):t===102?(n.lastIntValue=12,n.advance(),!0):t===114?(n.lastIntValue=13,n.advance(),!0):!1};tt.regexp_eatControlLetter=function(n){var t=n.current();return UN(t)?(n.lastIntValue=t%32,n.advance(),!0):!1};function UN(n){return n>=65&&n<=90||n>=97&&n<=122}tt.regexp_eatRegExpUnicodeEscapeSequence=function(n,t){t===void 0&&(t=!1);var r=n.pos,i=t||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var s=n.lastIntValue;if(i&&s>=55296&&s<=56319){var o=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var a=n.lastIntValue;if(a>=56320&&a<=57343)return n.lastIntValue=(s-55296)*1024+(a-56320)+65536,!0}n.pos=o,n.lastIntValue=s}return!0}if(i&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&dH(n.lastIntValue))return!0;i&&n.raise("Invalid unicode escape"),n.pos=r}return!1};function dH(n){return n>=0&&n<=1114111}tt.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var t=n.current();return t!==99&&(!n.switchN||t!==107)?(n.lastIntValue=t,n.advance(),!0):!1};tt.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var t=n.current();if(t>=49&&t<=57){do n.lastIntValue=10*n.lastIntValue+(t-48),n.advance();while((t=n.current())>=48&&t<=57);return!0}return!1};var $N=0,As=1,Zn=2;tt.regexp_eatCharacterClassEscape=function(n){var t=n.current();if(pH(t))return n.lastIntValue=-1,n.advance(),As;var r=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((r=t===80)||t===112)){n.lastIntValue=-1,n.advance();var i;if(n.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return r&&i===Zn&&n.raise("Invalid property name"),i;n.raise("Invalid property name")}return $N};function pH(n){return n===100||n===68||n===115||n===83||n===119||n===87}tt.regexp_eatUnicodePropertyValueExpression=function(n){var t=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var r=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var i=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,r,i),As}}if(n.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var s=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,s)}return $N};tt.regexp_validateUnicodePropertyNameAndValue=function(n,t,r){kl(n.unicodeProperties.nonBinary,t)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[t].test(r)||n.raise("Invalid property value")};tt.regexp_validateUnicodePropertyNameOrValue=function(n,t){if(n.unicodeProperties.binary.test(t))return As;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(t))return Zn;n.raise("Invalid property name")};tt.regexp_eatUnicodePropertyName=function(n){var t=0;for(n.lastStringValue="";jN(t=n.current());)n.lastStringValue+=Cs(t),n.advance();return n.lastStringValue!==""};function jN(n){return UN(n)||n===95}tt.regexp_eatUnicodePropertyValue=function(n){var t=0;for(n.lastStringValue="";gH(t=n.current());)n.lastStringValue+=Cs(t),n.advance();return n.lastStringValue!==""};function gH(n){return jN(n)||Qg(n)}tt.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)};tt.regexp_eatCharacterClass=function(n){if(n.eat(91)){var t=n.eat(94),r=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),t&&r===Zn&&n.raise("Negated character class may contain strings"),!0}return!1};tt.regexp_classContents=function(n){return n.current()===93?As:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),As)};tt.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var t=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var r=n.lastIntValue;n.switchU&&(t===-1||r===-1)&&n.raise("Invalid character class"),t!==-1&&r!==-1&&t>r&&n.raise("Range out of order in character class")}}};tt.regexp_eatClassAtom=function(n){var t=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var r=n.current();(r===99||qN(r))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=t}var i=n.current();return i!==93?(n.lastIntValue=i,n.advance(),!0):!1};tt.regexp_eatClassEscape=function(n){var t=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=t}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)};tt.regexp_classSetExpression=function(n){var t=As,r;if(!this.regexp_eatClassSetRange(n))if(r=this.regexp_eatClassSetOperand(n)){r===Zn&&(t=Zn);for(var i=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(r=this.regexp_eatClassSetOperand(n))){r!==Zn&&(t=As);continue}n.raise("Invalid character in character class")}if(i!==n.pos)return t;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(i!==n.pos)return t}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(r=this.regexp_eatClassSetOperand(n),!r)return t;r===Zn&&(t=Zn)}};tt.regexp_eatClassSetRange=function(n){var t=n.pos;if(this.regexp_eatClassSetCharacter(n)){var r=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var i=n.lastIntValue;return r!==-1&&i!==-1&&r>i&&n.raise("Range out of order in character class"),!0}n.pos=t}return!1};tt.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?As:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)};tt.regexp_eatNestedClass=function(n){var t=n.pos;if(n.eat(91)){var r=n.eat(94),i=this.regexp_classContents(n);if(n.eat(93))return r&&i===Zn&&n.raise("Negated character class may contain strings"),i;n.pos=t}if(n.eat(92)){var s=this.regexp_eatCharacterClassEscape(n);if(s)return s;n.pos=t}return null};tt.regexp_eatClassStringDisjunction=function(n){var t=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var r=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return r}else n.raise("Invalid escape");n.pos=t}return null};tt.regexp_classStringDisjunctionContents=function(n){for(var t=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===Zn&&(t=Zn);return t};tt.regexp_classString=function(n){for(var t=0;this.regexp_eatClassSetCharacter(n);)t++;return t===1?As:Zn};tt.regexp_eatClassSetCharacter=function(n){var t=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=t,!1);var r=n.current();return r<0||r===n.lookahead()&&mH(r)||yH(r)?!1:(n.advance(),n.lastIntValue=r,!0)};function mH(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function yH(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}tt.regexp_eatClassSetReservedPunctuator=function(n){var t=n.current();return vH(t)?(n.lastIntValue=t,n.advance(),!0):!1};function vH(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}tt.regexp_eatClassControlLetter=function(n){var t=n.current();return Qg(t)||t===95?(n.lastIntValue=t%32,n.advance(),!0):!1};tt.regexp_eatHexEscapeSequence=function(n){var t=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=t}return!1};tt.regexp_eatDecimalDigits=function(n){var t=n.pos,r=0;for(n.lastIntValue=0;Qg(r=n.current());)n.lastIntValue=10*n.lastIntValue+(r-48),n.advance();return n.pos!==t};function Qg(n){return n>=48&&n<=57}tt.regexp_eatHexDigits=function(n){var t=n.pos,r=0;for(n.lastIntValue=0;GN(r=n.current());)n.lastIntValue=16*n.lastIntValue+zN(r),n.advance();return n.pos!==t};function GN(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function zN(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}tt.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var t=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var r=n.lastIntValue;t<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=t*64+r*8+n.lastIntValue:n.lastIntValue=t*8+r}else n.lastIntValue=t;return!0}return!1};tt.regexp_eatOctalDigit=function(n){var t=n.current();return qN(t)?(n.lastIntValue=t-48,n.advance(),!0):(n.lastIntValue=0,!1)};function qN(n){return n>=48&&n<=55}tt.regexp_eatFixedHexDigits=function(n,t){var r=n.pos;n.lastIntValue=0;for(var i=0;i<t;++i){var s=n.current();if(!GN(s))return n.pos=r,!1;n.lastIntValue=16*n.lastIntValue+zN(s),n.advance()}return!0};var P_=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new Wg(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Dt=jr.prototype;Dt.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new P_(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Dt.getToken=function(){return this.next(),new P_(this)};typeof Symbol<"u"&&(Dt[Symbol.iterator]=function(){var n=this;return{next:function(){var t=n.getToken();return{done:t.type===q.eof,value:t}}}});Dt.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(q.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())};Dt.readToken=function(n){return Wi(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)};Dt.fullCharCodeAtPos=function(){var n=this.input.charCodeAt(this.pos);if(n<=55295||n>=56320)return n;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?n:(n<<10)+t-56613888};Dt.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),t=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(r===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(var i=void 0,s=t;(i=gN(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,r),t,this.pos,n,this.curPosition())};Dt.skipLineComment=function(n){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!Dl(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+n,this.pos),t,this.pos,r,this.curPosition())};Dt.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&mN.test(String.fromCharCode(n)))++this.pos;else break e}}};Dt.finishToken=function(n,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=n,this.value=t,this.updateContext(r)};Dt.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&t===46?(this.pos+=3,this.finishToken(q.ellipsis)):(++this.pos,this.finishToken(q.dot))};Dt.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(q.assign,2):this.finishOp(q.slash,1)};Dt.readToken_mult_modulo_exp=function(n){var t=this.input.charCodeAt(this.pos+1),r=1,i=n===42?q.star:q.modulo;return this.options.ecmaVersion>=7&&n===42&&t===42&&(++r,i=q.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(q.assign,r+1):this.finishOp(i,r)};Dt.readToken_pipe_amp=function(n){var t=this.input.charCodeAt(this.pos+1);if(t===n){if(this.options.ecmaVersion>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(q.assign,3)}return this.finishOp(n===124?q.logicalOR:q.logicalAND,2)}return t===61?this.finishOp(q.assign,2):this.finishOp(n===124?q.bitwiseOR:q.bitwiseAND,1)};Dt.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(q.assign,2):this.finishOp(q.bitwiseXOR,1)};Dt.readToken_plus_min=function(n){var t=this.input.charCodeAt(this.pos+1);return t===n?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Pn.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(q.incDec,2):t===61?this.finishOp(q.assign,2):this.finishOp(q.plusMin,1)};Dt.readToken_lt_gt=function(n){var t=this.input.charCodeAt(this.pos+1),r=1;return t===n?(r=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+r)===61?this.finishOp(q.assign,r+1):this.finishOp(q.bitShift,r)):t===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(r=2),this.finishOp(q.relational,r))};Dt.readToken_eq_excl=function(n){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(q.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(q.arrow)):this.finishOp(n===61?q.eq:q.prefix,1)};Dt.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var r=this.input.charCodeAt(this.pos+2);if(r<48||r>57)return this.finishOp(q.questionDot,2)}if(t===63){if(n>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(q.assign,3)}return this.finishOp(q.coalesce,2)}}return this.finishOp(q.question,1)};Dt.readToken_numberSign=function(){var n=this.options.ecmaVersion,t=35;if(n>=13&&(++this.pos,t=this.fullCharCodeAtPos(),Wi(t,!0)||t===92))return this.finishToken(q.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Cs(t)+"'")};Dt.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(q.parenL);case 41:return++this.pos,this.finishToken(q.parenR);case 59:return++this.pos,this.finishToken(q.semi);case 44:return++this.pos,this.finishToken(q.comma);case 91:return++this.pos,this.finishToken(q.bracketL);case 93:return++this.pos,this.finishToken(q.bracketR);case 123:return++this.pos,this.finishToken(q.braceL);case 125:return++this.pos,this.finishToken(q.braceR);case 58:return++this.pos,this.finishToken(q.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(q.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(q.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Cs(n)+"'")};Dt.finishOp=function(n,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(n,r)};Dt.readRegexp=function(){for(var n,t,r=this.pos;;){this.pos>=this.input.length&&this.raise(r,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(Pn.test(i)&&this.raise(r,"Unterminated regular expression"),n)n=!1;else{if(i==="[")t=!0;else if(i==="]"&&t)t=!1;else if(i==="/"&&!t)break;n=i==="\\"}++this.pos}var s=this.input.slice(r,this.pos);++this.pos;var o=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(o);var u=this.regexpState||(this.regexpState=new Qi(this));u.reset(r,s,a),this.validateRegExpFlags(u),this.validateRegExpPattern(u);var l=null;try{l=new RegExp(s,a)}catch{}return this.finishToken(q.regexp,{pattern:s,flags:a,value:l})};Dt.readInt=function(n,t,r){for(var i=this.options.ecmaVersion>=12&&t===void 0,s=r&&this.input.charCodeAt(this.pos)===48,o=this.pos,a=0,u=0,l=0,c=t??1/0;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),f=void 0;if(i&&h===95){s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),u===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),u=h;continue}if(h>=97?f=h-97+10:h>=65?f=h-65+10:h>=48&&h<=57?f=h-48:f=1/0,f>=n)break;u=h,a=a*n+f}return i&&u===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===o||t!=null&&this.pos-o!==t?null:a};function _H(n,t){return t?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function HN(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}Dt.readRadixNumber=function(n){var t=this.pos;this.pos+=2;var r=this.readInt(n);return r==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(r=HN(this.input.slice(t,this.pos)),++this.pos):Wi(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(q.num,r)};Dt.readNumber=function(n){var t=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var r=this.pos-t>=2&&this.input.charCodeAt(t)===48;r&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!r&&!n&&this.options.ecmaVersion>=11&&i===110){var s=HN(this.input.slice(t,this.pos));return++this.pos,Wi(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(q.num,s)}r&&/[89]/.test(this.input.slice(t,this.pos))&&(r=!1),i===46&&!r&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!r&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),Wi(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o=_H(this.input.slice(t,this.pos),r);return this.finishToken(q.num,o)};Dt.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),t;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(r,"Code point out of bounds")}else t=this.readHexChar(4);return t};Dt.readString=function(n){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===n)break;i===92?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Dl(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(q.string,t)};var WN={};Dt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===WN)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1};Dt.invalidStringToken=function(n,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw WN;this.raise(n,t)};Dt.readTmplToken=function(){for(var n="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(r===96||r===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===q.template||this.type===q.invalidTemplate)?r===36?(this.pos+=2,this.finishToken(q.dollarBraceL)):(++this.pos,this.finishToken(q.backQuote)):(n+=this.input.slice(t,this.pos),this.finishToken(q.template,n));if(r===92)n+=this.input.slice(t,this.pos),n+=this.readEscapedChar(!0),t=this.pos;else if(Dl(r)){switch(n+=this.input.slice(t,this.pos),++this.pos,r){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(r);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};Dt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(q.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};Dt.readEscapedChar=function(n){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Cs(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var r=this.pos-1;this.invalidStringToken(r,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],s=parseInt(i,8);return s>255&&(i=i.slice(0,-1),s=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),(i!=="0"||t===56||t===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-i.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(s)}return Dl(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};Dt.readHexChar=function(n){var t=this.pos,r=this.readInt(16,n);return r===null&&this.invalidStringToken(t,"Bad character escape sequence"),r};Dt.readWord1=function(){this.containsEsc=!1;for(var n="",t=!0,r=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var s=this.fullCharCodeAtPos();if(Ro(s,i))this.pos+=s<=65535?1:2;else if(s===92){this.containsEsc=!0,n+=this.input.slice(r,this.pos);var o=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(t?Wi:Ro)(a,i)||this.invalidStringToken(o,"Invalid Unicode escape"),n+=Cs(a),r=this.pos}else break;t=!1}return n+this.input.slice(r,this.pos)};Dt.readWord=function(){var n=this.readWord1(),t=q.name;return this.keywords.test(n)&&(t=I_[n]),this.finishToken(t,n)};var bH="8.15.0";jr.acorn={Parser:jr,version:bH,defaultOptions:rv,Position:kh,SourceLocation:Wg,getLineInfo:vN,Node:Zg,TokenType:Mt,tokTypes:q,keywordTypes:I_,TokContext:ui,tokContexts:fr,isIdentifierChar:Ro,isIdentifierStart:Wi,Token:P_,isNewLine:Dl,lineBreak:Pn,lineBreakG:jq,nonASCIIwhitespace:mN};function KN(n,t){return jr.parse(n,t)}function xH(n,t,r,i,s){r||(r=$e),function o(a,u,l){var c=l||a.type;r[c](a,u,o),t[c]&&t[c](a,u)}(n,i,s)}function wH(n,t,r,i,s){var o=[];r||(r=$e),function a(u,l,c){var h=c||u.type,f=u!==o[o.length-1];f&&o.push(u),r[h](u,l,a),t[h]&&t[h](u,l||o,o),f&&o.pop()}(n,i,s)}function M_(n,t,r){r(n,t)}function qa(n,t,r){}var $e={};$e.Program=$e.BlockStatement=$e.StaticBlock=function(n,t,r){for(var i=0,s=n.body;i<s.length;i+=1){var o=s[i];r(o,t,"Statement")}};$e.Statement=M_;$e.EmptyStatement=qa;$e.ExpressionStatement=$e.ParenthesizedExpression=$e.ChainExpression=function(n,t,r){return r(n.expression,t,"Expression")};$e.IfStatement=function(n,t,r){r(n.test,t,"Expression"),r(n.consequent,t,"Statement"),n.alternate&&r(n.alternate,t,"Statement")};$e.LabeledStatement=function(n,t,r){return r(n.body,t,"Statement")};$e.BreakStatement=$e.ContinueStatement=qa;$e.WithStatement=function(n,t,r){r(n.object,t,"Expression"),r(n.body,t,"Statement")};$e.SwitchStatement=function(n,t,r){r(n.discriminant,t,"Expression");for(var i=0,s=n.cases;i<s.length;i+=1){var o=s[i];r(o,t)}};$e.SwitchCase=function(n,t,r){n.test&&r(n.test,t,"Expression");for(var i=0,s=n.consequent;i<s.length;i+=1){var o=s[i];r(o,t,"Statement")}};$e.ReturnStatement=$e.YieldExpression=$e.AwaitExpression=function(n,t,r){n.argument&&r(n.argument,t,"Expression")};$e.ThrowStatement=$e.SpreadElement=function(n,t,r){return r(n.argument,t,"Expression")};$e.TryStatement=function(n,t,r){r(n.block,t,"Statement"),n.handler&&r(n.handler,t),n.finalizer&&r(n.finalizer,t,"Statement")};$e.CatchClause=function(n,t,r){n.param&&r(n.param,t,"Pattern"),r(n.body,t,"Statement")};$e.WhileStatement=$e.DoWhileStatement=function(n,t,r){r(n.test,t,"Expression"),r(n.body,t,"Statement")};$e.ForStatement=function(n,t,r){n.init&&r(n.init,t,"ForInit"),n.test&&r(n.test,t,"Expression"),n.update&&r(n.update,t,"Expression"),r(n.body,t,"Statement")};$e.ForInStatement=$e.ForOfStatement=function(n,t,r){r(n.left,t,"ForInit"),r(n.right,t,"Expression"),r(n.body,t,"Statement")};$e.ForInit=function(n,t,r){n.type==="VariableDeclaration"?r(n,t):r(n,t,"Expression")};$e.DebuggerStatement=qa;$e.FunctionDeclaration=function(n,t,r){return r(n,t,"Function")};$e.VariableDeclaration=function(n,t,r){for(var i=0,s=n.declarations;i<s.length;i+=1){var o=s[i];r(o,t)}};$e.VariableDeclarator=function(n,t,r){r(n.id,t,"Pattern"),n.init&&r(n.init,t,"Expression")};$e.Function=function(n,t,r){n.id&&r(n.id,t,"Pattern");for(var i=0,s=n.params;i<s.length;i+=1){var o=s[i];r(o,t,"Pattern")}r(n.body,t,n.expression?"Expression":"Statement")};$e.Pattern=function(n,t,r){n.type==="Identifier"?r(n,t,"VariablePattern"):n.type==="MemberExpression"?r(n,t,"MemberPattern"):r(n,t)};$e.VariablePattern=qa;$e.MemberPattern=M_;$e.RestElement=function(n,t,r){return r(n.argument,t,"Pattern")};$e.ArrayPattern=function(n,t,r){for(var i=0,s=n.elements;i<s.length;i+=1){var o=s[i];o&&r(o,t,"Pattern")}};$e.ObjectPattern=function(n,t,r){for(var i=0,s=n.properties;i<s.length;i+=1){var o=s[i];o.type==="Property"?(o.computed&&r(o.key,t,"Expression"),r(o.value,t,"Pattern")):o.type==="RestElement"&&r(o.argument,t,"Pattern")}};$e.Expression=M_;$e.ThisExpression=$e.Super=$e.MetaProperty=qa;$e.ArrayExpression=function(n,t,r){for(var i=0,s=n.elements;i<s.length;i+=1){var o=s[i];o&&r(o,t,"Expression")}};$e.ObjectExpression=function(n,t,r){for(var i=0,s=n.properties;i<s.length;i+=1){var o=s[i];r(o,t)}};$e.FunctionExpression=$e.ArrowFunctionExpression=$e.FunctionDeclaration;$e.SequenceExpression=function(n,t,r){for(var i=0,s=n.expressions;i<s.length;i+=1){var o=s[i];r(o,t,"Expression")}};$e.TemplateLiteral=function(n,t,r){for(var i=0,s=n.quasis;i<s.length;i+=1){var o=s[i];r(o,t)}for(var a=0,u=n.expressions;a<u.length;a+=1){var l=u[a];r(l,t,"Expression")}};$e.TemplateElement=qa;$e.UnaryExpression=$e.UpdateExpression=function(n,t,r){r(n.argument,t,"Expression")};$e.BinaryExpression=$e.LogicalExpression=function(n,t,r){r(n.left,t,"Expression"),r(n.right,t,"Expression")};$e.AssignmentExpression=$e.AssignmentPattern=function(n,t,r){r(n.left,t,"Pattern"),r(n.right,t,"Expression")};$e.ConditionalExpression=function(n,t,r){r(n.test,t,"Expression"),r(n.consequent,t,"Expression"),r(n.alternate,t,"Expression")};$e.NewExpression=$e.CallExpression=function(n,t,r){if(r(n.callee,t,"Expression"),n.arguments)for(var i=0,s=n.arguments;i<s.length;i+=1){var o=s[i];r(o,t,"Expression")}};$e.MemberExpression=function(n,t,r){r(n.object,t,"Expression"),n.computed&&r(n.property,t,"Expression")};$e.ExportNamedDeclaration=$e.ExportDefaultDeclaration=function(n,t,r){n.declaration&&r(n.declaration,t,n.type==="ExportNamedDeclaration"||n.declaration.id?"Statement":"Expression"),n.source&&r(n.source,t,"Expression")};$e.ExportAllDeclaration=function(n,t,r){n.exported&&r(n.exported,t),r(n.source,t,"Expression")};$e.ImportDeclaration=function(n,t,r){for(var i=0,s=n.specifiers;i<s.length;i+=1){var o=s[i];r(o,t)}r(n.source,t,"Expression")};$e.ImportExpression=function(n,t,r){r(n.source,t,"Expression")};$e.ImportSpecifier=$e.ImportDefaultSpecifier=$e.ImportNamespaceSpecifier=$e.Identifier=$e.PrivateIdentifier=$e.Literal=qa;$e.TaggedTemplateExpression=function(n,t,r){r(n.tag,t,"Expression"),r(n.quasi,t,"Expression")};$e.ClassDeclaration=$e.ClassExpression=function(n,t,r){return r(n,t,"Class")};$e.Class=function(n,t,r){n.id&&r(n.id,t,"Pattern"),n.superClass&&r(n.superClass,t,"Expression"),r(n.body,t)};$e.ClassBody=function(n,t,r){for(var i=0,s=n.body;i<s.length;i+=1){var o=s[i];r(o,t)}};$e.MethodDefinition=$e.PropertyDefinition=$e.Property=function(n,t,r){n.computed&&r(n.key,t,"Expression"),n.value&&r(n.value,t,"Expression")};const EH=["setup","draw","preload","deviceMoved","deviceTurned","deviceShaken","doubleClicked","mousePressed","mouseReleased","mouseMoved","mouseDragged","mouseClicked","mouseWheel","touchStarted","touchMoved","touchEnded","keyPressed","keyReleased","keyTyped","windowResized"],fc={fetchScript:async function(n){if(n.src)try{return await fetch(n.src).then(r=>r.text())}catch(t){return console.error("Error fetching script:",t),""}else return n.textContent},extractUserDefinedVariablesAndFuncs:function(n){const t={variables:[],functions:[]},r=-1;try{const i=KN(n,{ecmaVersion:2021,sourceType:"module",locations:!0});xH(i,{VariableDeclarator(s){if(s.id.type==="Identifier"){const o=s.init&&["ArrowFunctionExpression","FunctionExpression"].includes(s.init.type)?"functions":"variables";t[o].push({name:s.id.name,line:s.loc.start.line+r})}},FunctionDeclaration(s){s.id&&s.id.type==="Identifier"&&t.functions.push({name:s.id.name,line:s.loc.start.line+r})},ClassDeclaration(s){s.id&&s.id.type==="Identifier"&&t.variables.push({name:s.id.name,line:s.loc.start.line+r})}})}catch(i){console.error("Error parsing code:",i)}return t},checkForConstsAndFuncs:function(n,t){const r=[...n.variables,...n.functions];function i(o,a,u){const l=`https://p5js.org/reference/p5/${a}`;return`${o} "${a}" on line ${u} is being redeclared and conflicts with a p5.js ${o.toLowerCase()}. p5.js reference: ${l}`}for(let{name:o,line:a}of r)if(ka[o]!==void 0){const l=i("Constant",o,a);return console.log(l),!0}const s=new Set(Object.getOwnPropertyNames(t.prototype).filter(o=>!o.startsWith("_")&&o!=="constructor"));for(let{name:o,line:a}of r)if(!EH.includes(o)&&s.has(o)){const u=i("Function",o,a);return console.log(u),!0}return!1},getUserCode:async function(){const n=document.querySelectorAll("script"),t=n[n.length-1];return await fc.fetchScript(t)},runFES:async function(n){const t=await fc.getUserCode(),r=fc.extractUserDefinedVariablesAndFuncs(t);fc.checkForConstsAndFuncs(r,n)}};function YN(n,t,r){r.presetup=async function(){n.disableFriendlyErrors||fc.runFES(n)}}typeof p5<"u"&&YN(p5,p5.prototype);function XN(n,t){const r=(i,s)=>{const o=pt("fes.fileLoadError.suggestion",{filePath:s,url:"https://github.com/processing/p5.js/wiki/Local-server"});switch(i){case 0:return{message:pt("fes.fileLoadError.image",{suggestion:o}),method:"loadImage"};case 1:return{message:pt("fes.fileLoadError.xml",{suggestion:o}),method:"loadXML"};case 2:return{message:pt("fes.fileLoadError.table",{suggestion:o}),method:"loadTable"};case 3:return{message:pt("fes.fileLoadError.strings",{suggestion:o}),method:"loadStrings"};case 4:return{message:pt("fes.fileLoadError.font",{suggestion:o}),method:"loadFont"};case 5:return{message:pt("fes.fileLoadError.json",{suggestion:o}),method:"loadJSON"};case 6:return{message:pt("fes.fileLoadError.bytes",{suggestion:o}),method:"loadBytes"};case 7:return{message:pt("fes.fileLoadError.large"),method:"loadX"};case 8:return{message:pt("fes.fileLoadError.gif"),method:"loadImage"}}};n._friendlyFileLoadError=function(i,s){const{message:o,method:a}=r(i,s);n._friendlyError(o,a,3)}}typeof p5<"u"&&XN(p5,p5.prototype);function SH(n){n.registerAddon(oN),n.registerAddon(aN),n.registerAddon(fN),n.registerAddon(YN),n.registerAddon(XN)}function ZN(n,t){t.storeItem=function(r,i){typeof r!="string"&&console.log(`The argument that you passed to storeItem() - ${r} is not a string.`),r.endsWith("p5TypeID")&&console.log(`The argument that you passed to storeItem() - ${r} must not end with 'p5TypeID'.`),typeof i>"u"&&console.log("You cannot store undefined variables using storeItem().");let s=typeof i;switch(s){case"number":case"boolean":i=i.toString();break;case"object":i instanceof n.Color?(s="p5.Color",i=i.toString()):i instanceof n.Vector&&(s="p5.Vector",i=[i.x,i.y,i.z]),i=JSON.stringify(i);break}localStorage.setItem(r,i);const o=`${r}p5TypeID`;localStorage.setItem(o,s)},t.getItem=function(r){let i=localStorage.getItem(r);const s=localStorage.getItem(`${r}p5TypeID`);if(typeof s>"u")console.log(`Unable to determine type of item stored under ${r}in local storage. Did you save the item with something other than setItem()?`);else if(i!==null)switch(s){case"number":i=parseFloat(i);break;case"boolean":i=i==="true";break;case"object":i=JSON.parse(i);break;case"p5.Color":i=this.color(JSON.parse(i));break;case"p5.Vector":i=JSON.parse(i),i=this.createVector(...i);break}return i},t.clearStorage=function(){Object.keys(localStorage).forEach(i=>{i.endsWith("p5TypeID")&&this.removeItem(i.replace("p5TypeID",""))})},t.removeItem=function(r){typeof r!="string"&&console.log(`The argument that you passed to removeItem() - ${r} is not a string.`),localStorage.removeItem(r),localStorage.removeItem(`${r}p5TypeID`)}}typeof p5<"u"&&ZN(p5,p5.prototype);function CH(n){n.registerAddon(ZN)}function QN(n,t){t.select=function(s,o){const u=this._getContainer(o).querySelector(s);return u?this._wrapElement(u):null},t.selectAll=function(s,o){const a=[],l=this._getContainer(o).querySelectorAll(s);if(l)for(let c=0;c<l.length;c++){const h=this._wrapElement(l[c]);a.push(h)}return a},t._getContainer=function(s){let o=document;return typeof s=="string"?o=document.querySelector(s)||document:s instanceof Lr?o=s.elt:s instanceof HTMLElement&&(o=s),o},t._wrapElement=function(s){const o=Array.prototype.slice.call(s.children);if(s.tagName==="INPUT"&&s.type==="checkbox"){let a=new Lr(s,this);return a.checked=function(...u){return u.length===0?this.elt.checked:(u[0]?this.elt.checked=!0:this.elt.checked=!1,this)},a}else return s.tagName==="VIDEO"||s.tagName==="AUDIO"?new xh(s,this):s.tagName==="SELECT"?this.createSelect(new Lr(s,this)):o.length>0&&o.every(function(a){return a.tagName==="INPUT"||a.tagName==="LABEL"})&&(s.tagName==="DIV"||s.tagName==="SPAN")?this.createRadio(new Lr(s,this)):new Lr(s,this)},t.createElement=function(s,o){const a=document.createElement(s);return typeof o<"u"&&(a.innerHTML=o),r(a,this)},t.removeElements=function(s){const o=u=>!(u.elt instanceof HTMLCanvasElement);this._elements.filter(o).map(u=>u.remove())};function r(s,o,a){(o._userNode?o._userNode:document.body).appendChild(s);const l=a?new xh(s,o):new Lr(s,o);return o._elements.push(l),l}t.createDiv=function(s=""){let o=document.createElement("div");return o.innerHTML=s,r(o,this)},t.createP=function(s=""){let o=document.createElement("p");return o.innerHTML=s,r(o,this)},t.createSpan=function(s=""){let o=document.createElement("span");return o.innerHTML=s,r(o,this)},t.createImg=function(){const s=document.createElement("img"),o=arguments;let a;return o.length>1&&typeof o[1]=="string"&&(s.alt=o[1]),o.length>2&&typeof o[2]=="string"&&(s.crossOrigin=o[2]),s.src=o[0],a=r(s,this),s.addEventListener("load",function(){a.width=s.offsetWidth||s.width,a.height=s.offsetHeight||s.height;const u=o[o.length-1];typeof u=="function"&&u(a)}),a},t.createA=function(s,o,a){const u=document.createElement("a");return u.href=s,u.innerHTML=o,a&&(u.target=a),r(u,this)},t.createSlider=function(s,o,a,u){const l=document.createElement("input");return l.type="range",l.min=s,l.max=o,u===0?l.step=1e-18:u&&(l.step=u),typeof a=="number"&&(l.value=a),r(l,this)},t.createButton=function(s,o){const a=document.createElement("button");return a.innerHTML=s,o&&(a.value=o),r(a,this)},t.createCheckbox=function(...s){const o=document.createElement("div"),a=document.createElement("input");a.type="checkbox";const u=document.createElement("label");u.appendChild(a),o.appendChild(u);const l=r(o,this);if(l.checked=function(...c){const h=l.elt.firstElementChild.getElementsByTagName("input")[0];if(h){if(c.length===0)return h.checked;c[0]?h.checked=!0:h.checked=!1}return l},this.value=function(c){return l.value=c,this},s[0]){l.value(s[0]);const c=document.createElement("span");c.innerHTML=s[0],u.appendChild(c)}return s[1]&&(a.checked=!0),l},t.createSelect=function(...s){let o,a=s[0];if(a instanceof Lr&&a.elt instanceof HTMLSelectElement)o=a,this.elt=a.elt;else if(a instanceof HTMLSelectElement)o=r(a,this),this.elt=a;else{const u=document.createElement("select");a&&typeof a=="boolean"&&u.setAttribute("multiple","true"),o=r(u,this),this.elt=u}return o.option=function(u,l){let c;if(u!==void 0){for(let h=0;h<this.elt.length;h+=1)if(this.elt[h].textContent===u){c=h;break}if(c!==void 0)l===!1?this.elt.remove(c):this.elt[c].value=l;else{const h=document.createElement("option");h.textContent=u,h.value=l===void 0?u:l,this.elt.appendChild(h),this._pInst._elements.push(h)}}},o.selected=function(u){if(u!==void 0){for(let l=0;l<this.elt.length;l+=1)this.elt[l].value.toString()===u.toString()&&(this.elt.selectedIndex=l);return this}else if(this.elt.getAttribute("multiple")){let l=[];for(const c of this.elt.selectedOptions)l.push(c.value);return l}else return this.elt.value},o.disable=function(u){if(typeof u=="string")for(let l=0;l<this.elt.length;l++)this.elt[l].value.toString()===u&&(this.elt[l].disabled=!0,this.elt[l].selected=!1);else this.elt.disabled=!0;return this},o.enable=function(u){if(typeof u=="string")for(let l=0;l<this.elt.length;l++)this.elt[l].value.toString()===u&&(this.elt[l].disabled=!1,this.elt[l].selected=!1);else{this.elt.disabled=!1;for(let l=0;l<this.elt.length;l++)this.elt[l].disabled=!1,this.elt[l].selected=!1}return this},o};let i=0;t.createRadio=function(...s){let o,a,u;const l=s[0];l instanceof Lr&&(l.elt instanceof HTMLDivElement||l.elt instanceof HTMLSpanElement)?(o=l,this.elt=l.elt):l instanceof HTMLDivElement||l instanceof HTMLSpanElement?(o=r(l,this),this.elt=l,a=l,typeof s[1]=="string"&&(u=s[1])):(typeof l=="string"&&(u=l),a=document.createElement("div"),o=r(a,this),this.elt=a),o._name=u||`radioOption_${i++}`;const c=d=>d instanceof HTMLInputElement&&d.type==="radio",h=d=>d instanceof HTMLLabelElement,f=d=>d instanceof HTMLSpanElement;return o._getOptionsArray=function(){return Array.from(this.elt.children).filter(d=>c(d)||h(d)&&c(d.firstElementChild)).map(d=>c(d)?d:d.firstElementChild)},o.option=function(d,p){let g;for(const T of o._getOptionsArray())if(T.value===d){g=T;break}g===void 0&&(g=document.createElement("input"),g.setAttribute("type","radio"),g.setAttribute("value",d)),g.setAttribute("name",o._name);let y;h(g.parentElement)?y=g.parentElement:(y=document.createElement("label"),y.insertAdjacentElement("afterbegin",g));let v;return f(y.lastElementChild)?v=y.lastElementChild:(v=document.createElement("span"),g.insertAdjacentElement("afterend",v)),v.innerHTML=p===void 0?d:p,this.elt.appendChild(y),g},o.remove=function(d){for(const p of o._getOptionsArray())if(p.value===d){h(p.parentElement)?p.parentElement.remove():p.remove();return}},o.value=function(){let d="";for(const p of o._getOptionsArray())if(p.checked){d=p.value;break}return d},o.selected=function(d){let p=null;if(d===void 0){for(const g of o._getOptionsArray())if(g.checked){p=g;break}}else{o._getOptionsArray().forEach(g=>{g.checked=!1,g.removeAttribute("checked")});for(const g of o._getOptionsArray())g.value===d&&(g.setAttribute("checked",!0),g.checked=!0,p=g)}return p},o.disable=function(d=!0){for(const p of o._getOptionsArray())p.setAttribute("disabled",d)},o},t.createColorPicker=function(s){const o=document.createElement("input");let a;o.type="color",s?s instanceof n.Color?o.value=s.toString("#rrggbb"):(this.push(),this.colorMode("rgb"),o.value=this.color(s).toString("#rrggbb"),this.pop()):o.value="#000000",a=r(o,this);const u=this;return a.color=function(){u.push(),s&&s.mode&&u.colorMode(s.mode,...s!=null&&s.maxes?s.maxes[s.mode]||[]:[]);const l=u.color(this.elt.value);return u.pop(),l},a},t.createInput=function(s="",o="text"){let a=document.createElement("input");return a.setAttribute("value",s),a.setAttribute("type",o),r(a,this)},t.createFileInput=function(s,o=!1){const a=function(l){for(const c of l.target.files)io._load(c,s)};if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){console.log("The File APIs are not fully supported in this browser. Cannot create element.");return}const u=document.createElement("input");return u.setAttribute("type","file"),o&&u.setAttribute("multiple",!0),u.addEventListener("change",a,!1),r(u,this)}}typeof p5<"u"&&QN(p5,p5.prototype);function AH(n){n.registerAddon(QN),n.registerAddon(B5),n.registerAddon(ok),n.registerAddon(V5)}function JN(n,t){t.deviceOrientation=window.innerWidth/window.innerHeight>1?"landscape":"portrait",t.accelerationX=0,t.accelerationY=0,t.accelerationZ=0,t.pAccelerationX=0,t.pAccelerationY=0,t.pAccelerationZ=0,t._updatePAccelerations=function(){this.pAccelerationX=this.accelerationX,this.pAccelerationY=this.accelerationY,this.pAccelerationZ=this.accelerationZ},t.rotationX=0,t.rotationY=0,t.rotationZ=0,t.pRotationX=0,t.pRotationY=0,t.pRotationZ=0;let r=0,i=0,s=0,o="clockwise",a="clockwise",u="clockwise";t.pRotateDirectionX=void 0,t.pRotateDirectionY=void 0,t.pRotateDirectionZ=void 0,t._updatePRotations=function(){this.pRotationX=this.rotationX,this.pRotationY=this.rotationY,this.pRotationZ=this.rotationZ},t.turnAxis=void 0;let l=.5,c=30;t.setMoveThreshold=function(h){l=h},t.setShakeThreshold=function(h){c=h},t._ondeviceorientation=function(h){this._updatePRotations(),this.rotationX=this._fromDegrees(h.beta),this.rotationY=this._fromDegrees(h.gamma),this.rotationZ=this._fromDegrees(h.alpha),this._handleMotion()},t._ondevicemotion=function(h){this._updatePAccelerations(),this.accelerationX=h.acceleration.x*2,this.accelerationY=h.acceleration.y*2,this.accelerationZ=h.acceleration.z*2,this._handleMotion()},t._handleMotion=function(){window.orientation===90||window.orientation===-90?this.deviceOrientation="landscape":window.orientation===0?this.deviceOrientation="portrait":window.orientation===void 0&&(this.deviceOrientation="undefined");const h=this._isGlobal?window:this;if(typeof h.deviceMoved=="function"&&(Math.abs(this.accelerationX-this.pAccelerationX)>l||Math.abs(this.accelerationY-this.pAccelerationY)>l||Math.abs(this.accelerationZ-this.pAccelerationZ)>l)&&h.deviceMoved(),typeof h.deviceTurned=="function"){const f=this._toDegrees(this.rotationX)+180,d=this._toDegrees(this.pRotationX)+180;let p=r+180;f-d>0&&f-d<270||f-d<-270?o="clockwise":(f-d<0||f-d>270)&&(o="counter-clockwise"),o!==this.pRotateDirectionX&&(p=f),Math.abs(f-p)>90&&Math.abs(f-p)<270&&(p=f,this.turnAxis="X",h.deviceTurned()),this.pRotateDirectionX=o,r=p-180;const g=this._toDegrees(this.rotationY)+180,y=this._toDegrees(this.pRotationY)+180;let v=i+180;g-y>0&&g-y<270||g-y<-270?a="clockwise":(g-y<0||g-this.pRotationY>270)&&(a="counter-clockwise"),a!==this.pRotateDirectionY&&(v=g),Math.abs(g-v)>90&&Math.abs(g-v)<270&&(v=g,this.turnAxis="Y",h.deviceTurned()),this.pRotateDirectionY=a,i=v-180;const T=this._toDegrees(this.rotationZ),_=this._toDegrees(this.pRotationZ);T-_>0&&T-_<270||T-_<-270?u="clockwise":(T-_<0||T-_>270)&&(u="counter-clockwise"),u!==this.pRotateDirectionZ&&(s=T),Math.abs(T-s)>90&&Math.abs(T-s)<270&&(s=T,this.turnAxis="Z",h.deviceTurned()),this.pRotateDirectionZ=u,this.turnAxis=void 0}if(typeof h.deviceShaken=="function"){let f,d;this.pAccelerationX!==null&&(f=Math.abs(this.accelerationX-this.pAccelerationX),d=Math.abs(this.accelerationY-this.pAccelerationY)),f+d>c&&h.deviceShaken()}}}typeof p5<"u"&&JN(p5,p5.prototype);function TH(n){return["Alt","Shift","Control","Meta"].includes(n)||typeof n!="string"?!1:n.length>1}function eR(n,t){t.keyIsPressed=!1,t.code=null,t.key="",t.keyCode=0,t._onkeydown=function(r){if(this._downKeys[r.code])return;this.keyIsPressed=!0,this.keyCode=r.which,this.key=r.key,this.code=r.code,this._downKeyCodes[r.code]=!0,this._downKeys[r.key]=!0;const i=this._isGlobal?window:this;typeof i.keyPressed=="function"&&!r.charCode&&i.keyPressed(r)===!1&&r.preventDefault()},t._onkeyup=function(r){const i=this._isGlobal?window:this;if(typeof i.keyReleased=="function"&&i.keyReleased(r)===!1&&r.preventDefault(),delete this._downKeyCodes[r.code],delete this._downKeys[r.key],!this._areDownKeys())this.keyIsPressed=!1,this.key="",this.code=null;else{const s=Object.keys(this._downKeyCodes).pop();this.code=s;const o=Object.keys(this._downKeys).pop();this.key=o}},t._onkeypress=function(r){if(r.which===this._lastKeyCodeTyped&&r.repeat)return;this._lastKeyCodeTyped=r.which,this.key=r.key||String.fromCharCode(r.which)||r.which;const i=this._isGlobal?window:this;typeof i.keyTyped=="function"&&i.keyTyped(r)===!1&&r.preventDefault()},t._onblur=function(r){this._downKeys={}},t.keyIsDown=function(r){return TH(r)?this._downKeyCodes[r]||this._downKeys[r]||!1:this._downKeys[r]||this._downKeyCodes[r]||!1},t._areDownKeys=function(){for(const r in this._downKeys)if(this._downKeys.hasOwnProperty(r)&&this._downKeys[r]===!0)return!0;return!1}}typeof p5<"u"&&eR(p5,p5.prototype);function tR(n,t){t.movedX=0,t.movedY=0,t._hasMouseInteracted=!1,t.mouseX=0,t.mouseY=0,t.pmouseX=0,t.pmouseY=0,t.winMouseX=0,t.winMouseY=0,t.pwinMouseX=0,t.pwinMouseY=0,t.mouseButton={left:!1,right:!1,center:!1},t.touches=[],t._activePointers=new Map,t.mouseIsPressed=!1,t._updatePointerCoords=function(s){if(this._curElement!==null){const o=this._curElement.elt,a=o.scrollWidth/this.width||1,u=o.scrollHeight/this.height||1;if(s.pointerType=="touch"){const c=[];for(const h of this._activePointers.values())c.push(i(o,a,u,h));this.touches=c}const l=r(o,a,u,s);this.movedX=s.movementX||0,this.movedY=s.movementY||0,this.mouseX=l.x,this.mouseY=l.y,this.winMouseX=l.winX,this.winMouseY=l.winY,this._hasMouseInteracted||(this._updateMouseCoords(),this._hasMouseInteracted=!0)}},t._updateMouseCoords=function(){this.pmouseX=this.mouseX,this.pmouseY=this.mouseY,this.pwinMouseX=this.winMouseX,this.pwinMouseY=this.winMouseY,this._pmouseWheelDeltaY=this._mouseWheelDeltaY};function r(s,o,a,u){const l=s.getBoundingClientRect();return{x:(u.clientX-l.left)/o,y:(u.clientY-l.top)/a,winX:u.clientX,winY:u.clientY}}function i(s,o,a,u){const l=s.getBoundingClientRect();return{x:(u.clientX-l.left)/o,y:(u.clientY-l.top)/a,winX:u.clientX,winY:u.clientY,id:u.pointerId}}t._setMouseButton=function(s){this.mouseButton.left=Array.from(this._activePointers.values()).some(o=>(o.buttons&1)!==0),this.mouseButton.center=Array.from(this._activePointers.values()).some(o=>(o.buttons&4)!==0),this.mouseButton.right=Array.from(this._activePointers.values()).some(o=>(o.buttons&2)!==0)},t._onpointermove=function(s){const o=this._isGlobal?window:this;let a;this._updatePointerCoords(s),this._activePointers.set(s.pointerId,s),this._setMouseButton(s),!this.mouseIsPressed&&typeof o.mouseMoved=="function"?(a=o.mouseMoved(s),a===!1&&s.preventDefault()):this.mouseIsPressed&&typeof o.mouseDragged=="function"&&(a=o.mouseDragged(s),a===!1&&s.preventDefault())},t._onpointerdown=function(s){const o=this._isGlobal?window:this;let a;this.mouseIsPressed=!0,this._activePointers.set(s.pointerId,s),this._setMouseButton(s),this._updatePointerCoords(s),typeof o.mousePressed=="function"&&(a=o.mousePressed(s),a===!1&&s.preventDefault())},t._onpointerup=function(s){const o=this._isGlobal?window:this;let a;this.mouseIsPressed=!1,this._activePointers.delete(s.pointerId),this._setMouseButton(s),this._updatePointerCoords(s),typeof o.mouseReleased=="function"&&(a=o.mouseReleased(s),a===!1&&s.preventDefault())},t._ondragend=t._onpointerup,t._ondragover=t._onpointermove,t._onclick=function(s){const o=this._isGlobal?window:this;typeof o.mouseClicked=="function"&&o.mouseClicked(s)===!1&&s.preventDefault()},t._ondblclick=function(s){const o=this._isGlobal?window:this;typeof o.doubleClicked=="function"&&o.doubleClicked(s)===!1&&s.preventDefault()},t._mouseWheelDeltaY=0,t._pmouseWheelDeltaY=0,t._onwheel=function(s){const o=this._isGlobal?window:this;this._mouseWheelDeltaY=s.deltaY,typeof o.mouseWheel=="function"&&(s.delta=s.deltaY,o.mouseWheel(s)===!1&&s.preventDefault())},t.requestPointerLock=function(){const s=this._curElement.elt;return s.requestPointerLock=s.requestPointerLock||s.mozRequestPointerLock,s.requestPointerLock?(s.requestPointerLock(),!0):(console.log("requestPointerLock is not implemented in this browser"),!1)},t.exitPointerLock=function(){document.exitPointerLock()}}typeof p5<"u"&&tR(p5,p5.prototype);function IH(n){n.registerAddon(JN),n.registerAddon(eR),n.registerAddon(tR)}function DH(n){n.registerAddon(v_),n.registerAddon(__),n.registerAddon(sk),n.registerAddon(m_),n.registerAddon(b_),n.registerAddon(C_)}class kH{constructor(t){this.columns=[],this.rows=[]}toString(t=","){let r=this.rows.map(i=>i.arr);return this.columns.some(i=>i===null)||(r=[this.columns,...r]),TG(r,{separator:t})}addRow(t){const r=t||new p5.TableRow;if(typeof r.arr>"u"||typeof r.obj>"u")throw new Error(`invalid TableRow: ${r}`);return r.table=this,this.rows.push(r),r}removeRow(t){this.rows[t].table=null;const r=this.rows.splice(t+1,this.rows.length);this.rows.pop(),this.rows=this.rows.concat(r)}getRow(t){return this.rows[t]}getRows(){return this.rows}findRow(t,r){if(typeof r=="string"){for(let i=0;i<this.rows.length;i++)if(this.rows[i].obj[this.columns.indexOf(r)]===t)return this.rows[i]}else for(let i=0;i<this.rows.length;i++)if(this.rows[i].arr[r]===t)return this.rows[i];return null}findRows(t,r){const i=[];if(typeof r=="string")for(let s=0;s<this.rows.length;s++)this.rows[s].obj[this.columns.indexOf(r)]===t&&i.push(this.rows[s]);else for(let s=0;s<this.rows.length;s++)this.rows[s].arr[r]===t&&i.push(this.rows[s]);return i}matchRow(t,r){if(typeof r=="number"){for(let i=0;i<this.rows.length;i++)if(this.rows[i].arr[r].match(t))return this.rows[i]}else for(let i=0;i<this.rows.length;i++)if(this.rows[i].obj[this.columns.indexOf(r)].match(t))return this.rows[i];return null}matchRows(t,r){const i=[];if(typeof r=="number")for(let s=0;s<this.rows.length;s++)this.rows[s].arr[r].match(t)&&i.push(this.rows[s]);else for(let s=0;s<this.rows.length;s++)this.rows[s].obj[this.columns.indexOf(r)].match(t)&&i.push(this.rows[s]);return i}getColumn(t){const r=[];if(typeof t=="string")for(let i=0;i<this.rows.length;i++)r.push(this.rows[i].obj[this.columns.indexOf(t)]);else for(let i=0;i<this.rows.length;i++)r.push(this.rows[i].arr[t]);return r}clearRows(){delete this.rows,this.rows=[]}addColumn(t){const r=t||null;this.columns.push(r)}getColumnCount(){return this.columns.length}getRowCount(){return this.rows.length}removeTokens(t,r){const i=a=>a.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),s=[];for(let a=0;a<t.length;a++)s.push(i(t.charAt(a)));const o=new RegExp(s.join("|"),"g");if(typeof r>"u")for(let a=0;a<this.columns.length;a++)for(let u=0;u<this.rows.length;u++){let l=this.rows[u].arr[a];l=l.replace(o,""),this.rows[u].arr[a]=l,this.rows[u].obj[this.columns[a]]=l}else if(typeof r=="string")for(let a=0;a<this.rows.length;a++){let u=this.rows[a].obj[r];u=u.replace(o,""),this.rows[a].obj[r]=u;const l=this.columns.indexOf(r);this.rows[a].arr[l]=u}else for(let a=0;a<this.rows.length;a++){let u=this.rows[a].arr[r];u=u.replace(o,""),this.rows[a].arr[r]=u,this.rows[a].obj[this.columns[r]]=u}}trim(t){const r=new RegExp(" ","g");if(typeof t>"u")for(let i=0;i<this.columns.length;i++)for(let s=0;s<this.rows.length;s++){let o=this.rows[s].arr[i];o=o.replace(r,""),this.rows[s].arr[i]=o,this.rows[s].obj[this.columns[i]]=o}else if(typeof t=="string")for(let i=0;i<this.rows.length;i++){let s=this.rows[i].obj[t];s=s.replace(r,""),this.rows[i].obj[t]=s;const o=this.columns.indexOf(t);this.rows[i].arr[o]=s}else for(let i=0;i<this.rows.length;i++){let s=this.rows[i].arr[t];s=s.replace(r,""),this.rows[i].arr[t]=s,this.rows[i].obj[this.columns[t]]=s}}removeColumn(t){let r,i;typeof t=="string"?(r=t,i=this.columns.indexOf(t)):(i=t,r=this.columns[t]);const s=this.columns.splice(i+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(s);for(let o=0;o<this.rows.length;o++){const a=this.rows[o].arr,u=a.splice(i+1,a.length);a.pop(),this.rows[o].arr=a.concat(u),delete this.rows[o].obj[r]}}set(t,r,i){this.rows[t].set(r,i)}setNum(t,r,i){this.rows[t].setNum(r,i)}setString(t,r,i){this.rows[t].setString(r,i)}get(t,r){return typeof r=="string"?this.rows[t].get(this.columns.indexOf(r)):this.rows[t].get(r)}getNum(t,r){return this.rows[t].getNum(r)}getString(t,r){return this.rows[t].getString(r)}getObject(t){const r={};let i,s,o;for(let a=0;a<this.rows.length;a++)if(i=this.rows[a].obj,typeof t=="string")if(s=this.columns.indexOf(t),s>=0)o=i[t],r[o]=i;else throw new Error(`This table has no column named "${t}"`);else r[a]=this.rows[a].obj;return r}getArray(){const t=[];for(let r=0;r<this.rows.length;r++)t.push(this.rows[r].arr);return t}}function rR(n,t){n.Table=kH}typeof p5<"u"&&rR(p5,p5.prototype);class NH{constructor(t=[]){let r=t;this.arr=r,this.obj=Object.fromEntries(r.entries()),this.table=null}set(t,r){if(typeof t=="string"){const i=this.table.columns.indexOf(t);if(i>=0)this.obj[t]=r,this.arr[i]=r;else throw new Error(`This table has no column named "${t}"`)}else if(t<this.table.columns.length){this.arr[t]=r;const i=this.table.columns[t];this.obj[i]=r}else throw new Error(`Column #${t} is out of the range of this table`)}setNum(t,r){const i=parseFloat(r);this.set(t,i)}setString(t,r){const i=r.toString();this.set(t,i)}get(t){return typeof t=="string"?this.obj[this.table.columns.indexOf(t)]:this.arr[t]}getNum(t){let r;if(typeof t=="string"?r=parseFloat(this.obj[this.table.columns.indexOf(t)]):r=parseFloat(this.arr[t]),r.toString()==="NaN")throw`Error: ${this.obj[t]} is NaN (Not a Number)`;return r}getString(t){return typeof t=="string"?this.obj[this.table.columns.indexOf(t)].toString():this.arr[t].toString()}}function nR(n,t){n.TableRow=NH}typeof p5<"u"&&nR(p5,p5.prototype);function RH(n){n.registerAddon(Sk),n.registerAddon(rR),n.registerAddon(nR),n.registerAddon(O5)}function iR(n,t){t.abs=Math.abs,t.ceil=Math.ceil,t.constrain=function(r,i,s){return Math.max(Math.min(r,s),i)},t.dist=function(...r){if(r.length===4)return Math.hypot(r[2]-r[0],r[3]-r[1]);if(r.length===6)return Math.hypot(r[3]-r[0],r[4]-r[1],r[5]-r[2])},t.exp=Math.exp,t.floor=Math.floor,t.lerp=function(r,i,s){return s*(i-r)+r},t.log=Math.log,t.mag=function(r,i){return Math.hypot(r,i)},t.map=function(r,i,s,o,a,u){const l=(r-i)/(s-i)*(a-o)+o;return u?o<a?this.constrain(l,o,a):this.constrain(l,a,o):l},t.max=function(...r){const i=s=>{let o=-1/0;for(let a of s)o=Math.max(o,a);return o};return r[0]instanceof Array?i(r[0]):i(r)},t.min=function(...r){const i=s=>{let o=1/0;for(let a of s)o=Math.min(o,a);return o};return r[0]instanceof Array?i(r[0]):i(r)},t.norm=function(r,i,s){return this.map(r,i,s,0,1)},t.pow=Math.pow,t.round=function(r,i){if(!i)return Math.round(r);const s=Math.pow(10,i);return Math.round(r*s)/s},t.sq=r=>r*r,t.sqrt=Math.sqrt,t.fract=function(r){let i=0,s=Number(r);if(isNaN(s)||Math.abs(s)===1/0)return s;if(s<0&&(s=-s,i=1),String(s).includes(".")&&!String(s).includes("e")){let o=String(s);return o=+("0"+o.slice(o.indexOf("."))),Math.abs(i-o)}else return s<1?Math.abs(i-s):0}}typeof p5<"u"&&iR(p5,p5.prototype);function sR(n,t){let u=4,l=.5;const c=f=>.5*(1-Math.cos(f*Math.PI));let h;t.noise=function(f,d=0,p=0){if(h==null){h=new Array(4096);for(let k=0;k<4096;k++)h[k]=Math.random()}f<0&&(f=-f),d<0&&(d=-d),p<0&&(p=-p);let g=Math.floor(f),y=Math.floor(d),v=Math.floor(p),T=f-g,_=d-y,C=p-v,E,S,R=0,w=.5,x,b,A;for(let k=0;k<u;k++){let N=g+(y<<4)+(v<<8);E=c(T),S=c(_),x=h[N&4095],x+=E*(h[N+1&4095]-x),b=h[N+16&4095],b+=E*(h[N+16+1&4095]-b),x+=S*(b-x),N+=256,b=h[N&4095],b+=E*(h[N+1&4095]-b),A=h[N+16&4095],A+=E*(h[N+16+1&4095]-A),b+=S*(A-b),x+=c(C)*(b-x),R+=x*w,w*=l,g<<=1,T*=2,y<<=1,_*=2,v<<=1,C*=2,T>=1&&(g++,T--),_>=1&&(y++,_--),C>=1&&(v++,C--)}return R},t.noiseDetail=function(f,d){f>0&&(u=f),d>0&&(l=d)},t.noiseSeed=function(f){const d=(()=>{let v,T;return{setSeed(_){T=v=(_??Math.random()*4294967296)>>>0},getSeed(){return v},rand(){return T=(1664525*T+1013904223)%4294967296,T/4294967296}}})();d.setSeed(f),h=new Array(4096);for(let p=0;p<4096;p++)h[p]=d.rand()}}typeof p5<"u"&&sR(p5,p5.prototype);function oR(n,t){const r="_lcg_random_state";let a=0;t._lcg=function(u){return this[u]=(1664525*this[u]+1013904223)%4294967296,this[u]/4294967296},t._lcgSetSeed=function(u,l){this[u]=(l??Math.random()*4294967296)>>>0},t.randomSeed=function(u){this._lcgSetSeed(r,u),this._gaussian_previous=!1},t.random=function(u,l){let c;if(this[r]!=null?c=this._lcg(r):c=Math.random(),typeof u>"u")return c;if(typeof l>"u")return u instanceof Array?u[Math.floor(c*u.length)]:c*u;if(u>l){const h=u;u=l,l=h}return c*(l-u)+u},t.randomGaussian=function(u,l=1){let c,h,f,d;if(this._gaussian_previous)c=a,this._gaussian_previous=!1;else{do h=this.random(2)-1,f=this.random(2)-1,d=h*h+f*f;while(d>=1);d=Math.sqrt(-2*Math.log(d)/d),c=h*d,a=f*d,this._gaussian_previous=!0}const p=u||0;return c*l+p}}typeof p5<"u"&&oR(p5,p5.prototype);function aR(n,t){t.createVector=function(r,i,s){return this instanceof n?new n.Vector(this._fromRadians.bind(this),this._toRadians.bind(this),...arguments):new n.Vector(r,i,s)},t.createMatrix=function(...r){return new n.Matrix(...r)}}typeof p5<"u"&&aR(p5,p5.prototype);function FH(n){n.registerAddon(iR),n.registerAddon(sR),n.registerAddon(oR),n.registerAddon(y_),n.registerAddon(aR),n.registerAddon(m5)}function uR(n,t){t.float=function(r){return r instanceof Array?r.map(parseFloat):parseFloat(r)},t.int=function(r,i=10){if(r===1/0||r==="Infinity")return 1/0;if(r===-1/0||r==="-Infinity")return-1/0;if(typeof r=="string")return parseInt(r,i);if(typeof r=="number")return r|0;if(typeof r=="boolean")return r?1:0;if(r instanceof Array)return r.map(s=>t.int(s,i))},t.str=function(r){return r instanceof Array?r.map(t.str):String(r)},t.boolean=function(r){if(typeof r=="number")return r!==0;if(typeof r=="string")return r.toLowerCase()==="true";if(typeof r=="boolean")return r;if(r instanceof Array)return r.map(t.boolean)},t.byte=function(r){const i=t.int(r,10);if(typeof i=="number")return(i+128)%256-128;if(i instanceof Array)return i.map(t.byte)},t.char=function(r){if(typeof r=="number"&&!isNaN(r))return String.fromCharCode(r);if(r instanceof Array)return r.map(t.char);if(typeof r=="string")return t.char(parseInt(r,10))},t.unchar=function(r){if(typeof r=="string"&&r.length===1)return r.charCodeAt(0);if(r instanceof Array)return r.map(t.unchar)},t.hex=function(r,i){if(i=i??(i=8),r instanceof Array)return r.map(s=>t.hex(s,i));if(r===1/0||r===-1/0)return(r===1/0?"F":"0").repeat(i);if(typeof r=="number"){r<0&&(r=4294967295+r+1);let s=Number(r).toString(16).toUpperCase();for(;s.length<i;)s=`0${s}`;return s.length>=i&&(s=s.substring(s.length-i,s.length)),s}},t.unhex=function(r){return r instanceof Array?r.map(t.unhex):parseInt(`0x${r}`,16)}}typeof p5<"u"&&uR(p5,p5.prototype);function lR(n,t){t.nf=function(a,u,l){return a instanceof Array?a.map(c=>r(c,u,l)):Object.prototype.toString.call(a)==="[object Arguments]"?a.length===3?this.nf(a[0],a[1],a[2]):a.length===2?this.nf(a[0],a[1]):this.nf(a[0]):r(a,u,l)};function r(a,u,l){let c=a<0;a=Math.abs(a);let[h,f]=a.toString().split(".");if(typeof l>"u"){h=h.padStart(u,"0");let d=f?h+"."+f:h;return c?"-"+d:d}else{[h,f]=a.toFixed(l).toString().split("."),h=h.padStart(u,"0");let p=typeof f>"u"?h:h+"."+f;return c?"-"+p:p}}t.nfc=function(a,u){return a instanceof Array?a.map(l=>i(l,u)):i(a,u)};function i(a,u){a=a.toString();const l=a.indexOf(".");let c=l!==-1?a.substring(l):"",h=l!==-1?a.substring(0,l):a;if(h=h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),u===0)c="";else if(typeof u<"u")if(u>c.length){c+=l===-1?".":"";const f=u-c.length+1;for(let d=0;d<f;d++)c+="0"}else c=c.substring(0,u+1);return h+c}t.nfp=function(...a){const u=t.nf.apply(this,a);return u instanceof Array?u.map(s):s(u)};function s(a){return parseFloat(a)>0?`+${a.toString()}`:a.toString()}t.nfs=function(...a){const u=t.nf.apply(this,a);return u instanceof Array?u.map(o):o(u)};function o(a){return parseFloat(a)>=0?` ${a.toString()}`:a.toString()}t.splitTokens=function(a,u){let l;if(typeof u<"u"){let c=u;const h=/\]/g.exec(c);let f=/\[/g.exec(c);f&&h?(c=c.slice(0,h.index)+c.slice(h.index+1),f=/\[/g.exec(c),c=c.slice(0,f.index)+c.slice(f.index+1),l=new RegExp(`[\\[${c}\\]]`,"g")):h?(c=c.slice(0,h.index)+c.slice(h.index+1),l=new RegExp(`[${c}\\]]`,"g")):f?(c=c.slice(0,f.index)+c.slice(f.index+1),l=new RegExp(`[${c}\\[]`,"g")):l=new RegExp(`[${c}]`,"g")}else l=/\s/g;return a.split(l).filter(c=>c)},t.shuffle=function(a,u){const l=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(a);a=u||l?a:a.slice();let c,h,f=a.length;for(;f>1;)c=this.random(0,1)*f|0,h=a[--f],a[f]=a[c],a[c]=h;return a}}typeof p5<"u"&&lR(p5,p5.prototype);function cR(n,t){t.day=function(){return new Date().getDate()},t.hour=function(){return new Date().getHours()},t.minute=function(){return new Date().getMinutes()},t.millis=function(){return this._millisStart===-1?0:window.performance.now()-this._millisStart},t.month=function(){return new Date().getMonth()+1},t.second=function(){return new Date().getSeconds()},t.year=function(){return new Date().getFullYear()}}typeof p5<"u"&&cR(p5,p5.prototype);function PH(n){n.registerAddon(uR),n.registerAddon(lR),n.registerAddon(cR)}function hR(n,t){t.orbitControl=function(r,i,s,o){this._assert3d("orbitControl");const a=this._renderer.states.curCamera;typeof r>"u"&&(r=1),typeof i>"u"&&(i=r),typeof s>"u"&&(s=1),typeof o!="object"&&(o={}),this.contextMenuDisabled!==!0&&(this.canvas.oncontextmenu=()=>!1,this.contextMenuDisabled=!0),this.wheelDefaultDisabled!==!0&&(this.canvas.onwheel=()=>!1,this.wheelDefaultDisabled=!0);const{disableTouchActions:u=!0}=o;this.touchActionsDisabled!==!0&&u&&(this.canvas.style["touch-action"]="none",this.touchActionsDisabled=!0);const{freeRotation:l=!1}=o,c=[];this.touches.forEach(R=>{this._renderer.prevTouches.forEach(w=>{if(R.id===w.id){const x={x:R.x,y:R.y,px:w.x,py:w.y};c.push(x)}})}),this._renderer.prevTouches=this.touches;let h=0,f=0,d=0,p=0,g=0;const y=.85,v=.6,T=.15,_=.01,C=4e-4,E=this.height<this.width?this.height:this.width;let S=!1;if(c.length>0){if(S=c[0].x>0&&c[0].x<this.width&&c[0].y>0&&c[0].y<this.height,c.length===1){const R=c[0];f=-r*(R.x-R.px)/E,d=i*(R.y-R.py)/E}else{const R=c[0],w=c[1],x=Math.hypot(R.x-w.x,R.y-w.y),b=Math.hypot(R.px-w.px,R.py-w.py);h=-(x-b)*s*C,p=.5*(R.x+w.x)-.5*(R.px+w.px),g=.5*(R.y+w.y)-.5*(R.py+w.py)}this.touches.length>0?S&&(this._renderer.executeRotateAndMove=!0,this._renderer.executeZoom=!0):(this._renderer.executeRotateAndMove=!1,this._renderer.executeZoom=!1)}else S=this.mouseX>0&&this.mouseX<this.width&&this.mouseY>0&&this.mouseY<this.height,this._mouseWheelDeltaY!==0?(h=Math.sign(this._mouseWheelDeltaY)*s,h*=_,this._mouseWheelDeltaY=0,S&&(this._renderer.executeZoom=!0)):this._renderer.executeZoom=!1,this.mouseIsPressed?(this.mouseButton.left?(f=-r*this.movedX/E,d=i*this.movedY/E):this.mouseButton.right&&(p=this.movedX,g=this.movedY*a.yScale),S&&(this._renderer.executeRotateAndMove=!0)):this._renderer.executeRotateAndMove=!1;if(h!==0&&this._renderer.executeZoom&&(this._renderer.zoomVelocity+=h),Math.abs(this._renderer.zoomVelocity)>.001?(l?a._orbitFree(0,0,this._renderer.zoomVelocity):a._orbit(0,0,this._renderer.zoomVelocity),a.projMatrix.mat4[15]!==0&&(a.projMatrix.mat4[0]*=Math.pow(10,-this._renderer.zoomVelocity),a.projMatrix.mat4[5]*=Math.pow(10,-this._renderer.zoomVelocity),this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.mat4[0]=a.projMatrix.mat4[0],this._renderer.states.uPMatrix.mat4[5]=a.projMatrix.mat4[5]),this._renderer.zoomVelocity*=y):this._renderer.zoomVelocity=0,(f!==0||d!==0)&&this._renderer.executeRotateAndMove&&this._renderer.rotateVelocity.add(f*v,d*v),this._renderer.rotateVelocity.magSq()>1e-6?(l?a._orbitFree(-this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0):a._orbit(this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0),this._renderer.rotateVelocity.mult(y)):this._renderer.rotateVelocity.set(0,0),(p!==0||g!==0)&&this._renderer.executeRotateAndMove){const R=p*2/this.width,w=-g*2/this.height;this._renderer.moveVelocity.add(R*T,w*T)}if(this._renderer.moveVelocity.magSq()>1e-6){const R=a._getLocalAxes(),w=a.eyeX-a.centerX,x=a.eyeY-a.centerY,b=a.eyeZ-a.centerZ,A=Math.sqrt(w*w+x*x+b*b);let k=new de(a.centerX,a.centerY,a.centerZ);k=a.cameraMatrix.multiplyPoint(k),k=this._renderer.states.uPMatrix.multiplyAndNormalizePoint(k),k.x-=this._renderer.moveVelocity.x,k.y-=this._renderer.moveVelocity.y;let N,I;const j=this._renderer.states.uPMatrix.mat4;j[15]===0?(N=(j[8]+k.x)/j[0]*A,I=(j[9]+k.y)/j[5]*A):(N=(k.x-j[12])/j[0],I=(k.y-j[13])/j[5]),a.setPosition(a.eyeX+N*R.x[0]+I*R.y[0],a.eyeY+N*R.x[1]+I*R.y[1],a.eyeZ+N*R.x[2]+I*R.y[2]),this._renderer.moveVelocity.mult(y)}else this._renderer.moveVelocity.set(0,0);return this},t.debugMode=function(...r){this._assert3d("debugMode");for(let i=n.lifecycleHooks.postdraw.length-1;i>=0;i--)(n.lifecycleHooks.postdraw[i].toString()===this._grid().toString()||n.lifecycleHooks.postdraw[i].toString()===this._axesIcon().toString())&&n.lifecycleHooks.postdraw.splice(i,1);r[0]===c5?n.lifecycleHooks.postdraw.push(this._grid(r[1],r[2],r[3],r[4],r[5])):r[0]===h5?n.lifecycleHooks.postdraw.push(this._axesIcon(r[1],r[2],r[3],r[4])):(n.lifecycleHooks.postdraw.push(this._grid(r[0],r[1],r[2],r[3],r[4])),n.lifecycleHooks.postdraw.push(this._axesIcon(r[5],r[6],r[7],r[8])))},t.noDebugMode=function(){this._assert3d("noDebugMode");for(let r=n.lifecycleHooks.postdraw.length-1;r>=0;r--)(n.lifecycleHooks.postdraw[r].toString()===this._grid().toString()||n.lifecycleHooks.postdraw[r].toString()===this._axesIcon().toString())&&n.lifecycleHooks.postdraw.splice(r,1)},t._grid=function(r,i,s,o,a){typeof r>"u"&&(r=this.width/2),typeof i>"u"&&(i=Math.round(r/30)<4?4:Math.round(r/30)),typeof s>"u"&&(s=0),typeof o>"u"&&(o=0),typeof a>"u"&&(a=0);const u=r/i,l=r/2;return function(){this.push(),this.stroke(this._renderer.states.curStrokeColor[0]*255,this._renderer.states.curStrokeColor[1]*255,this._renderer.states.curStrokeColor[2]*255),this._renderer.states.setValue("uModelMatrix",this._renderer.states.uModelMatrix.clone()),this._renderer.states.uModelMatrix.reset();for(let c=0;c<=i;c++)this.beginShape(this.LINES),this.vertex(-l+s,o,c*u-l+a),this.vertex(+l+s,o,c*u-l+a),this.endShape();for(let c=0;c<=i;c++)this.beginShape(this.LINES),this.vertex(c*u-l+s,o,-l+a),this.vertex(c*u-l+s,o,+l+a),this.endShape();this.pop()}},t._axesIcon=function(r,i,s,o){return typeof r>"u"&&(r=this.width/20>40?this.width/20:40),typeof i>"u"&&(i=-this.width/4),typeof s>"u"&&(s=i),typeof o>"u"&&(o=i),()=>{this.push(),this._renderer.states.setValue("uModelMatrix",this._renderer.states.uModelMatrix.clone()),this._renderer.states.uModelMatrix.reset(),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(i,s,o),this.vertex(i+r,s,o),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(i,s,o),this.vertex(i,s+r,o),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(i,s,o),this.vertex(i,s,o+r),this.endShape(),this.pop()}}}typeof p5<"u"&&hR(p5,p5.prototype);async function MH(n){try{return(await fetch(n,{method:"HEAD"})).ok}catch{return!1}}function fR(n,t){t.loadModel=async function(h,f,d,p,g){let y=!1,v=!1;typeof f=="object"?(d=f.normalize||!1,p=f.successCallback,g=f.failureCallback,f=f.fileType||f,y=f.flipU||!1,v=f.flipV||!1):(typeof arguments[arguments.length-1]=="function"&&(typeof arguments[arguments.length-2]=="function"?(p=arguments[arguments.length-2],g=arguments[arguments.length-1]):p=arguments[arguments.length-1]),typeof f=="string"?typeof d!="boolean"&&(d=!1):typeof f=="boolean"?(d=f,f=h.slice(-4)):(f=h.slice(-4),d=!1)),f.toLowerCase()!==".obj"&&f.toLowerCase()!==".stl"&&(f=".obj");const T=new Hr(void 0,void 0,void 0,this._renderer);T.gid=`${h}|${d}`;async function _(C){const E=[];for(let S of C){const R=S.match(/^mtllib (.+)/);if(R){let w="";const x=R[1],b=h.split("/");b.length>1?(b.pop(),w=b.join("/")+"/"+x):w=x,E.push(MH(w).then(A=>A?r(w):(console.warn(`MTL file not found or error in parsing; proceeding without materials: ${w}`),{})).catch(A=>(console.warn(`Error loading MTL file: ${w}`,A),{})))}}try{const S=await Promise.all(E);return Object.assign({},...S)}catch{return{}}}try{if(f.match(/\.stl$/i)){const{data:C}=await Bn(h,"arrayBuffer");return s(T,C),d&&T.normalize(),y&&T.flipU(),v&&T.flipV(),T._makeTriangleEdges(),p?p(T):T}else if(f.match(/\.obj$/i)){const{data:C}=await Bn(h,"text"),E=C.split(`
`),S=await _(E);return i(T,E,S),d&&T.normalize(),y&&T.flipU(),v&&T.flipV(),T._makeTriangleEdges(),p?p(T):T}}catch(C){if(n._friendlyFileLoadError(3,h),g)return g(C);throw C}};async function r(h){let f=null,d={};const{data:p}=await Bn(h,"text"),g=p.split(`
`);for(let y=0;y<g.length;++y){const v=g[y].trim().split(/\s+/);v[0]==="newmtl"?(f=v[1],d[f]={}):v[0]==="Kd"?d[f].diffuseColor=[parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])]:v[0]==="Ka"?d[f].ambientColor=[parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])]:v[0]==="Ks"?d[f].specularColor=[parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])]:v[0]==="map_Kd"&&(d[f].texturePath=v[1])}return d}function i(h,f,d={}){const p={v:[],vt:[],vn:[]},g={};let y=null,v=!1,T=!1;for(let _=0;_<f.length;++_){const C=f[_].trim().split(/\b\s+/);if(C.length>0){if(C[0]==="usemtl")y=C[1];else if(C[0]==="v"||C[0]==="vn"){const E=new de(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3]));p[C[0]].push(E)}else if(C[0]==="vt"){const E=[parseFloat(C[1]),1-parseFloat(C[2])];p[C[0]].push(E)}else if(C[0]==="f")for(let E=3;E<C.length;++E){const S=[],R=[1,E-1,E];for(let w=0;w<R.length;++w){const x=C[R[w]];let b=x.split("/");for(let A=0;A<b.length;A++)b[A]=parseInt(b[A])-1;if(g[x]||(g[x]={}),g[x][y]===void 0){const A=h.vertices.length;if(h.vertices.push(p.v[b[0]].copy()),h.uvs.push(p.vt[b[1]]?p.vt[b[1]].slice():[0,0]),h.vertexNormals.push(p.vn[b[2]]?p.vn[b[2]].copy():new de),g[x][y]=A,S.push(A),y&&d[y]&&d[y].diffuseColor){v=!0;const k=d[y].diffuseColor;h.vertexColors.push(k[0]),h.vertexColors.push(k[1]),h.vertexColors.push(k[2]),h.vertexColors.push(1)}else T=!0}else S.push(g[x][y])}S[0]!==S[1]&&S[0]!==S[2]&&S[1]!==S[2]&&h.faces.push(S)}}}if(h.vertexNormals.length===0&&h.computeNormals(),v===T)throw new Error("Model coloring is inconsistent. Either all vertices should have colors or none should.");return h}function s(h,f){if(o(f))u(h,f);else{const d=new DataView(f);if(!("TextDecoder"in window))return console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)"),h;const y=new TextDecoder("utf-8").decode(d).split(`
`);l(h,y)}return h}function o(h){const f=new DataView(h),d=[115,111,108,105,100];for(let p=0;p<5;p++)if(a(d,f,p))return!1;return!0}function a(h,f,d){for(let p=0,g=h.length;p<g;p++)if(h[p]!==f.getUint8(d+p,!1))return!1;return!0}function u(h,f){const d=new DataView(f),p=d.getUint32(80,!0);let g,y,v,T=!1,_,C,E,S;for(let x=0;x<70;x++)d.getUint32(x,!1)===1129270351&&d.getUint8(x+4)===82&&d.getUint8(x+5)===61&&(T=!0,_=[],C=d.getUint8(x+6)/255,E=d.getUint8(x+7)/255,S=d.getUint8(x+8)/255);const R=84,w=50;for(let x=0;x<p;x++){const b=R+x*w,A=d.getFloat32(b,!0),k=d.getFloat32(b+4,!0),N=d.getFloat32(b+8,!0);if(T){const j=d.getUint16(b+48,!0);(j&32768)===0?(g=(j&31)/31,y=(j>>5&31)/31,v=(j>>10&31)/31):(g=C,y=E,v=S)}const I=new de(A,k,N);for(let j=1;j<=3;j++){const Q=b+j*12,le=new de(d.getFloat32(Q,!0),d.getFloat32(Q+4,!0),d.getFloat32(Q+8,!0));h.vertices.push(le),h.vertexNormals.push(I),T&&_.push(g,y,v)}h.faces.push([3*x,3*x+1,3*x+2]),h.uvs.push([0,0],[0,0],[0,0])}return h}function l(h,f){let d="",p=[],g,y;for(let v=0;v<f.length;++v){const T=f[v].trim(),_=T.split(" ");for(let C=0;C<_.length;++C)_[C]===""&&_.splice(C,1);if(_.length!==0)switch(d){case"":if(_[0]!=="solid"){console.error(T),console.error(`Invalid state "${_[0]}", should be "solid"`);return}else d="solid";break;case"solid":if(_[0]!=="facet"||_[1]!=="normal"){console.error(T),console.error(`Invalid state "${_[0]}", should be "facet normal"`);return}else g=new de(parseFloat(_[2]),parseFloat(_[3]),parseFloat(_[4])),h.vertexNormals.push(g,g,g),d="facet normal";break;case"facet normal":if(_[0]!=="outer"||_[1]!=="loop"){console.error(T),console.error(`Invalid state "${_[0]}", should be "outer loop"`);return}else d="vertex";break;case"vertex":if(_[0]==="vertex")y=new de(parseFloat(_[1]),parseFloat(_[2]),parseFloat(_[3])),h.vertices.push(y),h.uvs.push([0,0]),p.push(h.vertices.indexOf(y));else if(_[0]==="endloop")h.faces.push(p),p=[],d="endloop";else{console.error(T),console.error(`Invalid state "${_[0]}", should be "vertex" or "endloop"`);return}break;case"endloop":if(_[0]!=="endfacet"){console.error(T),console.error(`Invalid state "${_[0]}", should be "endfacet"`);return}else d="endfacet";break;case"endfacet":if(_[0]!=="endsolid")if(_[0]==="facet"&&_[1]==="normal")g=new de(parseFloat(_[2]),parseFloat(_[3]),parseFloat(_[4])),h.vertexNormals.push(g,g,g),d="facet normal";else{console.error(T),console.error(`Invalid state "${_[0]}", should be "endsolid" or "facet normal"`);return}break;default:console.error(`Invalid state "${d}"`);break}}return h}t.model=function(h,f=1){this._assert3d("model"),this._renderer.model(h,f)};let c=0;t.createModel=function(h,f=" ",d){let p=!1,g,y,v=!1,T=!1;d&&typeof d=="object"?(p=d.normalize||!1,g=d.successCallback,y=d.failureCallback,v=d.flipU||!1,T=d.flipV||!1):typeof d=="boolean"?(p=d,g=arguments[3],y=arguments[4]):(g=typeof arguments[2]=="function"?arguments[2]:void 0,y=arguments[3]);const _=new n.Geometry;if(_.gid=`${f}|${p}|${c++}`,f.match(/\.stl$/i))try{let E=new TextEncoder().encode(h).buffer;s(_,E)}catch(C){y?y(C):n._friendlyError("Error during parsing: "+C.message);return}else if(f.match(/\.obj$/i))try{const C=h.split(`
`);i(_,C)}catch(C){y?y(C):n._friendlyError("Error during parsing: "+C.message);return}else n._friendlyFileLoadError(3,h),y?y():n._friendlyError("Sorry, the file type is invalid. Only OBJ and STL files are supported.");return p&&_.normalize(),v&&_.flipU(),T&&_.flipV(),_._makeTriangleEdges(),typeof g=="function"&&g(_),_}}typeof p5<"u"&&fR(p5,p5.prototype);const Tn={IDEOGRAPHIC:"ideographic",_CTX_MIDDLE:"middle",_TEXT_BOUNDS:"_textBoundsSingle",_FONT_BOUNDS:"_fontBoundsSingle",HANGING:"hanging",START:"start",END:"end"};function dR(n,t){const i="#000000",s=/\r?\n/g,o=/,\s+/,a=/^".*"$/,u=/\t/g,l="fontVariationSettings",c=["wght","wdth","ital","slnt","opsz"],h=new RegExp(`(?:${c.join("|")})`);["text","textAlign","textAscent","textDescent","textLeading","textMode","textFont","textSize","textStyle","textWidth","textWrap","textBounds","textDirection","textProperty","textProperties","fontBounds","fontWidth","fontAscent","fontDescent","textWeight"].forEach(_=>{t[_]=function(...C){if(!(_ in st.prototype))throw Error(`Renderer2D.prototype.${_} is not defined.`);return this._renderer[_](...C)},n.Graphics.prototype[_]=function(...C){return this._renderer[_](...C)}});const d={textAlign:{default:t.LEFT,type:"Context2d"},textBaseline:{default:t.BASELINE,type:"Context2d"},textFont:{default:{family:"sans-serif"}},textLeading:{default:15},textSize:{default:12},textWrap:{default:t.WORD},fontStretch:{default:t.NORMAL,isShorthand:!0},fontWeight:{default:t.NORMAL,isShorthand:!0},lineHeight:{default:t.NORMAL,isShorthand:!0},fontVariant:{default:t.NORMAL,isShorthand:!0},fontStyle:{default:t.NORMAL,isShorthand:!0},direction:{default:"inherit"}},p=["font","direction","fontKerning","fontStretch","fontVariantCaps","letterSpacing","textAlign","textBaseline","textRendering","wordSpacing"],g=Object.keys(d).filter(_=>d[_].isShorthand),y=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"];let v,T;if(st.prototype.text=function(_,C,E,S,R){let w=this.textDrawingContext().textBaseline;({x:C,y:E,width:S,height:R}=this._handleRectMode(C,E,S,R));let x=this._processLines(_,S,R);x=this._positionLines(C,E,S,R,x),x.forEach(b=>this._renderText(b.text,b.x,b.y)),this.textDrawingContext().textBaseline=w},st.prototype.textBounds=function(_,C,E,S,R){return this._computeBounds(Tn._TEXT_BOUNDS,_,C,E,S,R).bounds},st.prototype.fontBounds=function(_,C,E,S,R){return this._computeBounds(Tn._FONT_BOUNDS,_,C,E,S,R).bounds},st.prototype.textWidth=function(_){let C=this._processLines(_);return Math.max(...C.map(E=>this._textWidthSingle(E)))},st.prototype.fontWidth=function(_){let C=this._processLines(_);return Math.max(...C.map(E=>this._fontWidthSingle(E)))},st.prototype.textAscent=function(_=""){return _.length?this.textDrawingContext().measureText(_).actualBoundingBoxAscent:this.fontAscent()},st.prototype.fontAscent=function(){return this.textDrawingContext().measureText("_").fontBoundingBoxAscent},st.prototype.textDescent=function(_=""){return _.length?this.textDrawingContext().measureText(_).actualBoundingBoxDescent:this.fontDescent()},st.prototype.fontDescent=function(){return this.textDrawingContext().measureText("_").fontBoundingBoxDescent},st.prototype.textAlign=function(_,C){return typeof _<"u"?(this.states.setValue("textAlign",_),typeof C<"u"&&(C===t.CENTER&&(C=Tn._CTX_MIDDLE),this.states.setValue("textBaseline",C)),this._applyTextProperties()):{horizontal:this.states.textAlign,vertical:this.states.textBaseline}},st.prototype._currentTextFont=function(){return this.states.textFont.font||this.states.textFont.family},st.prototype.textFont=function(_,C,E){var R;if(arguments.length===0)return this._currentTextFont();let S=_;if(_ instanceof n.Font?S=_.face.family:_.data instanceof Uint8Array?(S=_.name.fontFamily,(R=_.name)!=null&&R.fontSubfamily&&(S+="-"+_.name.fontSubfamily)):typeof _=="string"&&typeof C>"u"&&/[.0-9]+(%|em|p[xt])/.test(S)&&({family:S,size:C}=this._directSetFontString(S)),typeof S!="string")throw Error("null font in textFont()");return arguments.length===2&&typeof C=="object"&&(E=C,C=void 0),this.states.setValue("textFont",{font:_,family:S,size:C}),typeof C<"u"&&this._setTextSize(C),typeof E=="object"&&this.textProperties(E),this._applyTextProperties()},st.prototype._directSetFontString=function(_,C=0){C&&console.log('_directSetFontString"'+_+'"');let E=g.reduce((w,x)=>(w[x]=d[x].default,w),{}),S=this._cachedDiv(E);S.style.font=_;let R=getComputedStyle(S);return g.forEach(w=>{this.states[w]=R[w],C&&console.log("  this.states."+w+'="'+R[w]+'"')}),{family:R.fontFamily,size:R.fontSize}},st.prototype.textLeading=function(_){return typeof _=="number"?(this.states.setValue("leadingSet",!0),this.states.setValue("textLeading",_),this._applyTextProperties()):this.states.textLeading},st.prototype.textWeight=function(_){if(typeof _=="number"){this.states.setValue("fontWeight",_),this._applyTextProperties(),n.prototype._isSafari()||this._setCanvasStyleProperty("font-variation-settings",`"wght" ${_}`);return}return this.states.fontWeight},st.prototype.textSize=function(_){return typeof _<"u"?(this._setTextSize(_),this._applyTextProperties()):this.states.textSize},st.prototype.textStyle=function(_){return typeof _<"u"?(this.states.setValue("fontStyle",_),this._applyTextProperties()):this.states.fontStyle},st.prototype.textWrap=function(_){return _===t.WORD||_===t.CHAR?(this.states.setValue("textWrap",_),this._pInst):this.states.textWrap},st.prototype.textDirection=function(_){return typeof _<"u"?(this.states.setValue("direction",_),this._applyTextProperties()):this.states.direction},st.prototype.textProperty=function(_,C,E){let S=!1,R=(E==null?void 0:E.debug)||!1;if(typeof C>"u"){let w=this.textProperties();if(_ in w)return w[_];throw Error('Unknown text option "'+_+'"')}return _ in this.states&&this.states[_]!==C?(this.states[_]=C,S=!0,R&&console.log("this.states."+_+'="'+options[_]+'"')):_ in this.textDrawingContext()?(this._setContextProperty(_,C,R),S=!0):_ in this.textCanvas().style?(this._setCanvasStyleProperty(_,C,R),S=!0):console.warn('Ignoring unknown text option: "'+_+`"
`),S?this._applyTextProperties():this._pInst},st.prototype.textProperties=function(_){if(typeof _<"u")return Object.keys(_).forEach(E=>{this.textProperty(E,_[E])}),this._pInst;let C=this.textDrawingContext();return _=p.reduce((E,S)=>(E[S]=C[S],E),{}),Object.keys(d).forEach(E=>{var S;if(((S=d[E])==null?void 0:S.type)==="Context2d")_[E]=C[E];else if(E==="textFont"){let R=this._currentTextFont();typeof R=="object"&&"_pInst"in R&&(R=Object.assign({},R),delete R._pInst),_[E]=R}else _[E]=this.states[E]}),_},st.prototype.textMode=function(){},st.prototype._currentTextFont=function(){return this.states.textFont.font||this.states.textFont.family},st.prototype._computeBounds=function(_,C,E,S,R,w,x){let b=this.textDrawingContext(),A=b.textBaseline,{textLeading:k,textAlign:N}=this.states;({width:R,height:w}=this._rectModeAdjust(E,S,R,w));let I=this._processLines(C,R,w),j=I.map((le,fe)=>this[_].bind(this)(le,E,S+fe*k));I.length>1&&j.forEach(le=>le.x+=n.Renderer2D.prototype._xAlignOffset.call(this,N,R)),typeof w<"u"&&n.Renderer2D.prototype._yAlignOffset.call(this,j,w);let Q=j[0];return I.length>1&&(Q=this._aggregateBounds(j),x!=null&&x.ignoreRectMode||this._rectModeAlign(Q,R||0,w||0)),b.textBaseline=A,{bounds:Q,lines:I}},st.prototype._rectModeAdjust=function(_,C,E,S){if(typeof E<"u")switch(this.states.rectMode){case t.CENTER:break;case t.CORNERS:E-=_,S-=C;break;case t.RADIUS:E*=2,S*=2;break}return{x:_,y:C,width:E,height:S}},st.prototype._setCanvasStyleProperty=function(_,C,E){let S=C.toString();E&&console.log("canvas.style."+_+'="'+S+'"'),_===l&&this._handleFontVariationSettings(S),this.textCanvas().style[_]=S,this.textCanvas().style[_]},st.prototype._handleFontVariationSettings=function(_,C=!1){typeof _=="object"&&(_=Object.keys(_).map(S=>S+" "+_[S]).join(", ")),_.split(o).forEach(S=>{S=S.replace(/["']/g,"");let R=h.exec(S);if(R&&R.length){let w=R[0],x=parseFloat(parseFloat(S.replace(w,"").trim()).toFixed(3));switch(w){case"wght":return C&&console.log("setting font-weight="+x),this.states.fontWeight!==x&&this.textWeight(x),x;case"wdth":break;case"ital":C&&console.log("setting font-style="+(x?"italic":"normal"));break;case"slnt":C&&console.log("setting font-style="+(x?"oblique":"normal"));break;case"opsz":C&&console.log("setting font-optical-size="+x);break}}})},st.prototype._setContextProperty=function(_,C,E=!1){if(this.textDrawingContext()[_]===C)return this._pInst;(v??(v=[])).push([_,C]),E&&console.log("queued context2d."+_+'="'+C+'"')},st.prototype._handleRectMode=function(_,C,E,S){let R=this.states.rectMode;if(typeof E<"u")switch(R){case t.RADIUS:E*=2,_-=E/2,typeof S<"u"&&(S*=2,C-=S/2);break;case t.CENTER:_-=E/2,typeof S<"u"&&(C-=S/2);break;case t.CORNERS:E-=_,typeof S<"u"&&(S-=C);break}return{x:_,y:C,width:E,height:S}},st.prototype._fontSizePx=function(_,{family:C}=this.states.textFont){if((x=>!isNaN(x)&&x.trim()!=="")(_))return parseFloat(_);let S=this._cachedDiv({fontSize:_});S.style.fontSize=_,S.style.fontFamily=C;let R=getComputedStyle(S).fontSize,w=parseFloat(R);if(typeof w!="number")throw Error("textSize: invalid font-size");return w},st.prototype._cachedDiv=function(_){if(typeof T>"u"){let C=document.createElement("div");C.ariaHidden="true",C.style.display="none",Object.entries(_).forEach(([E,S])=>{C.style[E]=S}),this.textCanvas().appendChild(C),T=C}return T},st.prototype._aggregateBounds=function(_){let C=Math.min(..._.map(w=>w.x)),E=Math.min(..._.map(w=>w.y)),S=Math.max(..._.map(w=>w.y+w.h)),R=Math.max(..._.map(w=>w.x+w.w));return{x:C,y:E,w:R-C,h:S-E}},st.prototype._processLines=function(_,C,E){typeof C<"u"&&this.textDrawingContext().textBaseline===t.BASELINE&&(this.drawingContext.textBaseline=t.TOP);let S=this._splitOnBreaks(_.toString()),R=S.length>1,w=typeof C<"u",x=w&&S.some(k=>this._textWidthSingle(k)>C),{textLeading:b,textWrap:A}=this.states;if((R||x)&&w&&(S=this._lineate(A,S,C)),w&&typeof E<"u"){if(typeof b>"u")throw Error("leading is required if height is specified");for(let k=0;k<S.length;k++)if(b*(k+1)>E){S=S.slice(0,k);break}}return S},st.prototype._xAlignOffset=function(_,C){switch(_){case t.LEFT:return 0;case t.CENTER:return C/2;case t.RIGHT:return C;case Tn.START:return 0;case Tn.END:throw new Error("textBounds: END not yet supported for textAlign");default:return 0}},st.prototype._rectModeAlign=function(_,C,E){if(typeof C<"u"){switch(this.states.rectMode){case t.CENTER:_.x-=(C-_.w)/2,_.y-=(E-_.h)/2;break;case t.CORNERS:_.w+=_.x,_.h+=_.y;break;case t.RADIUS:_.x-=(C-_.w)/2,_.y-=(E-_.h)/2,_.w/=2,_.h/=2;break}return _}},st.prototype._rectModeAlignRevert=function(_,C,E){if(typeof C<"u"){switch(this.states.rectMode){case t.CENTER:_.x+=(C-_.w)/2,_.y+=(E-_.h)/2;break;case t.CORNERS:_.w-=_.x,_.h-=_.y;break;case t.RADIUS:_.x+=(C-_.w)/2,_.y+=(E-_.h)/2,_.w*=2,_.h*=2;break}return _}},st.prototype._textWidthSingle=function(_){let C=this.textDrawingContext().measureText(_),E=C.actualBoundingBoxLeft;return C.actualBoundingBoxRight+E},st.prototype._fontWidthSingle=function(_){return this.textDrawingContext().measureText(_).width},st.prototype._textBoundsSingle=function(_,C=0,E=0){let S=this.textDrawingContext().measureText(_),R=S.actualBoundingBoxAscent,w=S.actualBoundingBoxDescent,x=S.actualBoundingBoxLeft,b=S.actualBoundingBoxRight;return{x:C-x,y:E-R,w:b+x,h:R+w}},st.prototype._fontBoundsSingle=function(_,C=0,E=0){let S=this.textDrawingContext().measureText(_),R=S.fontBoundingBoxAscent,w=S.fontBoundingBoxDescent;return C-=this._xAlignOffset(this.states.textAlign,S.width),{x:C,y:E-R,w:S.width,h:R+w}},st.prototype._setTextSize=function(_){if(typeof _=="string"&&(_=this._fontSizePx(_)),typeof _=="number"){if(this.states.textSize!==_)return this.states.setValue("textSize",_),this.states.leadingSet||this.states.setValue("textLeading",this.states.textSize*1.275),!0}else console.warn("textSize: invalid size: "+_);return!1},st.prototype._lineate=function(_,C,E=1/0,S={}){let R=S.splitChar??(_===t.WORD?" ":""),w,x,b,A,k=[];for(let N=0;N<C.length;N++){w="",A=C[N].split(R);for(let I=0;I<A.length;I++)x=`${w+A[I]}`+R,b=this._textWidthSingle(x),w.length>0&&b>E?(k.push(w.trim()),w=`${A[I]}`+R):w=x;k.push(w.trim())}return k},st.prototype._splitOnBreaks=function(_){return!_||_.length===0?[""]:_.replace(u,"  ").split(s)},st.prototype._parseFontFamily=function(_){return _.split(o).map(S=>(S=S.trim(),S.indexOf(" ")>-1&&!a.test(S)&&(S=`"${S}"`),S)).join(", ")},st.prototype._applyFontString=function(){let{textFont:_,textSize:C,lineHeight:E,fontStyle:S,fontWeight:R,fontVariant:w}=this.states,x=this.textDrawingContext(),b=this._parseFontFamily(_.family),A=S!==t.NORMAL?`${S} `:"",k=R!==t.NORMAL?`${R} `:"",N=w!==t.NORMAL?`${w} `:"",I=`${C}px`+(E!==t.NORMAL?`/${E} `:" "),j=`${A}${N}${k}${I}${b}`.trim();if(x.font=j,x.font!==j){let Q=j,le=x.font;if(Q!==le)return!1}return!0},st.prototype._applyTextProperties=function(_=!1){this._applyFontString();let C=this.textDrawingContext();C.direction=this.states.direction,C.textAlign=this.states.textAlign,C.textBaseline=this.states.textBaseline;let E=this.states.fontStretch;for(y.includes(E)&&C.fontStretch!==E&&(C.fontStretch=E);v!=null&&v.length;){let[S,R]=v.shift();_&&console.log('apply context property "'+S+'" = "'+R+'"'),C[S]=R,C[S]!==R&&(console.warn(`Unable to set '${S}' property on context2d. It may not be supported.`),console.log('Expected "'+R+'" but got: "'+C[S]+'"'))}return this._pInst},n.Renderer2D&&(n.Renderer2D.prototype.textCanvas=function(){return this.canvas},n.Renderer2D.prototype.textDrawingContext=function(){return this.drawingContext},n.Renderer2D.prototype._renderText=function(_,C,E,S,R){let w=this.states,x=this.textDrawingContext();E<R||E>=S||(this.push(),w.strokeColor&&w.strokeSet&&x.strokeText(_,C,E),!this._clipping&&w.fillColor&&(w.fillSet||this._setFill(i),x.fillText(_,C,E)),this.pop())},n.Renderer2D.prototype._positionLines=function(_,C,E,S,R){let{textLeading:w,textAlign:x}=this.states,b,A=new Array(R.length),k=typeof E>"u"?0:E,N=typeof S>"u"?0:S;for(let I=0;I<R.length;I++){switch(x){case Tn.START:throw new Error("textBounds: START not yet supported for textAlign");case t.LEFT:b=_;break;case t.CENTER:b=_+k/2;break;case t.RIGHT:b=_+k;break;case Tn.END:throw new Error("textBounds: END not yet supported for textAlign")}A[I]={text:R[I],x:b,y:C+I*w}}return this._yAlignOffset(A,N)},n.Renderer2D.prototype._yAlignOffset=function(_,C){if(typeof C>"u")throw Error("_yAlignOffset: height is required");let{textLeading:E,textBaseline:S}=this.states,R=0,w=_.length,x=C-E*(w-1);switch(S){case t.TOP:break;case t.BASELINE:break;case Tn._CTX_MIDDLE:R=x/2;break;case t.BOTTOM:R=x;break;case Tn.IDEOGRAPHIC:console.warn("textBounds: IDEOGRAPHIC not yet supported for textBaseline");break;case Tn.HANGING:console.warn("textBounds: HANGING not yet supported for textBaseline");break}return _.forEach(b=>b.y+=R),_}),n.RendererGL){n.RendererGL.prototype.textCanvas=function(){return this._textCanvas||(this._textCanvas=document.createElement("canvas"),this._textCanvas.width=1,this._textCanvas.height=1,this._textCanvas.style.display="none",this.canvas.parentElement.insertBefore(this._textCanvas,this.canvas)),this._textCanvas},n.RendererGL.prototype.textDrawingContext=function(){if(!this._textDrawingContext){const C=this.textCanvas();this._textDrawingContext=C.getContext("2d")}return this._textDrawingContext};const _=n.RendererGL.prototype.remove;n.RendererGL.prototype.remove=function(){this._textCanvas&&this._textCanvas.parentElement.removeChild(this._textCanvas),_.call(this)},n.RendererGL.prototype._positionLines=function(C,E,S,R,w){let{textLeading:x,textAlign:b}=this.states;const A=w.map(Q=>this._fontWidthSingle(Q));let k,N=new Array(w.length),I=typeof S>"u"?Math.max(0,...A):S,j=typeof R>"u"?0:R;for(let Q=0;Q<w.length;Q++){switch(b){case Tn.START:throw new Error("textBounds: START not yet supported for textAlign");case t.LEFT:k=C;break;case t.CENTER:k=C+(I-A[Q])/2-I/2+(S||0)/2;break;case t.RIGHT:k=C+I-A[Q]-I+(S||0);break;case Tn.END:throw new Error("textBounds: END not yet supported for textAlign")}N[Q]={text:w[Q],x:k,y:E+Q*x}}return this._yAlignOffset(N,j)},n.RendererGL.prototype._yAlignOffset=function(C,E){var N;if(typeof E>"u")throw Error("_yAlignOffset: height is required");let{textLeading:S,textBaseline:R,textSize:w,textFont:x}=this.states,b=0,A=C.length,k=w*A+(S-w)*(A-1);switch(R){case t.TOP:b=w;break;case t.BASELINE:break;case Tn._CTX_MIDDLE:b=-k/2+w+(E||0)/2;break;case t.BOTTOM:b=-(k-w)+(E||0);break;default:console.warn(`${R} is not supported in WebGL mode.`);break}return b+=((N=this.states.textFont.font)==null?void 0:N._verticalAlign(w))||0,C.forEach(I=>I.y+=b),C}}}typeof p5<"u"&&dR(p5,p5.prototype);var Gf={},XS;function LH(){if(XS)return Gf;XS=1,Object.defineProperty(Gf,"__esModule",{value:!0});var n=function(){function t(){}return t.parse=function(r){for(var i=new Set,s=0,o=r;s<o.length;s++){var a=o[s];if(!t.REGEXP.test(a))throw new TypeError('"'+a+'" is invalid unicode-range.');var u=a.match(t.REGEXP),l=u[1],c=u[2],h=u[3];if(l){if(/\?[^?]+$/.test(l))throw new TypeError('"'+a+'" is invalid unicode-range.');if(l.includes("?"))for(var f=l.replace(/\?/g,"0"),d=l.replace(/\?/g,"F"),p=t.parse(["U+"+f+"-"+d]),g=0,y=p;g<y.length;g++){var v=y[g];i.add(v)}else i.add(parseInt(l,16))}if(c&&h)for(var T=parseInt(c,16),_=parseInt(h,16),v=T;v<=_;v++)i.add(v)}return Array.from(i).sort(function(C,E){return C-E})},t.stringify=function(r){for(var i=Array.from(new Set(r)).sort(function(c,h){return c-h}),s=[],o,a=0;a<i.length;a++){var u=i[a],l=i[a-1];o&&u-l!==1&&(s.push(t.rangeString(o,l)),o=u),o||(o=u),a===i.length-1&&(o===u?s.push(t.rangeString(u)):s.push(t.rangeString(o,u)))}return s},t.rangeString=function(r,i){return!i||r===i?"U+"+r.toString(16):"U+"+r.toString(16)+"-"+i.toString(16)},t.REGEXP=/^u\+(?:([0-9a-f]?[0-9a-f?]{1,5})|([0-9a-f]{1,6})-([0-9a-f]{1,6}))?$/i,t}();return Gf.UnicodeRange=n,Gf}var ZS=LH();const OH=[{category:"control character",hexrange:["0000","001f"]},{category:"basic latin",hexrange:["0000","007f"]},{category:"latin-1 supplement",hexrange:["0080","00ff"]},{category:"latin extended-a",hexrange:["0100","017f"]},{category:"latin extended-b",hexrange:["0180","024f"]},{category:"ipa extensions",hexrange:["0250","02af"]},{category:"spacing modifier letters",hexrange:["02b0","02ff"]},{category:"combining diacritical marks",hexrange:["0300","036f"]},{category:"greek and coptic",hexrange:["0370","03ff"]},{category:"cyrillic",hexrange:["0400","04ff"]},{category:"cyrillic supplement",hexrange:["0500","052f"]},{category:"armenian",hexrange:["0530","058f"]},{category:"hebrew",hexrange:["0590","05ff"]},{category:"arabic",hexrange:["0600","06ff"]},{category:"syriac",hexrange:["0700","074f"]},{category:"arabic supplement",hexrange:["0750","077f"]},{category:"thaana",hexrange:["0780","07bf"]},{category:"nko",hexrange:["07c0","07ff"]},{category:"samaritan",hexrange:["0800","083f"]},{category:"mandaic",hexrange:["0840","085f"]},{category:"syriac supplement",hexrange:["0860","086f"]},{category:"arabic extended-b",hexrange:["0870","089f"]},{category:"arabic extended-a",hexrange:["08a0","08ff"]},{category:"devanagari",hexrange:["0900","097f"]},{category:"bengali",hexrange:["0980","09ff"]},{category:"gurmukhi",hexrange:["0a00","0a7f"]},{category:"gujarati",hexrange:["0a80","0aff"]},{category:"oriya",hexrange:["0b00","0b7f"]},{category:"tamil",hexrange:["0b80","0bff"]},{category:"telugu",hexrange:["0c00","0c7f"]},{category:"kannada",hexrange:["0c80","0cff"]},{category:"malayalam",hexrange:["0d00","0d7f"]},{category:"sinhala",hexrange:["0d80","0dff"]},{category:"thai",hexrange:["0e00","0e7f"]},{category:"lao",hexrange:["0e80","0eff"]},{category:"tibetan",hexrange:["0f00","0fff"]},{category:"myanmar",hexrange:["1000","109f"]},{category:"georgian",hexrange:["10a0","10ff"]},{category:"hangul jamo",hexrange:["1100","11ff"]},{category:"ethiopic",hexrange:["1200","137f"]},{category:"ethiopic supplement",hexrange:["1380","139f"]},{category:"cherokee",hexrange:["13a0","13ff"]},{category:"unified canadian aboriginal syllabics",hexrange:["1400","167f"]},{category:"ogham",hexrange:["1680","169f"]},{category:"runic",hexrange:["16a0","16ff"]},{category:"tagalog",hexrange:["1700","171f"]},{category:"hanunoo",hexrange:["1720","173f"]},{category:"buhid",hexrange:["1740","175f"]},{category:"tagbanwa",hexrange:["1760","177f"]},{category:"khmer",hexrange:["1780","17ff"]},{category:"mongolian",hexrange:["1800","18af"]},{category:"unified canadian aboriginal syllabics extended",hexrange:["18b0","18ff"]},{category:"limbu",hexrange:["1900","194f"]},{category:"tai le",hexrange:["1950","197f"]},{category:"new tai lue",hexrange:["1980","19df"]},{category:"khmer symbols",hexrange:["19e0","19ff"]},{category:"buginese",hexrange:["1a00","1a1f"]},{category:"tai tham",hexrange:["1a20","1aaf"]},{category:"combining diacritical marks extended",hexrange:["1ab0","1aff"]},{category:"balinese",hexrange:["1b00","1b7f"]},{category:"sundanese",hexrange:["1b80","1bbf"]},{category:"batak",hexrange:["1bc0","1bff"]},{category:"lepcha",hexrange:["1c00","1c4f"]},{category:"ol chiki",hexrange:["1c50","1c7f"]},{category:"cyrillic extended-c",hexrange:["1c80","1c8f"]},{category:"georgian extended",hexrange:["1c90","1cbf"]},{category:"sundanese supplement",hexrange:["1cc0","1ccf"]},{category:"vedic extensions",hexrange:["1cd0","1cff"]},{category:"phonetic extensions",hexrange:["1d00","1d7f"]},{category:"phonetic extensions supplement",hexrange:["1d80","1dbf"]},{category:"combining diacritical marks supplement",hexrange:["1dc0","1dff"]},{category:"latin extended additional",hexrange:["1e00","1eff"]},{category:"greek extended",hexrange:["1f00","1fff"]},{category:"general punctuation",hexrange:["2000","206f"]},{category:"superscripts and subscripts",hexrange:["2070","209f"]},{category:"currency symbols",hexrange:["20a0","20cf"]},{category:"combining diacritical marks for symbols",hexrange:["20d0","20ff"]},{category:"letterlike symbols",hexrange:["2100","214f"]},{category:"number forms",hexrange:["2150","218f"]},{category:"arrows",hexrange:["2190","21ff"]},{category:"mathematical operators",hexrange:["2200","22ff"]},{category:"miscellaneous technical",hexrange:["2300","23ff"]},{category:"control pictures",hexrange:["2400","243f"]},{category:"optical character recognition",hexrange:["2440","245f"]},{category:"enclosed alphanumerics",hexrange:["2460","24ff"]},{category:"box drawing",hexrange:["2500","257f"]},{category:"block elements",hexrange:["2580","259f"]},{category:"geometric shapes",hexrange:["25a0","25ff"]},{category:"miscellaneous symbols",hexrange:["2600","26ff"]},{category:"dingbats",hexrange:["2700","27bf"]},{category:"miscellaneous mathematical symbols-a",hexrange:["27c0","27ef"]},{category:"supplemental arrows-a",hexrange:["27f0","27ff"]},{category:"braille patterns",hexrange:["2800","28ff"]},{category:"supplemental arrows-b",hexrange:["2900","297f"]},{category:"miscellaneous mathematical symbols-b",hexrange:["2980","29ff"]},{category:"supplemental mathematical operators",hexrange:["2a00","2aff"]},{category:"miscellaneous symbols and arrows",hexrange:["2b00","2bff"]},{category:"glagolitic",hexrange:["2c00","2c5f"]},{category:"latin extended-c",hexrange:["2c60","2c7f"]},{category:"coptic",hexrange:["2c80","2cff"]},{category:"georgian supplement",hexrange:["2d00","2d2f"]},{category:"tifinagh",hexrange:["2d30","2d7f"]},{category:"ethiopic extended",hexrange:["2d80","2ddf"]},{category:"cyrillic extended-a",hexrange:["2de0","2dff"]},{category:"supplemental punctuation",hexrange:["2e00","2e7f"]},{category:"cjk radicals supplement",hexrange:["2e80","2eff"]},{category:"kangxi radicals",hexrange:["2f00","2fdf"]},{category:"ideographic description characters",hexrange:["2ff0","2fff"]},{category:"cjk symbols and punctuation",hexrange:["3000","303f"]},{category:"hiragana",hexrange:["3040","309f"]},{category:"katakana",hexrange:["30a0","30ff"]},{category:"bopomofo",hexrange:["3100","312f"]},{category:"hangul compatibility jamo",hexrange:["3130","318f"]},{category:"kanbun",hexrange:["3190","319f"]},{category:"bopomofo extended",hexrange:["31a0","31bf"]},{category:"cjk strokes",hexrange:["31c0","31ef"]},{category:"katakana phonetic extensions",hexrange:["31f0","31ff"]},{category:"enclosed cjk letters and months",hexrange:["3200","32ff"]},{category:"cjk compatibility",hexrange:["3300","33ff"]},{category:"cjk unified ideographs extension a",hexrange:["3400","4dbf"]},{category:"yijing hexagram symbols",hexrange:["4dc0","4dff"]},{category:"cjk unified ideographs",hexrange:["4e00","9fff"]},{category:"yi syllables",hexrange:["a000","a48f"]},{category:"yi radicals",hexrange:["a490","a4cf"]},{category:"lisu",hexrange:["a4d0","a4ff"]},{category:"vai",hexrange:["a500","a63f"]},{category:"cyrillic extended-b",hexrange:["a640","a69f"]},{category:"bamum",hexrange:["a6a0","a6ff"]},{category:"modifier tone letters",hexrange:["a700","a71f"]},{category:"latin extended-d",hexrange:["a720","a7ff"]},{category:"syloti nagri",hexrange:["a800","a82f"]},{category:"common indic number forms",hexrange:["a830","a83f"]},{category:"phags-pa",hexrange:["a840","a87f"]},{category:"saurashtra",hexrange:["a880","a8df"]},{category:"devanagari extended",hexrange:["a8e0","a8ff"]},{category:"kayah li",hexrange:["a900","a92f"]},{category:"rejang",hexrange:["a930","a95f"]},{category:"hangul jamo extended-a",hexrange:["a960","a97f"]},{category:"javanese",hexrange:["a980","a9df"]},{category:"myanmar extended-b",hexrange:["a9e0","a9ff"]},{category:"cham",hexrange:["aa00","aa5f"]},{category:"myanmar extended-a",hexrange:["aa60","aa7f"]},{category:"tai viet",hexrange:["aa80","aadf"]},{category:"meetei mayek extensions",hexrange:["aae0","aaff"]},{category:"ethiopic extended-a",hexrange:["ab00","ab2f"]},{category:"latin extended-e",hexrange:["ab30","ab6f"]},{category:"cherokee supplement",hexrange:["ab70","abbf"]},{category:"meetei mayek",hexrange:["abc0","abff"]},{category:"hangul syllables",hexrange:["ac00","d7af"]},{category:"hangul jamo extended-b",hexrange:["d7b0","d7ff"]},{category:"high surrogates",hexrange:["d800","db7f"]},{category:"high private use surrogates",hexrange:["db80","dbff"]},{category:"low surrogates",hexrange:["dc00","dfff"]},{category:"private use area",hexrange:["e000","f8ff"]},{category:"cjk compatibility ideographs",hexrange:["f900","faff"]},{category:"alphabetic presentation forms",hexrange:["fb00","fb4f"]},{category:"arabic presentation forms-a",hexrange:["fb50","fdff"]},{category:"variation selectors",hexrange:["fe00","fe0f"]},{category:"vertical forms",hexrange:["fe10","fe1f"]},{category:"combining half marks",hexrange:["fe20","fe2f"]},{category:"cjk compatibility forms",hexrange:["fe30","fe4f"]},{category:"small form variants",hexrange:["fe50","fe6f"]},{category:"arabic presentation forms-b",hexrange:["fe70","feff"]},{category:"halfwidth and fullwidth forms",hexrange:["ff00","ffef"]},{category:"specials",hexrange:["fff0","ffff"]},{category:"linear b syllabary",hexrange:["10000","1007f"]},{category:"linear b ideograms",hexrange:["10080","100ff"]},{category:"aegean numbers",hexrange:["10100","1013f"]},{category:"ancient greek numbers",hexrange:["10140","1018f"]},{category:"ancient symbols",hexrange:["10190","101cf"]},{category:"phaistos disc",hexrange:["101d0","101ff"]},{category:"lycian",hexrange:["10280","1029f"]},{category:"carian",hexrange:["102a0","102df"]},{category:"coptic epact numbers",hexrange:["102e0","102ff"]},{category:"old italic",hexrange:["10300","1032f"]},{category:"gothic",hexrange:["10330","1034f"]},{category:"old permic",hexrange:["10350","1037f"]},{category:"ugaritic",hexrange:["10380","1039f"]},{category:"old persian",hexrange:["103a0","103df"]},{category:"deseret",hexrange:["10400","1044f"]},{category:"shavian",hexrange:["10450","1047f"]},{category:"osmanya",hexrange:["10480","104af"]},{category:"osage",hexrange:["104b0","104ff"]},{category:"elbasan",hexrange:["10500","1052f"]},{category:"caucasian albanian",hexrange:["10530","1056f"]},{category:"vithkuqi",hexrange:["10570","105bf"]},{category:"linear a",hexrange:["10600","1077f"]},{category:"latin extended-f",hexrange:["10780","107bf"]},{category:"cypriot syllabary",hexrange:["10800","1083f"]},{category:"imperial aramaic",hexrange:["10840","1085f"]},{category:"palmyrene",hexrange:["10860","1087f"]},{category:"nabataean",hexrange:["10880","108af"]},{category:"hatran",hexrange:["108e0","108ff"]},{category:"phoenician",hexrange:["10900","1091f"]},{category:"lydian",hexrange:["10920","1093f"]},{category:"meroitic hieroglyphs",hexrange:["10980","1099f"]},{category:"meroitic cursive",hexrange:["109a0","109ff"]},{category:"kharoshthi",hexrange:["10a00","10a5f"]},{category:"old south arabian",hexrange:["10a60","10a7f"]},{category:"old north arabian",hexrange:["10a80","10a9f"]},{category:"manichaean",hexrange:["10ac0","10aff"]},{category:"avestan",hexrange:["10b00","10b3f"]},{category:"inscriptional parthian",hexrange:["10b40","10b5f"]},{category:"inscriptional pahlavi",hexrange:["10b60","10b7f"]},{category:"psalter pahlavi",hexrange:["10b80","10baf"]},{category:"old turkic",hexrange:["10c00","10c4f"]},{category:"old hungarian",hexrange:["10c80","10cff"]},{category:"hanifi rohingya",hexrange:["10d00","10d3f"]},{category:"rumi numeral symbols",hexrange:["10e60","10e7f"]},{category:"yezidi",hexrange:["10e80","10ebf"]},{category:"arabic extended-c",hexrange:["10ec0","10eff"]},{category:"old sogdian",hexrange:["10f00","10f2f"]},{category:"sogdian",hexrange:["10f30","10f6f"]},{category:"old uyghur",hexrange:["10f70","10faf"]},{category:"chorasmian",hexrange:["10fb0","10fdf"]},{category:"elymaic",hexrange:["10fe0","10fff"]},{category:"brahmi",hexrange:["11000","1107f"]},{category:"kaithi",hexrange:["11080","110cf"]},{category:"sora sompeng",hexrange:["110d0","110ff"]},{category:"chakma",hexrange:["11100","1114f"]},{category:"mahajani",hexrange:["11150","1117f"]},{category:"sharada",hexrange:["11180","111df"]},{category:"sinhala archaic numbers",hexrange:["111e0","111ff"]},{category:"khojki",hexrange:["11200","1124f"]},{category:"multani",hexrange:["11280","112af"]},{category:"khudawadi",hexrange:["112b0","112ff"]},{category:"grantha",hexrange:["11300","1137f"]},{category:"newa",hexrange:["11400","1147f"]},{category:"tirhuta",hexrange:["11480","114df"]},{category:"siddham",hexrange:["11580","115ff"]},{category:"modi",hexrange:["11600","1165f"]},{category:"mongolian supplement",hexrange:["11660","1167f"]},{category:"takri",hexrange:["11680","116cf"]},{category:"ahom",hexrange:["11700","1174f"]},{category:"dogra",hexrange:["11800","1184f"]},{category:"warang citi",hexrange:["118a0","118ff"]},{category:"dives akuru",hexrange:["11900","1195f"]},{category:"nandinagari",hexrange:["119a0","119ff"]},{category:"zanabazar square",hexrange:["11a00","11a4f"]},{category:"soyombo",hexrange:["11a50","11aaf"]},{category:"unified canadian aboriginal syllabics extended-a",hexrange:["11ab0","11abf"]},{category:"pau cin hau",hexrange:["11ac0","11aff"]},{category:"devanagari extended-a",hexrange:["11b00","11b5f"]},{category:"bhaiksuki",hexrange:["11c00","11c6f"]},{category:"marchen",hexrange:["11c70","11cbf"]},{category:"masaram gondi",hexrange:["11d00","11d5f"]},{category:"gunjala gondi",hexrange:["11d60","11daf"]},{category:"makasar",hexrange:["11ee0","11eff"]},{category:"kawi",hexrange:["11f00","11f5f"]},{category:"lisu supplement",hexrange:["11fb0","11fbf"]},{category:"tamil supplement",hexrange:["11fc0","11fff"]},{category:"cuneiform",hexrange:["12000","123ff"]},{category:"cuneiform numbers and punctuation",hexrange:["12400","1247f"]},{category:"early dynastic cuneiform",hexrange:["12480","1254f"]},{category:"cypro-minoan",hexrange:["12f90","12fff"]},{category:"egyptian hieroglyphs",hexrange:["13000","1342f"]},{category:"egyptian hieroglyph format controls",hexrange:["13430","1345f"]},{category:"anatolian hieroglyphs",hexrange:["14400","1467f"]},{category:"bamum supplement",hexrange:["16800","16a3f"]},{category:"mro",hexrange:["16a40","16a6f"]},{category:"tangsa",hexrange:["16a70","16acf"]},{category:"bassa vah",hexrange:["16ad0","16aff"]},{category:"pahawh hmong",hexrange:["16b00","16b8f"]},{category:"medefaidrin",hexrange:["16e40","16e9f"]},{category:"miao",hexrange:["16f00","16f9f"]},{category:"ideographic symbols and punctuation",hexrange:["16fe0","16fff"]},{category:"tangut",hexrange:["17000","187ff"]},{category:"tangut components",hexrange:["18800","18aff"]},{category:"khitan small script",hexrange:["18b00","18cff"]},{category:"tangut supplement",hexrange:["18d00","18d7f"]},{category:"kana extended-b",hexrange:["1aff0","1afff"]},{category:"kana supplement",hexrange:["1b000","1b0ff"]},{category:"kana extended-a",hexrange:["1b100","1b12f"]},{category:"small kana extension",hexrange:["1b130","1b16f"]},{category:"nushu",hexrange:["1b170","1b2ff"]},{category:"duployan",hexrange:["1bc00","1bc9f"]},{category:"shorthand format controls",hexrange:["1bca0","1bcaf"]},{category:"znamenny musical notation",hexrange:["1cf00","1cfcf"]},{category:"byzantine musical symbols",hexrange:["1d000","1d0ff"]},{category:"musical symbols",hexrange:["1d100","1d1ff"]},{category:"ancient greek musical notation",hexrange:["1d200","1d24f"]},{category:"kaktovik numerals",hexrange:["1d2c0","1d2df"]},{category:"mayan numerals",hexrange:["1d2e0","1d2ff"]},{category:"tai xuan jing symbols",hexrange:["1d300","1d35f"]},{category:"counting rod numerals",hexrange:["1d360","1d37f"]},{category:"mathematical alphanumeric symbols",hexrange:["1d400","1d7ff"]},{category:"sutton signwriting",hexrange:["1d800","1daaf"]},{category:"latin extended-g",hexrange:["1df00","1dfff"]},{category:"glagolitic supplement",hexrange:["1e000","1e02f"]},{category:"cyrillic extended-d",hexrange:["1e030","1e08f"]},{category:"nyiakeng puachue hmong",hexrange:["1e100","1e14f"]},{category:"toto",hexrange:["1e290","1e2bf"]},{category:"wancho",hexrange:["1e2c0","1e2ff"]},{category:"nag mundari",hexrange:["1e4d0","1e4ff"]},{category:"ethiopic extended-b",hexrange:["1e7e0","1e7ff"]},{category:"mende kikakui",hexrange:["1e800","1e8df"]},{category:"adlam",hexrange:["1e900","1e95f"]},{category:"indic siyaq numbers",hexrange:["1ec70","1ecbf"]},{category:"ottoman siyaq numbers",hexrange:["1ed00","1ed4f"]},{category:"arabic mathematical alphabetic symbols",hexrange:["1ee00","1eeff"]},{category:"mahjong tiles",hexrange:["1f000","1f02f"]},{category:"domino tiles",hexrange:["1f030","1f09f"]},{category:"playing cards",hexrange:["1f0a0","1f0ff"]},{category:"enclosed alphanumeric supplement",hexrange:["1f100","1f1ff"]},{category:"enclosed ideographic supplement",hexrange:["1f200","1f2ff"]},{category:"miscellaneous symbols and pictographs",hexrange:["1f300","1f5ff"]},{category:"emoticons (emoji)",hexrange:["1f600","1f64f"]},{category:"ornamental dingbats",hexrange:["1f650","1f67f"]},{category:"transport and map symbols",hexrange:["1f680","1f6ff"]},{category:"alchemical symbols",hexrange:["1f700","1f77f"]},{category:"geometric shapes extended",hexrange:["1f780","1f7ff"]},{category:"supplemental arrows-c",hexrange:["1f800","1f8ff"]},{category:"supplemental symbols and pictographs",hexrange:["1f900","1f9ff"]},{category:"chess symbols",hexrange:["1fa00","1fa6f"]},{category:"symbols and pictographs extended-a",hexrange:["1fa70","1faff"]},{category:"symbols for legacy computing",hexrange:["1fb00","1fbff"]},{category:"cjk unified ideographs extension b",hexrange:["20000","2a6df"]},{category:"cjk unified ideographs extension c",hexrange:["2a700","2b73f"]},{category:"cjk unified ideographs extension d",hexrange:["2b740","2b81f"]},{category:"cjk unified ideographs extension e",hexrange:["2b820","2ceaf"]},{category:"cjk unified ideographs extension f",hexrange:["2ceb0","2ebef"]},{category:"cjk unified ideographs extension i",hexrange:["2ebf0","2ee5f"]},{category:"cjk compatibility ideographs supplement",hexrange:["2f800","2fa1f"]},{category:"cjk unified ideographs extension g",hexrange:["30000","3134f"]},{category:"cjk unified ideographs extension h",hexrange:["31350","323af"]},{category:"tags",hexrange:["e0000","e007f"]},{category:"variation selectors supplement",hexrange:["e0100","e01ef"]},{category:"supplementary private use area-a",hexrange:["f0000","fffff"]},{category:"supplementary private use area-b",hexrange:["100000","10ffff"]}];function Fl(n){let t=n.length;for(;--t>=0;)n[t]=0}const VH=3,BH=258,pR=29,UH=256,$H=UH+1+pR,gR=30,jH=512,GH=new Array(($H+2)*2);Fl(GH);const zH=new Array(gR*2);Fl(zH);const qH=new Array(jH);Fl(qH);const HH=new Array(BH-VH+1);Fl(HH);const WH=new Array(pR);Fl(WH);const KH=new Array(gR);Fl(KH);const YH=(n,t,r,i)=>{let s=n&65535|0,o=n>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do s=s+t[i++]|0,o=o+s|0;while(--a);s%=65521,o%=65521}return s|o<<16|0};var sv=YH;const XH=()=>{let n,t=[];for(var r=0;r<256;r++){n=r;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;t[r]=n}return t},ZH=new Uint32Array(XH()),QH=(n,t,r,i)=>{const s=ZH,o=i+r;n^=-1;for(let a=i;a<o;a++)n=n>>>8^s[(n^t[a])&255];return n^-1};var Ti=QH,ov={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},mR={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const JH=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var eW=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const i in r)JH(r,i)&&(n[i]=r[i])}}return n},tW=n=>{let t=0;for(let i=0,s=n.length;i<s;i++)t+=n[i].length;const r=new Uint8Array(t);for(let i=0,s=0,o=n.length;i<o;i++){let a=n[i];r.set(a,s),s+=a.length}return r},yR={assign:eW,flattenChunks:tW};let vR=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{vR=!1}const Rh=new Uint8Array(256);for(let n=0;n<256;n++)Rh[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Rh[254]=Rh[254]=1;var rW=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let t,r,i,s,o,a=n.length,u=0;for(s=0;s<a;s++)r=n.charCodeAt(s),(r&64512)===55296&&s+1<a&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),s++)),u+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(u),o=0,s=0;o<u;s++)r=n.charCodeAt(s),(r&64512)===55296&&s+1<a&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),s++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|r&63):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|r&63):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|r&63);return t};const nW=(n,t)=>{if(t<65534&&n.subarray&&vR)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let r="";for(let i=0;i<t;i++)r+=String.fromCharCode(n[i]);return r};var iW=(n,t)=>{const r=t||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,t));let i,s;const o=new Array(r*2);for(s=0,i=0;i<r;){let a=n[i++];if(a<128){o[s++]=a;continue}let u=Rh[a];if(u>4){o[s++]=65533,i+=u-1;continue}for(a&=u===2?31:u===3?15:7;u>1&&i<r;)a=a<<6|n[i++]&63,u--;if(u>1){o[s++]=65533;continue}a<65536?o[s++]=a:(a-=65536,o[s++]=55296|a>>10&1023,o[s++]=56320|a&1023)}return nW(o,s)},sW=(n,t)=>{t=t||n.length,t>n.length&&(t=n.length);let r=t-1;for(;r>=0&&(n[r]&192)===128;)r--;return r<0||r===0?t:r+Rh[n[r]]>t?r:t},av={string2buf:rW,buf2string:iW,utf8border:sW};function oW(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var aW=oW;const zf=16209,uW=16191;var lW=function(t,r){let i,s,o,a,u,l,c,h,f,d,p,g,y,v,T,_,C,E,S,R,w,x,b,A;const k=t.state;i=t.next_in,b=t.input,s=i+(t.avail_in-5),o=t.next_out,A=t.output,a=o-(r-t.avail_out),u=o+(t.avail_out-257),l=k.dmax,c=k.wsize,h=k.whave,f=k.wnext,d=k.window,p=k.hold,g=k.bits,y=k.lencode,v=k.distcode,T=(1<<k.lenbits)-1,_=(1<<k.distbits)-1;e:do{g<15&&(p+=b[i++]<<g,g+=8,p+=b[i++]<<g,g+=8),C=y[p&T];t:for(;;){if(E=C>>>24,p>>>=E,g-=E,E=C>>>16&255,E===0)A[o++]=C&65535;else if(E&16){S=C&65535,E&=15,E&&(g<E&&(p+=b[i++]<<g,g+=8),S+=p&(1<<E)-1,p>>>=E,g-=E),g<15&&(p+=b[i++]<<g,g+=8,p+=b[i++]<<g,g+=8),C=v[p&_];r:for(;;){if(E=C>>>24,p>>>=E,g-=E,E=C>>>16&255,E&16){if(R=C&65535,E&=15,g<E&&(p+=b[i++]<<g,g+=8,g<E&&(p+=b[i++]<<g,g+=8)),R+=p&(1<<E)-1,R>l){t.msg="invalid distance too far back",k.mode=zf;break e}if(p>>>=E,g-=E,E=o-a,R>E){if(E=R-E,E>h&&k.sane){t.msg="invalid distance too far back",k.mode=zf;break e}if(w=0,x=d,f===0){if(w+=c-E,E<S){S-=E;do A[o++]=d[w++];while(--E);w=o-R,x=A}}else if(f<E){if(w+=c+f-E,E-=f,E<S){S-=E;do A[o++]=d[w++];while(--E);if(w=0,f<S){E=f,S-=E;do A[o++]=d[w++];while(--E);w=o-R,x=A}}}else if(w+=f-E,E<S){S-=E;do A[o++]=d[w++];while(--E);w=o-R,x=A}for(;S>2;)A[o++]=x[w++],A[o++]=x[w++],A[o++]=x[w++],S-=3;S&&(A[o++]=x[w++],S>1&&(A[o++]=x[w++]))}else{w=o-R;do A[o++]=A[w++],A[o++]=A[w++],A[o++]=A[w++],S-=3;while(S>2);S&&(A[o++]=A[w++],S>1&&(A[o++]=A[w++]))}}else if((E&64)===0){C=v[(C&65535)+(p&(1<<E)-1)];continue r}else{t.msg="invalid distance code",k.mode=zf;break e}break}}else if((E&64)===0){C=y[(C&65535)+(p&(1<<E)-1)];continue t}else if(E&32){k.mode=uW;break e}else{t.msg="invalid literal/length code",k.mode=zf;break e}break}}while(i<s&&o<u);S=g>>3,i-=S,g-=S<<3,p&=(1<<g)-1,t.next_in=i,t.next_out=o,t.avail_in=i<s?5+(s-i):5-(i-s),t.avail_out=o<u?257+(u-o):257-(o-u),k.hold=p,k.bits=g};const ou=15,QS=852,JS=592,eC=0,s0=1,tC=2,cW=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),hW=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fW=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dW=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),pW=(n,t,r,i,s,o,a,u)=>{const l=u.bits;let c=0,h=0,f=0,d=0,p=0,g=0,y=0,v=0,T=0,_=0,C,E,S,R,w,x=null,b;const A=new Uint16Array(ou+1),k=new Uint16Array(ou+1);let N=null,I,j,Q;for(c=0;c<=ou;c++)A[c]=0;for(h=0;h<i;h++)A[t[r+h]]++;for(p=l,d=ou;d>=1&&A[d]===0;d--);if(p>d&&(p=d),d===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,u.bits=1,0;for(f=1;f<d&&A[f]===0;f++);for(p<f&&(p=f),v=1,c=1;c<=ou;c++)if(v<<=1,v-=A[c],v<0)return-1;if(v>0&&(n===eC||d!==1))return-1;for(k[1]=0,c=1;c<ou;c++)k[c+1]=k[c]+A[c];for(h=0;h<i;h++)t[r+h]!==0&&(a[k[t[r+h]]++]=h);if(n===eC?(x=N=a,b=20):n===s0?(x=cW,N=hW,b=257):(x=fW,N=dW,b=0),_=0,h=0,c=f,w=o,g=p,y=0,S=-1,T=1<<p,R=T-1,n===s0&&T>QS||n===tC&&T>JS)return 1;for(;;){I=c-y,a[h]+1<b?(j=0,Q=a[h]):a[h]>=b?(j=N[a[h]-b],Q=x[a[h]-b]):(j=96,Q=0),C=1<<c-y,E=1<<g,f=E;do E-=C,s[w+(_>>y)+E]=I<<24|j<<16|Q|0;while(E!==0);for(C=1<<c-1;_&C;)C>>=1;if(C!==0?(_&=C-1,_+=C):_=0,h++,--A[c]===0){if(c===d)break;c=t[r+a[h]]}if(c>p&&(_&R)!==S){for(y===0&&(y=p),w+=f,g=c-y,v=1<<g;g+y<d&&(v-=A[g+y],!(v<=0));)g++,v<<=1;if(T+=1<<g,n===s0&&T>QS||n===tC&&T>JS)return 1;S=_&R,s[S]=p<<24|g<<16|w-o|0}}return _!==0&&(s[w+_]=c-y<<24|64<<16|0),u.bits=p,0};var Uc=pW;const gW=0,_R=1,bR=2,{Z_FINISH:rC,Z_BLOCK:mW,Z_TREES:qf,Z_OK:Oa,Z_STREAM_END:yW,Z_NEED_DICT:vW,Z_STREAM_ERROR:si,Z_DATA_ERROR:xR,Z_MEM_ERROR:wR,Z_BUF_ERROR:_W,Z_DEFLATED:nC}=mR,Jg=16180,iC=16181,sC=16182,oC=16183,aC=16184,uC=16185,lC=16186,cC=16187,hC=16188,fC=16189,Np=16190,ns=16191,o0=16192,dC=16193,a0=16194,pC=16195,gC=16196,mC=16197,yC=16198,Hf=16199,Wf=16200,vC=16201,_C=16202,bC=16203,xC=16204,wC=16205,u0=16206,EC=16207,SC=16208,ur=16209,ER=16210,SR=16211,bW=852,xW=592,wW=15,EW=wW,CC=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function SW(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ha=n=>{if(!n)return 1;const t=n.state;return!t||t.strm!==n||t.mode<Jg||t.mode>SR?1:0},CR=n=>{if(Ha(n))return si;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=t.wrap&1),t.mode=Jg,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(bW),t.distcode=t.distdyn=new Int32Array(xW),t.sane=1,t.back=-1,Oa},AR=n=>{if(Ha(n))return si;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,CR(n)},TR=(n,t)=>{let r;if(Ha(n))return si;const i=n.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?si:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,AR(n))},IR=(n,t)=>{if(!n)return si;const r=new SW;n.state=r,r.strm=n,r.window=null,r.mode=Jg;const i=TR(n,t);return i!==Oa&&(n.state=null),i},CW=n=>IR(n,EW);let AC=!0,l0,c0;const AW=n=>{if(AC){l0=new Int32Array(512),c0=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Uc(_R,n.lens,0,288,l0,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Uc(bR,n.lens,0,32,c0,0,n.work,{bits:5}),AC=!1}n.lencode=l0,n.lenbits=9,n.distcode=c0,n.distbits=5},DR=(n,t,r,i)=>{let s;const o=n.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>i&&(s=i),o.window.set(t.subarray(r-i,r-i+s),o.wnext),i-=s,i?(o.window.set(t.subarray(r-i,r),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0},TW=(n,t)=>{let r,i,s,o,a,u,l,c,h,f,d,p,g,y,v=0,T,_,C,E,S,R,w,x;const b=new Uint8Array(4);let A,k;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ha(n)||!n.output||!n.input&&n.avail_in!==0)return si;r=n.state,r.mode===ns&&(r.mode=o0),a=n.next_out,s=n.output,l=n.avail_out,o=n.next_in,i=n.input,u=n.avail_in,c=r.hold,h=r.bits,f=u,d=l,x=Oa;e:for(;;)switch(r.mode){case Jg:if(r.wrap===0){r.mode=o0;break}for(;h<16;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,b[0]=c&255,b[1]=c>>>8&255,r.check=Ti(r.check,b,2,0),c=0,h=0,r.mode=iC;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",r.mode=ur;break}if((c&15)!==nC){n.msg="unknown compression method",r.mode=ur;break}if(c>>>=4,h-=4,w=(c&15)+8,r.wbits===0&&(r.wbits=w),w>15||w>r.wbits){n.msg="invalid window size",r.mode=ur;break}r.dmax=1<<r.wbits,r.flags=0,n.adler=r.check=1,r.mode=c&512?fC:ns,c=0,h=0;break;case iC:for(;h<16;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(r.flags=c,(r.flags&255)!==nC){n.msg="unknown compression method",r.mode=ur;break}if(r.flags&57344){n.msg="unknown header flags set",r.mode=ur;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(b[0]=c&255,b[1]=c>>>8&255,r.check=Ti(r.check,b,2,0)),c=0,h=0,r.mode=sC;case sC:for(;h<32;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(b[0]=c&255,b[1]=c>>>8&255,b[2]=c>>>16&255,b[3]=c>>>24&255,r.check=Ti(r.check,b,4,0)),c=0,h=0,r.mode=oC;case oC:for(;h<16;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(b[0]=c&255,b[1]=c>>>8&255,r.check=Ti(r.check,b,2,0)),c=0,h=0,r.mode=aC;case aC:if(r.flags&1024){for(;h<16;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(b[0]=c&255,b[1]=c>>>8&255,r.check=Ti(r.check,b,2,0)),c=0,h=0}else r.head&&(r.head.extra=null);r.mode=uC;case uC:if(r.flags&1024&&(p=r.length,p>u&&(p=u),p&&(r.head&&(w=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(i.subarray(o,o+p),w)),r.flags&512&&r.wrap&4&&(r.check=Ti(r.check,i,p,o)),u-=p,o+=p,r.length-=p),r.length))break e;r.length=0,r.mode=lC;case lC:if(r.flags&2048){if(u===0)break e;p=0;do w=i[o+p++],r.head&&w&&r.length<65536&&(r.head.name+=String.fromCharCode(w));while(w&&p<u);if(r.flags&512&&r.wrap&4&&(r.check=Ti(r.check,i,p,o)),u-=p,o+=p,w)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=cC;case cC:if(r.flags&4096){if(u===0)break e;p=0;do w=i[o+p++],r.head&&w&&r.length<65536&&(r.head.comment+=String.fromCharCode(w));while(w&&p<u);if(r.flags&512&&r.wrap&4&&(r.check=Ti(r.check,i,p,o)),u-=p,o+=p,w)break e}else r.head&&(r.head.comment=null);r.mode=hC;case hC:if(r.flags&512){for(;h<16;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(r.wrap&4&&c!==(r.check&65535)){n.msg="header crc mismatch",r.mode=ur;break}c=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),n.adler=r.check=0,r.mode=ns;break;case fC:for(;h<32;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}n.adler=r.check=CC(c),c=0,h=0,r.mode=Np;case Np:if(r.havedict===0)return n.next_out=a,n.avail_out=l,n.next_in=o,n.avail_in=u,r.hold=c,r.bits=h,vW;n.adler=r.check=1,r.mode=ns;case ns:if(t===mW||t===qf)break e;case o0:if(r.last){c>>>=h&7,h-=h&7,r.mode=u0;break}for(;h<3;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}switch(r.last=c&1,c>>>=1,h-=1,c&3){case 0:r.mode=dC;break;case 1:if(AW(r),r.mode=Hf,t===qf){c>>>=2,h-=2;break e}break;case 2:r.mode=gC;break;case 3:n.msg="invalid block type",r.mode=ur}c>>>=2,h-=2;break;case dC:for(c>>>=h&7,h-=h&7;h<32;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",r.mode=ur;break}if(r.length=c&65535,c=0,h=0,r.mode=a0,t===qf)break e;case a0:r.mode=pC;case pC:if(p=r.length,p){if(p>u&&(p=u),p>l&&(p=l),p===0)break e;s.set(i.subarray(o,o+p),a),u-=p,o+=p,l-=p,a+=p,r.length-=p;break}r.mode=ns;break;case gC:for(;h<14;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(r.nlen=(c&31)+257,c>>>=5,h-=5,r.ndist=(c&31)+1,c>>>=5,h-=5,r.ncode=(c&15)+4,c>>>=4,h-=4,r.nlen>286||r.ndist>30){n.msg="too many length or distance symbols",r.mode=ur;break}r.have=0,r.mode=mC;case mC:for(;r.have<r.ncode;){for(;h<3;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}r.lens[N[r.have++]]=c&7,c>>>=3,h-=3}for(;r.have<19;)r.lens[N[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},x=Uc(gW,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,x){n.msg="invalid code lengths set",r.mode=ur;break}r.have=0,r.mode=yC;case yC:for(;r.have<r.nlen+r.ndist;){for(;v=r.lencode[c&(1<<r.lenbits)-1],T=v>>>24,_=v>>>16&255,C=v&65535,!(T<=h);){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(C<16)c>>>=T,h-=T,r.lens[r.have++]=C;else{if(C===16){for(k=T+2;h<k;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(c>>>=T,h-=T,r.have===0){n.msg="invalid bit length repeat",r.mode=ur;break}w=r.lens[r.have-1],p=3+(c&3),c>>>=2,h-=2}else if(C===17){for(k=T+3;h<k;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}c>>>=T,h-=T,w=0,p=3+(c&7),c>>>=3,h-=3}else{for(k=T+7;h<k;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}c>>>=T,h-=T,w=0,p=11+(c&127),c>>>=7,h-=7}if(r.have+p>r.nlen+r.ndist){n.msg="invalid bit length repeat",r.mode=ur;break}for(;p--;)r.lens[r.have++]=w}}if(r.mode===ur)break;if(r.lens[256]===0){n.msg="invalid code -- missing end-of-block",r.mode=ur;break}if(r.lenbits=9,A={bits:r.lenbits},x=Uc(_R,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,x){n.msg="invalid literal/lengths set",r.mode=ur;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},x=Uc(bR,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,x){n.msg="invalid distances set",r.mode=ur;break}if(r.mode=Hf,t===qf)break e;case Hf:r.mode=Wf;case Wf:if(u>=6&&l>=258){n.next_out=a,n.avail_out=l,n.next_in=o,n.avail_in=u,r.hold=c,r.bits=h,lW(n,d),a=n.next_out,s=n.output,l=n.avail_out,o=n.next_in,i=n.input,u=n.avail_in,c=r.hold,h=r.bits,r.mode===ns&&(r.back=-1);break}for(r.back=0;v=r.lencode[c&(1<<r.lenbits)-1],T=v>>>24,_=v>>>16&255,C=v&65535,!(T<=h);){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(_&&(_&240)===0){for(E=T,S=_,R=C;v=r.lencode[R+((c&(1<<E+S)-1)>>E)],T=v>>>24,_=v>>>16&255,C=v&65535,!(E+T<=h);){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}c>>>=E,h-=E,r.back+=E}if(c>>>=T,h-=T,r.back+=T,r.length=C,_===0){r.mode=wC;break}if(_&32){r.back=-1,r.mode=ns;break}if(_&64){n.msg="invalid literal/length code",r.mode=ur;break}r.extra=_&15,r.mode=vC;case vC:if(r.extra){for(k=r.extra;h<k;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=_C;case _C:for(;v=r.distcode[c&(1<<r.distbits)-1],T=v>>>24,_=v>>>16&255,C=v&65535,!(T<=h);){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if((_&240)===0){for(E=T,S=_,R=C;v=r.distcode[R+((c&(1<<E+S)-1)>>E)],T=v>>>24,_=v>>>16&255,C=v&65535,!(E+T<=h);){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}c>>>=E,h-=E,r.back+=E}if(c>>>=T,h-=T,r.back+=T,_&64){n.msg="invalid distance code",r.mode=ur;break}r.offset=C,r.extra=_&15,r.mode=bC;case bC:if(r.extra){for(k=r.extra;h<k;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){n.msg="invalid distance too far back",r.mode=ur;break}r.mode=xC;case xC:if(l===0)break e;if(p=d-l,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){n.msg="invalid distance too far back",r.mode=ur;break}p>r.wnext?(p-=r.wnext,g=r.wsize-p):g=r.wnext-p,p>r.length&&(p=r.length),y=r.window}else y=s,g=a-r.offset,p=r.length;p>l&&(p=l),l-=p,r.length-=p;do s[a++]=y[g++];while(--p);r.length===0&&(r.mode=Wf);break;case wC:if(l===0)break e;s[a++]=r.length,l--,r.mode=Wf;break;case u0:if(r.wrap){for(;h<32;){if(u===0)break e;u--,c|=i[o++]<<h,h+=8}if(d-=l,n.total_out+=d,r.total+=d,r.wrap&4&&d&&(n.adler=r.check=r.flags?Ti(r.check,s,d,a-d):sv(r.check,s,d,a-d)),d=l,r.wrap&4&&(r.flags?c:CC(c))!==r.check){n.msg="incorrect data check",r.mode=ur;break}c=0,h=0}r.mode=EC;case EC:if(r.wrap&&r.flags){for(;h<32;){if(u===0)break e;u--,c+=i[o++]<<h,h+=8}if(r.wrap&4&&c!==(r.total&4294967295)){n.msg="incorrect length check",r.mode=ur;break}c=0,h=0}r.mode=SC;case SC:x=yW;break e;case ur:x=xR;break e;case ER:return wR;case SR:default:return si}return n.next_out=a,n.avail_out=l,n.next_in=o,n.avail_in=u,r.hold=c,r.bits=h,(r.wsize||d!==n.avail_out&&r.mode<ur&&(r.mode<u0||t!==rC))&&DR(n,n.output,n.next_out,d-n.avail_out),f-=n.avail_in,d-=n.avail_out,n.total_in+=f,n.total_out+=d,r.total+=d,r.wrap&4&&d&&(n.adler=r.check=r.flags?Ti(r.check,s,d,n.next_out-d):sv(r.check,s,d,n.next_out-d)),n.data_type=r.bits+(r.last?64:0)+(r.mode===ns?128:0)+(r.mode===Hf||r.mode===a0?256:0),(f===0&&d===0||t===rC)&&x===Oa&&(x=_W),x},IW=n=>{if(Ha(n))return si;let t=n.state;return t.window&&(t.window=null),n.state=null,Oa},DW=(n,t)=>{if(Ha(n))return si;const r=n.state;return(r.wrap&2)===0?si:(r.head=t,t.done=!1,Oa)},kW=(n,t)=>{const r=t.length;let i,s,o;return Ha(n)||(i=n.state,i.wrap!==0&&i.mode!==Np)?si:i.mode===Np&&(s=1,s=sv(s,t,r,0),s!==i.check)?xR:(o=DR(n,t,r,r),o?(i.mode=ER,wR):(i.havedict=1,Oa))};var NW=AR,RW=TR,FW=CR,PW=CW,MW=IR,LW=TW,OW=IW,VW=DW,BW=kW,UW="pako inflate (from Nodeca project)",os={inflateReset:NW,inflateReset2:RW,inflateResetKeep:FW,inflateInit:PW,inflateInit2:MW,inflate:LW,inflateEnd:OW,inflateGetHeader:VW,inflateSetDictionary:BW,inflateInfo:UW};function $W(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var jW=$W;const kR=Object.prototype.toString,{Z_NO_FLUSH:GW,Z_FINISH:zW,Z_OK:Fh,Z_STREAM_END:h0,Z_NEED_DICT:f0,Z_STREAM_ERROR:qW,Z_DATA_ERROR:TC,Z_MEM_ERROR:HW}=mR;function em(n){this.options=yR.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new aW,this.strm.avail_out=0;let r=os.inflateInit2(this.strm,t.windowBits);if(r!==Fh)throw new Error(ov[r]);if(this.header=new jW,os.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=av.string2buf(t.dictionary):kR.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=os.inflateSetDictionary(this.strm,t.dictionary),r!==Fh)))throw new Error(ov[r])}em.prototype.push=function(n,t){const r=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let o,a,u;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?zW:GW,kR.call(n)==="[object ArrayBuffer]"?r.input=new Uint8Array(n):r.input=n,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),o=os.inflate(r,a),o===f0&&s&&(o=os.inflateSetDictionary(r,s),o===Fh?o=os.inflate(r,a):o===TC&&(o=f0));r.avail_in>0&&o===h0&&r.state.wrap>0&&n[r.next_in]!==0;)os.inflateReset(r),o=os.inflate(r,a);switch(o){case qW:case TC:case f0:case HW:return this.onEnd(o),this.ended=!0,!1}if(u=r.avail_out,r.next_out&&(r.avail_out===0||o===h0))if(this.options.to==="string"){let l=av.utf8border(r.output,r.next_out),c=r.next_out-l,h=av.buf2string(r.output,l);r.next_out=c,r.avail_out=i-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===Fh&&u===0)){if(o===h0)return o=os.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};em.prototype.onData=function(n){this.chunks.push(n)};em.prototype.onEnd=function(n){n===Fh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=yR.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function WW(n,t){const r=new em(t);if(r.push(n),r.err)throw r.msg||ov[r.err];return r.result}var KW=WW,YW={inflate:KW};const{inflate:XW}=YW;var ZW=XW;const NR={inflate:ZW};var Pe={};Pe.parse=function(n){var t=Pe.B,r=function(E,S,R,w){var x=Pe.T,b={cmap:x.cmap,head:x.head,hhea:x.hhea,maxp:x.maxp,hmtx:x.hmtx,name:x.name,"OS/2":x.OS2,post:x.post,loca:x.loca,kern:x.kern,glyf:x.glyf,"CFF ":x.CFF,GSUB:x.GSUB,CBLC:x.CBLC,CBDT:x.CBDT,"SVG ":x.SVG,COLR:x.colr,CPAL:x.cpal,sbix:x.sbix,fvar:x.fvar,gvar:x.gvar,avar:x.avar,HVAR:x.HVAR},A={_data:E,_index:S,_offset:R};for(var k in b){var N=Pe.findTable(E,k,R);if(N){var I=N[0],j=w[I];j==null&&(j=b[k].parseTab(E,I,N[1],A)),A[k]=w[I]=j}}return A};function i(E){var S=t.readUshort(E,12),R=t.readUint(E,16),w=new Uint8Array(R),x=12+S*16;t.writeASCII(w,0,"OTTO"),t.writeUshort(w,4,S);for(var b=44,A=0;A<S;A++){var k=t.readASCII(E,b,4),N=t.readUint(E,b+4),I=t.readUint(E,b+8),j=t.readUint(E,b+12);b+=20;var Q=E.slice(N,N+I);I!=j&&(Q=NR.inflate(Q));var le=12+A*16;t.writeASCII(w,le,k),t.writeUint(w,le+8,x),t.writeUint(w,le+12,j),w.set(Q,x),x+=j}return w}var s=new Uint8Array(n);let o;s[0]==119&&(o=s,s=i(s));var a={},u=t.readASCII(s,0,4);if(u=="ttcf"){var l=4;t.readUshort(s,l),l+=2,t.readUshort(s,l),l+=2;var c=t.readUint(s,l);l+=4;for(var h=[],f=0;f<c;f++){var d=t.readUint(s,l);l+=4,h.push(r(s,f,d,a))}return h}var p=r(s,0,0,a);p._compressedData=o;var g=p.fvar;if(g){for(var y=[p],f=0;f<g[1].length;f++){var v=g[1][f],T={};y.push(T);for(var _ in p)T[_]=p[_];T._index=f;var C=T.name=JSON.parse(JSON.stringify(T.name));C.fontSubfamily=v[0],v[3]==null&&(v[3]=(C.fontFamily+"-"+C.fontSubfamily).replaceAll(" ","")),C.postScriptName=v[3]}return y}return[p]};Pe.findTable=function(n,t,r){for(var i=Pe.B,s=i.readUshort(n,r+4),o=r+12,a=0;a<s;a++){var u=i.readASCII(n,o,4);i.readUint(n,o+4);var l=i.readUint(n,o+8),c=i.readUint(n,o+12);if(u==t)return[l,c];o+=16}return null};Pe.T={};Pe.B={readFixed:function(n,t){return(n[t]<<8|n[t+1])+(n[t+2]<<8|n[t+3])/(256*256+4)},readF2dot14:function(n,t){var r=Pe.B.readShort(n,t);return r/16384},readInt:function(n,t){var r=Pe.B.t.uint8;return r[0]=n[t+3],r[1]=n[t+2],r[2]=n[t+1],r[3]=n[t],Pe.B.t.int32[0]},readInt8:function(n,t){var r=Pe.B.t.uint8;return r[0]=n[t],Pe.B.t.int8[0]},readShort:function(n,t){var r=Pe.B.t.uint16;return r[0]=n[t]<<8|n[t+1],Pe.B.t.int16[0]},readUshort:function(n,t){return n[t]<<8|n[t+1]},writeUshort:function(n,t,r){n[t]=r>>8&255,n[t+1]=r&255},readUshorts:function(n,t,r){for(var i=[],s=0;s<r;s++){var o=Pe.B.readUshort(n,t+s*2);i.push(o)}return i},readUint:function(n,t){var r=Pe.B.t.uint8;return r[3]=n[t],r[2]=n[t+1],r[1]=n[t+2],r[0]=n[t+3],Pe.B.t.uint32[0]},writeUint:function(n,t,r){n[t]=r>>24&255,n[t+1]=r>>16&255,n[t+2]=r>>8&255,n[t+3]=r>>0&255},readUint64:function(n,t){return Pe.B.readUint(n,t)*4294967296+Pe.B.readUint(n,t+4)},readASCII:function(n,t,r){for(var i="",s=0;s<r;s++)i+=String.fromCharCode(n[t+s]);return i},writeASCII:function(n,t,r){for(var i=0;i<r.length;i++)n[t+i]=r.charCodeAt(i)},readUnicode:function(n,t,r){for(var i="",s=0;s<r;s++){var o=n[t++]<<8|n[t++];i+=String.fromCharCode(o)}return i},_tdec:window.TextDecoder?new window.TextDecoder:null,readUTF8:function(n,t,r){var i=Pe.B._tdec;return i&&t==0&&r==n.length?i.decode(n):Pe.B.readASCII(n,t,r)},readBytes:function(n,t,r){for(var i=[],s=0;s<r;s++)i.push(n[t+s]);return i},readASCIIArray:function(n,t,r){for(var i=[],s=0;s<r;s++)i.push(String.fromCharCode(n[t+s]));return i},t:function(){var n=new ArrayBuffer(8);return{buff:n,int8:new Int8Array(n),uint8:new Uint8Array(n),int16:new Int16Array(n),uint16:new Uint16Array(n),int32:new Int32Array(n),uint32:new Uint32Array(n)}}()};Pe.T.CFF={parseTab:function(n,t,r){var i=Pe.B,s=Pe.T.CFF;n=new Uint8Array(n.buffer,t,r),t=0,n[t],t++,n[t],t++,n[t],t++,n[t],t++;var o=[];t=s.readIndex(n,t,o);for(var a=[],u=0;u<o.length-1;u++)a.push(i.readASCII(n,t+o[u],o[u+1]-o[u]));t+=o[o.length-1];var l=[];t=s.readIndex(n,t,l);for(var c=[],u=0;u<l.length-1;u++)c.push(s.readDict(n,t+l[u],t+l[u+1]));t+=l[l.length-1];var h=c[0],f=[];t=s.readIndex(n,t,f);for(var d=[],u=0;u<f.length-1;u++)d.push(i.readASCII(n,t+f[u],f[u+1]-f[u]));if(t+=f[f.length-1],s.readSubrs(n,t,h),h.CharStrings&&(h.CharStrings=s.readBytes(n,h.CharStrings)),h.ROS){t=h.FDArray;var p=[];t=s.readIndex(n,t,p),h.FDArray=[];for(var u=0;u<p.length-1;u++){var g=s.readDict(n,t+p[u],t+p[u+1]);s._readFDict(n,g,d),h.FDArray.push(g)}t+=p[p.length-1],t=h.FDSelect,h.FDSelect=[];var y=n[t];if(t++,y==3){var v=i.readUshort(n,t);t+=2;for(var u=0;u<v+1;u++)h.FDSelect.push(i.readUshort(n,t),n[t+2]),t+=3}else throw y}return h.charset&&(h.charset=s.readCharset(n,h.charset,h.CharStrings.length)),s._readFDict(n,h,d),h},_readFDict:function(n,t,r){var i=Pe.T.CFF,s;t.Private&&(s=t.Private[1],t.Private=i.readDict(n,s,s+t.Private[0]),t.Private.Subrs&&i.readSubrs(n,s+t.Private.Subrs,t.Private));for(var o in t)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)!=-1&&(t[o]=r[t[o]-426+35])},readSubrs:function(n,t,r){r.Subrs=Pe.T.CFF.readBytes(n,t);var i,s=r.Subrs.length+1;s<1240?i=107:s<33900?i=1131:i=32768,r.Bias=i},readBytes:function(n,t){Pe.B;var r=[];t=Pe.T.CFF.readIndex(n,t,r);for(var i=[],s=r.length-1,o=n.byteOffset+t,a=0;a<s;a++){var u=r[a];i.push(new Uint8Array(n.buffer,o+u,r[a+1]-u))}return i},tableSE:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],glyphByUnicode:function(n,t){for(var r=0;r<n.charset.length;r++)if(n.charset[r]==t)return r;return-1},glyphBySE:function(n,t){return t<0||t>255?-1:Pe.T.CFF.glyphByUnicode(n,Pe.T.CFF.tableSE[t])},readCharset:function(n,t,r){var i=Pe.B,s=[".notdef"],o=n[t];if(t++,o==0)for(var a=0;a<r;a++){var u=i.readUshort(n,t);t+=2,s.push(u)}else if(o==1||o==2)for(;s.length<r;){var u=i.readUshort(n,t);t+=2;var l=0;o==1?(l=n[t],t++):(l=i.readUshort(n,t),t+=2);for(var a=0;a<=l;a++)s.push(u),u++}else throw"error: format: "+o;return s},readIndex:function(n,t,r){var i=Pe.B,s=i.readUshort(n,t)+1;t+=2;var o=n[t];if(t++,o==1)for(var a=0;a<s;a++)r.push(n[t+a]);else if(o==2)for(var a=0;a<s;a++)r.push(i.readUshort(n,t+a*2));else if(o==3)for(var a=0;a<s;a++)r.push(i.readUint(n,t+a*3-1)&16777215);else if(o==4)for(var a=0;a<s;a++)r.push(i.readUint(n,t+a*4));else if(s!=1)throw"unsupported offset size: "+o+", count: "+s;return t+=s*o,t-1},getCharString:function(n,t,r){var i=Pe.B,s=n[t],o=n[t+1];n[t+2],n[t+3],n[t+4];var a=1,u=null,l=null;s<=20&&(u=s,a=1),s==12&&(u=s*100+o,a=2),21<=s&&s<=27&&(u=s,a=1),s==28&&(l=i.readShort(n,t+1),a=3),29<=s&&s<=31&&(u=s,a=1),32<=s&&s<=246&&(l=s-139,a=1),247<=s&&s<=250&&(l=(s-247)*256+o+108,a=2),251<=s&&s<=254&&(l=-(s-251)*256-o-108,a=2),s==255&&(l=i.readInt(n,t+1)/65535,a=5),r.val=l??"o"+u,r.size=a},readCharString:function(n,t,r){for(var i=t+r,s=Pe.B,o=[];t<i;){var a=n[t],u=n[t+1];n[t+2],n[t+3],n[t+4];var l=1,c=null,h=null;a<=20&&(c=a,l=1),a==12&&(c=a*100+u,l=2),(a==19||a==20)&&(c=a,l=2),21<=a&&a<=27&&(c=a,l=1),a==28&&(h=s.readShort(n,t+1),l=3),29<=a&&a<=31&&(c=a,l=1),32<=a&&a<=246&&(h=a-139,l=1),247<=a&&a<=250&&(h=(a-247)*256+u+108,l=2),251<=a&&a<=254&&(h=-(a-251)*256-u-108,l=2),a==255&&(h=s.readInt(n,t+1)/65535,l=5),o.push(h??"o"+c),t+=l}return o},readDict:function(n,t,r){for(var i=Pe.B,s={},o=[];t<r;){var a=n[t],u=n[t+1];n[t+2],n[t+3],n[t+4];var l=1,c=null,h=null;if(a==28&&(h=i.readShort(n,t+1),l=3),a==29&&(h=i.readInt(n,t+1),l=5),32<=a&&a<=246&&(h=a-139,l=1),247<=a&&a<=250&&(h=(a-247)*256+u+108,l=2),251<=a&&a<=254&&(h=-(a-251)*256-u-108,l=2),a==255)throw h=i.readInt(n,t+1)/65535,l=5,"unknown number";if(a==30){var f=[];for(l=1;;){var d=n[t+l];l++;var p=d>>4,g=d&15;if(p!=15&&f.push(p),g!=15&&f.push(g),g==15)break}for(var y="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],T=0;T<f.length;T++)y+=v[f[T]];h=parseFloat(y)}if(a<=21){var _=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"];if(c=_[a],l=1,a==12){var _=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold","","","LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend","","","","","","","ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"];c=_[u],l=2}}c!=null?(s[c]=o.length==1?o[0]:o,o=[]):o.push(h),t+=l}return s}};Pe.T.cmap={parseTab:function(n,t,r){var i={tables:[],ids:{},off:t};n=new Uint8Array(n.buffer,t,r),t=0;var s=Pe.B,o=s.readUshort,a=Pe.T.cmap;o(n,t),t+=2;var u=o(n,t);t+=2;for(var l=[],c=0;c<u;c++){var h=o(n,t);t+=2;var f=o(n,t);t+=2;var d=s.readUint(n,t);t+=4;var p="p"+h+"e"+f,g=l.indexOf(d);if(g==-1){g=i.tables.length;var y={};l.push(d);var v=y.format=o(n,d);v==0?y=a.parse0(n,d,y):v==4?y=a.parse4(n,d,y):v==6?y=a.parse6(n,d,y):v==12&&(y=a.parse12(n,d,y)),i.tables.push(y)}i.ids[p]!=null&&console.log("multiple tables for one platform+encoding: "+p),i.ids[p]=g}return i},parse0:function(n,t,r){var i=Pe.B;t+=2;var s=i.readUshort(n,t);t+=2,i.readUshort(n,t),t+=2,r.map=[];for(var o=0;o<s-6;o++)r.map.push(n[t+o]);return r},parse4:function(n,t,r){var i=Pe.B,s=i.readUshort,o=i.readUshorts,a=t;t+=2;var u=s(n,t);t+=2,s(n,t),t+=2;var l=s(n,t);t+=2;var c=l>>>1;r.searchRange=s(n,t),t+=2,r.entrySelector=s(n,t),t+=2,r.rangeShift=s(n,t),t+=2,r.endCount=o(n,t,c),t+=c*2,t+=2,r.startCount=o(n,t,c),t+=c*2,r.idDelta=[];for(var h=0;h<c;h++)r.idDelta.push(i.readShort(n,t)),t+=2;return r.idRangeOffset=o(n,t,c),t+=c*2,r.glyphIdArray=o(n,t,a+u-t>>1),r},parse6:function(n,t,r){var i=Pe.B;t+=2,i.readUshort(n,t),t+=2,i.readUshort(n,t),t+=2,r.firstCode=i.readUshort(n,t),t+=2;var s=i.readUshort(n,t);t+=2,r.glyphIdArray=[];for(var o=0;o<s;o++)r.glyphIdArray.push(i.readUshort(n,t)),t+=2;return r},parse12:function(n,t,r){var i=Pe.B,s=i.readUint;t+=4,s(n,t),t+=4,s(n,t),t+=4;var o=s(n,t)*3;t+=4;for(var a=r.groups=new Uint32Array(o),u=0;u<o;u+=3)a[u]=s(n,t+(u<<2)),a[u+1]=s(n,t+(u<<2)+4),a[u+2]=s(n,t+(u<<2)+8);return r}};Pe.T.CBLC={parseTab:function(n,t,r){var i=Pe.B,s=t;i.readUshort(n,t),t+=2,i.readUshort(n,t),t+=2;var o=i.readUint(n,t);t+=4;for(var a=[],u=0;u<o;u++){var l=i.readUint(n,t);t+=4,i.readUint(n,t),t+=4,i.readUint(n,t),t+=4,t+=4,t+=24,i.readUshort(n,t),t+=2,i.readUshort(n,t),t+=2,t+=4;for(var c=s+l,h=0;h<3;h++){var f=i.readUshort(n,c);c+=2;var d=i.readUshort(n,c);c+=2;var p=i.readUint(n,c);c+=4;var g=d-f+1,y=s+l+p,v=i.readUshort(n,y);if(y+=2,v!=1)throw v;var T=i.readUshort(n,y);y+=2;var _=i.readUint(n,y);y+=4;for(var C=[],E=0;E<g;E++){var S=i.readUint(n,y+E*4);C.push(_+S)}a.push([f,d,T,C])}}return a}};Pe.T.CBDT={parseTab:function(n,t,r){return Pe.B,new Uint8Array(n.buffer,n.byteOffset+t,r)}};Pe.T.glyf={parseTab:function(n,t,r,i){for(var s=[],o=i.maxp.numGlyphs,a=0;a<o;a++)s.push(null);return s},_parseGlyf:function(n,t){var r=Pe.B,i=n._data,s=n.loca;if(s[t]==s[t+1])return null;var o=Pe.findTable(i,"glyf",n._offset)[0]+s[t],a={};if(a.noc=r.readShort(i,o),o+=2,a.xMin=r.readShort(i,o),o+=2,a.yMin=r.readShort(i,o),o+=2,a.xMax=r.readShort(i,o),o+=2,a.yMax=r.readShort(i,o),o+=2,a.xMin>=a.xMax||a.yMin>=a.yMax)return null;if(a.noc>0){a.endPts=[];for(var u=0;u<a.noc;u++)a.endPts.push(r.readUshort(i,o)),o+=2;var l=r.readUshort(i,o);if(o+=2,i.length-o<l)return null;a.instructions=r.readBytes(i,o,l),o+=l;var c=a.endPts[a.noc-1]+1;a.flags=[];for(var u=0;u<c;u++){var h=i[o];if(o++,a.flags.push(h),(h&8)!=0){var f=i[o];o++;for(var d=0;d<f;d++)a.flags.push(h),u++}}a.xs=[];for(var u=0;u<c;u++){var p=(a.flags[u]&2)!=0,g=(a.flags[u]&16)!=0;p?(a.xs.push(g?i[o]:-i[o]),o++):g?a.xs.push(0):(a.xs.push(r.readShort(i,o)),o+=2)}a.ys=[];for(var u=0;u<c;u++){var p=(a.flags[u]&4)!=0,g=(a.flags[u]&32)!=0;p?(a.ys.push(g?i[o]:-i[o]),o++):g?a.ys.push(0):(a.ys.push(r.readShort(i,o)),o+=2)}for(var y=0,v=0,u=0;u<c;u++)y+=a.xs[u],v+=a.ys[u],a.xs[u]=y,a.ys[u]=v}else{var T=1,_=2,C=8,E=32,S=64,R=128,w=256;a.parts=[];var x;do{x=r.readUshort(i,o),o+=2;var b={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(a.parts.push(b),b.glyphIndex=r.readUshort(i,o),o+=2,x&T){var A=r.readShort(i,o);o+=2;var k=r.readShort(i,o);o+=2}else{var A=r.readInt8(i,o);o++;var k=r.readInt8(i,o);o++}x&_?(b.m.tx=A,b.m.ty=k):(b.p1=A,b.p2=k),x&C?(b.m.a=b.m.d=r.readF2dot14(i,o),o+=2):x&S?(b.m.a=r.readF2dot14(i,o),o+=2,b.m.d=r.readF2dot14(i,o),o+=2):x&R&&(b.m.a=r.readF2dot14(i,o),o+=2,b.m.b=r.readF2dot14(i,o),o+=2,b.m.c=r.readF2dot14(i,o),o+=2,b.m.d=r.readF2dot14(i,o),o+=2)}while(x&E);if(x&w){var N=r.readUshort(i,o);o+=2,a.instr=[];for(var u=0;u<N;u++)a.instr.push(i[o]),o++}}return a}};Pe.T.head={parseTab:function(n,t,r){var i=Pe.B,s={};return i.readFixed(n,t),t+=4,s.fontRevision=i.readFixed(n,t),t+=4,i.readUint(n,t),t+=4,i.readUint(n,t),t+=4,s.flags=i.readUshort(n,t),t+=2,s.unitsPerEm=i.readUshort(n,t),t+=2,s.created=i.readUint64(n,t),t+=8,s.modified=i.readUint64(n,t),t+=8,s.xMin=i.readShort(n,t),t+=2,s.yMin=i.readShort(n,t),t+=2,s.xMax=i.readShort(n,t),t+=2,s.yMax=i.readShort(n,t),t+=2,s.macStyle=i.readUshort(n,t),t+=2,s.lowestRecPPEM=i.readUshort(n,t),t+=2,s.fontDirectionHint=i.readShort(n,t),t+=2,s.indexToLocFormat=i.readShort(n,t),t+=2,s.glyphDataFormat=i.readShort(n,t),t+=2,s}};Pe.T.hhea={parseTab:function(n,t,r){var i=Pe.B,s={};i.readFixed(n,t),t+=4;for(var o=["ascender","descender","lineGap","advanceWidthMax","minLeftSideBearing","minRightSideBearing","xMaxExtent","caretSlopeRise","caretSlopeRun","caretOffset","res0","res1","res2","res3","metricDataFormat","numberOfHMetrics"],a=0;a<o.length;a++){var u=o[a],l=u=="advanceWidthMax"||u=="numberOfHMetrics"?i.readUshort:i.readShort;s[u]=l(n,t+a*2)}return s}};Pe.T.hmtx={parseTab:function(n,t,r,i){for(var s=Pe.B,o=[],a=[],u=i.maxp.numGlyphs,l=i.hhea.numberOfHMetrics,c=0,h=0,f=0;f<l;)c=s.readUshort(n,t+(f<<2)),h=s.readShort(n,t+(f<<2)+2),o.push(c),a.push(h),f++;for(;f<u;)o.push(c),a.push(h),f++;return{aWidth:o,lsBearing:a}}};Pe.T.kern={parseTab:function(n,t,r,i){var s=Pe.B,o=Pe.T.kern,a=s.readUshort(n,t);if(a==1)return o.parseV1(n,t,r,i);var u=s.readUshort(n,t+2);t+=4;for(var l={glyph1:[],rval:[]},c=0;c<u;c++){t+=2;var r=s.readUshort(n,t);t+=2;var h=s.readUshort(n,t);t+=2;var f=h>>>8;f&=15,f==0&&(t=o.readFormat0(n,t,l))}return l},parseV1:function(n,t,r,i){var s=Pe.B,o=Pe.T.kern;s.readFixed(n,t);var a=s.readUint(n,t+4);t+=8;for(var u={glyph1:[],rval:[]},l=0;l<a;l++){s.readUint(n,t),t+=4;var c=s.readUshort(n,t);t+=2,s.readUshort(n,t),t+=2;var h=c&255;h==0&&(t=o.readFormat0(n,t,u))}return u},readFormat0:function(n,t,r){var i=Pe.B,s=i.readUshort,o=-1,a=s(n,t);s(n,t+2),s(n,t+4),s(n,t+6),t+=8;for(var u=0;u<a;u++){var l=s(n,t);t+=2;var c=s(n,t);t+=2;var h=i.readShort(n,t);t+=2,l!=o&&(r.glyph1.push(l),r.rval.push({glyph2:[],vals:[]}));var f=r.rval[r.rval.length-1];f.glyph2.push(c),f.vals.push(h),o=l}return t}};Pe.T.loca={parseTab:function(n,t,r,i){var s=Pe.B,o=[],a=i.head.indexToLocFormat,u=i.maxp.numGlyphs+1;if(a==0)for(var l=0;l<u;l++)o.push(s.readUshort(n,t+(l<<1))<<1);if(a==1)for(var l=0;l<u;l++)o.push(s.readUint(n,t+(l<<2)));return o}};Pe.T.maxp={parseTab:function(n,t,r){var i=Pe.B,s=i.readUshort,o={};return i.readUint(n,t),t+=4,o.numGlyphs=s(n,t),t+=2,o}};Pe.T.name={parseTab:function(n,t,r){var i=Pe.B,s={};i.readUshort(n,t),t+=2;var o=i.readUshort(n,t);t+=2;var a=i.readUshort(n,t);t+=2;for(var u=t-6+a,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=i.readUshort,h=0;h<o;h++){var f=c(n,t);t+=2;var d=c(n,t);t+=2;var p=c(n,t);t+=2;var g=c(n,t);t+=2;var y=c(n,t);t+=2;var v=c(n,t);t+=2;var T=u+v,_;f==0||f==3&&d==0||f==1&&d==25?_=i.readUnicode(n,T,y/2):d==0?_=i.readASCII(n,T,y):d==1||d==3||d==4||d==5||d==10?_=i.readUnicode(n,T,y/2):f==1?(_=i.readASCII(n,T,y),console.log("reading unknown MAC encoding "+d+" as ASCII")):(console.log("unknown encoding "+d+", platformID: "+f),_=i.readASCII(n,T,y));var C="p"+f+","+p.toString(16);s[C]==null&&(s[C]={});var E=l[g];E==null&&(E="_"+g),s[C][E]=_,s[C]._lang=p}var S=Pe.T.name.selectOne(s),R="fontFamily";if(S[R]==null)for(var w in s)s[w][R]!=null&&(S[R]=s[w][R]);return S},selectOne:function(n){var t="postScriptName";for(var r in n)if(n[r][t]!=null&&n[r]._lang==1033)return n[r];for(var r in n)if(n[r][t]!=null&&n[r]._lang==0)return n[r];for(var r in n)if(n[r][t]!=null&&n[r]._lang==3084)return n[r];for(var r in n)if(n[r][t]!=null)return n[r];var i;for(var r in n){i=n[r];break}return console.log("returning name table with languageID "+i._lang),i[t]==null&&i.ID!=null&&(i[t]=i.ID),i}};Pe.T.OS2={parseTab:function(n,t,r){var i=Pe.B,s=i.readUshort(n,t);t+=2;var o=Pe.T.OS2,a={};if(s==0)o.version0(n,t,a);else if(s==1)o.version1(n,t,a);else if(s==2||s==3||s==4)o.version2(n,t,a);else if(s==5)o.version5(n,t,a);else throw"unknown OS/2 table version: "+s;return a},version0:function(n,t,r){var i=Pe.B;return r.xAvgCharWidth=i.readShort(n,t),t+=2,r.usWeightClass=i.readUshort(n,t),t+=2,r.usWidthClass=i.readUshort(n,t),t+=2,r.fsType=i.readUshort(n,t),t+=2,r.ySubscriptXSize=i.readShort(n,t),t+=2,r.ySubscriptYSize=i.readShort(n,t),t+=2,r.ySubscriptXOffset=i.readShort(n,t),t+=2,r.ySubscriptYOffset=i.readShort(n,t),t+=2,r.ySuperscriptXSize=i.readShort(n,t),t+=2,r.ySuperscriptYSize=i.readShort(n,t),t+=2,r.ySuperscriptXOffset=i.readShort(n,t),t+=2,r.ySuperscriptYOffset=i.readShort(n,t),t+=2,r.yStrikeoutSize=i.readShort(n,t),t+=2,r.yStrikeoutPosition=i.readShort(n,t),t+=2,r.sFamilyClass=i.readShort(n,t),t+=2,r.panose=i.readBytes(n,t,10),t+=10,r.ulUnicodeRange1=i.readUint(n,t),t+=4,r.ulUnicodeRange2=i.readUint(n,t),t+=4,r.ulUnicodeRange3=i.readUint(n,t),t+=4,r.ulUnicodeRange4=i.readUint(n,t),t+=4,r.achVendID=i.readASCII(n,t,4),t+=4,r.fsSelection=i.readUshort(n,t),t+=2,r.usFirstCharIndex=i.readUshort(n,t),t+=2,r.usLastCharIndex=i.readUshort(n,t),t+=2,r.sTypoAscender=i.readShort(n,t),t+=2,r.sTypoDescender=i.readShort(n,t),t+=2,r.sTypoLineGap=i.readShort(n,t),t+=2,r.usWinAscent=i.readUshort(n,t),t+=2,r.usWinDescent=i.readUshort(n,t),t+=2,t},version1:function(n,t,r){var i=Pe.B;return t=Pe.T.OS2.version0(n,t,r),r.ulCodePageRange1=i.readUint(n,t),t+=4,r.ulCodePageRange2=i.readUint(n,t),t+=4,t},version2:function(n,t,r){var i=Pe.B,s=i.readUshort;return t=Pe.T.OS2.version1(n,t,r),r.sxHeight=i.readShort(n,t),t+=2,r.sCapHeight=i.readShort(n,t),t+=2,r.usDefault=s(n,t),t+=2,r.usBreak=s(n,t),t+=2,r.usMaxContext=s(n,t),t+=2,t},version5:function(n,t,r){var i=Pe.B.readUshort;return t=Pe.T.OS2.version2(n,t,r),r.usLowerOpticalPointSize=i(n,t),t+=2,r.usUpperOpticalPointSize=i(n,t),t+=2,t}};Pe.T.post={parseTab:function(n,t,r){var i=Pe.B,s={};return s.version=i.readFixed(n,t),t+=4,s.italicAngle=i.readFixed(n,t),t+=4,s.underlinePosition=i.readShort(n,t),t+=2,s.underlineThickness=i.readShort(n,t),t+=2,s}};Pe.T.SVG={parseTab:function(n,t,r){var i=Pe.B,s={entries:[],svgs:[]},o=t;i.readUshort(n,t),t+=2;var a=i.readUint(n,t);t+=4,i.readUint(n,t),t+=4,t=a+o;var u=i.readUshort(n,t);t+=2;for(var l=0;l<u;l++){var c=i.readUshort(n,t);t+=2;var h=i.readUshort(n,t);t+=2;var f=i.readUint(n,t);t+=4;var d=i.readUint(n,t);t+=4;var p=new Uint8Array(n.buffer,o+f+a,d);p[0]==31&&p[1]==139&&p[2]==8&&(p=NR.inflate(p));for(var g=i.readUTF8(p,0,p.length),y=c;y<=h;y++)s.entries[y]=s.svgs.length;s.svgs.push(g)}return s}};Pe.T.sbix={parseTab:function(n,t,r,i){for(var s=i.maxp.numGlyphs,o=t,a=Pe.B,u=a.readUint(n,t+4),l=[],c=u-1;c<u;c++)for(var h=o+a.readUint(n,t+8+c*4),f=0;f<s;f++){var d=a.readUint(n,h+4+f*4),p=a.readUint(n,h+4+f*4+4);if(d==p){l[f]=null;continue}var g=h+d,y=a.readASCII(n,g+4,4);if(y!="png ")throw y;l[f]=new Uint8Array(n.buffer,n.byteOffset+g+8,p-d-8)}return l}};Pe.T.colr={parseTab:function(n,t,r){var i=Pe.B,s=t;t+=2;var o=i.readUshort(n,t);t+=2;var a=i.readUint(n,t);t+=4;var u=i.readUint(n,t);t+=4;var l=i.readUshort(n,t);t+=2;for(var c={},h=s+a,f=0;f<o;f++)c["g"+i.readUshort(n,h)]=[i.readUshort(n,h+2),i.readUshort(n,h+4)],h+=6;var d=[];h=s+u;for(var f=0;f<l;f++)d.push(i.readUshort(n,h),i.readUshort(n,h+2)),h+=4;return[c,d]}};Pe.T.cpal={parseTab:function(n,t,r){var i=Pe.B,s=t,o=i.readUshort(n,t);if(t+=2,o==0){i.readUshort(n,t),t+=2,i.readUshort(n,t),t+=2;var a=i.readUshort(n,t);t+=2;var u=i.readUint(n,t);return t+=4,new Uint8Array(n.buffer,s+u,a*4)}else throw o}};Pe.T.GSUB={parseTab:function(n,t,r,i){var s=Pe.B,o=s.readUshort;s.readUint;var a=t;o(n,a),a+=2,o(n,a),a+=2,o(n,a),a+=2;var u=o(n,a);a+=2,o(n,a),a+=2,a=t+u;var l={},c=o(n,a);a+=2;for(var h=0;h<c;h++){var f=s.readASCII(n,a,4);a+=4,o(n,a),a+=2,l[f]=!0}return l}};Pe.T.fvar={parseTab:function(n,t,r,i){var s=i.name,o=t,a=Pe.B,u=[],l=[];o+=8;var c=a.readUshort(n,o);o+=2,o+=2;var h=a.readUshort(n,o);o+=2;var f=a.readUshort(n,o);o+=2;for(var d=0;d<c;d++){var p=a.readASCII(n,o,4),g=a.readFixed(n,o+4),y=a.readFixed(n,o+8),v=a.readFixed(n,o+12),T=a.readUshort(n,o+16),_=a.readUshort(n,o+18);u.push([p,g,y,v,T,s["_"+_]]),o+=20}for(var d=0;d<h;d++){for(var C=a.readUshort(n,o),E=null,T=a.readUshort(n,o+2),S=[],R=0;R<c;R++)S.push(a.readFixed(n,o+4+R*4));o+=4+c*4,(f&3)==2&&(E=a.readUshort(n,o),o+=2),l.push([s["_"+C],T,S,E])}return[u,l]}};Pe.T.gvar=function(){var n=32768,t=16384,r=8192,i=128,s=64,o=128,a=32768,u=Pe.B;function l(d,p,g){for(var y=[],v=0;v<g;v++)y.push(u.readF2dot14(d,p+v*2));return y}function c(d,p,g,y,v){for(var T=[],_=0;_<g;_++){var C=u.readUshort(d,p);p+=2;var E=u.readUshort(d,p),S=E&61440;E=E&4095,p+=2;var R=null,w=null,x=null;S&n&&(R=l(d,p,y),p+=y*2),S&t&&(w=l(d,p,y),p+=y*2),S&t&&(x=l(d,p,y),p+=y*2),T.push([C,E,S,w,R,x])}return T}function h(d,p,g){var y=d[p];if(p++,y==0)return[[],p];127<y&&(y=(y&127)<<8|d[p++]);for(var v=[],T=0;v.length<y;){var _=d[p];p++;var C=(_&o)!=0;_=(_&127)+1;for(var E=0;E<_;E++){var S=0;C?(S=u.readUshort(d,p),p+=2):(S=d[p],p++),T+=S,v.push(T)}}return[v,p]}function f(d,p,g,y){var v=p+4,T=u.readUshort(d,v);v+=2;var _=u.readUshort(d,v);v+=2;var C=u.readUint(d,v);v+=4;var E=u.readUshort(d,v);v+=2,u.readUshort(d,v),v+=2;var S=u.readUint(d,v);v+=4;for(var R=[],w=0;w<E+1;w++)R.push(u.readUint(d,v+w*4));var x=[],b=[],A=[];v=p+C;for(var w=0;w<_;w++){var k=l(d,v+w*T*2,T),N=[],I=[];x.push(k),b.push(N),A.push(I);for(var j=0;j<T;j++)N[j]=Math.min(k[j],0),I[j]=Math.max(k[j],0)}for(var Q=new Int8Array(d.buffer),le=[],w=0;w<E;w++){v=p+S+R[w];var fe=u.readUshort(d,v);v+=2;var ne=fe&a;fe&=4095;var oe=u.readUshort(d,v);v+=2;var ie=c(d,v,fe,T),ue=[];le.push(ue),v=p+S+R[w]+oe;var ee=null;if(ne){var ve=h(d,v);ee=ve[0],v=ve[1]}for(var ge=0;ge<fe;ge++){var we=ie[ge],Se=v+we[0],ae=ee;if(we[2]&r){var ve=h(d,v);ae=ve[0],v=ve[1]}for(var xe=[];v<Se;){var ce=d[v++],he=(ce&63)+1;if(ce&i)for(var j=0;j<he;j++)xe.push(0);else if(ce&s){for(var j=0;j<he;j++)xe.push(u.readShort(d,v+j*2));v+=he*2}else{for(var j=0;j<he;j++)xe.push(Q[v+j]);v+=he}}var ye=we[1];if(ue.push([[we[3]?we[3]:b[ye],we[4]?we[4]:x[ye],we[5]?we[5]:A[ye]],xe,ae.length==0?null:ae]),ae.length!=0&&ae.length*2!=xe.length)throw"e"}}return le}return{parseTab:f}}();Pe.T.avar={parseTab:function(n,t,r,i){var s=t,o=Pe.B,a=[];s+=6;var u=o.readUshort(n,s);s+=2;for(var l=0;l<u;l++){var c=o.readUshort(n,s);s+=2;var h=[];a.push(h);for(var f=0;f<c;f++){var d=o.readF2dot14(n,s),p=o.readF2dot14(n,s+2);s+=4,h.push(d,p)}}return a}};Pe.T.HVAR={parseTab:function(n,t,r,i){var s=t,o=t,a=Pe.B;s+=4;var u=a.readUint(n,s);s+=4;var l=a.readUint(n,s);s+=4;var c=a.readUint(n,s);s+=4;var h=a.readUint(n,s);if(s+=4,c!=0||h!=0)throw c;s=o+u;var f=s,Q=a.readUshort(n,s);if(s+=2,Q!=1)throw"e";var d=a.readUint(n,s);s+=4;var p=a.readUshort(n,s);s+=2;for(var g=[],y=0;y<p;y++)g.push(a.readUint(n,s+y*4));s+=p*4,s=f+d;var v=a.readUshort(n,s);s+=2;var T=a.readUshort(n,s);s+=2;for(var _=[],y=0;y<T;y++){var C=[[],[],[]];_.push(C);for(var E=0;E<v;E++)C[0].push(a.readF2dot14(n,s+0)),C[1].push(a.readF2dot14(n,s+2)),C[2].push(a.readF2dot14(n,s+4)),s+=6}for(var S=new Int8Array(n.buffer),R=[],y=0;y<g.length;y++){s=o+u+g[y];var w=[];R.push(w);var x=a.readUshort(n,s);s+=2;var b=a.readUshort(n,s);if(s+=2,b&32768)throw"e";var T=a.readUshort(n,s);s+=2;for(var A=[],E=0;E<T;E++)A.push(a.readUshort(n,s+E*2));s+=T*2;for(var k=0;k<x;k++){for(var N=[],I=0;I<T;I++)N.push(I<b?a.readShort(n,s):S[s]),s+=I<b?2:1;var j=new Array(_.length);j.fill(0),w.push(j);for(var E=0;E<A.length;E++)j[A[E]]=N[E]}}s=o+l;var Q=n[s++];if(Q!=0)throw"e";var le=n[s++],fe=a.readUshort(n,s);s+=2;for(var ne=15,oe=48,ie=((le&oe)>>4)+1,ue=[],y=0;y<fe;y++){var ee=0;ie==1?ee=n[s++]:(ee=a.readUshort(n,s),s+=2);var ve=ee>>(le&ne)+1,ge=ee&(1<<(le&ne)+1)-1;ue.push(R[ve][ge])}return[_,ue]}};Pe.U=function(){var n={MoveTo:function(x,b,A){x.cmds.push("M"),x.crds.push(b,A)},LineTo:function(x,b,A){x.cmds.push("L"),x.crds.push(b,A)},CurveTo:function(x,b,A,k,N,I,j){x.cmds.push("C"),x.crds.push(b,A,k,N,I,j)},qCurveTo:function(x,b,A,k,N){x.cmds.push("Q"),x.crds.push(b,A,k,N)},ClosePath:function(x){x.cmds.push("Z")}};function t(x,b,A,k){var N=b[A],I=b[A+1],j=x.kern;if(j){var Q=j.glyph1.indexOf(N);if(Q!=-1){var le=j.rval[Q].glyph2.indexOf(I);if(le!=-1)return[0,0,j.rval[Q].vals[le],0]}}return[0,0,0,0]}function r(x,b,A){A==null&&(A={}),A.ltr,A.fts;var k=A.axs;x.fvar&&k==null&&(k=x.fvar[1][x._index][2]);var N=x.HVAR;k&&N&&(k=d(x,k));for(var I=[],j=0;j<b.length;j++){var Q=b.codePointAt(j);Q>65535&&j++,I.push(l(x,Q))}for(var le=[],j=0;j<I.length;j++){var fe=t(x,I,j),ne=I[j],oe=x.hmtx.aWidth[ne]+fe[2];if(N&&N[1][ne])for(var ie=N[1][ne],ue=0;ue<N[0].length;ue++)oe+=f(N[0][ue],k)*ie[ue];le.push({g:ne,cl:j,dx:0,dy:0,ax:oe,ay:0})}return le}function i(x,b,A){var k={cmds:[],crds:[]},N=0,I=0,j,Q;A&&(j=A.clr,Q=A.axs);for(var le=0;le<b.length;le++){for(var fe=b[le],ne=c(x,fe.g,!1,Q),oe=ne.crds,ie=0;ie<oe.length;ie+=2)k.crds.push(oe[ie]+N+fe.dx),k.crds.push(oe[ie+1]+I+fe.dy);j&&k.cmds.push(j);for(var ie=0;ie<ne.cmds.length;ie++)k.cmds.push(ne.cmds[ie]);var ue=k.cmds.length;j&&ue!=0&&k.cmds[ue-1]!="X"&&k.cmds.push("X"),N+=fe.ax,I+=fe.ay}return{cmds:k.cmds,crds:k.crds}}function s(x,b,A){for(var k=0,N=~~(x.length/b);k+1!=N;){var I=k+(N-k>>>1);x[I*b]<=A?k=I:N=I}return k*b}for(var o=[9,10,11,12,13,32,133,160,5760,6158,8232,8233,8239,8288,12288,65279],a={},u=0;u<o.length;u++)a[o[u]]=1;for(var u=8192;u<=8205;u++)a[u]=1;function l(x,b){if(x._ctab==null){for(var A=x.cmap,k=-1,N=["p3e10","p0e4","p3e1","p1e0","p0e3","p0e1","p3e0","p3e5"],I=0;I<N.length;I++)if(A.ids[N[I]]!=null){k=A.ids[N[I]];break}if(k==-1)throw"no familiar platform and encoding!";x._ctab=A.tables[k]}var j=x._ctab,Q=j.format,le=-1;if(Q==0)b>=j.map.length?le=0:le=j.map[b];else if(Q==4){var fe=j.endCount;if(le=0,b<=fe[fe.length-1]){var ne=s(fe,1,b);if(fe[ne]<b&&ne++,b>=j.startCount[ne]){var oe=0;j.idRangeOffset[ne]!=0?oe=j.glyphIdArray[b-j.startCount[ne]+(j.idRangeOffset[ne]>>1)-(j.idRangeOffset.length-ne)]:oe=b+j.idDelta[ne],le=oe&65535}}}else if(Q==6){var ie=b-j.firstCode,ue=j.glyphIdArray;ie<0||ie>=ue.length?le=0:le=ue[ie]}else if(Q==12){var ee=j.groups;if(le=0,b<=ee[ee.length-2]){var I=s(ee,3,b);ee[I]<=b&&b<=ee[I+1]&&(le=ee[I+2]+(b-ee[I]))}}else throw"unknown cmap table format "+j.format;var ve=x["SVG "],ge=x.loca;return le!=0&&x["CFF "]==null&&(ve==null||ve.entries[le]==null)&&ge&&ge[le]==ge[le+1]&&a[b]==null&&(le=0),le}function c(x,b,A,k){var N={cmds:[],crds:[]};x.fvar&&(k==null&&(k=x.fvar[1][x._index][2]),k=d(x,k));var I=x["SVG "],j=x["CFF "],Q=x.COLR,le=x.CBLC,fe=x.CBDT,ne=x.sbix,oe=window.UPNG,ie=null;if(le&&oe)for(var ue=0;ue<le.length;ue++)le[ue][0]<=b&&b<=le[ue][1]&&(ie=le[ue]);if(ie||ne&&ne[b]){if(ie&&ie[2]!=17)throw"not a PNG";x.__tmp==null&&(x.__tmp={});var ee=x.__tmp["g"+b];if(ee==null){var ve,ge;if(ne)ve=ne[b],ge=ve.length;else{var we=ie[3][b-ie[0]]+5;ge=fe[we+1]<<16|fe[we+2]<<8|fe[we+3],we+=4,ve=new Uint8Array(fe.buffer,fe.byteOffset+we,ge)}for(var Se="",ue=0;ue<ge;ue++)Se+=String.fromCharCode(ve[ue]);ee=x.__tmp["g"+b]="data:image/png;base64,"+btoa(Se)}N.cmds.push(ee);var ae=x.head.unitsPerEm*1.15,xe=Math.round(ae),ce=Math.round(ae),he=Math.round(-ce*.15);N.crds.push(0,ce+he,xe,ce+he,xe,he,0,he)}else if(I&&I.entries[b]){var ye=I.entries[b];if(ye!=null){if(typeof ye=="number"){var G=I.svgs[ye];if(typeof G=="string"){var W=new DOMParser,X=W.parseFromString(G,"image/svg+xml");G=I.svgs[ye]=X.getElementsByTagName("svg")[0]}ye=Pe.U.SVG.toPath(G,b),I.entries[b]=ye}N=ye}}else if(A!=!0&&Q&&Q[0]["g"+b]&&Q[0]["g"+b][1]>1){let ze=function(Me){var Ue=Me.toString(16);return(Ue.length==1?"0":"")+Ue};for(var De=ze,V=x.CPAL,L=Q[0]["g"+b],ue=0;ue<L[1];ue++){var z=L[0]+ue,J=Q[1][2*z],re=Q[1][2*z+1]*4,te=c(x,J,J==b),me="#"+ze(V[re+2])+ze(V[re+1])+ze(V[re+0]);N.cmds.push(me),N.cmds=N.cmds.concat(te.cmds),N.crds=N.crds.concat(te.crds),N.cmds.push("X")}}else if(j){var Ee=j.Private,Ce={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:Ee?Ee.defaultWidthX:0,open:!1};if(j.ROS){for(var Fe=0;j.FDSelect[Fe+2]<=b;)Fe+=2;Ee=j.FDArray[j.FDSelect[Fe+1]].Private}R(j.CharStrings[b],Ce,j,Ee,N)}else x.glyf&&h(b,x,N,k);return{cmds:N.cmds,crds:N.crds}}function h(x,b,A,k){var N=b.glyf[x];N==null&&(N=b.glyf[x]=Pe.T.glyf._parseGlyf(b,x)),N!=null&&(N.noc>-1?g(N,b,x,A,k):y(N,b,x,A,k))}function f(x,b){b.length;for(var A=1,k=x[0],N=x[1],I=x[2],j=0;j<b.length;j++){var Q=1;k[j]>N[j]||N[j]>I[j]||k[j]<0&&I[j]>0&&N[j]!=0||N[j]==0?Q=1:b[j]<k[j]||b[j]>I[j]?Q=0:b[j]==N[j]?Q=1:b[j]<N[j]?Q=(b[j]-k[j])/(N[j]-k[j]):Q=(I[j]-b[j])/(I[j]-N[j]),A=A*Q}return A}function d(x,b){for(var A=x.fvar,k=x.avar,N=A?A[0]:null,I=[],j=0;j<N.length;j++){var Q=N[j][1],le=N[j][2],fe=N[j][3],ne=Math.max(Q,Math.min(fe,b[j]));if(ne<le?I[j]=(le-ne)/(Q-le):ne>le?I[j]=(ne-le)/(fe-le):I[j]=0,k&&I[j]!=-1){for(var oe=k[j],ie=0;ie<oe.length&&!(oe[ie]>=I[j]);ie+=2);var ue=(I[j]-oe[ie-2])/(oe[ie]-oe[ie-2]);I[j]=ue*oe[ie+1]+(1-ue)*oe[ie-1]}}return I}function p(x,b,A,k,N){var I=A.length,j=new Array(I*2+8);j.fill(0);for(var Q=0;Q<I;Q++){var le=0,fe=0,ne=b.indexOf(Q);if(ne!=-1)le=x[ne],fe=x[b.length+ne];else{for(var oe=0;N[oe]<Q;)oe++;for(var ie=oe==0?0:N[oe-1]+1,ue=N[oe],ee=-1,ve=-1,ge=0;ge<b.length;ge++){var we=b[ge];we<ie||we>ue||we>=I||(ee=ge,ve==-1&&(ve=ge))}for(var ge=0;ge<b.length;ge++){var we=b[ge];if(!(we<ie||we>ue||we>=I)&&(we<Q&&(ee=ge),Q<we)){ve=ge;break}}for(var Se=0;Se<2;Se++){var ae=Se==0?A:k,xe=Se*b.length,ce=0,he=ae[b[ee]],ye=ae[b[ve]],G=ae[Q],W=x[xe+ee],X=x[xe+ve];if(he==ye)W==X?ce=W:ce=0;else if(G<=Math.min(he,ye))he<ye?ce=W:ce=X;else if(Math.max(he,ye)<=G)he<ye?ce=X:ce=W;else{var V=(G-he)/(ye-he);ce=V*X+(1-V)*W}Se==0?le=ce:fe=ce}}j[Q]=le,j[I+4+Q]=fe}return j}function g(x,b,A,k,N){var I=x.xs,j=x.ys;if(b.fvar&&N){I=I.slice(0),j=j.slice(0);for(var Q=b.gvar,le=Q?Q[A]:null,fe=0;fe<le.length;fe++){var ne=le[fe][0],oe=f(ne,N);if(!(oe<1e-9)){var ie=le[fe][1],ue=le[fe][2];if(ue&&(ie=le[fe][1]=p(ie,ue,I,j,x.endPts),le[fe][2]=null),ie.length==I.length*2+8)for(var ee=0;ee<I.length;ee++)I[ee]+=oe*ie[ee],j[ee]+=oe*ie[ee+I.length+4]}}}for(var ve=0;ve<x.noc;ve++){for(var ge=ve==0?0:x.endPts[ve-1]+1,we=x.endPts[ve],ee=ge;ee<=we;ee++){var Se=ee==ge?we:ee-1,ae=ee==we?ge:ee+1,xe=x.flags[ee]&1,ce=x.flags[Se]&1,he=x.flags[ae]&1,ye=I[ee],G=j[ee];if(ee==ge)if(xe)if(ce)n.MoveTo(k,I[Se],j[Se]);else{n.MoveTo(k,ye,G);continue}else ce?n.MoveTo(k,I[Se],j[Se]):n.MoveTo(k,Math.floor((I[Se]+ye)*.5),Math.floor((j[Se]+G)*.5));xe?ce&&n.LineTo(k,ye,G):he?n.qCurveTo(k,ye,G,I[ae],j[ae]):n.qCurveTo(k,ye,G,Math.floor((ye+I[ae])*.5),Math.floor((G+j[ae])*.5))}n.ClosePath(k)}}function y(x,b,A,k,N){var I=[0,0,0,0,0,0],j=[0,0,0,0,0,0],Q=x.parts.length;if(b.fvar&&N)for(var le=b.gvar,fe=le?le[A]:null,ne=0;ne<fe.length;ne++){var oe=fe[ne][0],ie=f(oe,N);if(!(ie<1e-6)){var ue=fe[ne][1],ee=fe[ne][2];if(ee==null)for(var ve=0;ve<Q;ve++)I[ve]+=ie*ue[ve],j[ve]+=ie*ue[ve+Q+4];else for(var ge=0;ge<ee.length;ge++){var ve=ee[ge];I[ve]+=ie*ue[0],j[ve]+=ie*ue[0+Q]}}}for(var ge=0;ge<Q;ge++){var we={cmds:[],crds:[]},Se=x.parts[ge];h(Se.glyphIndex,b,we,N);for(var ae=Se.m,xe=ae.tx+I[ge],ce=ae.ty+j[ge],ve=0;ve<we.crds.length;ve+=2){var he=we.crds[ve],ye=we.crds[ve+1];k.crds.push(he*ae.a+ye*ae.c+xe),k.crds.push(he*ae.b+ye*ae.d+ce)}for(var ve=0;ve<we.cmds.length;ve++)k.cmds.push(we.cmds[ve])}}function v(x,b){var A=x.cmds,k=x.crds;b==null&&(b=5);function N(W){return parseFloat(W.toFixed(b))}function I(W){for(var X=[],V=!1,L="",z=0;z<W.length;z++){var J=W[z],re=typeof J=="number";if(!re){if(J==L&&J.length==1&&J!="m")continue;L=J}V&&re&&J>=0&&X.push(" "),X.push(J),V=re}return X.join("")}for(var j=[],Q=0,le={M:2,L:2,Q:4,C:6},fe=0,ne=0,oe=0,ie=0,ue=0,ee=0,ve=0;ve<A.length;ve++){var ge=A[ve],we=le[ge]?le[ge]:0,Se=[],ae,xe,ce,he;if(ge=="L")ae=k[Q]-fe,xe=k[Q+1]-ne,ce=N(ae+oe),he=N(xe+ie),A[ve+1]=="Z"&&k[Q]==ue&&k[Q+1]==ee?(ce=ae,he=xe):ce==0&&he==0||(ce==0?Se.push("v",he):he==0?Se.push("h",ce):Se.push("l",ce,he));else{Se.push(ge.toLowerCase());for(var ye=0;ye<we;ye+=2)ae=k[Q+ye]-fe,xe=k[Q+ye+1]-ne,ce=N(ae+oe),he=N(xe+ie),Se.push(ce,he)}we!=0&&(oe+=ae-ce,ie+=xe-he);for(var G=Se,ye=0;ye<G.length;ye++)j.push(G[ye]);we!=0&&(Q+=we,fe=k[Q-2],ne=k[Q-1]),ge=="M"&&(ue=fe,ee=ne),ge=="Z"&&(fe=ue,ne=ee)}return I(j)}function T(x){var b={cmds:[],crds:[]};return Pe.U.SVG.svgToPath(x,b),{cmds:b.cmds,crds:b.crds}}function _(x,b,A,k){for(var N=b>>1,I=A>>1,j=new Uint8Array(N*I*4),Q=new Uint32Array(x.buffer),le=new Uint32Array(j.buffer),fe=0;fe<I;fe++)for(var ne=0;ne<N;ne++){var oe=fe*N+ne,ie=(fe<<1)*b+(ne<<1),ue=Q[ie],ee=Q[ie+1],ve=Q[ie+b],ge=Q[ie+b+1],we=ue>>>24,Se=ee>>>24,ae=ve>>>24,xe=ge>>>24,ce=we+Se+ae+xe;if(ce==1020){var he=(ue>>>0&255)+(ee>>>0&255)+(ve>>>0&255)+(ge>>>0&255)+2>>>2,ye=(ue>>>8&255)+(ee>>>8&255)+(ve>>>8&255)+(ge>>>8&255)+2>>>2,G=(ue>>>16&255)+(ee>>>16&255)+(ve>>>16&255)+(ge>>>16&255)+2>>>2;le[oe]=255<<24|G<<16|ye<<8|he}else if(ce==0)le[oe]=0;else{var he=(ue>>>0&255)*we+(ee>>>0&255)*Se+(ve>>>0&255)*ae+(ge>>>0&255)*xe,ye=(ue>>>8&255)*we+(ee>>>8&255)*Se+(ve>>>8&255)*ae+(ge>>>8&255)*xe,G=(ue>>>16&255)*we+(ee>>>16&255)*Se+(ve>>>16&255)*ae+(ge>>>16&255)*xe,W=1/ce;he=~~(he*W+.5),ye=~~(ye*W+.5),G=~~(G*W+.5),le[oe]=ce+2>>>2<<24|G<<16|ye<<8|he}}return{buff:j,w:N,h:I}}var C,E;function S(x,b){for(var A=0,k=x.cmds,N=x.crds,I=0;I<k.length;I++){var j=k[I];if(j=="M")b.moveTo(N[A],N[A+1]),A+=2;else if(j=="L")b.lineTo(N[A],N[A+1]),A+=2;else if(j=="C")b.bezierCurveTo(N[A],N[A+1],N[A+2],N[A+3],N[A+4],N[A+5]),A+=6;else if(j=="Q")b.quadraticCurveTo(N[A],N[A+1],N[A+2],N[A+3]),A+=4;else if(j[0]=="d"){var Q=window.UPNG,le=N[A],fe=N[A+1],ne=N[A+2],oe=N[A+3],ie=N[A+4],ue=N[A+5],ee=N[A+6],ve=N[A+7];if(A+=8,Q==null){b.moveTo(le,fe),b.lineTo(ne,oe),b.lineTo(ie,ue),b.lineTo(ee,ve),b.closePath();continue}for(var ge=ne-le,we=oe-fe,Se=ee-le,ae=ve-fe,xe=atob(j.slice(22)),ce=new Uint8Array(xe.length),he=0;he<xe.length;he++)ce[he]=xe.charCodeAt(he);for(var ye=Q.decode(ce.buffer),G=ye.width,W=ye.height,X=new Uint8Array(Q.toRGBA8(ye)[0]),V=b.getTransform(),L=Math.sqrt(Math.abs(V.a*V.d-V.b*V.c))*Math.sqrt(Se*Se+ae*ae)/W;L<.5;){var z=_(X,G,W);X=z.buff,G=z.w,W=z.h,L*=2}C==null&&(C=document.createElement("canvas"),E=C.getContext("2d")),(C.width!=G||C.height!=W)&&(C.width=G,C.height=W),E.putImageData(new ImageData(new Uint8ClampedArray(X.buffer),G,W),0,0),b.save(),b.transform(ge,we,Se,ae,le,fe),b.scale(1/G,1/W),b.drawImage(C,0,0),b.restore()}else if(j.charAt(0)=="#"||j.charAt(0)=="r")b.beginPath(),b.fillStyle=j;else if(j.charAt(0)=="O"&&j!="OX"){b.beginPath();var J=j.split("-");b.lineWidth=parseFloat(J[2]),b.lineCap=["butt","round","square"][parseFloat(J[3])],b.lineJoin=["miter","round","bevel"][parseFloat(J[4])],b.miterLimit=parseFloat(J[5]),b.lineDashOffset=parseFloat(J[6]),b.setLineDash(J[7].split(",").map(parseFloat)),b.strokeStyle=J[1]}else j=="Z"?b.closePath():j=="X"?b.fill():j=="OX"&&b.stroke()}}function R(x,b,A,k,N){for(var I=b.stack,j=b.nStems,Q=b.haveWidth,le=b.width,fe=b.open,ne=0,oe=b.x,ie=b.y,ue=0,ee=0,ve=0,ge=0,we=0,Se=0,ae=0,xe=0,ce=0,he=0,ye=Pe.T.CFF,G=k.nominalWidthX,W={val:0,size:0};ne<x.length;){ye.getCharString(x,ne,W);var X=W.val;if(ne+=W.size,X=="o1"||X=="o18"){var V;V=I.length%2!==0,V&&!Q&&(le=I.shift()+G),j+=I.length>>1,I.length=0,Q=!0}else if(X=="o3"||X=="o23"){var V;V=I.length%2!==0,V&&!Q&&(le=I.shift()+G),j+=I.length>>1,I.length=0,Q=!0}else if(X=="o4")I.length>1&&!Q&&(le=I.shift()+G,Q=!0),fe&&n.ClosePath(N),ie+=I.pop(),n.MoveTo(N,oe,ie),fe=!0;else if(X=="o5")for(;I.length>0;)oe+=I.shift(),ie+=I.shift(),n.LineTo(N,oe,ie);else if(X=="o6"||X=="o7")for(var L=I.length,z=X=="o6",J=0;J<L;J++){var re=I.shift();z?oe+=re:ie+=re,z=!z,n.LineTo(N,oe,ie)}else if(X=="o8"||X=="o24"){for(var L=I.length,te=0;te+6<=L;)ue=oe+I.shift(),ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),oe=ve+I.shift(),ie=ge+I.shift(),n.CurveTo(N,ue,ee,ve,ge,oe,ie),te+=6;X=="o24"&&(oe+=I.shift(),ie+=I.shift(),n.LineTo(N,oe,ie))}else{if(X=="o11")break;if(X=="o1234"||X=="o1235"||X=="o1236"||X=="o1237")X=="o1234"&&(ue=oe+I.shift(),ee=ie,ve=ue+I.shift(),ge=ee+I.shift(),ce=ve+I.shift(),he=ge,we=ce+I.shift(),Se=ge,ae=we+I.shift(),xe=ie,oe=ae+I.shift(),n.CurveTo(N,ue,ee,ve,ge,ce,he),n.CurveTo(N,we,Se,ae,xe,oe,ie)),X=="o1235"&&(ue=oe+I.shift(),ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),ce=ve+I.shift(),he=ge+I.shift(),we=ce+I.shift(),Se=he+I.shift(),ae=we+I.shift(),xe=Se+I.shift(),oe=ae+I.shift(),ie=xe+I.shift(),I.shift(),n.CurveTo(N,ue,ee,ve,ge,ce,he),n.CurveTo(N,we,Se,ae,xe,oe,ie)),X=="o1236"&&(ue=oe+I.shift(),ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),ce=ve+I.shift(),he=ge,we=ce+I.shift(),Se=ge,ae=we+I.shift(),xe=Se+I.shift(),oe=ae+I.shift(),n.CurveTo(N,ue,ee,ve,ge,ce,he),n.CurveTo(N,we,Se,ae,xe,oe,ie)),X=="o1237"&&(ue=oe+I.shift(),ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),ce=ve+I.shift(),he=ge+I.shift(),we=ce+I.shift(),Se=he+I.shift(),ae=we+I.shift(),xe=Se+I.shift(),Math.abs(ae-oe)>Math.abs(xe-ie)?oe=ae+I.shift():ie=xe+I.shift(),n.CurveTo(N,ue,ee,ve,ge,ce,he),n.CurveTo(N,we,Se,ae,xe,oe,ie));else if(X=="o14"){if(I.length>0&&I.length!=4&&!Q&&(le=I.shift()+A.nominalWidthX,Q=!0),I.length==4){var me=I.shift(),Ee=I.shift(),Ce=I.shift(),Fe=I.shift(),De=ye.glyphBySE(A,Ce),ze=ye.glyphBySE(A,Fe);R(A.CharStrings[De],b,A,k,N),b.x=me,b.y=Ee,R(A.CharStrings[ze],b,A,k,N)}fe&&(n.ClosePath(N),fe=!1)}else if(X=="o19"||X=="o20"){var V;V=I.length%2!==0,V&&!Q&&(le=I.shift()+G),j+=I.length>>1,I.length=0,Q=!0,ne+=j+7>>3}else if(X=="o21")I.length>2&&!Q&&(le=I.shift()+G,Q=!0),ie+=I.pop(),oe+=I.pop(),fe&&n.ClosePath(N),n.MoveTo(N,oe,ie),fe=!0;else if(X=="o22")I.length>1&&!Q&&(le=I.shift()+G,Q=!0),oe+=I.pop(),fe&&n.ClosePath(N),n.MoveTo(N,oe,ie),fe=!0;else if(X=="o25"){for(;I.length>6;)oe+=I.shift(),ie+=I.shift(),n.LineTo(N,oe,ie);ue=oe+I.shift(),ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),oe=ve+I.shift(),ie=ge+I.shift(),n.CurveTo(N,ue,ee,ve,ge,oe,ie)}else if(X=="o26")for(I.length%2&&(oe+=I.shift());I.length>0;)ue=oe,ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),oe=ve,ie=ge+I.shift(),n.CurveTo(N,ue,ee,ve,ge,oe,ie);else if(X=="o27")for(I.length%2&&(ie+=I.shift());I.length>0;)ue=oe+I.shift(),ee=ie,ve=ue+I.shift(),ge=ee+I.shift(),oe=ve+I.shift(),ie=ge,n.CurveTo(N,ue,ee,ve,ge,oe,ie);else if(X=="o10"||X=="o29"){var Me=X=="o10"?k:A;if(I.length==0)console.log("error: empty stack");else{var Ue=I.pop(),Qe=Me.Subrs[Ue+Me.Bias];b.x=oe,b.y=ie,b.nStems=j,b.haveWidth=Q,b.width=le,b.open=fe,R(Qe,b,A,k,N),oe=b.x,ie=b.y,j=b.nStems,Q=b.haveWidth,le=b.width,fe=b.open}}else if(X=="o30"||X=="o31"){var L,kt=I.length,te=0,Lt=X=="o31";for(L=kt&-3,te+=kt-L;te<L;)Lt?(ue=oe+I.shift(),ee=ie,ve=ue+I.shift(),ge=ee+I.shift(),ie=ge+I.shift(),L-te==5?(oe=ve+I.shift(),te++):oe=ve,Lt=!1):(ue=oe,ee=ie+I.shift(),ve=ue+I.shift(),ge=ee+I.shift(),oe=ve+I.shift(),L-te==5?(ie=ge+I.shift(),te++):ie=ge,Lt=!0),n.CurveTo(N,ue,ee,ve,ge,oe,ie),te+=4}else{if((X+"").charAt(0)=="o")throw console.log("Unknown operation: "+X,x),X;I.push(X)}}}b.x=oe,b.y=ie,b.nStems=j,b.haveWidth=Q,b.width=le,b.open=fe}function w(x,b){var A=function(k){var N=0;return(k&4294967168)==0?N=1:(k&4294965248)==0?N=2:(k&4294901760)==0?N=3:(k&4292870144)==0&&(N=4),N};fetch(x).then(function(k){return k.arrayBuffer()}).then(function(k){return WebAssembly.instantiate(k)}).then(function(k){console.log("HB ready");var N=k.instance.exports,I=N.memory,j,Q,le,fe,ne,oe,ie,ue,ee;Pe.U.shapeHB=function(){var ve=function(we){for(var Se=N.hb_buffer_get_length(we),ae=[],xe=N.hb_buffer_get_glyph_infos(we,0)>>>2,ce=N.hb_buffer_get_glyph_positions(we,0)>>>2,he=0;he<Se;++he){var ye=xe+he*5,G=ce+he*5;ae.push({g:Q[ye+0],cl:Q[ye+2],ax:le[G+0],ay:le[G+1],dx:le[G+2],dy:le[G+3]})}return ae},ge;return function(we,Se,ae){var xe=we._data,ce=we.name.postScriptName,he=ae.ltr,ye=ae.fts,G=ae.axs;if(we.fvar&&G==null&&(G=we.fvar[1][we._index][2]),j=new Uint8Array(I.buffer),Q=new Uint32Array(I.buffer),le=new Int32Array(I.buffer),fe=new Float32Array(I.buffer),ne!=ce&&(oe!=null&&(N.hb_blob_destroy(oe),N.free(ie),N.hb_face_destroy(ue),N.hb_font_destroy(ee)),ie=N.malloc(xe.byteLength),j.set(xe,ie),oe=N.hb_blob_create(ie,xe.byteLength,2,0,0),ue=N.hb_face_create(oe,we._index),ee=N.hb_font_create(ue),ne=ce),window.TextEncoder==null){alert("Your browser is too old. Please, update it.");return}ge==null&&(ge=new window.TextEncoder("utf8"));var W=N.hb_buffer_create(),X=ge.encode(Se),V=X.length,L=N.malloc(V);j.set(X,L),N.hb_buffer_add_utf8(W,L,V,0,V),N.free(L);var z=Pe.B,J=0;if(ye){J=N.malloc(16*ye.length);for(var re=0;re<ye.length;re++){var te=ye[re],me=J+re*16,Ee=me>>>2;z.writeASCII(j,me,te[0].split("").reverse().join("")),Q[Ee+1]=te[1],Q[Ee+2]=te[2],Q[Ee+3]=te[3]}}var Ce=0;if(G&&we.fvar){var Fe=we.fvar[0];Ce=N.malloc(8*G.length);for(var re=0;re<G.length;re++){var me=Ce+re*8,Ee=me>>>2;z.writeASCII(j,me,Fe[re][0].split("").reverse().join("")),fe[Ee+1]=G[re]}}G&&N.hb_font_set_variations(ee,Ce,G.length),N.hb_buffer_set_direction(W,he?4:5),N.hb_buffer_guess_segment_properties(W),N.hb_shape(ee,W,J,ye?ye.length:0);var De=ve(W);N.hb_buffer_destroy(W),ye&&N.free(J),G&&N.free(Ce);var ze=De.slice(0);he||ze.reverse();for(var Me=0,Ue=0,re=1;re<ze.length;re++){for(var Qe=ze[re],kt=Qe.cl;;){var Lt=Se.codePointAt(Me),lt=A(Lt);if(Ue+lt<=kt)Ue+=lt,Me+=Lt<=65535?1:2;else break}Qe.cl=Me}return De}}(),b()})}return{shape:r,shapeToPath:i,codeToGlyph:l,glyphToPath:c,pathToSVG:v,SVGToPath:T,pathToContext:S,initHB:w}}();var d0={exports:{}},IC;function QW(){return IC||(IC=1,function(n,t){(function(r,i){n.exports=i()})(self,()=>(()=>{var r={177:(s,o,a)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BezierPath=void 0;const u=a(558),l=a(188);o.BezierPath=class{constructor(c){this.samples=[],this.segments=c;const h=c.map(v=>v.getTotalLength()),f=[0];for(let v=1;v<h.length;v++)f.push(f[v-1]+h[v-1]);this._totalLength=f[f.length-1]+h[h.length-1];const d=c.map(v=>Math.max(4,Math.ceil(v.getTotalLength()/u.BezierSegment.sampleSpacing()))),p=d.reduce((v,T)=>v+T),g=1/p/10,y=this._totalLength/p;this.samples.push({dist:0,pt:this.segments[0].A,tan:this.segments[0].tangentAtParameter(0),segIdx:0,t:0}),c.forEach((v,T)=>{const _=d[T],C=(0,l.times)(_+1).map(w=>w/_),E=C.map(w=>v.pointAtParameter(w));let S;for(let w=0;w<4;w++){S=(0,l.times)(_).map(A=>Math.hypot(E[A+1].x-E[A].x,E[A+1].y-E[A].y));const x=S.map(A=>A-y);let b=0;for(let A=1;A<C.length-1;A++)b+=x[A-1],C[A]-=g*b,E[A]=v.pointAtParameter(C[A])}let R=0;E.slice(1).forEach((w,x)=>{R+=S[x],this.samples.push({dist:f[T]+R,pt:w,tan:this.segments[T].tangentAtParameter(C[x+1]),segIdx:T,t:C[x+1]})})}),this._jumps=[],this.segmentStartEnds=[{start:0,end:0}];for(let v=1;v<this.samples.length;v++){const T=this.samples[v-1],_=this.samples[v];if(_.segIdx===T.segIdx?this.segmentStartEnds[this.segmentStartEnds.length-1].end=_.dist:this.segmentStartEnds[_.segIdx]={start:_.dist,end:_.dist},T.segIdx!==_.segIdx&&(this.segments[T.segIdx].D.x!==this.segments[_.segIdx].A.x||this.segments[T.segIdx].D.y!==this.segments[_.segIdx].A.y)){const C=(T.dist+_.dist)/2,E={dist:C-1e-8,pt:this.segments[T.segIdx].D,tan:this.segments[T.segIdx].tangentAtParameter(1),segIdx:T.segIdx,t:1},S={dist:C+1e-8,pt:this.segments[_.segIdx].A,tan:this.segments[_.segIdx].tangentAtParameter(0),segIdx:_.segIdx,t:0};this._jumps.push(C),this.samples.splice(v,0,E,S),v+=2}}}jumps(){return[...this._jumps]}getTotalLength(){return this._totalLength}findClosestSampleIdx(c){let h=0,f=this.samples.length-1;for(;h<f;){const d=Math.floor((h+f)/2);if(this.samples[d].dist>c)f=d-1;else{if(!(this.samples[d].dist<c))return d;h=d+1}}return Math.max(0,Math.min(this.samples.length-1,Math.floor((h+f)/2)))}getPointAtLength(c,h=!1){if(c<=0)return this.samples[0].pt;if(c>=this._totalLength)return this.samples[this.samples.length-1].pt;const f=this.findClosestSampleIdx(c),d=this.samples[f].dist<c?Math.min(f+1,this.samples.length-1):Math.max(0,f-1),p=Math.abs(this.samples[d].dist-this.samples[f].dist)<1e-6?0:(c-this.samples[f].dist)/(this.samples[d].dist-this.samples[f].dist);if(h||this.samples[f].segIdx>this.samples[d].segIdx)return{x:(1-p)*this.samples[f].pt.x+p*this.samples[d].pt.x,y:(1-p)*this.samples[f].pt.y+p*this.samples[d].pt.y};if(this.samples[f].segIdx!==this.samples[d].segIdx){if(p<.5){const g=this.segments[this.samples[f].segIdx],y=2*p,v=(1-y)*this.samples[f].t+y;return g.pointAtParameter(v)}{const g=this.segments[this.samples[d].segIdx],y=2*(p-.5)*this.samples[d].t;return g.pointAtParameter(y)}}{const g=this.segments[this.samples[f].segIdx],y=(1-p)*this.samples[f].t+p*this.samples[d].t;return g.pointAtParameter(y)}}getAngleAtLength(c,h=!1){const f=this.getTangentAtLength(c,h);return Math.atan2(f.y,f.x)}getTangentAtLength(c,h=!1){if(c<=0)return this.samples[0].tan;if(c>=this._totalLength)return this.samples[this.samples.length-1].tan;const f=this.findClosestSampleIdx(c),d=this.samples[f].dist<c?Math.min(f+1,this.samples.length-1):Math.max(0,f-1),p=(c-this.samples[f].dist)/(this.samples[d].dist-this.samples[f].dist);if(h||this.samples[f].segIdx>this.samples[d].segIdx){let g=(1-p)*this.samples[f].tan.x+p*this.samples[d].tan.x,y=(1-p)*this.samples[f].tan.y+p*this.samples[d].tan.y;const v=Math.max(Math.hypot(g,y),1e-4);return g/=v,y/=v,{x:g,y}}if(this.samples[f].segIdx!==this.samples[d].segIdx){if(p<.5){const g=this.segments[this.samples[f].segIdx],y=2*p,v=(1-y)*this.samples[f].t+y;return g.tangentAtParameter(v)}{const g=this.segments[this.samples[d].segIdx],y=2*(p-.5)*this.samples[d].t;return g.tangentAtParameter(y)}}{const g=this.segments[this.samples[f].segIdx],y=(1-p)*this.samples[f].t+p*this.samples[d].t;return g.tangentAtParameter(y)}}}},558:(s,o,a)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BezierSegment=void 0;const u=a(188);class l{constructor(h,f,d,p){this._totalLength=void 0,this.A=h,this.B=f,this.C=d,this.D=p}static sampleSpacing(){return 2}tangentAtParameter(h){const f=Math.max(0,Math.min(1,h));if(f===0||f===1){let v,T;f===0?this.A.x===this.B.x&&this.A.y===this.B.y?(v=this.C.x-this.A.x,T=this.C.y-this.A.y):(v=this.B.x-this.A.x,T=this.B.y-this.A.y):this.D.x===this.C.x&&this.D.y===this.C.y?(v=this.D.x-this.B.x,T=this.D.y-this.B.y):(v=this.D.x-this.C.x,T=this.D.y-this.C.y);const _=Math.hypot(v,T);return Math.abs(_)>1e-4&&(v/=_,T/=_),{x:v,y:T}}const d=1-f;let p=3*this.D.x*Math.pow(f,2)-3*this.C.x*Math.pow(f,2)+6*this.C.x*d*f-6*this.B.x*d*f+3*this.B.x*Math.pow(d,2)-3*this.A.x*Math.pow(d,2),g=3*this.D.y*Math.pow(f,2)-3*this.C.y*Math.pow(f,2)+6*this.C.y*d*f-6*this.B.y*d*f+3*this.B.y*Math.pow(d,2)-3*this.A.y*Math.pow(d,2);const y=Math.hypot(p,g);return Math.abs(y)>1e-4&&(p/=y,g/=y),{x:p,y:g}}isLinear(){return this.A.x===this.B.x&&this.A.y===this.B.y&&this.C.x===this.D.x&&this.C.y===this.D.y}pointAtParameter(h){const f=Math.max(0,Math.min(1,h));return{x:Math.pow(1-f,3)*this.A.x+3*Math.pow(1-f,2)*f*this.B.x+3*(1-f)*Math.pow(f,2)*this.C.x+Math.pow(f,3)*this.D.x,y:Math.pow(1-f,3)*this.A.y+3*Math.pow(1-f,2)*f*this.B.y+3*(1-f)*Math.pow(f,2)*this.C.y+Math.pow(f,3)*this.D.y}}getTotalLength(){if(this._totalLength===void 0)if(this.isLinear())this._totalLength=Math.hypot(this.D.x-this.A.x,this.D.y-this.A.y);else{const h=Math.max(10,Math.ceil((Math.hypot(this.B.x-this.A.x,this.B.y-this.A.y)+Math.hypot(this.C.x-this.B.x,this.C.y-this.B.y)+Math.hypot(this.D.x-this.C.x,this.D.y-this.C.y))/l.sampleSpacing())),f=(0,u.times)(h).map(p=>this.pointAtParameter(p/(h-1)));let d=0;for(let p=1;p<f.length;p++)d+=Math.hypot(f[p].x-f[p-1].x,f[p].y-f[p-1].y);this._totalLength=d}return this._totalLength}}o.BezierSegment=l},729:(s,o,a)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createFromCommands=o.create=o.createFromElement=o.createFromCircle=o.createFromLine=o.createFromPath=void 0;const u=a(821),l=a(558),c={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};o.createFromPath=h=>{const f=function(g){const y=g.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").replace(/(\d)([A-Za-z])/g,"$1 $2").replace(/([A-Za-z])(\d)/g,"$1 $2").trim().split(/\s*,|\s+/),v=[];let T="",_={};for(;y.length>0;){let C=y.shift();c.hasOwnProperty(C)?T=C:y.unshift(C),_={type:T},c[T].forEach(E=>{C=y.shift(),_[E]=parseFloat(C)}),T==="M"?T="L":T==="m"&&(T="l"),v.push(_)}return v}(h.getAttribute("d"));if(f.length<2)throw new Error(`Path doesn't have enough commands: ${JSON.stringify(f)}`);if(f[0].type!=="M")throw new Error(`Path starts with ${f[0].type} instead of M!`);let d={x:f[0].x,y:f[0].y};f.shift();const p=[];for(;f.length>0;){const g=f.shift();if(g.type==="C")p.push(new l.BezierSegment(d,{x:g.x1,y:g.y1},{x:g.x2,y:g.y2},{x:g.x,y:g.y})),d={x:g.x,y:g.y};else if(g.type==="L")p.push(new l.BezierSegment(d,d,{x:g.x,y:g.y},{x:g.x,y:g.y})),d={x:g.x,y:g.y};else if(g.type==="H")p.push(new l.BezierSegment(d,d,{x:g.x,y:d.y},{x:g.x,y:d.y})),d={x:g.x,y:d.y};else if(g.type==="V")p.push(new l.BezierSegment(d,d,{x:d.x,y:g.y},{x:d.x,y:g.y})),d={x:d.x,y:g.y};else if(g.type!=="Z")throw new Error(`Unsupported path command ${g.type}; use only H, V, M, L, C, Z!`)}return new u.BezierPath(p)},o.createFromLine=h=>{const[f,d,p,g]=["x1","x2","y1","y2"].map(y=>parseFloat(h.getAttribute(y)||"0"));return new u.BezierPath([new l.BezierSegment({x:f,y:p},{x:f,y:p},{x:d,y:g},{x:d,y:g})])},o.createFromCircle=h=>{const[f,d,p]=["cx","cy","r"].map(y=>parseFloat(h.getAttribute(y)||"0")),g=1.3;return new u.BezierPath([new l.BezierSegment({x:f-p,y:d},{x:f-p,y:d-g*p},{x:f+p,y:d-g*p},{x:f+p,y:d}),new l.BezierSegment({x:f+p,y:d},{x:f+p,y:d+g*p},{x:f-p,y:d+g*p},{x:f-p,y:d})])},o.createFromElement=h=>{const f=h.tagName.toLowerCase();if(f==="path")return(0,o.createFromPath)(h);if(f==="line")return(0,o.createFromLine)(h);if(f==="circle")return(0,o.createFromCircle)(h);throw new Error(`Unsupported SVG tag: ${f}`)},o.create=h=>{const f=[];for(let d=1;d<h.length;d++){const p=h[d-1],g=h[d];f.push(new l.BezierSegment(p.pt,p.right||p.pt,g.left||g.pt,g.pt))}return new u.BezierPath(f)},o.createFromCommands=h=>{const f=h.slice();if(f.length<2)throw new Error(`Path doesn't have enough commands: ${JSON.stringify(f)}`);if(f[0].type!=="M")throw new Error(`Path starts with ${f[0].type} instead of M!`);let d={x:f[0].x,y:f[0].y},p=Object.assign({},d);const g=[];for(;f.length>0;){const y=f.shift();if(y.type==="M")p={x:y.x,y:y.y},d=p;else if(y.type==="C")g.push(new l.BezierSegment(d,{x:y.x1,y:y.y1},{x:y.x2,y:y.y2},{x:y.x,y:y.y})),d={x:y.x,y:y.y};else if(y.type==="L")y.x===d.x&&y.y===d.y||g.push(new l.BezierSegment(d,d,{x:y.x,y:y.y},{x:y.x,y:y.y})),d={x:y.x,y:y.y};else if(y.type==="H")y.x!==d.x&&g.push(new l.BezierSegment(d,d,{x:y.x,y:d.y},{x:y.x,y:d.y})),d={x:y.x,y:d.y};else if(y.type==="V")y.y!==d.y&&g.push(new l.BezierSegment(d,d,{x:d.x,y:y.y},{x:d.x,y:y.y})),d={x:d.x,y:y.y};else if(y.type==="Q")g.push(new l.BezierSegment(d,{x:d.x+.6666666666666666*(y.x1-d.x),y:d.y+.6666666666666666*(y.y1-d.y)},{x:y.x+.6666666666666666*(y.x1-y.x),y:y.y+.6666666666666666*(y.y1-y.y)},{x:y.x,y:y.y})),d={x:y.x,y:y.y};else{if(y.type!=="Z")throw new Error(`Unsupported path command ${y.type}; use only H, V, M, L, C, Z!`);Math.hypot(d.x-p.x,d.y-p.y)>0&&g.push(new l.BezierSegment(d,d,p,p))}}return new u.BezierPath(g)}},821:function(s,o,a){var u=this&&this.__createBinding||(Object.create?function(c,h,f,d){d===void 0&&(d=f);var p=Object.getOwnPropertyDescriptor(h,f);p&&!("get"in p?!h.__esModule:p.writable||p.configurable)||(p={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(c,d,p)}:function(c,h,f,d){d===void 0&&(d=f),c[d]=h[f]}),l=this&&this.__exportStar||function(c,h){for(var f in c)f==="default"||Object.prototype.hasOwnProperty.call(h,f)||u(h,c,f)};Object.defineProperty(o,"__esModule",{value:!0}),l(a(177),o),l(a(558),o),l(a(729),o),l(a(856),o)},856:(s,o)=>{Object.defineProperty(o,"__esModule",{value:!0})},188:(s,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.times=void 0,o.times=function(a){const u=[];for(let l=0;l<a;l++)u.push(l);return u}}},i={};return function s(o){var a=i[o];if(a!==void 0)return a.exports;var u=i[o]={exports:{}};return r[o].call(u.exports,u,u.exports,s),u.exports}(821)})())}(d0)),d0.exports}var JW=QW();const DC={M:2,L:2,C:6,Q:4},RR=["ttf","otf","woff"],eK=new RegExp(`\\.(${RR.join("|")})`,"i"),tK=new RegExp(`([^/]+)(\\.(?:${RR.join("|")}))`,"i"),FR="Sorry, only TTF, OTF and WOFF files are supported.",rK=["weight","stretch","style"];class L_{constructor(t,r,i,s,o){if(!(r instanceof FontFace))throw Error("FontFace is required");this._pInst=t,this.name=i,this.path=s,this.data=o,this.face=r}static hasGlyphData(t){let{font:r}=t;return typeof r=="object"&&typeof r.data<"u"}fontBounds(t,r,i,s,o,a){var l;({width:s,height:o,options:a}=this._parseArgs(s,o,a));let u=((l=a==null?void 0:a.graphics)==null?void 0:l._renderer)||this._pInst._renderer;if(!u)throw Error("p5 or graphics required for fontBounds()");return u.fontBounds(t,r,i,s,o)}textBounds(t,r,i,s,o,a){var l;({width:s,height:o,options:a}=this._parseArgs(s,o,a));let u=((l=a==null?void 0:a.graphics)==null?void 0:l._renderer)||this._pInst._renderer;if(!u)throw Error("p5 or graphics required for fontBounds()");return u.textBounds(t,r,i,s,o)}textToPaths(t,r,i,s,o,a){if({width:s,height:o,options:a}=this._parseArgs(s,o,a),!this.data)throw Error('No font data available for "'+this.name+`"
Try downloading a local copy of the font file`);return this._lineateAndPathify(t,r,i,s,o,a).map(c=>c.glyphs).flat().map(c=>c.path.commands).flat()}textToPoints(t,r,i,s,o,a){return this.textToContours(t,r,i,s,o,a).reduce((l,c)=>(l.push(...c),l),[])}textToContours(t,r=0,i=0,s,o,a){({width:s,height:o,options:a}=this._parseArgs(s,o,a));const u=this.textToPaths(t,r,i,s,o,a),l=[];for(const c of u)c[0]==="M"&&l.push([]),l[l.length-1].push(c);return l.map(c=>sK(c,a,this))}textToModel(t,r,i,s,o,a){({width:s,height:o,options:a}=this._parseArgs(s,o,a));const u=(a==null?void 0:a.extrude)||0,l=this.textToContours(t,r,i,s,o,a),c=this._pInst.buildGeometry(()=>{if(u===0){this._pInst.beginShape(),this._pInst.normal(0,0,1);for(const h of l){this._pInst.beginContour();for(const{x:f,y:d}of h)this._pInst.vertex(f,d);this._pInst.endContour(this._pInst.CLOSE)}this._pInst.endShape()}else{for(const h of[1,-1]){this._pInst.beginShape();for(const f of l){this._pInst.beginContour();for(const{x:d,y:p}of f)this._pInst.vertex(d,p,h*u*.5);this._pInst.endContour(this._pInst.CLOSE)}this._pInst.endShape(),this._pInst.beginShape()}for(const h of l){this._pInst.beginShape(this._pInst.QUAD_STRIP);for(const f of h)for(const d of[-1,1])this._pInst.vertex(f.x,f.y,d*u*.5);this._pInst.endShape()}}});if(u!==0){c.computeNormals();for(const h of c.faces)if(h.every(f=>c.vertices[f].z<=-u*.5+.1)){for(const f of h)c.vertexNormals[f].set(0,0,-1);h.reverse()}}return c}variations(){var r;let t={};if(this.data){let i=(r=this.face)==null?void 0:r.axes;i&&i.forEach(s=>{t[s.tag]=s.value})}return rK.forEach(i=>{let s=this.face[i];s!=="normal"&&(t[i]=t[i]||s)}),t}metadata(){var r;let t=((r=this.data)==null?void 0:r.name)||{};for(let i in this.face)/^load/.test(i)||(t[i]=t[i]||this.face[i]);return t}static async list(t=!1){if(t){console.log("There are",document.fonts.size,`font-faces
`);let r=0;for(let i of document.fonts.values()){console.log("FontFace: {");for(let s in i)console.log("  "+s+": "+i[s]);console.log(`}
`),i.status==="loaded"&&r++}console.log(r+" loaded")}return await Array.from(document.fonts)}_verticalAlign(t){var c,h,f;const{sCapHeight:r}=((c=this.data)==null?void 0:c["OS/2"])||{},{unitsPerEm:i=1e3}=((h=this.data)==null?void 0:h.head)||{},{ascender:s=0,descender:o=0}=((f=this.data)==null?void 0:f.hhea)||{},a=s/2;return((r||s+o)/2-a)*t/i}_lineateAndPathify(t,r,i,s,o,a={}){var y,v,T;let u=((y=a==null?void 0:a.graphics)==null?void 0:y._renderer)||this._pInst._renderer,l=u.drawingContext.textBaseline,{lines:c,bounds:h}=u._computeBounds(Tn._FONT_BOUNDS,t,r,i,s,o,{ignoreRectMode:!0,...a});c=this._position(u,c,h,s,o);let f=((T=(v=this.data)==null?void 0:v.head)==null?void 0:T.unitsPerEm)||1e3,d=u.states.textSize/f;const p=this._currentAxes(u);let g=c.map(_=>this._lineToGlyphs(_,{scale:d,axs:p}));return u.drawingContext.textBaseline=l,g}_currentAxes(t){var i,s;let r;return(((s=(i=this.data)==null?void 0:i.fvar)==null?void 0:s.length)??0)>0&&(r=this.data.fvar[0].map(([a,u,l,c,h,f])=>{if(!t)return l;if(a==="wght")return t.states.fontWeight;if(a==="wdth")return 100;if(t.textCanvas().style.fontVariationSettings){const d=new RegExp(`\\b${a}s+(d+)`).exec(t.textCanvas().style.fontVariationSettings);return d?parseInt(d[1]):l}else return l})),r}_textToPathPoints(t,r,i,s,o,a){({width:s,height:o,options:a}=this._parseArgs(s,o,a));let u=this.textToPaths(t,r,i,s,o,a);const l=(d,p,g,y)=>{if(fn.dist(p.x,p.y,g.x,g.y)>y){let v={x:(p.x+g.x)/2,y:(p.y+g.y)/2};d.push(v),l(d,p,v,y),l(d,v,g,y)}};let c=[],{textSize:h}=this._pInst._renderer.states,f=h/this.data.head.unitsPerEm*500;for(let d=0;d<u.length;d++){let{type:p,data:g}=u[d];if(p!=="Z"){let y={x:g[g.length-2],y:g[g.length-1]};p==="L"&&c.length&&!(a!=null&&a.nodivide)>0&&l(c,c[c.length-1],y,f),c.push(y)}}return c}_parseArgs(t,r,i={}){return typeof t=="object"?(i=t,t=r=void 0):typeof r=="object"&&(i=r,r=void 0),{width:t,height:r,options:i}}_position(t,r,i,s,o){let{textAlign:a,textLeading:u}=t.states,c=this._measureTextDefault(t,"X").fontBoundingBoxAscent,h=(f,d)=>{let p=i.x,g=i.y+d*u+c,y=t._fontWidthSingle(f);if(a===Dn?p+=(i.w-y)/2:a===ap&&(p+=i.w-y),typeof s<"u")switch(t.states.rectMode){case Dn:p-=s/2,g-=o/2;break;case hh:p-=s,g-=o;break}return{text:f,x:p,y:g}};return r.map(h)}_lineToGlyphs(t,{scale:r=1,axs:i}={}){if(!this.data)throw Error('No font data available for "'+this.name+`"
Try downloading a local copy of the font file`);let s=Pe.U.shape(this.data,t.text,{axs:i});return t.glyphShapes=s,t.glyphs=this._shapeToPaths(s,t,{scale:r,axs:i}),t}_positionGlyphs(t,r){var l;let i=((l=r==null?void 0:r.graphics)==null?void 0:l._renderer)||this._pInst._renderer;const s=this._currentAxes(i),o=Pe.U.shape(this.data,t,{axs:s}),a=[];let u=0;for(const c of o)a.push({x:u,index:c.g,shape:c}),u+=c.ax;return a}_singleShapeToPath(t,{scale:r=1,x:i=0,y:s=0,lineX:o=0,lineY:a=0,axs:u}={}){let l=this.data,c=0,{g:h,ax:f,ay:d,dx:p,dy:g}=t,{crds:y,cmds:v}=Pe.U.glyphToPath(l,h,!0,u),T={path:{commands:[]}};for(let _=0;_<v.length;_++){let C=v[_],E=[C];if(C in DC){let S=DC[C];for(let R=0;R<S;R+=2){let w=y[R+c]+i+p,x=y[R+c+1]+s+g,b=o+w*r,A=a+x*-r;E.push(b),E.push(A)}c+=S}T.path.commands.push(E)}return{glyph:T,ax:f,ay:d}}_shapeToPaths(t,r,{scale:i=1,axs:s}={}){let o=0,a=0,u=[];if(t.length!==r.text.length)throw Error("Invalid shape data");for(let l=0;l<t.length;l++){const{glyph:c,ax:h,ay:f}=this._singleShapeToPath(t[l],{scale:i,x:o,y:a,lineX:r.x,lineY:r.y,axs:s});u.push(c),o+=h,a+=f}return u}_measureTextDefault(t,r){let{textAlign:i,textBaseline:s}=t.states,o=t.textDrawingContext();o.textAlign="left",o.textBaseline="alphabetic";let a=o.measureText(r);return o.textAlign=i,o.textBaseline=s,a}drawPaths(t,r,i){t.strokeStyle=(i==null?void 0:i.stroke)||t.strokeStyle,t.fillStyle=(i==null?void 0:i.fill)||t.fillStyle,t.beginPath(),r.forEach(([s,...o])=>{s==="M"?t.moveTo(...o):s==="L"?t.lineTo(...o):s==="C"?t.bezierCurveTo(...o):s==="Q"?t.quadraticCurveTo(...o):s==="Z"&&t.closePath()}),i!=null&&i.fill&&t.fill(),i!=null&&i.stroke&&t.stroke()}_pathsToCommands(t,r){let i=[];for(let s=0;s<t.length;s++){let o=t[s],{x:a,y:u,path:l}=o,{crds:c,cmds:h}=l;for(let f=0,d=0;d<h.length;d++){let p=h[d],g={type:p,data:[]};if(p=="M"||p=="L")g.data.push(a+c[f]*r,u+c[f+1]*-r),f+=2;else if(p=="C"){for(let y=0;y<6;y+=2)g.data.push(a+c[f+y]*r,u+c[f+y+1]*-r);f+=6}else if(p=="Q"){for(let y=0;y<4;y+=2)g.data.push(a+c[f+y]*r,u+c[f+y+1]*-r);f+=4}i.push(g)}}return i}}async function Kf(n,t,r,i,s){let o=nK(t,r,i,s);return o.status!=="loaded"&&await o.load(),document.fonts.add(o),new L_(n,o,t,r,s)}function nK(n,t,r,i){var a;n.includes(" ")&&(n="'"+n+"'");let s=(i==null?void 0:i._compressedData)??(i==null?void 0:i._data);if(!s){if(!eK.test(t))throw Error(FR);t.startsWith("url(")||(t="url("+t+")"),s=t}if((((a=i==null?void 0:i.fvar)==null?void 0:a.length)??0)>0){r=r||{};for(const[u,l,c,h,f,d]of i.fvar[0])u==="wght"?r.weight=`${l} ${h}`:u==="wdth"&&(r.stretch=`${l}% ${h}%`)}let o=new FontFace(n,s,r);if(o.status==="error")throw Error('Failed to create FontFace for "'+n+'"');return o}function iK(n,t){let r,i=n==null?void 0:n.name;if(i){if(i.fullName)return i.fullName;i.familyName&&(r=i.familyName)}if(!r){let s=tK.exec(t);s&&s.length>=3?r=s[1]:r=t}return r.includes(" ")&&(r=r.replace(/ /g,"_")),r}function sK(n,t,r){const i=(d,p)=>{if(typeof d!="object")d=p;else for(const g in p)typeof d[g]>"u"&&(d[g]=p[g]);return d},s=(d,p)=>{const g=d.length;return d[p<0?p%g+g:p%g]},o=(d,p)=>{p=p||0;let g=0;for(let y=d.length-1;d.length>3&&y>=0;--y)collinear(s(d,y-1),s(d,y),s(d,y+1),p)&&(d.splice(y%d.length,1),g++);return g},a=JW.createFromCommands(MR(n));let u=i(t,{sampleFactor:.1,simplifyThreshold:0});const l=Math.max(1,Math.ceil(a.getTotalLength()*u.sampleFactor));let c=[];const h=r._pInst.angleMode(),f=r._pInst.DEGREES;for(let d=0;d<l;d++){const p=a.getTotalLength()*(l===1?0:d/(l-1));c.push({...a.getPointAtLength(p),get angle(){const g=a.getAngleAtLength(p);return h===f?g*180/Math.PI:g},get alpha(){return this.angle}})}return u.simplifyThreshold&&o(c,u.simplifyThreshold),c}function oK(n){return(n.startsWith('"')||n.startsWith("'"))&&n.at(0)===n.at(-1)?n.slice(1,-1).replace(/\/(['"])/g,"$1"):n}function aK(...n){let t=n.shift();(typeof t!="string"||t.length===0)&&p5._friendlyError(FR,"p5.loadFont");let r;typeof n[0]=="string"&&(r=n.shift());let i,s,o;for(let a=0;a<n.length;a++){const u=n[a];typeof u=="function"?i?s=u:i=u:typeof u=="object"&&(o=u)}return{path:t,name:r,success:i,error:s,options:o}}function PR(n,t){n.Font=L_,t.parseFontData=async function(r){let i=r instanceof Uint8Array?r:await t.loadBytes(r);if(!i)throw Error("Failed to load font data");let s=Pe.parse(i);if(s.length===0||s[0].cmap===void 0)throw Error("parsing font data");return s[0]},t.loadFont=async function(...r){var f;let{path:i,name:s,success:o,error:a,options:{sets:u,...l}={}}=aK(...r),c=i.includes("@font-face");if(c||(f=(await fetch(i,{method:"HEAD"})).headers.get("content-type"))!=null&&f.startsWith("text/css")&&(c=!0,i=await fetch(i).then(g=>g.text())),c){const d=new CSSStyleSheet;await d.replace(i);const p=[];for(const S of d.cssRules)if(S instanceof CSSFontFaceRule){const R=S.style;let w=oK(R.getPropertyValue("font-family"));const x=R.getPropertyValue("src"),b={...l||{}};for(const A of R){if(A==="font-family"||A==="src")continue;const k=A.replace(/^font-/,"").split("-").map((N,I)=>I===0?N:`${N[0].toUpperCase()}${N.slice(1)}`).join("");b[k]=R.getPropertyValue(A)}p.push({name:w,src:x,fontDescriptors:b,loadWithData:async()=>{let A;try{const k=/url\(([^\)]+)\)/.exec(x);if(k){let N=k[1];/^['"]/.exec(N)&&N.at(0)===N.at(-1)&&(N=N.slice(1,-1)),A=await t.parseFontData(N)}}catch{}return Kf(this,w,x,b,A)},loadWithoutData:()=>Kf(this,w,x,b)})}u=u||["latin"];const g=(u instanceof Array?u:[u]).map(S=>S.toLowerCase()),y=OH.filter(S=>g.some(R=>S.category.includes(R)&&S.category.includes("ext")===R.includes("ext"))),v=new Set(ZS.UnicodeRange.parse(y.map(S=>`U+${S.hexrange[0]}-${S.hexrange[1]}`)));let T=0,_=0,C;for(const S of p){if(!S.fontDescriptors.unicodeRange)continue;const w=[...new Set(ZS.UnicodeRange.parse(S.fontDescriptors.unicodeRange.split(/,\s*/g))).values()].filter(A=>v.has(A)).length,x={style:"normal",weight:400,...l},b=Object.keys(S.fontDescriptors).filter(A=>S.fontDescriptors[A]===x[A]).length;(b>_||b===_&&w>=T)&&(_=b,T=w,C=S)}const E=C||p.at(-1);for(const S of p)S!==E&&S.loadWithoutData();return E==null?void 0:E.loadWithData()}let h;try{const d=await t.parseFontData(i);s=s||iK(d,i),h=await Kf(this,s,i,l,d)}catch{let p=s||i.substring(i.lastIndexOf("/")+1).replace(/\.[^/.]+$/,"");console.warn(`WARN: No glyph data for '${p}', retrying as FontFace`);try{h=await Kf(this,p,i,l)}catch(g){if(a)return a(g);throw g}}return o?o(h):h}}const MR=n=>n.map(t=>{const r=t[0];switch(r){case"Z":return{type:r};case"M":case"L":{const[,i,s]=t;return{type:r,x:i,y:s}}case"Q":{const[,i,s,o,a]=t;return{type:r,x1:i,y1:s,x:o,y:a}}case"C":{const[,i,s,o,a,u,l]=t;return{type:r,x1:i,y1:s,x2:o,y2:a,x:u,y:l}}default:throw new Error(`Unexpected path command: ${r}`)}});typeof p5<"u"&&PR(p5,p5.prototype);function uK(n,t){at.prototype.maxCachedGlyphs=function(){return 200},L_.prototype._getFontInfo=function(g){this._fontInfos=this._fontInfos||{};const y=JSON.stringify(g);if(this._fontInfos[y])return this._fontInfos[y];{const v=new p(this,{axs:g});return this._fontInfos[y]=v,v}};const r=9,i=r,s=64,o=64,a=64,u=64,l=64,c=64;class h{constructor(y,v){this.width=y,this.height=v,this.infos=[]}findImage(y){const v=this.width*this.height;if(y>v)throw new Error("font is too complex to render in 3D");let T,_;for(let E=this.infos.length-1;E>=0;--E){const S=this.infos[E];if(S.index+y<v){T=S,_=S.imageData;break}}if(!T){try{_=new ImageData(this.width,this.height)}catch{let S=document.getElementsByTagName("canvas")[0];const R=!S;S||(S=document.createElement("canvas"),S.style.display="none",document.body.appendChild(S));const w=S.getContext("2d");w&&(_=w.createImageData(this.width,this.height)),R&&document.body.removeChild(S)}T={index:0,imageData:_},this.infos.push(T)}const C=T.index;return T.index+=y,_._dirty=!0,{imageData:_,index:C}}}function f(g,y,v,T,_){const E=g.imageData.data;let S=g.index++*4;E[S++]=y,E[S++]=v,E[S++]=T,E[S++]=_}const d=Math.sqrt(3);class p{constructor(y,{axs:v}={}){this.font=y,this.axs=v,this.strokeImageInfos=new h(s,o),this.colDimImageInfos=new h(a,u),this.rowDimImageInfos=new h(a,u),this.colCellImageInfos=new h(l,c),this.rowCellImageInfos=new h(l,c),this.glyphInfos={}}getGlyphInfo(y){let v=this.glyphInfos[y.index];if(v)return v;const T=this.axs,{glyph:{path:{commands:_}}}=this.font._singleShapeToPath(y.shape,{axs:T});let C=1/0,E=-1/0,S=1/0,R=-1/0;for(const ce of _)for(let he=1;he<ce.length;he+=2)C=Math.min(C,ce[he]),E=Math.max(E,ce[he]),S=Math.min(S,ce[he+1]),R=Math.max(R,ce[he+1]);if(C>=E||S>=R||!_.length)return this.glyphInfos[y.index]={};const w=E-C,x=R-S,b=MR(_);let A;const k=[],N=[],I=[];for(A=r-1;A>=0;--A)I.push([]);for(A=i-1;A>=0;--A)N.push([]);function j(ce,he,ye){const G=k.length;k.push(ye);function W(me,Ee,Ce){for(let Fe=me.length;Fe-- >0;){const De=me[Fe];Ee>De&&(Ee=De),Ce<De&&(Ce=De)}return{min:Ee,max:Ce}}const X=.5,V=W(ce,1,0),L=Math.max(Math.floor(V.min*r-X),0),z=Math.min(Math.ceil(V.max*r+X),r);for(let me=L;me<z;++me)I[me].push(G);const J=W(he,1,0),re=Math.max(Math.floor(J.min*i-X),0),te=Math.min(Math.ceil(J.max*i+X),i);for(let me=re;me<te;++me)N[me].push(G)}function Q(ce,he,ye){return ce<he?he:ce>ye?ye:ce}function le(ce){return Q(255*ce,0,255)}class fe{constructor(he,ye,G,W){this.p0=he,this.c0=ye,this.c1=G,this.p1=W}toQuadratic(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:((this.c0.x+this.c1.x)*3-(this.p0.x+this.p1.x))/4,cy:((this.c0.y+this.c1.y)*3-(this.p0.y+this.p1.y))/4}}quadError(){return de.sub(de.sub(this.p1,this.p0),de.mult(de.sub(this.c1,this.c0),3)).mag()/2}split(he){const ye=de.lerp(this.p0,this.c0,he),G=de.lerp(this.c0,this.c1,he),W=de.lerp(ye,G,he);this.c1=de.lerp(this.c1,this.p1,he),this.c0=de.lerp(G,this.c1,he);const X=de.lerp(W,this.c0,he),V=new fe(this.p0,ye,W,X);return this.p0=X,V}splitInflections(){const he=de.sub(this.c0,this.p0),ye=de.sub(de.sub(this.c1,this.c0),he),G=de.sub(de.sub(de.sub(this.p1,this.c1),he),de.mult(ye,2)),W=[];let X=ye.x*G.y-ye.y*G.x;if(X!==0){let V=he.x*G.y-he.y*G.x,L=he.x*ye.y-he.y*ye.x;const z=V*V-4*X*L;if(z>=0){X<0&&(X=-X,V=-V,L=-L);const J=Math.sqrt(z),re=(-V-J)/(2*X);let te=(-V+J)/(2*X);re>0&&re<1&&(W.push(this.split(re)),te=1-(1-te)/(1-re)),te>0&&te<1&&W.push(this.split(te))}}return W.push(this),W}}function ne(ce,he,ye,G,W,X,V,L){const z=new fe(new de(ce,he),new de(ye,G),new de(W,X),new de(V,L)).splitInflections(),J=[],re=30/d;for(let te of z){const me=[];let Ee;for(;Ee=re/te.quadError(),!(Ee>=.5*.5*.5);){const Ce=Math.pow(Ee,1/3),Fe=te.split(Ce),De=te.split(1-Ce/(1-Ce));J.push(Fe),me.push(te),te=De}Ee<1&&J.push(te.split(.5)),J.push(te),Array.prototype.push.apply(J,me.reverse())}return J}function oe(ce,he,ye,G){const W=(ce+ye)/2,X=(he+G)/2;j([ce,ye],[he,G],{x:ce,y:he,cx:W,cy:X})}function ie(ce,he,ye,G){return Math.abs(ye-ce)<1e-5&&Math.abs(G-he)<1e-5}let ue,ee,ve,ge;for(const ce of b){const he=(ce.x-C)/w,ye=(ce.y-S)/x;if(!ie(ue,ee,he,ye)){switch(ce.type){case"M":{ve=he,ge=ye;break}case"L":{oe(ue,ee,he,ye);break}case"Q":{const G=(ce.x1-C)/w,W=(ce.y1-S)/x;j([ue,he,G],[ee,ye,W],{x:ue,y:ee,cx:G,cy:W});break}case"Z":{ie(ue,ee,ve,ge)?k.push({x:ue,y:ee}):(oe(ue,ee,ve,ge),k.push({x:ve,y:ge}));break}case"C":{const G=(ce.x1-C)/w,W=(ce.y1-S)/x,X=(ce.x2-C)/w,V=(ce.y2-S)/x,L=ne(ue,ee,G,W,X,V,he,ye);for(let z=0;z<L.length;z++){const J=L[z].toQuadratic();j([J.x,J.x1,J.cx],[J.y,J.y1,J.cy],J)}break}default:throw new Error(`unknown command type: ${ce.type}`)}ue=he,ee=ye}}const we=k.length,Se=this.strokeImageInfos.findImage(we),ae=Se.index;for(let ce=0;ce<we;++ce){const he=k[ce];f(Se,le(he.x),le(he.y),le(he.cx),le(he.cy))}function xe(ce,he,ye){const G=ce.length,W=he.findImage(G),X=W.index;let V=0;for(let z=0;z<G;++z)V+=ce[z].length;const L=ye.findImage(V);for(let z=0;z<G;++z){const J=ce[z],re=J.length,te=L.index;f(W,te>>7,te&127,re>>7,re&127);for(let me=0;me<re;++me){const Ee=J[me]+ae;f(L,Ee>>7,Ee&127,0,0)}}return{cellImageInfo:L,dimOffset:X,dimImageInfo:W}}return v=this.glyphInfos[y.index]={glyph:y,uGlyphRect:[C,S,E,R],strokeImageInfo:Se,strokes:k,colInfo:xe(I,this.colDimImageInfos,this.colCellImageInfos),rowInfo:xe(N,this.rowDimImageInfos,this.rowCellImageInfos)},v.uGridOffset=[v.colInfo.dimOffset,v.rowInfo.dimOffset],v}}at.prototype._renderText=function(g,y,v,T,_){var le,fe;if(!this.states.textFont||typeof this.states.textFont=="string"){console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.");return}if(v>=T||!this.states.fillColor)return;if(!n.Font.hasGlyphData(this.states.textFont)){console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts with glyph data are supported");return}this.push();const C=this.states.strokeColor,E=this.states.drawMode;this.states.setValue("strokeColor",null),this.states.setValue("drawMode",hp);const{font:S}=this.states.textFont;if(!S)throw new Error("In WebGL mode, textFont() needs to be given the result of loadFont() instead of a font family name.");const R=S._currentAxes(this);let w=S._getFontInfo(R);const x={x:y,y:v},A=this.states.textSize/(((fe=(le=S.data)==null?void 0:le.head)==null?void 0:fe.unitsPerEm)||1e3);this.translate(x.x,x.y,0),this.scale(A,A,1);const k=this.GL,N=!this._defaultFontShader,I=this._getFontShader();I.init(),I.bindShader(),N&&(I.setUniform("uGridImageSize",[a,u]),I.setUniform("uCellsImageSize",[l,c]),I.setUniform("uStrokeImageSize",[s,o]),I.setUniform("uGridSize",[r,i]));const j=this.states.fillSet?this.states.curFillColor:[0,0,0,255];this._setGlobalUniforms(I),this._applyColorBlend(j);let Q=this.geometryBufferCache.getGeometryByID("glyph");Q||(Q=this._textGeom=new Hr(1,1,function(){for(let ne=0;ne<=1;ne++)for(let oe=0;oe<=1;oe++)this.vertices.push(new de(oe,ne,0)),this.uvs.push(oe,ne)},this),Q.gid="glyph",Q.computeFaces().computeNormals(),this.geometryBufferCache.ensureCached(Q));for(const ne of this.buffers.text)ne._prepareBuffer(Q,I);this._bindBuffer(this.geometryBufferCache.cache.glyph.indexBuffer,k.ELEMENT_ARRAY_BUFFER),I.setUniform("uMaterialColor",j),k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.glyphDataCache=this.glyphDataCache||new Set;try{const ne=S._positionGlyphs(g);for(const oe of ne){const ie=w.getGlyphInfo(oe);if(ie.uGlyphRect){const ue=ie.rowInfo,ee=ie.colInfo,ve=[ie.strokeImageInfo.imageData,ue.cellImageInfo.imageData,ue.dimImageInfo.imageData,ee.cellImageInfo.imageData,ee.dimImageInfo.imageData];for(const ge of ve)this.glyphDataCache.delete(ge),this.glyphDataCache.add(ge);for(;this.glyphDataCache.size>this.maxCachedGlyphs();){const ge=this.glyphDataCache.values().next().value;this.glyphDataCache.delete(ge);const we=this.textures.get(ge);we&&(we.remove(),this.textures.delete(ge))}I.setUniform("uSamplerStrokes",ie.strokeImageInfo.imageData),I.setUniform("uSamplerRowStrokes",ue.cellImageInfo.imageData),I.setUniform("uSamplerRows",ue.dimImageInfo.imageData),I.setUniform("uSamplerColStrokes",ee.cellImageInfo.imageData),I.setUniform("uSamplerCols",ee.dimImageInfo.imageData),I.setUniform("uGridOffset",ie.uGridOffset),I.setUniform("uGlyphRect",ie.uGlyphRect),I.setUniform("uGlyphOffset",oe.x),I.bindTextures(),k.drawElements(k.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)}}}finally{I.unbindShader(),this.states.setValue("strokeColor",C),this.states.setValue("drawMode",E),k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.pop()}}}var p0={},g0={},kC;function lK(){return kC||(kC=1,function(n){(function t(r){var i,s,o,a,u,l;function c(S){var R={},w,x;for(w in S)S.hasOwnProperty(w)&&(x=S[w],typeof x=="object"&&x!==null?R[w]=c(x):R[w]=x);return R}function h(S,R){var w,x,b,A;for(x=S.length,b=0;x;)w=x>>>1,A=b+w,R(S[A])?x=w:(b=A+1,x-=w+1);return b}i={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},o={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},a={},u={},l={},s={Break:a,Skip:u,Remove:l};function f(S,R){this.parent=S,this.key=R}f.prototype.replace=function(R){this.parent[this.key]=R},f.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function d(S,R,w,x){this.node=S,this.path=R,this.wrap=w,this.ref=x}function p(){}p.prototype.path=function(){var R,w,x,b,A,k;function N(I,j){if(Array.isArray(j))for(x=0,b=j.length;x<b;++x)I.push(j[x]);else I.push(j)}if(!this.__current.path)return null;for(A=[],R=2,w=this.__leavelist.length;R<w;++R)k=this.__leavelist[R],N(A,k.path);return N(A,this.__current.path),A},p.prototype.type=function(){var S=this.current();return S.type||this.__current.wrap},p.prototype.parents=function(){var R,w,x;for(x=[],R=1,w=this.__leavelist.length;R<w;++R)x.push(this.__leavelist[R].node);return x},p.prototype.current=function(){return this.__current.node},p.prototype.__execute=function(R,w){var x,b;return b=void 0,x=this.__current,this.__current=w,this.__state=null,R&&(b=R.call(this,w.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=x,b},p.prototype.notify=function(R){this.__state=R},p.prototype.skip=function(){this.notify(u)},p.prototype.break=function(){this.notify(a)},p.prototype.remove=function(){this.notify(l)},p.prototype.__initialize=function(S,R){this.visitor=R,this.root=S,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,R.fallback==="iteration"?this.__fallback=Object.keys:typeof R.fallback=="function"&&(this.__fallback=R.fallback),this.__keys=o,R.keys&&(this.__keys=Object.assign(Object.create(this.__keys),R.keys))};function g(S){return S==null?!1:typeof S=="object"&&typeof S.type=="string"}function y(S,R){return(S===i.ObjectExpression||S===i.ObjectPattern)&&R==="properties"}function v(S,R){for(var w=S.length-1;w>=0;--w)if(S[w].node===R)return!0;return!1}p.prototype.traverse=function(R,w){var x,b,A,k,N,I,j,Q,le,fe,ne,oe;for(this.__initialize(R,w),oe={},x=this.__worklist,b=this.__leavelist,x.push(new d(R,null,null,null)),b.push(new d(null,null,null,null));x.length;){if(A=x.pop(),A===oe){if(A=b.pop(),I=this.__execute(w.leave,A),this.__state===a||I===a)return;continue}if(A.node){if(I=this.__execute(w.enter,A),this.__state===a||I===a)return;if(x.push(oe),b.push(A),this.__state===u||I===u)continue;if(k=A.node,N=k.type||A.wrap,fe=this.__keys[N],!fe)if(this.__fallback)fe=this.__fallback(k);else throw new Error("Unknown node type "+N+".");for(Q=fe.length;(Q-=1)>=0;)if(j=fe[Q],ne=k[j],!!ne){if(Array.isArray(ne)){for(le=ne.length;(le-=1)>=0;)if(ne[le]&&!v(b,ne[le])){if(y(N,fe[Q]))A=new d(ne[le],[j,le],"Property",null);else if(g(ne[le]))A=new d(ne[le],[j,le],null,null);else continue;x.push(A)}}else if(g(ne)){if(v(b,ne))continue;x.push(new d(ne,j,null,null))}}}}},p.prototype.replace=function(R,w){var x,b,A,k,N,I,j,Q,le,fe,ne,oe,ie;function ue(ee){var ve,ge,we,Se;if(ee.ref.remove()){for(ge=ee.ref.key,Se=ee.ref.parent,ve=x.length;ve--;)if(we=x[ve],we.ref&&we.ref.parent===Se){if(we.ref.key<ge)break;--we.ref.key}}}for(this.__initialize(R,w),ne={},x=this.__worklist,b=this.__leavelist,oe={root:R},I=new d(R,null,null,new f(oe,"root")),x.push(I),b.push(I);x.length;){if(I=x.pop(),I===ne){if(I=b.pop(),N=this.__execute(w.leave,I),N!==void 0&&N!==a&&N!==u&&N!==l&&I.ref.replace(N),(this.__state===l||N===l)&&ue(I),this.__state===a||N===a)return oe.root;continue}if(N=this.__execute(w.enter,I),N!==void 0&&N!==a&&N!==u&&N!==l&&(I.ref.replace(N),I.node=N),(this.__state===l||N===l)&&(ue(I),I.node=null),this.__state===a||N===a)return oe.root;if(A=I.node,!!A&&(x.push(ne),b.push(I),!(this.__state===u||N===u))){if(k=A.type||I.wrap,le=this.__keys[k],!le)if(this.__fallback)le=this.__fallback(A);else throw new Error("Unknown node type "+k+".");for(j=le.length;(j-=1)>=0;)if(ie=le[j],fe=A[ie],!!fe)if(Array.isArray(fe)){for(Q=fe.length;(Q-=1)>=0;)if(fe[Q]){if(y(k,le[j]))I=new d(fe[Q],[ie,Q],"Property",new f(fe,Q));else if(g(fe[Q]))I=new d(fe[Q],[ie,Q],null,new f(fe,Q));else continue;x.push(I)}}else g(fe)&&x.push(new d(fe,ie,null,new f(A,ie)))}}return oe.root};function T(S,R){var w=new p;return w.traverse(S,R)}function _(S,R){var w=new p;return w.replace(S,R)}function C(S,R){var w;return w=h(R,function(b){return b.range[0]>S.range[0]}),S.extendedRange=[S.range[0],S.range[1]],w!==R.length&&(S.extendedRange[1]=R[w].range[0]),w-=1,w>=0&&(S.extendedRange[0]=R[w].range[1]),S}function E(S,R,w){var x=[],b,A,k,N;if(!S.range)throw new Error("attachComments needs range information");if(!w.length){if(R.length){for(k=0,A=R.length;k<A;k+=1)b=c(R[k]),b.extendedRange=[0,S.range[0]],x.push(b);S.leadingComments=x}return S}for(k=0,A=R.length;k<A;k+=1)x.push(C(c(R[k]),w));return N=0,T(S,{enter:function(I){for(var j;N<x.length&&(j=x[N],!(j.extendedRange[1]>I.range[0]));)j.extendedRange[1]===I.range[0]?(I.leadingComments||(I.leadingComments=[]),I.leadingComments.push(j),x.splice(N,1)):N+=1;if(N===x.length)return s.Break;if(x[N].extendedRange[0]>I.range[1])return s.Skip}}),N=0,T(S,{leave:function(I){for(var j;N<x.length&&(j=x[N],!(I.range[1]<j.extendedRange[0]));)I.range[1]===j.extendedRange[0]?(I.trailingComments||(I.trailingComments=[]),I.trailingComments.push(j),x.splice(N,1)):N+=1;if(N===x.length)return s.Break;if(x[N].extendedRange[0]>I.range[1])return s.Skip}}),S}return r.Syntax=i,r.traverse=T,r.replace=_,r.attachComments=E,r.VisitorKeys=o,r.VisitorOption=s,r.Controller=p,r.cloneEnvironment=function(){return t({})},r})(n)}(g0)),g0}var rc={},m0={exports:{}},NC;function cK(){return NC||(NC=1,function(){function n(a){if(a==null)return!1;switch(a.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function t(a){if(a==null)return!1;switch(a.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function r(a){if(a==null)return!1;switch(a.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function i(a){return r(a)||a!=null&&a.type==="FunctionDeclaration"}function s(a){switch(a.type){case"IfStatement":return a.alternate!=null?a.alternate:a.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return a.body}return null}function o(a){var u;if(a.type!=="IfStatement"||a.alternate==null)return!1;u=a.consequent;do{if(u.type==="IfStatement"&&u.alternate==null)return!0;u=s(u)}while(u);return!1}m0.exports={isExpression:n,isStatement:r,isIterationStatement:t,isSourceElement:i,isProblematicIfStatement:o,trailingStatement:s}}()),m0.exports}var y0={exports:{}},RC;function LR(){return RC||(RC=1,function(){var n,t,r,i,s,o;t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function a(v){return 48<=v&&v<=57}function u(v){return 48<=v&&v<=57||97<=v&&v<=102||65<=v&&v<=70}function l(v){return v>=48&&v<=55}r=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function c(v){return v===32||v===9||v===11||v===12||v===160||v>=5760&&r.indexOf(v)>=0}function h(v){return v===10||v===13||v===8232||v===8233}function f(v){if(v<=65535)return String.fromCharCode(v);var T=String.fromCharCode(Math.floor((v-65536)/1024)+55296),_=String.fromCharCode((v-65536)%1024+56320);return T+_}for(i=new Array(128),o=0;o<128;++o)i[o]=o>=97&&o<=122||o>=65&&o<=90||o===36||o===95;for(s=new Array(128),o=0;o<128;++o)s[o]=o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===36||o===95;function d(v){return v<128?i[v]:t.NonAsciiIdentifierStart.test(f(v))}function p(v){return v<128?s[v]:t.NonAsciiIdentifierPart.test(f(v))}function g(v){return v<128?i[v]:n.NonAsciiIdentifierStart.test(f(v))}function y(v){return v<128?s[v]:n.NonAsciiIdentifierPart.test(f(v))}y0.exports={isDecimalDigit:a,isHexDigit:u,isOctalDigit:l,isWhiteSpace:c,isLineTerminator:h,isIdentifierStartES5:d,isIdentifierPartES5:p,isIdentifierStartES6:g,isIdentifierPartES6:y}}()),y0.exports}var v0={exports:{}},FC;function hK(){return FC||(FC=1,function(){var n=LR();function t(d){switch(d){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function r(d,p){return!p&&d==="yield"?!1:i(d,p)}function i(d,p){if(p&&t(d))return!0;switch(d.length){case 2:return d==="if"||d==="in"||d==="do";case 3:return d==="var"||d==="for"||d==="new"||d==="try";case 4:return d==="this"||d==="else"||d==="case"||d==="void"||d==="with"||d==="enum";case 5:return d==="while"||d==="break"||d==="catch"||d==="throw"||d==="const"||d==="yield"||d==="class"||d==="super";case 6:return d==="return"||d==="typeof"||d==="delete"||d==="switch"||d==="export"||d==="import";case 7:return d==="default"||d==="finally"||d==="extends";case 8:return d==="function"||d==="continue"||d==="debugger";case 10:return d==="instanceof";default:return!1}}function s(d,p){return d==="null"||d==="true"||d==="false"||r(d,p)}function o(d,p){return d==="null"||d==="true"||d==="false"||i(d,p)}function a(d){return d==="eval"||d==="arguments"}function u(d){var p,g,y;if(d.length===0||(y=d.charCodeAt(0),!n.isIdentifierStartES5(y)))return!1;for(p=1,g=d.length;p<g;++p)if(y=d.charCodeAt(p),!n.isIdentifierPartES5(y))return!1;return!0}function l(d,p){return(d-55296)*1024+(p-56320)+65536}function c(d){var p,g,y,v,T;if(d.length===0)return!1;for(T=n.isIdentifierStartES6,p=0,g=d.length;p<g;++p){if(y=d.charCodeAt(p),55296<=y&&y<=56319){if(++p,p>=g||(v=d.charCodeAt(p),!(56320<=v&&v<=57343)))return!1;y=l(y,v)}if(!T(y))return!1;T=n.isIdentifierPartES6}return!0}function h(d,p){return u(d)&&!s(d,p)}function f(d,p){return c(d)&&!o(d,p)}v0.exports={isKeywordES5:r,isKeywordES6:i,isReservedWordES5:s,isReservedWordES6:o,isRestrictedWord:a,isIdentifierNameES5:u,isIdentifierNameES6:c,isIdentifierES5:h,isIdentifierES6:f}}()),v0.exports}var PC;function fK(){return PC||(PC=1,function(){rc.ast=cK(),rc.code=LR(),rc.keyword=hK()}()),rc}var nc={},_0={},Yf={},Xf={},MC;function dK(){if(MC)return Xf;MC=1;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Xf.encode=function(t){if(0<=t&&t<n.length)return n[t];throw new TypeError("Must be between 0 and 63: "+t)},Xf.decode=function(t){var r=65,i=90,s=97,o=122,a=48,u=57,l=43,c=47,h=26,f=52;return r<=t&&t<=i?t-r:s<=t&&t<=o?t-s+h:a<=t&&t<=u?t-a+f:t==l?62:t==c?63:-1},Xf}var LC;function OR(){if(LC)return Yf;LC=1;var n=dK(),t=5,r=1<<t,i=r-1,s=r;function o(u){return u<0?(-u<<1)+1:(u<<1)+0}function a(u){var l=(u&1)===1,c=u>>1;return l?-c:c}return Yf.encode=function(l){var c="",h,f=o(l);do h=f&i,f>>>=t,f>0&&(h|=s),c+=n.encode(h);while(f>0);return c},Yf.decode=function(l,c,h){var f=l.length,d=0,p=0,g,y;do{if(c>=f)throw new Error("Expected more digits in base 64 VLQ value.");if(y=n.decode(l.charCodeAt(c++)),y===-1)throw new Error("Invalid base64 digit: "+l.charAt(c-1));g=!!(y&s),y&=i,d=d+(y<<p),p+=t}while(g);h.value=a(d),h.rest=c},Yf}var b0={},OC;function hf(){return OC||(OC=1,function(n){function t(E,S,R){if(S in E)return E[S];if(arguments.length===3)return R;throw new Error('"'+S+'" is a required argument.')}n.getArg=t;var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function s(E){var S=E.match(r);return S?{scheme:S[1],auth:S[2],host:S[3],port:S[4],path:S[5]}:null}n.urlParse=s;function o(E){var S="";return E.scheme&&(S+=E.scheme+":"),S+="//",E.auth&&(S+=E.auth+"@"),E.host&&(S+=E.host),E.port&&(S+=":"+E.port),E.path&&(S+=E.path),S}n.urlGenerate=o;function a(E){var S=E,R=s(E);if(R){if(!R.path)return E;S=R.path}for(var w=n.isAbsolute(S),x=S.split(/\/+/),b,A=0,k=x.length-1;k>=0;k--)b=x[k],b==="."?x.splice(k,1):b===".."?A++:A>0&&(b===""?(x.splice(k+1,A),A=0):(x.splice(k,2),A--));return S=x.join("/"),S===""&&(S=w?"/":"."),R?(R.path=S,o(R)):S}n.normalize=a;function u(E,S){E===""&&(E="."),S===""&&(S=".");var R=s(S),w=s(E);if(w&&(E=w.path||"/"),R&&!R.scheme)return w&&(R.scheme=w.scheme),o(R);if(R||S.match(i))return S;if(w&&!w.host&&!w.path)return w.host=S,o(w);var x=S.charAt(0)==="/"?S:a(E.replace(/\/+$/,"")+"/"+S);return w?(w.path=x,o(w)):x}n.join=u,n.isAbsolute=function(E){return E.charAt(0)==="/"||r.test(E)};function l(E,S){E===""&&(E="."),E=E.replace(/\/$/,"");for(var R=0;S.indexOf(E+"/")!==0;){var w=E.lastIndexOf("/");if(w<0||(E=E.slice(0,w),E.match(/^([^\/]+:\/)?\/*$/)))return S;++R}return Array(R+1).join("../")+S.substr(E.length+1)}n.relative=l;var c=function(){var E=Object.create(null);return!("__proto__"in E)}();function h(E){return E}function f(E){return p(E)?"$"+E:E}n.toSetString=c?h:f;function d(E){return p(E)?E.slice(1):E}n.fromSetString=c?h:d;function p(E){if(!E)return!1;var S=E.length;if(S<9||E.charCodeAt(S-1)!==95||E.charCodeAt(S-2)!==95||E.charCodeAt(S-3)!==111||E.charCodeAt(S-4)!==116||E.charCodeAt(S-5)!==111||E.charCodeAt(S-6)!==114||E.charCodeAt(S-7)!==112||E.charCodeAt(S-8)!==95||E.charCodeAt(S-9)!==95)return!1;for(var R=S-10;R>=0;R--)if(E.charCodeAt(R)!==36)return!1;return!0}function g(E,S,R){var w=v(E.source,S.source);return w!==0||(w=E.originalLine-S.originalLine,w!==0)||(w=E.originalColumn-S.originalColumn,w!==0||R)||(w=E.generatedColumn-S.generatedColumn,w!==0)||(w=E.generatedLine-S.generatedLine,w!==0)?w:v(E.name,S.name)}n.compareByOriginalPositions=g;function y(E,S,R){var w=E.generatedLine-S.generatedLine;return w!==0||(w=E.generatedColumn-S.generatedColumn,w!==0||R)||(w=v(E.source,S.source),w!==0)||(w=E.originalLine-S.originalLine,w!==0)||(w=E.originalColumn-S.originalColumn,w!==0)?w:v(E.name,S.name)}n.compareByGeneratedPositionsDeflated=y;function v(E,S){return E===S?0:E===null?1:S===null?-1:E>S?1:-1}function T(E,S){var R=E.generatedLine-S.generatedLine;return R!==0||(R=E.generatedColumn-S.generatedColumn,R!==0)||(R=v(E.source,S.source),R!==0)||(R=E.originalLine-S.originalLine,R!==0)||(R=E.originalColumn-S.originalColumn,R!==0)?R:v(E.name,S.name)}n.compareByGeneratedPositionsInflated=T;function _(E){return JSON.parse(E.replace(/^\)]}'[^\n]*\n/,""))}n.parseSourceMapInput=_;function C(E,S,R){if(S=S||"",E&&(E[E.length-1]!=="/"&&S[0]!=="/"&&(E+="/"),S=E+S),R){var w=s(R);if(!w)throw new Error("sourceMapURL could not be parsed");if(w.path){var x=w.path.lastIndexOf("/");x>=0&&(w.path=w.path.substring(0,x+1))}S=u(o(w),S)}return a(S)}n.computeSourceURL=C}(b0)),b0}var x0={},VC;function VR(){if(VC)return x0;VC=1;var n=hf(),t=Object.prototype.hasOwnProperty,r=typeof Map<"u";function i(){this._array=[],this._set=r?new Map:Object.create(null)}return i.fromArray=function(o,a){for(var u=new i,l=0,c=o.length;l<c;l++)u.add(o[l],a);return u},i.prototype.size=function(){return r?this._set.size:Object.getOwnPropertyNames(this._set).length},i.prototype.add=function(o,a){var u=r?o:n.toSetString(o),l=r?this.has(o):t.call(this._set,u),c=this._array.length;(!l||a)&&this._array.push(o),l||(r?this._set.set(o,c):this._set[u]=c)},i.prototype.has=function(o){if(r)return this._set.has(o);var a=n.toSetString(o);return t.call(this._set,a)},i.prototype.indexOf=function(o){if(r){var a=this._set.get(o);if(a>=0)return a}else{var u=n.toSetString(o);if(t.call(this._set,u))return this._set[u]}throw new Error('"'+o+'" is not in the set.')},i.prototype.at=function(o){if(o>=0&&o<this._array.length)return this._array[o];throw new Error("No element indexed by "+o)},i.prototype.toArray=function(){return this._array.slice()},x0.ArraySet=i,x0}var w0={},BC;function pK(){if(BC)return w0;BC=1;var n=hf();function t(i,s){var o=i.generatedLine,a=s.generatedLine,u=i.generatedColumn,l=s.generatedColumn;return a>o||a==o&&l>=u||n.compareByGeneratedPositionsInflated(i,s)<=0}function r(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return r.prototype.unsortedForEach=function(s,o){this._array.forEach(s,o)},r.prototype.add=function(s){t(this._last,s)?(this._last=s,this._array.push(s)):(this._sorted=!1,this._array.push(s))},r.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},w0.MappingList=r,w0}var UC;function BR(){if(UC)return _0;UC=1;var n=OR(),t=hf(),r=VR().ArraySet,i=pK().MappingList;function s(o){o||(o={}),this._file=t.getArg(o,"file",null),this._sourceRoot=t.getArg(o,"sourceRoot",null),this._skipValidation=t.getArg(o,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new i,this._sourcesContents=null}return s.prototype._version=3,s.fromSourceMap=function(a){var u=a.sourceRoot,l=new s({file:a.file,sourceRoot:u});return a.eachMapping(function(c){var h={generated:{line:c.generatedLine,column:c.generatedColumn}};c.source!=null&&(h.source=c.source,u!=null&&(h.source=t.relative(u,h.source)),h.original={line:c.originalLine,column:c.originalColumn},c.name!=null&&(h.name=c.name)),l.addMapping(h)}),a.sources.forEach(function(c){var h=c;u!==null&&(h=t.relative(u,c)),l._sources.has(h)||l._sources.add(h);var f=a.sourceContentFor(c);f!=null&&l.setSourceContent(c,f)}),l},s.prototype.addMapping=function(a){var u=t.getArg(a,"generated"),l=t.getArg(a,"original",null),c=t.getArg(a,"source",null),h=t.getArg(a,"name",null);this._skipValidation||this._validateMapping(u,l,c,h),c!=null&&(c=String(c),this._sources.has(c)||this._sources.add(c)),h!=null&&(h=String(h),this._names.has(h)||this._names.add(h)),this._mappings.add({generatedLine:u.line,generatedColumn:u.column,originalLine:l!=null&&l.line,originalColumn:l!=null&&l.column,source:c,name:h})},s.prototype.setSourceContent=function(a,u){var l=a;this._sourceRoot!=null&&(l=t.relative(this._sourceRoot,l)),u!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(l)]=u):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(a,u,l){var c=u;if(u==null){if(a.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);c=a.file}var h=this._sourceRoot;h!=null&&(c=t.relative(h,c));var f=new r,d=new r;this._mappings.unsortedForEach(function(p){if(p.source===c&&p.originalLine!=null){var g=a.originalPositionFor({line:p.originalLine,column:p.originalColumn});g.source!=null&&(p.source=g.source,l!=null&&(p.source=t.join(l,p.source)),h!=null&&(p.source=t.relative(h,p.source)),p.originalLine=g.line,p.originalColumn=g.column,g.name!=null&&(p.name=g.name))}var y=p.source;y!=null&&!f.has(y)&&f.add(y);var v=p.name;v!=null&&!d.has(v)&&d.add(v)},this),this._sources=f,this._names=d,a.sources.forEach(function(p){var g=a.sourceContentFor(p);g!=null&&(l!=null&&(p=t.join(l,p)),h!=null&&(p=t.relative(h,p)),this.setSourceContent(p,g))},this)},s.prototype._validateMapping=function(a,u,l,c){if(u&&typeof u.line!="number"&&typeof u.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0&&!u&&!l&&!c)){if(a&&"line"in a&&"column"in a&&u&&"line"in u&&"column"in u&&a.line>0&&a.column>=0&&u.line>0&&u.column>=0&&l)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:l,original:u,name:c}))}},s.prototype._serializeMappings=function(){for(var a=0,u=1,l=0,c=0,h=0,f=0,d="",p,g,y,v,T=this._mappings.toArray(),_=0,C=T.length;_<C;_++){if(g=T[_],p="",g.generatedLine!==u)for(a=0;g.generatedLine!==u;)p+=";",u++;else if(_>0){if(!t.compareByGeneratedPositionsInflated(g,T[_-1]))continue;p+=","}p+=n.encode(g.generatedColumn-a),a=g.generatedColumn,g.source!=null&&(v=this._sources.indexOf(g.source),p+=n.encode(v-f),f=v,p+=n.encode(g.originalLine-1-c),c=g.originalLine-1,p+=n.encode(g.originalColumn-l),l=g.originalColumn,g.name!=null&&(y=this._names.indexOf(g.name),p+=n.encode(y-h),h=y)),d+=p}return d},s.prototype._generateSourcesContent=function(a,u){return a.map(function(l){if(!this._sourcesContents)return null;u!=null&&(l=t.relative(u,l));var c=t.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)},s.prototype.toJSON=function(){var a={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(a.file=this._file),this._sourceRoot!=null&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},_0.SourceMapGenerator=s,_0}var ic={},E0={},$C;function gK(){return $C||($C=1,function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function t(r,i,s,o,a,u){var l=Math.floor((i-r)/2)+r,c=a(s,o[l],!0);return c===0?l:c>0?i-l>1?t(l,i,s,o,a,u):u==n.LEAST_UPPER_BOUND?i<o.length?i:-1:l:l-r>1?t(r,l,s,o,a,u):u==n.LEAST_UPPER_BOUND?l:r<0?-1:r}n.search=function(i,s,o,a){if(s.length===0)return-1;var u=t(-1,s.length,i,s,o,a||n.GREATEST_LOWER_BOUND);if(u<0)return-1;for(;u-1>=0&&o(s[u],s[u-1],!0)===0;)--u;return u}}(E0)),E0}var S0={},jC;function mK(){if(jC)return S0;jC=1;function n(i,s,o){var a=i[s];i[s]=i[o],i[o]=a}function t(i,s){return Math.round(i+Math.random()*(s-i))}function r(i,s,o,a){if(o<a){var u=t(o,a),l=o-1;n(i,u,a);for(var c=i[a],h=o;h<a;h++)s(i[h],c)<=0&&(l+=1,n(i,l,h));n(i,l+1,h);var f=l+1;r(i,s,o,f-1),r(i,s,f+1,a)}}return S0.quickSort=function(i,s){r(i,s,0,i.length-1)},S0}var GC;function yK(){if(GC)return ic;GC=1;var n=hf(),t=gK(),r=VR().ArraySet,i=OR(),s=mK().quickSort;function o(c,h){var f=c;return typeof c=="string"&&(f=n.parseSourceMapInput(c)),f.sections!=null?new l(f,h):new a(f,h)}o.fromSourceMap=function(c,h){return a.fromSourceMap(c,h)},o.prototype._version=3,o.prototype.__generatedMappings=null,Object.defineProperty(o.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),o.prototype.__originalMappings=null,Object.defineProperty(o.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),o.prototype._charIsMappingSeparator=function(h,f){var d=h.charAt(f);return d===";"||d===","},o.prototype._parseMappings=function(h,f){throw new Error("Subclasses must implement _parseMappings")},o.GENERATED_ORDER=1,o.ORIGINAL_ORDER=2,o.GREATEST_LOWER_BOUND=1,o.LEAST_UPPER_BOUND=2,o.prototype.eachMapping=function(h,f,d){var p=f||null,g=d||o.GENERATED_ORDER,y;switch(g){case o.GENERATED_ORDER:y=this._generatedMappings;break;case o.ORIGINAL_ORDER:y=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var v=this.sourceRoot;y.map(function(T){var _=T.source===null?null:this._sources.at(T.source);return _=n.computeSourceURL(v,_,this._sourceMapURL),{source:_,generatedLine:T.generatedLine,generatedColumn:T.generatedColumn,originalLine:T.originalLine,originalColumn:T.originalColumn,name:T.name===null?null:this._names.at(T.name)}},this).forEach(h,p)},o.prototype.allGeneratedPositionsFor=function(h){var f=n.getArg(h,"line"),d={source:n.getArg(h,"source"),originalLine:f,originalColumn:n.getArg(h,"column",0)};if(d.source=this._findSourceIndex(d.source),d.source<0)return[];var p=[],g=this._findMapping(d,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(g>=0){var y=this._originalMappings[g];if(h.column===void 0)for(var v=y.originalLine;y&&y.originalLine===v;)p.push({line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:n.getArg(y,"lastGeneratedColumn",null)}),y=this._originalMappings[++g];else for(var T=y.originalColumn;y&&y.originalLine===f&&y.originalColumn==T;)p.push({line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:n.getArg(y,"lastGeneratedColumn",null)}),y=this._originalMappings[++g]}return p},ic.SourceMapConsumer=o;function a(c,h){var f=c;typeof c=="string"&&(f=n.parseSourceMapInput(c));var d=n.getArg(f,"version"),p=n.getArg(f,"sources"),g=n.getArg(f,"names",[]),y=n.getArg(f,"sourceRoot",null),v=n.getArg(f,"sourcesContent",null),T=n.getArg(f,"mappings"),_=n.getArg(f,"file",null);if(d!=this._version)throw new Error("Unsupported version: "+d);y&&(y=n.normalize(y)),p=p.map(String).map(n.normalize).map(function(C){return y&&n.isAbsolute(y)&&n.isAbsolute(C)?n.relative(y,C):C}),this._names=r.fromArray(g.map(String),!0),this._sources=r.fromArray(p,!0),this._absoluteSources=this._sources.toArray().map(function(C){return n.computeSourceURL(y,C,h)}),this.sourceRoot=y,this.sourcesContent=v,this._mappings=T,this._sourceMapURL=h,this.file=_}a.prototype=Object.create(o.prototype),a.prototype.consumer=o,a.prototype._findSourceIndex=function(c){var h=c;if(this.sourceRoot!=null&&(h=n.relative(this.sourceRoot,h)),this._sources.has(h))return this._sources.indexOf(h);var f;for(f=0;f<this._absoluteSources.length;++f)if(this._absoluteSources[f]==c)return f;return-1},a.fromSourceMap=function(h,f){var d=Object.create(a.prototype),p=d._names=r.fromArray(h._names.toArray(),!0),g=d._sources=r.fromArray(h._sources.toArray(),!0);d.sourceRoot=h._sourceRoot,d.sourcesContent=h._generateSourcesContent(d._sources.toArray(),d.sourceRoot),d.file=h._file,d._sourceMapURL=f,d._absoluteSources=d._sources.toArray().map(function(R){return n.computeSourceURL(d.sourceRoot,R,f)});for(var y=h._mappings.toArray().slice(),v=d.__generatedMappings=[],T=d.__originalMappings=[],_=0,C=y.length;_<C;_++){var E=y[_],S=new u;S.generatedLine=E.generatedLine,S.generatedColumn=E.generatedColumn,E.source&&(S.source=g.indexOf(E.source),S.originalLine=E.originalLine,S.originalColumn=E.originalColumn,E.name&&(S.name=p.indexOf(E.name)),T.push(S)),v.push(S)}return s(d.__originalMappings,n.compareByOriginalPositions),d},a.prototype._version=3,Object.defineProperty(a.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function u(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}a.prototype._parseMappings=function(h,f){for(var d=1,p=0,g=0,y=0,v=0,T=0,_=h.length,C=0,E={},S={},R=[],w=[],x,b,A,k,N;C<_;)if(h.charAt(C)===";")d++,C++,p=0;else if(h.charAt(C)===",")C++;else{for(x=new u,x.generatedLine=d,k=C;k<_&&!this._charIsMappingSeparator(h,k);k++);if(b=h.slice(C,k),A=E[b],A)C+=b.length;else{for(A=[];C<k;)i.decode(h,C,S),N=S.value,C=S.rest,A.push(N);if(A.length===2)throw new Error("Found a source, but no line and column");if(A.length===3)throw new Error("Found a source and line, but no column");E[b]=A}x.generatedColumn=p+A[0],p=x.generatedColumn,A.length>1&&(x.source=v+A[1],v+=A[1],x.originalLine=g+A[2],g=x.originalLine,x.originalLine+=1,x.originalColumn=y+A[3],y=x.originalColumn,A.length>4&&(x.name=T+A[4],T+=A[4])),w.push(x),typeof x.originalLine=="number"&&R.push(x)}s(w,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=w,s(R,n.compareByOriginalPositions),this.__originalMappings=R},a.prototype._findMapping=function(h,f,d,p,g,y){if(h[d]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+h[d]);if(h[p]<0)throw new TypeError("Column must be greater than or equal to 0, got "+h[p]);return t.search(h,f,g,y)},a.prototype.computeColumnSpans=function(){for(var h=0;h<this._generatedMappings.length;++h){var f=this._generatedMappings[h];if(h+1<this._generatedMappings.length){var d=this._generatedMappings[h+1];if(f.generatedLine===d.generatedLine){f.lastGeneratedColumn=d.generatedColumn-1;continue}}f.lastGeneratedColumn=1/0}},a.prototype.originalPositionFor=function(h){var f={generatedLine:n.getArg(h,"line"),generatedColumn:n.getArg(h,"column")},d=this._findMapping(f,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(h,"bias",o.GREATEST_LOWER_BOUND));if(d>=0){var p=this._generatedMappings[d];if(p.generatedLine===f.generatedLine){var g=n.getArg(p,"source",null);g!==null&&(g=this._sources.at(g),g=n.computeSourceURL(this.sourceRoot,g,this._sourceMapURL));var y=n.getArg(p,"name",null);return y!==null&&(y=this._names.at(y)),{source:g,line:n.getArg(p,"originalLine",null),column:n.getArg(p,"originalColumn",null),name:y}}}return{source:null,line:null,column:null,name:null}},a.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(h){return h==null}):!1},a.prototype.sourceContentFor=function(h,f){if(!this.sourcesContent)return null;var d=this._findSourceIndex(h);if(d>=0)return this.sourcesContent[d];var p=h;this.sourceRoot!=null&&(p=n.relative(this.sourceRoot,p));var g;if(this.sourceRoot!=null&&(g=n.urlParse(this.sourceRoot))){var y=p.replace(/^file:\/\//,"");if(g.scheme=="file"&&this._sources.has(y))return this.sourcesContent[this._sources.indexOf(y)];if((!g.path||g.path=="/")&&this._sources.has("/"+p))return this.sourcesContent[this._sources.indexOf("/"+p)]}if(f)return null;throw new Error('"'+p+'" is not in the SourceMap.')},a.prototype.generatedPositionFor=function(h){var f=n.getArg(h,"source");if(f=this._findSourceIndex(f),f<0)return{line:null,column:null,lastColumn:null};var d={source:f,originalLine:n.getArg(h,"line"),originalColumn:n.getArg(h,"column")},p=this._findMapping(d,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(h,"bias",o.GREATEST_LOWER_BOUND));if(p>=0){var g=this._originalMappings[p];if(g.source===d.source)return{line:n.getArg(g,"generatedLine",null),column:n.getArg(g,"generatedColumn",null),lastColumn:n.getArg(g,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},ic.BasicSourceMapConsumer=a;function l(c,h){var f=c;typeof c=="string"&&(f=n.parseSourceMapInput(c));var d=n.getArg(f,"version"),p=n.getArg(f,"sections");if(d!=this._version)throw new Error("Unsupported version: "+d);this._sources=new r,this._names=new r;var g={line:-1,column:0};this._sections=p.map(function(y){if(y.url)throw new Error("Support for url field in sections not implemented.");var v=n.getArg(y,"offset"),T=n.getArg(v,"line"),_=n.getArg(v,"column");if(T<g.line||T===g.line&&_<g.column)throw new Error("Section offsets must be ordered and non-overlapping.");return g=v,{generatedOffset:{generatedLine:T+1,generatedColumn:_+1},consumer:new o(n.getArg(y,"map"),h)}})}return l.prototype=Object.create(o.prototype),l.prototype.constructor=o,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var c=[],h=0;h<this._sections.length;h++)for(var f=0;f<this._sections[h].consumer.sources.length;f++)c.push(this._sections[h].consumer.sources[f]);return c}}),l.prototype.originalPositionFor=function(h){var f={generatedLine:n.getArg(h,"line"),generatedColumn:n.getArg(h,"column")},d=t.search(f,this._sections,function(g,y){var v=g.generatedLine-y.generatedOffset.generatedLine;return v||g.generatedColumn-y.generatedOffset.generatedColumn}),p=this._sections[d];return p?p.consumer.originalPositionFor({line:f.generatedLine-(p.generatedOffset.generatedLine-1),column:f.generatedColumn-(p.generatedOffset.generatedLine===f.generatedLine?p.generatedOffset.generatedColumn-1:0),bias:h.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(h){return h.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(h,f){for(var d=0;d<this._sections.length;d++){var p=this._sections[d],g=p.consumer.sourceContentFor(h,!0);if(g)return g}if(f)return null;throw new Error('"'+h+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(h){for(var f=0;f<this._sections.length;f++){var d=this._sections[f];if(d.consumer._findSourceIndex(n.getArg(h,"source"))!==-1){var p=d.consumer.generatedPositionFor(h);if(p){var g={line:p.line+(d.generatedOffset.generatedLine-1),column:p.column+(d.generatedOffset.generatedLine===p.line?d.generatedOffset.generatedColumn-1:0)};return g}}}return{line:null,column:null}},l.prototype._parseMappings=function(h,f){this.__generatedMappings=[],this.__originalMappings=[];for(var d=0;d<this._sections.length;d++)for(var p=this._sections[d],g=p.consumer._generatedMappings,y=0;y<g.length;y++){var v=g[y],T=p.consumer._sources.at(v.source);T=n.computeSourceURL(p.consumer.sourceRoot,T,this._sourceMapURL),this._sources.add(T),T=this._sources.indexOf(T);var _=null;v.name&&(_=p.consumer._names.at(v.name),this._names.add(_),_=this._names.indexOf(_));var C={source:T,generatedLine:v.generatedLine+(p.generatedOffset.generatedLine-1),generatedColumn:v.generatedColumn+(p.generatedOffset.generatedLine===v.generatedLine?p.generatedOffset.generatedColumn-1:0),originalLine:v.originalLine,originalColumn:v.originalColumn,name:_};this.__generatedMappings.push(C),typeof C.originalLine=="number"&&this.__originalMappings.push(C)}s(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),s(this.__originalMappings,n.compareByOriginalPositions)},ic.IndexedSourceMapConsumer=l,ic}var C0={},zC;function vK(){if(zC)return C0;zC=1;var n=BR().SourceMapGenerator,t=hf(),r=/(\r?\n)/,i=10,s="$$$isSourceNode$$$";function o(a,u,l,c,h){this.children=[],this.sourceContents={},this.line=a??null,this.column=u??null,this.source=l??null,this.name=h??null,this[s]=!0,c!=null&&this.add(c)}return o.fromStringWithSourceMap=function(u,l,c){var h=new o,f=u.split(r),d=0,p=function(){var _=E(),C=E()||"";return _+C;function E(){return d<f.length?f[d++]:void 0}},g=1,y=0,v=null;return l.eachMapping(function(_){if(v!==null)if(g<_.generatedLine)T(v,p()),g++,y=0;else{var C=f[d]||"",E=C.substr(0,_.generatedColumn-y);f[d]=C.substr(_.generatedColumn-y),y=_.generatedColumn,T(v,E),v=_;return}for(;g<_.generatedLine;)h.add(p()),g++;if(y<_.generatedColumn){var C=f[d]||"";h.add(C.substr(0,_.generatedColumn)),f[d]=C.substr(_.generatedColumn),y=_.generatedColumn}v=_},this),d<f.length&&(v&&T(v,p()),h.add(f.splice(d).join(""))),l.sources.forEach(function(_){var C=l.sourceContentFor(_);C!=null&&(c!=null&&(_=t.join(c,_)),h.setSourceContent(_,C))}),h;function T(_,C){if(_===null||_.source===void 0)h.add(C);else{var E=c?t.join(c,_.source):_.source;h.add(new o(_.originalLine,_.originalColumn,E,C,_.name))}}},o.prototype.add=function(u){if(Array.isArray(u))u.forEach(function(l){this.add(l)},this);else if(u[s]||typeof u=="string")u&&this.children.push(u);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+u);return this},o.prototype.prepend=function(u){if(Array.isArray(u))for(var l=u.length-1;l>=0;l--)this.prepend(u[l]);else if(u[s]||typeof u=="string")this.children.unshift(u);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+u);return this},o.prototype.walk=function(u){for(var l,c=0,h=this.children.length;c<h;c++)l=this.children[c],l[s]?l.walk(u):l!==""&&u(l,{source:this.source,line:this.line,column:this.column,name:this.name})},o.prototype.join=function(u){var l,c,h=this.children.length;if(h>0){for(l=[],c=0;c<h-1;c++)l.push(this.children[c]),l.push(u);l.push(this.children[c]),this.children=l}return this},o.prototype.replaceRight=function(u,l){var c=this.children[this.children.length-1];return c[s]?c.replaceRight(u,l):typeof c=="string"?this.children[this.children.length-1]=c.replace(u,l):this.children.push("".replace(u,l)),this},o.prototype.setSourceContent=function(u,l){this.sourceContents[t.toSetString(u)]=l},o.prototype.walkSourceContents=function(u){for(var l=0,c=this.children.length;l<c;l++)this.children[l][s]&&this.children[l].walkSourceContents(u);for(var h=Object.keys(this.sourceContents),l=0,c=h.length;l<c;l++)u(t.fromSetString(h[l]),this.sourceContents[h[l]])},o.prototype.toString=function(){var u="";return this.walk(function(l){u+=l}),u},o.prototype.toStringWithSourceMap=function(u){var l={code:"",line:1,column:0},c=new n(u),h=!1,f=null,d=null,p=null,g=null;return this.walk(function(y,v){l.code+=y,v.source!==null&&v.line!==null&&v.column!==null?((f!==v.source||d!==v.line||p!==v.column||g!==v.name)&&c.addMapping({source:v.source,original:{line:v.line,column:v.column},generated:{line:l.line,column:l.column},name:v.name}),f=v.source,d=v.line,p=v.column,g=v.name,h=!0):h&&(c.addMapping({generated:{line:l.line,column:l.column}}),f=null,h=!1);for(var T=0,_=y.length;T<_;T++)y.charCodeAt(T)===i?(l.line++,l.column=0,T+1===_?(f=null,h=!1):h&&c.addMapping({source:v.source,original:{line:v.line,column:v.column},generated:{line:l.line,column:l.column},name:v.name})):l.column++}),this.walkSourceContents(function(y,v){c.setSourceContent(y,v)}),{code:l.code,map:c}},C0.SourceNode=o,C0}var qC;function _K(){return qC||(qC=1,nc.SourceMapGenerator=BR().SourceMapGenerator,nc.SourceMapConsumer=yK().SourceMapConsumer,nc.SourceNode=vK().SourceNode),nc}const bK="2.1.0",xK={version:bK};var HC;function wK(){return HC||(HC=1,function(n){(function(){var t,r,i,s,o,a,u,l,c,h,f,d,p,g,y,v,T,_,C,E,S,R,w,x,b,A;o=lK(),a=fK(),t=o.Syntax;function k(D){return se.Expression.hasOwnProperty(D.type)}function N(D){return se.Statement.hasOwnProperty(D.type)}r={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},i={"??":r.Coalesce,"||":r.LogicalOR,"&&":r.LogicalAND,"|":r.BitwiseOR,"^":r.BitwiseXOR,"&":r.BitwiseAND,"==":r.Equality,"!=":r.Equality,"===":r.Equality,"!==":r.Equality,is:r.Equality,isnt:r.Equality,"<":r.Relational,">":r.Relational,"<=":r.Relational,">=":r.Relational,in:r.Relational,instanceof:r.Relational,"<<":r.BitwiseSHIFT,">>":r.BitwiseSHIFT,">>>":r.BitwiseSHIFT,"+":r.Additive,"-":r.Additive,"*":r.Multiplicative,"%":r.Multiplicative,"/":r.Multiplicative,"**":r.Exponentiation};var I=1,j=2,Q=4,le=8,fe=16,ne=32,oe=64,ie=j|Q,ue=I|j,ee=I|j|Q,ve=I,ge=Q,we=I|Q,Se=I,ae=I|ne,xe=0,ce=I|fe,he=I|le;function ye(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function G(D,$){var O="";for($|=0;$>0;$>>>=1,D+=D)$&1&&(O+=D);return O}function W(D){return/[\r\n]/g.test(D)}function X(D){var $=D.length;return $&&a.code.isLineTerminator(D.charCodeAt($-1))}function V(D,$){var O;for(O in $)$.hasOwnProperty(O)&&(D[O]=$[O]);return D}function L(D,$){var O,B;function Y(Te){return typeof Te=="object"&&Te instanceof Object&&!(Te instanceof RegExp)}for(O in $)$.hasOwnProperty(O)&&(B=$[O],Y(B)?Y(D[O])?L(D[O],B):D[O]=L({},B):D[O]=B);return D}function z(D){var $,O,B,Y,Te;if(D!==D)throw new Error("Numeric literal whose value is NaN");if(D<0||D===0&&1/D<0)throw new Error("Numeric literal whose value is negative");if(D===1/0)return c?"null":h?"1e400":"1e+400";if($=""+D,!h||$.length<3)return $;for(O=$.indexOf("."),!c&&$.charCodeAt(0)===48&&O===1&&(O=0,$=$.slice(1)),B=$,$=$.replace("e+","e"),Y=0,(Te=B.indexOf("e"))>0&&(Y=+B.slice(Te+1),B=B.slice(0,Te)),O>=0&&(Y-=B.length-O-1,B=+(B.slice(0,O)+B.slice(O+1))+""),Te=0;B.charCodeAt(B.length+Te-1)===48;)--Te;return Te!==0&&(Y-=Te,B=B.slice(0,Te)),Y!==0&&(B+="e"+Y),(B.length<$.length||f&&D>1e12&&Math.floor(D)===D&&(B="0x"+D.toString(16)).length<$.length)&&+B===D&&($=B),$}function J(D,$){return(D&-2)===8232?($?"u":"\\u")+(D===8232?"2028":"2029"):D===10||D===13?($?"":"\\")+(D===10?"n":"r"):String.fromCharCode(D)}function re(D){var $,O,B,Y,Te,Re,Le,Xe;if(O=D.toString(),D.source){if($=O.match(/\/([^/]*)$/),!$)return O;for(B=$[1],O="",Le=!1,Xe=!1,Y=0,Te=D.source.length;Y<Te;++Y)Re=D.source.charCodeAt(Y),Xe?(O+=J(Re,Xe),Xe=!1):(Le?Re===93&&(Le=!1):Re===47?O+="\\":Re===91&&(Le=!0),O+=J(Re,Xe),Xe=Re===92);return"/"+O+"/"+B}return O}function te(D,$){var O;return D===8?"\\b":D===12?"\\f":D===9?"\\t":(O=D.toString(16).toUpperCase(),c||D>255?"\\u"+"0000".slice(O.length)+O:D===0&&!a.code.isDecimalDigit($)?"\\0":D===11?"\\x0B":"\\x"+"00".slice(O.length)+O)}function me(D){if(D===92)return"\\\\";if(D===10)return"\\n";if(D===13)return"\\r";if(D===8232)return"\\u2028";if(D===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Ee(D){var $,O,B,Y;for(Y=d==="double"?'"':"'",$=0,O=D.length;$<O;++$)if(B=D.charCodeAt($),B===39){Y='"';break}else if(B===34){Y="'";break}else B===92&&++$;return Y+D+Y}function Ce(D){var $="",O,B,Y,Te=0,Re=0,Le,Xe;for(O=0,B=D.length;O<B;++O){if(Y=D.charCodeAt(O),Y===39)++Te;else if(Y===34)++Re;else if(Y===47&&c)$+="\\";else if(a.code.isLineTerminator(Y)||Y===92){$+=me(Y);continue}else if(!a.code.isIdentifierPartES5(Y)&&(c&&Y<32||!c&&!p&&(Y<32||Y>126))){$+=te(Y,D.charCodeAt(O+1));continue}$+=String.fromCharCode(Y)}if(Le=!(d==="double"||d==="auto"&&Re<Te),Xe=Le?"'":'"',!(Le?Te:Re))return Xe+$+Xe;for(D=$,$=Xe,O=0,B=D.length;O<B;++O)Y=D.charCodeAt(O),(Y===39&&Le||Y===34&&!Le)&&($+="\\"),$+=String.fromCharCode(Y);return $+Xe}function Fe(D){var $,O,B,Y="";for($=0,O=D.length;$<O;++$)B=D[$],Y+=Array.isArray(B)?Fe(B):B;return Y}function De(D,$){if(!R)return Array.isArray(D)?Fe(D):D;if($==null){if(D instanceof s)return D;$={}}return $.loc==null?new s(null,null,R,D,$.name||null):new s($.loc.start.line,$.loc.start.column,R===!0?$.loc.source||null:R,D,$.name||null)}function ze(){return y||" "}function Me(D,$){var O,B,Y,Te;return O=De(D).toString(),O.length===0?[$]:(B=De($).toString(),B.length===0?[D]:(Y=O.charCodeAt(O.length-1),Te=B.charCodeAt(0),(Y===43||Y===45)&&Y===Te||a.code.isIdentifierPartES5(Y)&&a.code.isIdentifierPartES5(Te)||Y===47&&Te===105?[D,ze(),$]:a.code.isWhiteSpace(Y)||a.code.isLineTerminator(Y)||a.code.isWhiteSpace(Te)||a.code.isLineTerminator(Te)?[D,$]:[D,y,$]))}function Ue(D){return[u,D]}function Qe(D){var $;$=u,u+=l,D(u),u=$}function kt(D){var $;for($=D.length-1;$>=0&&!a.code.isLineTerminator(D.charCodeAt($));--$);return D.length-1-$}function Lt(D,$){var O,B,Y,Te,Re,Le,Xe,wt;for(O=D.split(/\r\n|[\r\n]/),Le=Number.MAX_VALUE,B=1,Y=O.length;B<Y;++B){for(Te=O[B],Re=0;Re<Te.length&&a.code.isWhiteSpace(Te.charCodeAt(Re));)++Re;Le>Re&&(Le=Re)}for(typeof $<"u"?(Xe=u,O[1][Le]==="*"&&($+=" "),u=$):(Le&1&&--Le,Xe=u),B=1,Y=O.length;B<Y;++B)wt=De(Ue(O[B].slice(Le))),O[B]=R?wt.join(""):wt;return u=Xe,O.join(`
`)}function lt(D,$){if(D.type==="Line"){if(X(D.value))return"//"+D.value;var O="//"+D.value;return x||(O+=`
`),O}return E.format.indent.adjustMultilineComment&&/[\n\r]/.test(D.value)?Lt("/*"+D.value+"*/",$):"/*"+D.value+"*/"}function Xt(D,$){var O,B,Y,Te,Re,Le,Xe,wt,or,Ji,ln,Pl,Ml,Sn;if(D.leadingComments&&D.leadingComments.length>0){if(Te=$,x){for(Y=D.leadingComments[0],$=[],wt=Y.extendedRange,or=Y.range,ln=w.substring(wt[0],or[0]),Sn=(ln.match(/\n/g)||[]).length,Sn>0?($.push(G(`
`,Sn)),$.push(Ue(lt(Y)))):($.push(ln),$.push(lt(Y))),Ji=or,O=1,B=D.leadingComments.length;O<B;O++)Y=D.leadingComments[O],or=Y.range,Pl=w.substring(Ji[1],or[0]),Sn=(Pl.match(/\n/g)||[]).length,$.push(G(`
`,Sn)),$.push(Ue(lt(Y))),Ji=or;Ml=w.substring(or[1],wt[1]),Sn=(Ml.match(/\n/g)||[]).length,$.push(G(`
`,Sn))}else for(Y=D.leadingComments[0],$=[],_&&D.type===t.Program&&D.body.length===0&&$.push(`
`),$.push(lt(Y)),X(De($).toString())||$.push(`
`),O=1,B=D.leadingComments.length;O<B;++O)Y=D.leadingComments[O],Xe=[lt(Y)],X(De(Xe).toString())||Xe.push(`
`),$.push(Ue(Xe));$.push(Ue(Te))}if(D.trailingComments)if(x)Y=D.trailingComments[0],wt=Y.extendedRange,or=Y.range,ln=w.substring(wt[0],or[0]),Sn=(ln.match(/\n/g)||[]).length,Sn>0?($.push(G(`
`,Sn)),$.push(Ue(lt(Y)))):($.push(ln),$.push(lt(Y)));else for(Re=!X(De($).toString()),Le=G(" ",kt(De([u,$,l]).toString())),O=0,B=D.trailingComments.length;O<B;++O)Y=D.trailingComments[O],Re?(O===0?$=[$,l]:$=[$,Le],$.push(lt(Y,Le))):$=[$,Ue(lt(Y))],O!==B-1&&!X(De($).toString())&&($=[$,`
`]);return $}function P(D,$,O){var B,Y=0;for(B=D;B<$;B++)w[B]===`
`&&Y++;for(B=1;B<Y;B++)O.push(g)}function U(D,$,O){return $<O?["(",D,")"]:D}function H(D){var $,O,B;for(B=D.split(/\r\n|\n/),$=1,O=B.length;$<O;$++)B[$]=g+u+B[$];return B}function Z(D,$){var O,B,Y;return O=D[E.verbatim],typeof O=="string"?B=U(H(O),r.Sequence,$):(B=H(O.content),Y=O.precedence!=null?O.precedence:r.Sequence,B=U(B,Y,$)),De(B,D)}function se(){}se.prototype.maybeBlock=function(D,$){var O,B,Y=this;return B=!E.comment||!D.leadingComments,D.type===t.BlockStatement&&B?[y,this.generateStatement(D,$)]:D.type===t.EmptyStatement&&B?";":(Qe(function(){O=[g,Ue(Y.generateStatement(D,$))]}),O)},se.prototype.maybeBlockSuffix=function(D,$){var O=X(De($).toString());return D.type===t.BlockStatement&&(!E.comment||!D.leadingComments)&&!O?[$,y]:O?[$,u]:[$,g,u]};function Ie(D){return De(D.name,D)}function Ne(D,$){return D.async?"async"+($?ze():y):""}function He(D){var $=D.generator&&!E.moz.starlessGenerator;return $?"*"+y:""}function Ze(D){var $=D.value,O="";return $.async&&(O+=Ne($,!D.computed)),$.generator&&(O+=He($)?"*":""),O}se.prototype.generatePattern=function(D,$,O){return D.type===t.Identifier?Ie(D):this.generateExpression(D,$,O)},se.prototype.generateFunctionParams=function(D){var $,O,B,Y;if(Y=!1,D.type===t.ArrowFunctionExpression&&!D.rest&&(!D.defaults||D.defaults.length===0)&&D.params.length===1&&D.params[0].type===t.Identifier)B=[Ne(D,!0),Ie(D.params[0])];else{for(B=D.type===t.ArrowFunctionExpression?[Ne(D,!1)]:[],B.push("("),D.defaults&&(Y=!0),$=0,O=D.params.length;$<O;++$)Y&&D.defaults[$]?B.push(this.generateAssignment(D.params[$],D.defaults[$],"=",r.Assignment,ee)):B.push(this.generatePattern(D.params[$],r.Assignment,ee)),$+1<O&&B.push(","+y);D.rest&&(D.params.length&&B.push(","+y),B.push("..."),B.push(Ie(D.rest))),B.push(")")}return B},se.prototype.generateFunctionBody=function(D){var $,O;return $=this.generateFunctionParams(D),D.type===t.ArrowFunctionExpression&&($.push(y),$.push("=>")),D.expression?($.push(y),O=this.generateExpression(D.body,r.Assignment,ee),O.toString().charAt(0)==="{"&&(O=["(",O,")"]),$.push(O)):$.push(this.maybeBlock(D.body,he)),$},se.prototype.generateIterationForStatement=function(D,$,O){var B=["for"+($.await?ze()+"await":"")+y+"("],Y=this;return Qe(function(){$.left.type===t.VariableDeclaration?Qe(function(){B.push($.left.kind+ze()),B.push(Y.generateStatement($.left.declarations[0],xe))}):B.push(Y.generateExpression($.left,r.Call,ee)),B=Me(B,D),B=[Me(B,Y.generateExpression($.right,r.Assignment,ee)),")"]}),B.push(this.maybeBlock($.body,O)),B},se.prototype.generatePropertyKey=function(D,$){var O=[];return $&&O.push("["),O.push(this.generateExpression(D,r.Assignment,ee)),$&&O.push("]"),O},se.prototype.generateAssignment=function(D,$,O,B,Y){return r.Assignment<B&&(Y|=I),U([this.generateExpression(D,r.Call,Y),y+O+y,this.generateExpression($,r.Assignment,Y)],r.Assignment,B)},se.prototype.semicolon=function(D){return!T&&D&ne?"":";"},se.Statement={BlockStatement:function(D,$){var O,B,Y=["{",g],Te=this;return Qe(function(){D.body.length===0&&x&&(O=D.range,O[1]-O[0]>2&&(B=w.substring(O[0]+1,O[1]-1),B[0]===`
`&&(Y=["{"]),Y.push(B)));var Re,Le,Xe,wt;for(wt=Se,$&le&&(wt|=fe),Re=0,Le=D.body.length;Re<Le;++Re)x&&(Re===0&&(D.body[0].leadingComments&&(O=D.body[0].leadingComments[0].extendedRange,B=w.substring(O[0],O[1]),B[0]===`
`&&(Y=["{"])),D.body[0].leadingComments||P(D.range[0],D.body[0].range[0],Y)),Re>0&&!D.body[Re-1].trailingComments&&!D.body[Re].leadingComments&&P(D.body[Re-1].range[1],D.body[Re].range[0],Y)),Re===Le-1&&(wt|=ne),D.body[Re].leadingComments&&x?Xe=Te.generateStatement(D.body[Re],wt):Xe=Ue(Te.generateStatement(D.body[Re],wt)),Y.push(Xe),X(De(Xe).toString())||x&&Re<Le-1&&D.body[Re+1].leadingComments||Y.push(g),x&&Re===Le-1&&(D.body[Re].trailingComments||P(D.body[Re].range[1],D.range[1],Y))}),Y.push(Ue("}")),Y},BreakStatement:function(D,$){return D.label?"break "+D.label.name+this.semicolon($):"break"+this.semicolon($)},ContinueStatement:function(D,$){return D.label?"continue "+D.label.name+this.semicolon($):"continue"+this.semicolon($)},ClassBody:function(D,$){var O=["{",g],B=this;return Qe(function(Y){var Te,Re;for(Te=0,Re=D.body.length;Te<Re;++Te)O.push(Y),O.push(B.generateExpression(D.body[Te],r.Sequence,ee)),Te+1<Re&&O.push(g)}),X(De(O).toString())||O.push(g),O.push(u),O.push("}"),O},ClassDeclaration:function(D,$){var O,B;return O=["class"],D.id&&(O=Me(O,this.generateExpression(D.id,r.Sequence,ee))),D.superClass&&(B=Me("extends",this.generateExpression(D.superClass,r.Unary,ee)),O=Me(O,B)),O.push(y),O.push(this.generateStatement(D.body,ae)),O},DirectiveStatement:function(D,$){return E.raw&&D.raw?D.raw+this.semicolon($):Ee(D.directive)+this.semicolon($)},DoWhileStatement:function(D,$){var O=Me("do",this.maybeBlock(D.body,Se));return O=this.maybeBlockSuffix(D.body,O),Me(O,["while"+y+"(",this.generateExpression(D.test,r.Sequence,ee),")"+this.semicolon($)])},CatchClause:function(D,$){var O,B=this;return Qe(function(){var Y;D.param?(O=["catch"+y+"(",B.generateExpression(D.param,r.Sequence,ee),")"],D.guard&&(Y=B.generateExpression(D.guard,r.Sequence,ee),O.splice(2,0," if ",Y))):O=["catch"]}),O.push(this.maybeBlock(D.body,Se)),O},DebuggerStatement:function(D,$){return"debugger"+this.semicolon($)},EmptyStatement:function(D,$){return";"},ExportDefaultDeclaration:function(D,$){var O=["export"],B;return B=$&ne?ae:Se,O=Me(O,"default"),N(D.declaration)?O=Me(O,this.generateStatement(D.declaration,B)):O=Me(O,this.generateExpression(D.declaration,r.Assignment,ee)+this.semicolon($)),O},ExportNamedDeclaration:function(D,$){var O=["export"],B,Y=this;return B=$&ne?ae:Se,D.declaration?Me(O,this.generateStatement(D.declaration,B)):(D.specifiers&&(D.specifiers.length===0?O=Me(O,"{"+y+"}"):D.specifiers[0].type===t.ExportBatchSpecifier?O=Me(O,this.generateExpression(D.specifiers[0],r.Sequence,ee)):(O=Me(O,"{"),Qe(function(Te){var Re,Le;for(O.push(g),Re=0,Le=D.specifiers.length;Re<Le;++Re)O.push(Te),O.push(Y.generateExpression(D.specifiers[Re],r.Sequence,ee)),Re+1<Le&&O.push(","+g)}),X(De(O).toString())||O.push(g),O.push(u+"}")),D.source?O=Me(O,["from"+y,this.generateExpression(D.source,r.Sequence,ee),this.semicolon($)]):O.push(this.semicolon($))),O)},ExportAllDeclaration:function(D,$){return["export"+y,"*"+y,"from"+y,this.generateExpression(D.source,r.Sequence,ee),this.semicolon($)]},ExpressionStatement:function(D,$){var O,B;function Y(Le){var Xe;return Le.slice(0,5)!=="class"?!1:(Xe=Le.charCodeAt(5),Xe===123||a.code.isWhiteSpace(Xe)||a.code.isLineTerminator(Xe))}function Te(Le){var Xe;return Le.slice(0,8)!=="function"?!1:(Xe=Le.charCodeAt(8),Xe===40||a.code.isWhiteSpace(Xe)||Xe===42||a.code.isLineTerminator(Xe))}function Re(Le){var Xe,wt,or;if(Le.slice(0,5)!=="async"||!a.code.isWhiteSpace(Le.charCodeAt(5)))return!1;for(wt=6,or=Le.length;wt<or&&a.code.isWhiteSpace(Le.charCodeAt(wt));++wt);return wt===or||Le.slice(wt,wt+8)!=="function"?!1:(Xe=Le.charCodeAt(wt+8),Xe===40||a.code.isWhiteSpace(Xe)||Xe===42||a.code.isLineTerminator(Xe))}return O=[this.generateExpression(D.expression,r.Sequence,ee)],B=De(O).toString(),B.charCodeAt(0)===123||Y(B)||Te(B)||Re(B)||C&&$&fe&&D.expression.type===t.Literal&&typeof D.expression.value=="string"?O=["(",O,")"+this.semicolon($)]:O.push(this.semicolon($)),O},ImportDeclaration:function(D,$){var O,B,Y=this;return D.specifiers.length===0?["import",y,this.generateExpression(D.source,r.Sequence,ee),this.semicolon($)]:(O=["import"],B=0,D.specifiers[B].type===t.ImportDefaultSpecifier&&(O=Me(O,[this.generateExpression(D.specifiers[B],r.Sequence,ee)]),++B),D.specifiers[B]&&(B!==0&&O.push(","),D.specifiers[B].type===t.ImportNamespaceSpecifier?O=Me(O,[y,this.generateExpression(D.specifiers[B],r.Sequence,ee)]):(O.push(y+"{"),D.specifiers.length-B===1?(O.push(y),O.push(this.generateExpression(D.specifiers[B],r.Sequence,ee)),O.push(y+"}"+y)):(Qe(function(Te){var Re,Le;for(O.push(g),Re=B,Le=D.specifiers.length;Re<Le;++Re)O.push(Te),O.push(Y.generateExpression(D.specifiers[Re],r.Sequence,ee)),Re+1<Le&&O.push(","+g)}),X(De(O).toString())||O.push(g),O.push(u+"}"+y)))),O=Me(O,["from"+y,this.generateExpression(D.source,r.Sequence,ee),this.semicolon($)]),O)},VariableDeclarator:function(D,$){var O=$&I?ee:ie;return D.init?[this.generateExpression(D.id,r.Assignment,O),y,"=",y,this.generateExpression(D.init,r.Assignment,O)]:this.generatePattern(D.id,r.Assignment,O)},VariableDeclaration:function(D,$){var O,B,Y,Te,Re,Le=this;O=[D.kind],Re=$&I?Se:xe;function Xe(){for(Te=D.declarations[0],E.comment&&Te.leadingComments?(O.push(`
`),O.push(Ue(Le.generateStatement(Te,Re)))):(O.push(ze()),O.push(Le.generateStatement(Te,Re))),B=1,Y=D.declarations.length;B<Y;++B)Te=D.declarations[B],E.comment&&Te.leadingComments?(O.push(","+g),O.push(Ue(Le.generateStatement(Te,Re)))):(O.push(","+y),O.push(Le.generateStatement(Te,Re)))}return D.declarations.length>1?Qe(Xe):Xe(),O.push(this.semicolon($)),O},ThrowStatement:function(D,$){return[Me("throw",this.generateExpression(D.argument,r.Sequence,ee)),this.semicolon($)]},TryStatement:function(D,$){var O,B,Y,Te;if(O=["try",this.maybeBlock(D.block,Se)],O=this.maybeBlockSuffix(D.block,O),D.handlers)for(B=0,Y=D.handlers.length;B<Y;++B)O=Me(O,this.generateStatement(D.handlers[B],Se)),(D.finalizer||B+1!==Y)&&(O=this.maybeBlockSuffix(D.handlers[B].body,O));else{for(Te=D.guardedHandlers||[],B=0,Y=Te.length;B<Y;++B)O=Me(O,this.generateStatement(Te[B],Se)),(D.finalizer||B+1!==Y)&&(O=this.maybeBlockSuffix(Te[B].body,O));if(D.handler)if(Array.isArray(D.handler))for(B=0,Y=D.handler.length;B<Y;++B)O=Me(O,this.generateStatement(D.handler[B],Se)),(D.finalizer||B+1!==Y)&&(O=this.maybeBlockSuffix(D.handler[B].body,O));else O=Me(O,this.generateStatement(D.handler,Se)),D.finalizer&&(O=this.maybeBlockSuffix(D.handler.body,O))}return D.finalizer&&(O=Me(O,["finally",this.maybeBlock(D.finalizer,Se)])),O},SwitchStatement:function(D,$){var O,B,Y,Te,Re,Le=this;if(Qe(function(){O=["switch"+y+"(",Le.generateExpression(D.discriminant,r.Sequence,ee),")"+y+"{"+g]}),D.cases)for(Re=Se,Y=0,Te=D.cases.length;Y<Te;++Y)Y===Te-1&&(Re|=ne),B=Ue(this.generateStatement(D.cases[Y],Re)),O.push(B),X(De(B).toString())||O.push(g);return O.push(Ue("}")),O},SwitchCase:function(D,$){var O,B,Y,Te,Re,Le=this;return Qe(function(){for(D.test?O=[Me("case",Le.generateExpression(D.test,r.Sequence,ee)),":"]:O=["default:"],Y=0,Te=D.consequent.length,Te&&D.consequent[0].type===t.BlockStatement&&(B=Le.maybeBlock(D.consequent[0],Se),O.push(B),Y=1),Y!==Te&&!X(De(O).toString())&&O.push(g),Re=Se;Y<Te;++Y)Y===Te-1&&$&ne&&(Re|=ne),B=Ue(Le.generateStatement(D.consequent[Y],Re)),O.push(B),Y+1!==Te&&!X(De(B).toString())&&O.push(g)}),O},IfStatement:function(D,$){var O,B,Y,Te=this;return Qe(function(){O=["if"+y+"(",Te.generateExpression(D.test,r.Sequence,ee),")"]}),Y=$&ne,B=Se,Y&&(B|=ne),D.alternate?(O.push(this.maybeBlock(D.consequent,Se)),O=this.maybeBlockSuffix(D.consequent,O),D.alternate.type===t.IfStatement?O=Me(O,["else ",this.generateStatement(D.alternate,B)]):O=Me(O,Me("else",this.maybeBlock(D.alternate,B)))):O.push(this.maybeBlock(D.consequent,B)),O},ForStatement:function(D,$){var O,B=this;return Qe(function(){O=["for"+y+"("],D.init?D.init.type===t.VariableDeclaration?O.push(B.generateStatement(D.init,xe)):(O.push(B.generateExpression(D.init,r.Sequence,ie)),O.push(";")):O.push(";"),D.test&&(O.push(y),O.push(B.generateExpression(D.test,r.Sequence,ee))),O.push(";"),D.update&&(O.push(y),O.push(B.generateExpression(D.update,r.Sequence,ee))),O.push(")")}),O.push(this.maybeBlock(D.body,$&ne?ae:Se)),O},ForInStatement:function(D,$){return this.generateIterationForStatement("in",D,$&ne?ae:Se)},ForOfStatement:function(D,$){return this.generateIterationForStatement("of",D,$&ne?ae:Se)},LabeledStatement:function(D,$){return[D.label.name+":",this.maybeBlock(D.body,$&ne?ae:Se)]},Program:function(D,$){var O,B,Y,Te,Re;for(Te=D.body.length,O=[_&&Te>0?`
`:""],Re=ce,Y=0;Y<Te;++Y)!_&&Y===Te-1&&(Re|=ne),x&&(Y===0&&(D.body[0].leadingComments||P(D.range[0],D.body[Y].range[0],O)),Y>0&&!D.body[Y-1].trailingComments&&!D.body[Y].leadingComments&&P(D.body[Y-1].range[1],D.body[Y].range[0],O)),B=Ue(this.generateStatement(D.body[Y],Re)),O.push(B),Y+1<Te&&!X(De(B).toString())&&(x&&D.body[Y+1].leadingComments||O.push(g)),x&&Y===Te-1&&(D.body[Y].trailingComments||P(D.body[Y].range[1],D.range[1],O));return O},FunctionDeclaration:function(D,$){return[Ne(D,!0),"function",He(D)||ze(),D.id?Ie(D.id):"",this.generateFunctionBody(D)]},ReturnStatement:function(D,$){return D.argument?[Me("return",this.generateExpression(D.argument,r.Sequence,ee)),this.semicolon($)]:["return"+this.semicolon($)]},WhileStatement:function(D,$){var O,B=this;return Qe(function(){O=["while"+y+"(",B.generateExpression(D.test,r.Sequence,ee),")"]}),O.push(this.maybeBlock(D.body,$&ne?ae:Se)),O},WithStatement:function(D,$){var O,B=this;return Qe(function(){O=["with"+y+"(",B.generateExpression(D.object,r.Sequence,ee),")"]}),O.push(this.maybeBlock(D.body,$&ne?ae:Se)),O}},V(se.prototype,se.Statement),se.Expression={SequenceExpression:function(D,$,O){var B,Y,Te;for(r.Sequence<$&&(O|=I),B=[],Y=0,Te=D.expressions.length;Y<Te;++Y)B.push(this.generateExpression(D.expressions[Y],r.Assignment,O)),Y+1<Te&&B.push(","+y);return U(B,r.Sequence,$)},AssignmentExpression:function(D,$,O){return this.generateAssignment(D.left,D.right,D.operator,$,O)},ArrowFunctionExpression:function(D,$,O){return U(this.generateFunctionBody(D),r.ArrowFunction,$)},ConditionalExpression:function(D,$,O){return r.Conditional<$&&(O|=I),U([this.generateExpression(D.test,r.Coalesce,O),y+"?"+y,this.generateExpression(D.consequent,r.Assignment,O),y+":"+y,this.generateExpression(D.alternate,r.Assignment,O)],r.Conditional,$)},LogicalExpression:function(D,$,O){return D.operator==="??"&&(O|=oe),this.BinaryExpression(D,$,O)},BinaryExpression:function(D,$,O){var B,Y,Te,Re,Le,Xe;return Re=i[D.operator],Y=D.operator==="**"?r.Postfix:Re,Te=D.operator==="**"?Re:Re+1,Re<$&&(O|=I),Le=this.generateExpression(D.left,Y,O),Xe=Le.toString(),Xe.charCodeAt(Xe.length-1)===47&&a.code.isIdentifierPartES5(D.operator.charCodeAt(0))?B=[Le,ze(),D.operator]:B=Me(Le,D.operator),Le=this.generateExpression(D.right,Te,O),D.operator==="/"&&Le.toString().charAt(0)==="/"||D.operator.slice(-1)==="<"&&Le.toString().slice(0,3)==="!--"?(B.push(ze()),B.push(Le)):B=Me(B,Le),D.operator==="in"&&!(O&I)?["(",B,")"]:(D.operator==="||"||D.operator==="&&")&&O&oe?["(",B,")"]:U(B,Re,$)},CallExpression:function(D,$,O){var B,Y,Te;for(B=[this.generateExpression(D.callee,r.Call,ue)],D.optional&&B.push("?."),B.push("("),Y=0,Te=D.arguments.length;Y<Te;++Y)B.push(this.generateExpression(D.arguments[Y],r.Assignment,ee)),Y+1<Te&&B.push(","+y);return B.push(")"),O&j?U(B,r.Call,$):["(",B,")"]},ChainExpression:function(D,$,O){r.OptionalChaining<$&&(O|=j);var B=this.generateExpression(D.expression,r.OptionalChaining,O);return U(B,r.OptionalChaining,$)},NewExpression:function(D,$,O){var B,Y,Te,Re,Le;if(Y=D.arguments.length,Le=O&Q&&!v&&Y===0?we:ve,B=Me("new",this.generateExpression(D.callee,r.New,Le)),!(O&Q)||v||Y>0){for(B.push("("),Te=0,Re=Y;Te<Re;++Te)B.push(this.generateExpression(D.arguments[Te],r.Assignment,ee)),Te+1<Re&&B.push(","+y);B.push(")")}return U(B,r.New,$)},MemberExpression:function(D,$,O){var B,Y;return B=[this.generateExpression(D.object,r.Call,O&j?ue:ve)],D.computed?(D.optional&&B.push("?."),B.push("["),B.push(this.generateExpression(D.property,r.Sequence,O&j?ee:we)),B.push("]")):(!D.optional&&D.object.type===t.Literal&&typeof D.object.value=="number"&&(Y=De(B).toString(),Y.indexOf(".")<0&&!/[eExX]/.test(Y)&&a.code.isDecimalDigit(Y.charCodeAt(Y.length-1))&&!(Y.length>=2&&Y.charCodeAt(0)===48)&&B.push(" ")),B.push(D.optional?"?.":"."),B.push(Ie(D.property))),U(B,r.Member,$)},MetaProperty:function(D,$,O){var B;return B=[],B.push(typeof D.meta=="string"?D.meta:Ie(D.meta)),B.push("."),B.push(typeof D.property=="string"?D.property:Ie(D.property)),U(B,r.Member,$)},UnaryExpression:function(D,$,O){var B,Y,Te,Re,Le;return Y=this.generateExpression(D.argument,r.Unary,ee),y===""?B=Me(D.operator,Y):(B=[D.operator],D.operator.length>2?B=Me(B,Y):(Re=De(B).toString(),Le=Re.charCodeAt(Re.length-1),Te=Y.toString().charCodeAt(0),((Le===43||Le===45)&&Le===Te||a.code.isIdentifierPartES5(Le)&&a.code.isIdentifierPartES5(Te))&&B.push(ze()),B.push(Y))),U(B,r.Unary,$)},YieldExpression:function(D,$,O){var B;return D.delegate?B="yield*":B="yield",D.argument&&(B=Me(B,this.generateExpression(D.argument,r.Yield,ee))),U(B,r.Yield,$)},AwaitExpression:function(D,$,O){var B=Me(D.all?"await*":"await",this.generateExpression(D.argument,r.Await,ee));return U(B,r.Await,$)},UpdateExpression:function(D,$,O){return D.prefix?U([D.operator,this.generateExpression(D.argument,r.Unary,ee)],r.Unary,$):U([this.generateExpression(D.argument,r.Postfix,ee),D.operator],r.Postfix,$)},FunctionExpression:function(D,$,O){var B=[Ne(D,!0),"function"];return D.id?(B.push(He(D)||ze()),B.push(Ie(D.id))):B.push(He(D)||y),B.push(this.generateFunctionBody(D)),B},ArrayPattern:function(D,$,O){return this.ArrayExpression(D,$,O,!0)},ArrayExpression:function(D,$,O,B){var Y,Te,Re=this;return D.elements.length?(Te=B?!1:D.elements.length>1,Y=["[",Te?g:""],Qe(function(Le){var Xe,wt;for(Xe=0,wt=D.elements.length;Xe<wt;++Xe)D.elements[Xe]?(Y.push(Te?Le:""),Y.push(Re.generateExpression(D.elements[Xe],r.Assignment,ee))):(Te&&Y.push(Le),Xe+1===wt&&Y.push(",")),Xe+1<wt&&Y.push(","+(Te?g:y))}),Te&&!X(De(Y).toString())&&Y.push(g),Y.push(Te?u:""),Y.push("]"),Y):"[]"},RestElement:function(D,$,O){return"..."+this.generatePattern(D.argument)},ClassExpression:function(D,$,O){var B,Y;return B=["class"],D.id&&(B=Me(B,this.generateExpression(D.id,r.Sequence,ee))),D.superClass&&(Y=Me("extends",this.generateExpression(D.superClass,r.Unary,ee)),B=Me(B,Y)),B.push(y),B.push(this.generateStatement(D.body,ae)),B},MethodDefinition:function(D,$,O){var B,Y;return D.static?B=["static"+y]:B=[],D.kind==="get"||D.kind==="set"?Y=[Me(D.kind,this.generatePropertyKey(D.key,D.computed)),this.generateFunctionBody(D.value)]:Y=[Ze(D),this.generatePropertyKey(D.key,D.computed),this.generateFunctionBody(D.value)],Me(B,Y)},Property:function(D,$,O){return D.kind==="get"||D.kind==="set"?[D.kind,ze(),this.generatePropertyKey(D.key,D.computed),this.generateFunctionBody(D.value)]:D.shorthand?D.value.type==="AssignmentPattern"?this.AssignmentPattern(D.value,r.Sequence,ee):this.generatePropertyKey(D.key,D.computed):D.method?[Ze(D),this.generatePropertyKey(D.key,D.computed),this.generateFunctionBody(D.value)]:[this.generatePropertyKey(D.key,D.computed),":"+y,this.generateExpression(D.value,r.Assignment,ee)]},ObjectExpression:function(D,$,O){var B,Y,Te,Re=this;return D.properties.length?(B=D.properties.length>1,Qe(function(){Te=Re.generateExpression(D.properties[0],r.Sequence,ee)}),!B&&!W(De(Te).toString())?["{",y,Te,y,"}"]:(Qe(function(Le){var Xe,wt;if(Y=["{",g,Le,Te],B)for(Y.push(","+g),Xe=1,wt=D.properties.length;Xe<wt;++Xe)Y.push(Le),Y.push(Re.generateExpression(D.properties[Xe],r.Sequence,ee)),Xe+1<wt&&Y.push(","+g)}),X(De(Y).toString())||Y.push(g),Y.push(u),Y.push("}"),Y)):"{}"},AssignmentPattern:function(D,$,O){return this.generateAssignment(D.left,D.right,"=",$,O)},ObjectPattern:function(D,$,O){var B,Y,Te,Re,Le,Xe=this;if(!D.properties.length)return"{}";if(Re=!1,D.properties.length===1)Le=D.properties[0],Le.type===t.Property&&Le.value.type!==t.Identifier&&(Re=!0);else for(Y=0,Te=D.properties.length;Y<Te;++Y)if(Le=D.properties[Y],Le.type===t.Property&&!Le.shorthand){Re=!0;break}return B=["{",Re?g:""],Qe(function(wt){var or,Ji;for(or=0,Ji=D.properties.length;or<Ji;++or)B.push(Re?wt:""),B.push(Xe.generateExpression(D.properties[or],r.Sequence,ee)),or+1<Ji&&B.push(","+(Re?g:y))}),Re&&!X(De(B).toString())&&B.push(g),B.push(Re?u:""),B.push("}"),B},ThisExpression:function(D,$,O){return"this"},Super:function(D,$,O){return"super"},Identifier:function(D,$,O){return Ie(D)},ImportDefaultSpecifier:function(D,$,O){return Ie(D.id||D.local)},ImportNamespaceSpecifier:function(D,$,O){var B=["*"],Y=D.id||D.local;return Y&&B.push(y+"as"+ze()+Ie(Y)),B},ImportSpecifier:function(D,$,O){var B=D.imported,Y=[B.name],Te=D.local;return Te&&Te.name!==B.name&&Y.push(ze()+"as"+ze()+Ie(Te)),Y},ExportSpecifier:function(D,$,O){var B=D.local,Y=[B.name],Te=D.exported;return Te&&Te.name!==B.name&&Y.push(ze()+"as"+ze()+Ie(Te)),Y},Literal:function(D,$,O){var B;if(D.hasOwnProperty("raw")&&S&&E.raw)try{if(B=S(D.raw).body[0].expression,B.type===t.Literal&&B.value===D.value)return D.raw}catch{}return D.regex?"/"+D.regex.pattern+"/"+D.regex.flags:typeof D.value=="bigint"?D.value.toString()+"n":D.bigint?D.bigint+"n":D.value===null?"null":typeof D.value=="string"?Ce(D.value):typeof D.value=="number"?z(D.value):typeof D.value=="boolean"?D.value?"true":"false":re(D.value)},GeneratorExpression:function(D,$,O){return this.ComprehensionExpression(D,$,O)},ComprehensionExpression:function(D,$,O){var B,Y,Te,Re,Le=this;return B=D.type===t.GeneratorExpression?["("]:["["],E.moz.comprehensionExpressionStartsWithAssignment&&(Re=this.generateExpression(D.body,r.Assignment,ee),B.push(Re)),D.blocks&&Qe(function(){for(Y=0,Te=D.blocks.length;Y<Te;++Y)Re=Le.generateExpression(D.blocks[Y],r.Sequence,ee),Y>0||E.moz.comprehensionExpressionStartsWithAssignment?B=Me(B,Re):B.push(Re)}),D.filter&&(B=Me(B,"if"+y),Re=this.generateExpression(D.filter,r.Sequence,ee),B=Me(B,["(",Re,")"])),E.moz.comprehensionExpressionStartsWithAssignment||(Re=this.generateExpression(D.body,r.Assignment,ee),B=Me(B,Re)),B.push(D.type===t.GeneratorExpression?")":"]"),B},ComprehensionBlock:function(D,$,O){var B;return D.left.type===t.VariableDeclaration?B=[D.left.kind,ze(),this.generateStatement(D.left.declarations[0],xe)]:B=this.generateExpression(D.left,r.Call,ee),B=Me(B,D.of?"of":"in"),B=Me(B,this.generateExpression(D.right,r.Sequence,ee)),["for"+y+"(",B,")"]},SpreadElement:function(D,$,O){return["...",this.generateExpression(D.argument,r.Assignment,ee)]},TaggedTemplateExpression:function(D,$,O){var B=ue;O&j||(B=ve);var Y=[this.generateExpression(D.tag,r.Call,B),this.generateExpression(D.quasi,r.Primary,ge)];return U(Y,r.TaggedTemplate,$)},TemplateElement:function(D,$,O){return D.value.raw},TemplateLiteral:function(D,$,O){var B,Y,Te;for(B=["`"],Y=0,Te=D.quasis.length;Y<Te;++Y)B.push(this.generateExpression(D.quasis[Y],r.Primary,ee)),Y+1<Te&&(B.push("${"+y),B.push(this.generateExpression(D.expressions[Y],r.Sequence,ee)),B.push(y+"}"));return B.push("`"),B},ModuleSpecifier:function(D,$,O){return this.Literal(D,$,O)},ImportExpression:function(D,$,O){return U(["import(",this.generateExpression(D.source,r.Assignment,ee),")"],r.Call,$)}},V(se.prototype,se.Expression),se.prototype.generateExpression=function(D,$,O){var B,Y;return Y=D.type||t.Property,E.verbatim&&D.hasOwnProperty(E.verbatim)?Z(D,$):(B=this[Y](D,$,O),E.comment&&(B=Xt(D,B)),De(B,D))},se.prototype.generateStatement=function(D,$){var O,B;return O=this[D.type](D,$),E.comment&&(O=Xt(D,O)),B=De(O).toString(),D.type===t.Program&&!_&&g===""&&B.charAt(B.length-1)===`
`&&(O=R?De(O).replaceRight(/\s+$/,""):B.replace(/\s+$/,"")),De(O,D)};function ct(D){var $;if($=new se,N(D))return $.generateStatement(D,Se);if(k(D))return $.generateExpression(D,r.Sequence,ee);throw new Error("Unknown node type: "+D.type)}function Gt(D,$){var O=ye(),B,Y;return $!=null?(typeof $.indent=="string"&&(O.format.indent.style=$.indent),typeof $.base=="number"&&(O.format.indent.base=$.base),$=L(O,$),l=$.format.indent.style,typeof $.base=="string"?u=$.base:u=G(l,$.format.indent.base)):($=O,l=$.format.indent.style,u=G(l,$.format.indent.base)),c=$.format.json,h=$.format.renumber,f=c?!1:$.format.hexadecimal,d=c?"double":$.format.quotes,p=$.format.escapeless,g=$.format.newline,y=$.format.space,$.format.compact&&(g=y=l=u=""),v=$.format.parentheses,T=$.format.semicolons,_=$.format.safeConcatenation,C=$.directive,S=c?null:$.parse,R=$.sourceMap,w=$.sourceCode,x=$.format.preserveBlankLines&&w!==null,E=$,R&&(n.browser?s=yG.sourceMap.SourceNode:s=_K().SourceNode),B=ct(D),R?(Y=B.toStringWithSourceMap({file:$.file,sourceRoot:$.sourceMapRoot}),$.sourceContent&&Y.map.setSourceContent($.sourceMap,$.sourceContent),$.sourceMapWithCode?Y:Y.map.toString()):(Y={code:B.toString(),map:null},$.sourceMapWithCode?Y:Y.code)}b={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},A=ye().format,n.version=xK.version,n.generate=Gt,n.attachComments=o.attachComments,n.Precedence=L({},r),n.browser=!1,n.FORMAT_MINIFY=b,n.FORMAT_DEFAULTS=A})()}(p0)),p0}var EK=wK();const SK=ik(EK);function UR(n,t){let r,i;const s=n.Shader.prototype.modify;n.Shader.prototype.modify=function(V,L={parser:!0,srcLocations:!1}){if(V instanceof Function){let z;if(L.parser){const te=V.toString(),me=KN(te,{ecmaVersion:2021,locations:L.srcLocations});wH(me,u,void 0,{varyings:{}});const Ee=SK.generate(me);z=new Function(Ee.slice(Ee.indexOf("{")+1,Ee.lastIndexOf("}")).replaceAll(";",""))}else z=V;const re=new ve(z,this,L.srcLocations).generate();return s.call(this,re)}else return s.call(this,V)};function o(V){switch(V){case"+":return"add";case"-":return"sub";case"*":return"mult";case"/":return"div";case"%":return"mod";case"==":case"===":return"equalTo";case">":return"greaterThan";case">=":return"greaterThanEqualTo";case"<":return"lessThan";case"&&":return"and";case"||":return"or"}}function a(V){var L,z;return V.type==="CallExpression"&&((L=V.callee)==null?void 0:L.type)==="Identifier"&&((z=V.callee)==null?void 0:z.name.startsWith("uniform"))}const u={UnaryExpression(V,L,z){if(z.some(a))return;const J={type:"Literal",value:V.operator},re=te=>{te.type="CallExpression",te.callee={type:"Identifier",name:"unaryNode"},te.arguments=[te.argument,J]};if(V.type==="MemberExpression"){const te=V.argument.property.name;[["x","y","z","w"],["r","g","b","a"],["s","t","p","q"]].some(Ce=>[...te].every(Fe=>Ce.includes(Fe)))&&V.argument.type==="MemberExpression"?(V.type="MemberExpression",V.object={type:"CallExpression",callee:{type:"Identifier",name:"unaryNode"},arguments:[V.argument.object,J]},V.property={type:"Identifier",name:te}):re(V)}else re(V);delete V.argument,delete V.operator},VariableDeclarator(V,L,z){var J,re;if(V.init.callee&&((J=V.init.callee.name)!=null&&J.startsWith("uniform"))){const te={type:"Literal",value:V.id.name};V.init.arguments.unshift(te)}if(V.init.callee&&((re=V.init.callee.name)!=null&&re.startsWith("varying"))){const te={type:"Literal",value:V.id.name};V.init.arguments.unshift(te),L.varyings[V.id.name]=te}},Identifier(V,L,z){L.varyings[V.name]&&!z.some(J=>J.type==="AssignmentExpression"&&J.left===V)&&(V.type="ExpressionStatement",V.expression={type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:V.name},property:{type:"Identifier",name:"getValue"}},arguments:[]})},ArrayExpression(V,L,z){const J=JSON.parse(JSON.stringify(V));V.type="CallExpression",V.callee={type:"Identifier",name:"dynamicNode"},V.arguments=[J]},AssignmentExpression(V,L,z){if(V.operator!=="="){const J=o(V.operator.replace("=","")),re={type:"CallExpression",callee:{type:"MemberExpression",object:V.left,property:{type:"Identifier",name:J}},arguments:[V.right]};V.operator="=",V.right=re}L.varyings[V.left.name]&&(V.type="ExpressionStatement",V.expression={type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:V.left.name},property:{type:"Identifier",name:"bridge"}},arguments:[V.right]})},BinaryExpression(V,L,z){if(z.some(a))return;if(["Literal","ArrayExpression","Identifier"].includes(V.left.type)){const re={type:"CallExpression",callee:{type:"Identifier",name:"dynamicNode"},arguments:[V.left]};V.left=re}V.type="CallExpression",V.callee={type:"MemberExpression",object:V.left,property:{type:"Identifier",name:o(V.operator)}},V.arguments=[V.right]}};class l{constructor(L,z){if(new.target===l)throw new TypeError("Cannot construct BaseNode instances directly. This is an abstract class.");if(this.type=z,this.componentNames=[],this.componentsChanged=!1,this.isInternal=L,this.usedIn=[],this.dependsOn=[],this.srcLine=null,this.usedInConditional=!1,r.srcLocations===!0&&L===!1)try{throw new Error("StackCapture")}catch(J){const re=J.stack.split(`
`);let te=5;j(this)&&te--,this.srcLine=re[te].trim()}}addVectorComponents(){if(this.type.startsWith("vec")){const L=parseInt(this.type.slice(3));this.componentNames=["x","y","z","w"].slice(0,L);const z=this;for(let J of this.componentNames){let re=new g(z,J,"float",!0);Object.defineProperty(this,J,{get(){return re},set(te){this.componentsChanged=!0,ue(this)?this.node.value=te:re=te}})}}}forceTemporaryVariable(){(!(N(this)&&ie(this.parent))||!Q(this))&&(this.useTemp=!0)}assertUsedInConditional(L){this.usedInConditional=!0,this.usedIn.push(L),this.forceTemporaryVariable()}isUsedInConditional(){return this.usedInConditional}checkConditionalDependencies(L){L.ifs.forEach(z=>{const J=()=>z.usedInSatisfied.length>=1,re=()=>z.dependsOn.length===z.dependsOnSatisfied.length;z.insertionPoint>-1||!z.usedIn.length||(z.dependsOn.some(te=>te.node===this)&&!z.dependsOnSatisfied.includes(this)&&z.dependsOnSatisfied.push(this),z.usedIn.includes(this)&&!z.usedInSatisfied.includes(this)&&z.usedInSatisfied.push(this),re()&&J()&&z.saveState(L,re(),J()))})}toGLSLBase(L){let z;if(this.shouldUseTemporaryVariable()){let J=L.declarations.length;z=this.getTemporaryVariable(L);let re=L.declarations.length-1-J;re=re>0?re:void 0,this.dependsOn.forEach(te=>{if(te.isVector){const me=te.originalComponents.map((Ee,Ce)=>Ee===te.currentComponents[Ce]);L.updateComponents(te.node,re,me)}else L.updateComponents(te.node,re)})}else z=this.toGLSL(L);return this.checkConditionalDependencies(L),z}shouldUseTemporaryVariable(){if(this.componentsChanged||fe(this)||this.useTemp)return!0;if(this.isInternal||Q(this)||le(this)||this.type==="sampler2D")return!1;let L=0;return L+=oe(this)*2,L+=j(this)*2,L+=I(this)*3,L+=this.usedIn.length,L>=4}getTemporaryVariable(L){if(!this.temporaryVariable){this.temporaryVariable=`temp_${L.getNextID()}`;let z="";this.srcLine&&(z+=`
// From ${this.srcLine}
`),z+="  "+this.type+" "+this.temporaryVariable+" = "+this.toGLSL(L)+";",L.declarations.push(z)}return this.temporaryVariable}add(L){return he(this,this.enforceType(L),"+")}sub(L){return he(this,this.enforceType(L),"-")}mult(L){return he(this,this.enforceType(L),"*")}div(L){return he(this,this.enforceType(L),"/")}mod(L){return he(this,this.enforceType(L),"%")}enforceType(L){if(b(L)){if(!ee(L.type))throw new TypeError(`You've tried to perform an operation on a struct of type: ${L.type}. Try accessing a member on that struct with '.'`);if(!ee(L.type))throw new TypeError(`You've tried to perform an operation on a struct of type: ${L.type}. Try accessing a member on that struct with '.'`);return(k(this)||I(this))&&A(L)?new h(L):L}else return typeof L=="number"?A(this)?new c(L):new h(L):Array.isArray(L)?W.dynamicVector(L):W[this.type](L)}toFloat(){if(k(this))return this;if(A(this))return new h(this)}toGLSL(L){throw new TypeError("Not supposed to call this function on BaseNode, which is an abstract class.")}}class c extends l{constructor(L=0,z=!1){super(z,"int"),this.x=L}toGLSL(L){if(b(this.x)){let z=this.x.toGLSLBase(L);return A(this.x.type)?z:`int(${z})`}else return typeof this.x=="number"?`${Math.floor(this.x)}`:`int(${this.x})`}}class h extends l{constructor(L=0,z=!1,J=!1){if(super(z,"float"),Array.isArray(L)&&(L=L[0]),J){const{parent:re,name:te}=J;this.name=te,this.parent=re}this.x=L}toGLSL(L){if(b(this.x)){let z=this.x.toGLSLBase(L);return k(this.x)?z:`float(${z})`}else return typeof this.x=="number"?`${this.x.toFixed(4)}`:`float(${this.x})`}}class f extends l{constructor(L,z,J=!1){super(J,z),this.originalValues=Se(L,parseInt(z.slice(3))),this.componentNames=["x","y","z","w"].slice(0,this.originalValues.length)}addVectorComponents(){const L=this.originalValues;this.componentsChanged=!1,this.componentNames.forEach((z,J)=>{const re={name:z,parent:this};let te=N(L[J])?L[J]:new h(L[J],!0,re);Object.defineProperty(this,z,{get(){return te},set(me){this.componentsChanged=!0,ue(this)?this.node.value=me:te=N(me)?me:new h(me,!0,re)}})}),this.originalValues=this.componentNames.map(z=>this[z])}toGLSL(L){if((!this.componentsChanged||!this.defined)&&!this.oldName){let z=this.componentNames.map((J,re)=>this.originalValues[re].toGLSLBase(L)).join(", ");return this.defined=!0,`${this.type}(${z})`}else return this.temporaryVariable}}class d extends l{constructor(L,z,J,re=!1){let te;const me=Ee=>{let Ce,Fe=0;const De=z.every((ze,Me)=>{const Ue=w(ze);let Qe=Ee.args[Me];return Qe==="genType"&&((Ce===void 0||Ce==="float"&&Ue.startsWith("vec"))&&(Ce=Ue),Qe=Ce),Fe+=Ue===Qe,Ue===Qe||Ue==="float"&&Qe.startsWith("vec")});return{...Ee,valid:De,similarity:Fe,genType:Ce}};if(Array.isArray(J)){let Ee=J.filter(Fe=>Fe.args.length===z.length);if(Ee.length===0){const Fe=new Set,De=[];J.forEach(Me=>Fe.add(Me.args.length)),Fe.forEach(Me=>De.push(`${Me}`));const ze=De.join(" or ");throw new Error(`Function '${L}' has ${J.length} variants which expect ${ze} arguments, but ${z.length} arguments were provided.`)}const Ce=function(Fe,De){return De=me(De),De.valid&&(!Fe||De.similarity>Fe.similarity)&&(Fe=De),Fe};te=Ee.reduce(Ce,null)}else te=me(J);if(!te||!te.valid){const Ee=De=>`(${De.map(ze=>ze).join(", ")})`,Ce=Array.isArray(J)?J.map(De=>Ee(De.args)).join(" or "):Ee(J.args),Fe=Ee(z.map(De=>w(De)));throw new Error(`Function '${L}' was called with wrong arguments. Most likely, you provided mixed lengths vectors as arguments.
Expected argument types: ${Ce}
Provided argument types: ${Fe}
All of the arguments with expected type 'genType' should have a matching type. If one of those is different, try to find where it was created.
        `)}if(z.length!==te.args.length)throw new Error(`Function '${L}' expects ${te.args.length} arguments, but ${z.length} were provided.`);z=z.map((Ee,Ce)=>{if(b(Ee))k(Ee)&&te.args[Ce]==="genType"&&te.genType!=="float"&&(Ee=W[te.genType](Ee));else{const Fe=te.args[Ce]==="genType"?te.genType:te.args[Ce];Ee=W[Fe](Ee)}return Ee}),te.returnType==="genType"&&(te.returnType=te.genType),super(re,te.returnType),this.name=L,this.args=z,this.argumentTypes=te.args}deconstructArgs(L){return this.args.map((J,re)=>(A(J)&&this.argumentTypes[re]!="float"&&(J=J.toFloat()),J.toGLSLBase(L),J.toGLSLBase(L))).join(", ")}toGLSL(L){return`${this.name}(${this.deconstructArgs(L)})`}}class p extends l{constructor(L,z,J=!1){super(J,z),this.name=L}toGLSL(L){return`${this.name}`}}class g extends l{constructor(L,z,J,re=!1){super(re,J),this.parent=L,this.componentName=z,this.type=J}toGLSL(L){let z=this.parent.toGLSLBase(L);return!Q(this.parent)&&!fe(this.parent)&&(z=`(${z})`),`${z}.${this.componentName}`}}class y extends p{constructor(L,z,J=!1){super(L,z,J),this.timesChanged=0,this.tempVars=0}getValue(){const L=r.context;if(!L.varyings[this.name]||!this.timesChanged)return this;let z=L.varyings[this.name].splice(0,this.timesChanged),J;return z.forEach((re,te)=>{let{value:me}=re;if(L.declarations.push(`  ${this.name} = ${me.toGLSLBase(L)};`),te===z.length-1){const Ee=`${this.name}_${this.tempVars++}`;J=ce(new p(Ee,this.type,!0)),L.declarations.push(`  ${this.type} ${Ee} = ${this.name};`)}}),this.timesChanged=0,J}bridge(L){(!b(L)||this.type.startsWith("vec")&&w(L)==="float")&&(L=W[this.type](L)),r.registerVarying(this,L),this.timesChanged+=1}}class v extends l{constructor(L,z,J,re=!1){super(re,null),this.operator=J,this.left=L,this.right=z;for(const te of[L,z])te.usedIn.push(this);this.type=this.determineType()}determineType(){if(["==",">",">=","<","<=","||","!","&&"].includes(this.operator))return"bool";if(this.left.type===this.right.type)return this.left.type;if(I(this.left)&&k(this.right))return this.left.type;if(I(this.right)&&k(this.left))return this.right.type;if(k(this.left)&&A(this.right)||A(this.left)&&k(this.right))return"float";throw new Error("Incompatible types for binary operator")}processOperand(L,z){if(L.temporaryVariable)return L.temporaryVariable;let J=L.toGLSLBase(z);return j(L)&&!L.temporaryVariable&&(J=`(${J})`),this.type==="float"&&A(L)&&(J=`float(${J})`),J}toGLSL(L){const z=this.processOperand(this.left,L),J=this.processOperand(this.right,L);return`${z} ${this.operator} ${J}`}}class T extends v{constructor(L,z,J){super(L,z,J)}toGLSL(L){return I(this)||k(this)?`mod(${this.left.toGLSLBase(L)}, ${this.right.toGLSLBase(L)})`:`${this.processOperand(L,this.left)} % ${this.processOperand(L,this.right)}`}}class _ extends l{constructor(L,z,J=!1){super(J,L.type),this.node=L,this.operator=z}toGLSL(L){let z=this.node.toGLSLBase(L);return!Q(this.node)&&!fe(this.node)&&!ne(this.node)&&(z=`(${z})`),`${this.operator}${z}`}}l.prototype.equalTo=function(V){return he(this,this.enforceType(V),"==")},l.prototype.greaterThan=function(V){return he(this,this.enforceType(V),">")},l.prototype.greaterThanEqualTo=function(V){return he(this,this.enforceType(V),">=")},l.prototype.lessThan=function(V){return he(this,this.enforceType(V),"<")},l.prototype.lessThanEqualTo=function(V){return he(this,this.enforceType(V),"<=")},l.prototype.not=function(){return new _(this.condition,"!",!0)},l.prototype.or=function(V){return new he(this,this.enforceType(V),"||",!0)},l.prototype.and=function(V){return new he(this,this.enforceType(V),"&&",!0)};function C(V){const L=new S;return V(),i=null,L}class E{constructor(L,z){this.dependsOn=[],this.usedIn=[],this.dependsOnSatisfied=[],this.usedInSatisfied=[],this.states=[],this.if(L,z),this.insertionPoint=-1,this.elseIfs=[],this.elseBranch=null,r.context.ifs.push(this)}if(L,z){this.condition=L,this.conditionString=L.toGLSL(r.context),this.ifBranch=C(z),this.ifBranch.parent=this}elseIf(L,z){let J=C(z);return z.parent=this,this.elseIfs.push({condition:L,elseBranch:J}),this}else(L){return this.elseBranch=C(L),this.elseBranch.parent=this,this}thenDiscard(){return new R(this.condition)}saveState(L,z,J){this.states.push({line:L.declarations.length,usedInSatisfied:z,dependsOnSatisfied:J}),this.insertionPoint=L.declarations.length-1}toGLSL(L){const z=L.declarations.length;this.dependsOn.forEach(me=>L.updateComponents(me.node));const re=L.declarations.length-z;this.insertionPoint+=re;let te=[`
  if (${this.conditionString}) {`,`
    ${this.ifBranch.toGLSL(L)}`,`
  }`];return this.elseIfs.length&&this.elseIfs.forEach(me=>{let{condition:Ee,elseBranch:Ce}=me;te.push(` else if (${Ee.toGLSL(L)}) {`),te.push(`
    ${Ce.toGLSL(L)}`),te.push(`
  }`)}),this.elseBranch&&(te.push(" else {"),te.push(`
    ${this.elseBranch.toGLSL(L)}`),te.push(`
  }
`)),te.push(`
`),te.flat().join("")}}t.assign=function(V,L){if(!i)throw new error('assign() is supposed to be used inside of conditional branchs. Use the "=" operator as normal otherwise.');i.assign(V,L)};class S{constructor(){i=this,this.statements=[],this.assignments=[],this.dependsOn=[],this.declarations=[];let L=null;Object.defineProperty(this,"parent",{get(){return L},set(z){z.dependsOn.push(...this.dependsOn),L=z}})}assign(L,z){!b(z)||z.type!==L.type?(z=W[L.type](z),this.declarations.push(z),this.assignments.push({node:L})):this.assignments.push({node:L,value:z}),L=L.parent?L.parent:L,z=z.parent?z.parent:z,![L,z].some(J=>this.dependsOn.some(re=>re.node===J))&&(L.assertUsedInConditional(this),this.dependsOn.push(ge(L)),z.shouldUseTemporaryVariable()&&(z.assertUsedInConditional(this),this.dependsOn.push(ge(z))))}toGLSL(L){let z=0;return this.assignments.forEach(({node:J,value:re})=>{let te,me;if(re)me=re.toGLSLBase(L);else{let Ee=this.declarations[z];z++,Ee.temporaryVariable=`temp_${L.getNextID()}`,this.statements.push(`${Ee.type} ${Ee.temporaryVariable} = ${Ee.toGLSL(L)};`),me=Ee.toGLSLBase(L)}Q(J)||fe(J)?te=`${J.toGLSLBase(L)} = ${me};`:N(J)&&J.name?te=`${J.parent.toGLSLBase(L)}.${J.name} = ${me};`:(J.temporaryVariable=`temp_${L.getNextID()}`,te=`${J.type} ${J.toGLSLBase(L)} = ${me};`),this.statements.push(te)}),this.statements.join(`
    `)}}class R{constructor(L){this.condition=L}toGLSL(L){L.discardConditions.push(`if (${this.condition}{discard;})`)}}function w(V){if(b(V))return V.type;if(Array.isArray(V)&&V.length>1)return`vec${V.length}`;if(typeof V=="number"||Array.isArray(V)&&V.length===1)return"float"}function x(V){let L=0;if(Array.isArray(V))for(let z of V)I(z)?L+=parseInt(z.type.slice(3)):L+=1;else I(V)&&(L+=parseInt(val.type.slice(3)));if(![2,3,4].includes(L))throw new Error(`You have attempted to construct a vector with ${L} values. Only vec2, vec3, and vec4 types are supported.`);return L}t.dynamicNode=function(V){if(b(V))return V;if(typeof V=="number")return new h(V);if(Array.isArray(V))return W.dynamicVector(V)},t.unaryNode=function(V,L){return V=dynamicNode(V),ce(new _(V,L))};function b(V){return V instanceof l}function A(V){return b(V)&&V.type==="int"}function k(V){return b(V)&&V.type==="float"}function N(V){return V instanceof h}function I(V){return b(V)&&(V.type==="vec2"||V.type==="vec3"||V.type==="vec4")}function j(V){return V instanceof v}function Q(V){return V instanceof p||V instanceof g}function le(V){return V instanceof E||V instanceof S}function fe(V){return V.temporaryVariable}function ne(V){return V instanceof h||V instanceof c||V instanceof f}function oe(V){return V instanceof d}function ie(V){return V instanceof f}function ue(V){return V instanceof _}function ee(V){return["int","float","vec2","vec3","vec4","sampler2D"].includes(V)}class ve{constructor(L,z,J){r=this,this.userCallback=L,this.srcLocations=J,this.cleanup=()=>{},this.generateHookOverrides(z),this.output={vertexDeclarations:new Set,fragmentDeclarations:new Set,uniforms:{}},this.uniformNodes=[],this.resetGLSLContext(),this.isGenerating=!1}generate(){const L=n.disableFriendlyErrors;return n.disableFriendlyErrors=!0,this.isGenerating=!0,this.userCallback(),this.output.vertexDeclarations=[...this.output.vertexDeclarations].join(`
`),this.output.fragmentDeclarations=[...this.output.fragmentDeclarations].join(`
`),this.isGenerating=!1,this.cleanup(),n.disableFriendlyErrors=L,this.output}generateHookOverrides(L){const z={...L.hooks.vertex,...L.hooks.fragment},J={};Object.keys(z).forEach(re=>{const te=L.hookTypes(re);this[te.name]=function(me){const Ee=[],Ce=[];te.parameters.forEach(Ue=>{if(ee(Ue.type.typeName))Ee.push(ye(Ue.name,Ue.type.typeName,!0));else{const kt={};Ue.type.properties.forEach(Lt=>{kt[Lt.name]=ye(`${Ue.name}.${Lt.name}`,Lt.type.typeName,!0)}),Ee.push(kt)}const Qe=Ue.type.qualifiers.length>0?Ue.type.qualifiers.join(" "):"";Ce.push(`${Qe} ${Ue.type.typeName} ${Ue.name}`.trim())});let Fe=me(...Ee);const De=te.returnType,ze={};ee(De.typeName)?(b(Fe)?k(Fe)&&De.typeName.startsWith("vec")&&(Fe=W[De.typeName](Fe)):Fe=W[De.typeName](Fe),ze.notAProperty=Fe.toGLSLBase(this.context),this.context.updateComponents(Fe)):Object.entries(Fe).forEach(([Ue,Qe])=>{Qe=dynamicNode(Qe),ze[Ue]=Qe.toGLSLBase(this.context),this.context.updateComponents(Qe)}),this.context.ifs.forEach(Ue=>{if(Ue.usedIn.length===0)return;const Qe=Ue.toGLSL(this.context);this.context.declarations.splice(Ue.insertionPoint,0,Qe)});let Me=[`(${Ce.join(", ")}) {`,...this.context.declarations,`
  ${te.returnType.typeName} finalReturnValue;`];Object.entries(ze).forEach(([Ue,Qe])=>{const kt=De.properties?`.${Ue}`:"";Me.push(`  finalReturnValue${kt} = ${Qe};`)}),this.context.declarations=[];for(let Ue in this.context.varyings){const Qe=this.context.varyings[Ue],kt=[];Qe.forEach(Lt=>{const{node:lt,value:Xt}=Lt;kt.push(`  ${lt.name} = ${Xt.toGLSLBase(this.context)};`),kt.unshift(...this.context.declarations),lt.timesChanged=0}),Me.push(...kt)}Me.push("  return finalReturnValue;","}"),this.output[re]=Me.join(`
`),this.resetGLSLContext()},J[te.name]=window[te.name],window[te.name]=function(me){r[te.name](me)}}),this.cleanup=()=>{for(const re in J)window[re]=J[re]}}registerVarying(L,z){Array.isArray(this.context.varyings[L.name])||(this.context.varyings[L.name]=[]),this.context.varyings[L.name].push({node:L,value:z}),this.output.vertexDeclarations.add(`OUT ${L.type} ${L.name};`),this.output.fragmentDeclarations.add(`IN ${L.type} ${L.name};`)}resetGLSLContext(){this.uniformNodes.forEach(L=>{L.usedIn=[],L.temporaryVariable=void 0}),this.context={id:0,getNextID(){return this.id++},declarations:[],varyings:[],ifs:[],updateComponents:function(L,z,J){if(L.componentsChanged){J||(J=L.componentNames.map(()=>!0));const re=[];if(ie(L))L.componentNames.forEach((te,me)=>{if(J[me]&&L[te]!==L.originalValues[me]){const Ee=W.float(L[te]),Ce=`  ${L.temporaryVariable}.${te} = ${Ee.toGLSLBase(this)};`;re.push(Ce)}});else{const te=L.componentNames.map(Ce=>L[Ce]),me=W[L.type](te),Ee=`  ${L.temporaryVariable} = ${me.toGLSLBase(this)};`;re.push(Ee)}z?this.declarations.splice(z,0,...re):this.declarations.push(...re),L.componentsChanged=!1}}},this.uniformNodes=[]}}function ge(V){return I(V)?{node:V,isVector:!0,originalComponents:[...V.componentNames.map(L=>V[L])],get currentComponents(){return V.componentNames.map(L=>V[L])}}:{node:V,isVector:!1}}function we(V){return V.map(L=>ge(L))}function Se(V,L){return Array.isArray(V)||(V=[V]),V=V.flat(),V=V.map(z=>I(z)?z.componentNames.map(re=>z[re]):z).flat(),V.length===1&&!ie(V[0])&&(V=Array(L).fill(V[0])),V}function ae(V){const L=[["x","y","z","w"],["r","g","b","a"],["s","t","p","q"]].map(z=>z.slice(0,V));return{get(z,J,re){if(J in z)return Reflect.get(...arguments);for(const te of L)if([...J].every(me=>te.includes(me))){if(J.length===1)return z[L[0][te.indexOf(J[0])]];const me=[...J].map(Ce=>{const Fe=te.indexOf(Ce),De=L[0][Fe];return z[De]}),Ee=`vec${J.length}`;return W[Ee](me)}},set(z,J,re,te){for(const me of L){const Ee=[...J];if(Ee.every(Ce=>me.includes(Ce))){const Ce=Array.isArray(re)?re:Array(J.length).fill(re);return Ee.forEach((Fe,De)=>{const ze=me.indexOf(Fe),Me=L[0][ze];Reflect.set(z,Me,Ce[De],te)}),!0}}return Reflect.set(...arguments)}}}t.If=function(V,L){return new E(V,L)},t.instanceID=function(){return ye("gl_InstanceID","int")},t.getTexture=function(...V){return G("getTexture",V,{args:["sampler2D","vec2"],returnType:"vec4",isp5Function:!0})};const xe={int:"Int",float:"Float",vec2:"Vector2",vec3:"Vector3",vec4:"Vector4",sampler2D:"Texture"};function ce(V,L){if(V.type.startsWith("vec")||L){const z=parseInt(V.type.slice(3));V=new Proxy(V,ae(z)),V.addVectorComponents()}return V}function he(V,L,z,J){let re;return z==="%"?re=new T(V,L):re=new v(V,L,z,J),ce(re)}function ye(V,L,z){const J=new p(V,L,z);return ce(J)}function G(V,L,z,J){let re=new d(V,L,z,J);return re=ce(re),re.dependsOn=we(re.args),re.args.map(me=>me.usedIn.filter(Ce=>le(Ce)).map(Ce=>Ce instanceof S?Ce.parent:Ce)).flat().forEach(me=>me.usedIn.push(re)),re}const W={int:V=>new c(V),float:V=>new h(V),vec2:V=>ce(new f(V,"vec2")),vec3:V=>ce(new f(V,"vec3")),vec4:V=>ce(new f(V,"vec4")),dynamicVector:function(V){const L=x(V);return this[`vec${L}`](V)}};for(const V in xe){const L=xe[V],z=`uniform${L}`;if(ve.prototype[z]=function(...te){let[me,...Ee]=te;V.startsWith("vec")&&!(Ee[0]instanceof Function)?(Ee=Se(Ee,parseInt(V.slice(3))),this.output.uniforms[`${V} ${me}`]=Ee):this.output.uniforms[`${V} ${me}`]=Ee[0];const Ce=ye(me,V,!1);return this.uniformNodes.push(Ce),Ce},t[z]=function(...te){return r[z](...te)},V==="sampler2D")continue;const J=`varying${L}`;ve.prototype[J]=function(te){return ce(new y(te,V,!1))},t[J]=function(te){return r[J](te)};const re=t[V];t[V]=function(...te){if(r!=null&&r.isGenerating)return V.startsWith("vec")?te=Se(te,parseInt(V.slice(3))):te=te[0],W[V](te);if(re)return re.apply(this,te);n._friendlyError(`It looks like you've called ${V} outside of a shader's modify() function.`)}}Object.entries({acos:{args:["genType"],returnType:"genType",isp5Function:!0},acosh:{args:["genType"],returnType:"genType",isp5Function:!1},asin:{args:["genType"],returnType:"genType",isp5Function:!0},asinh:{args:["genType"],returnType:"genType",isp5Function:!1},atan:[{args:["genType"],returnType:"genType",isp5Function:!1},{args:["genType","genType"],returnType:"genType",isp5Function:!1}],atanh:{args:["genType"],returnType:"genType",isp5Function:!1},cos:{args:["genType"],returnType:"genType",isp5Function:!0},cosh:{args:["genType"],returnType:"genType",isp5Function:!1},degrees:{args:["genType"],returnType:"genType",isp5Function:!0},radians:{args:["genType"],returnType:"genType",isp5Function:!0},sin:{args:["genType"],returnType:"genType",isp5Function:!0},sinh:{args:["genType"],returnType:"genType",isp5Function:!1},tan:{args:["genType"],returnType:"genType",isp5Function:!0},tanh:{args:["genType"],returnType:"genType",isp5Function:!1},abs:{args:["genType"],returnType:"genType",isp5Function:!0},ceil:{args:["genType"],returnType:"genType",isp5Function:!0},clamp:{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},dFdx:{args:["genType"],returnType:"genType",isp5Function:!1},dFdy:{args:["genType"],returnType:"genType",isp5Function:!1},exp:{args:["genType"],returnType:"genType",isp5Function:!0},exp2:{args:["genType"],returnType:"genType",isp5Function:!1},floor:{args:["genType"],returnType:"genType",isp5Function:!0},fma:{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},fract:{args:["genType"],returnType:"genType",isp5Function:!0},fwidth:{args:["genType"],returnType:"genType",isp5Function:!1},inversesqrt:{args:["genType"],returnType:"genType",isp5Function:!0},log:{args:["genType"],returnType:"genType",isp5Function:!0},log2:{args:["genType"],returnType:"genType",isp5Function:!1},max:[{args:["genType","genType"],returnType:"genType",isp5Function:!0},{args:["genType","float"],returnType:"genType",isp5Function:!0}],min:[{args:["genType","genType"],returnType:"genType",isp5Function:!0},{args:["genType","float"],returnType:"genType",isp5Function:!0}],mix:[{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},{args:["genType","genType","float"],returnType:"genType",isp5Function:!1}],pow:{args:["genType","genType"],returnType:"genType",isp5Function:!0},round:{args:["genType"],returnType:"genType",isp5Function:!0},roundEven:{args:["genType"],returnType:"genType",isp5Function:!1},smoothstep:[{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},{args:["float","float","genType"],returnType:"genType",isp5Function:!1}],sqrt:{args:["genType"],returnType:"genType",isp5Function:!0},step:{args:["genType","genType"],returnType:"genType",isp5Function:!1},trunc:{args:["genType"],returnType:"genType",isp5Function:!1},cross:{args:["vec3","vec3"],returnType:"vec3",isp5Function:!0},distance:{args:["genType","genType"],returnType:"float",isp5Function:!0},dot:{args:["genType","genType"],returnType:"float",isp5Function:!0},faceforward:{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},length:{args:["genType"],returnType:"float",isp5Function:!1},normalize:{args:["genType"],returnType:"genType",isp5Function:!0},reflect:{args:["genType","genType"],returnType:"genType",isp5Function:!1},refract:{args:["genType","genType","float"],returnType:"genType",isp5Function:!1},texture:{args:["sampler2D","vec2"],returnType:"vec4",isp5Function:!0}}).forEach(([V,L])=>{if(Array.isArray(L)?L[0].isp5Function:L.isp5Function){const J=t[V];t[V]=function(...re){return r!=null&&r.isGenerating?G(V,re,L):J.apply(this,re)}}else t[V]=function(...J){if(r!=null&&r.isGenerating)return new G(V,J,L);n._friendlyError(`It looks like you've called ${V} outside of a shader's modify() function.`)}})}typeof p5<"u"&&p5.registerAddon(UR);function CK(n){Bk(n,n.prototype),E_(n,n.prototype),hR(n,n.prototype),S_(n,n.prototype),fR(n,n.prototype),$k(n,n.prototype),uK(n,n.prototype),wk(n,n.prototype),xk(n,n.prototype),vk(n,n.prototype),bk(n,n.prototype),Ck(n,n.prototype),qk(n,n.prototype),_k(n,n.prototype),b_(n,n.prototype),C_(n,n.prototype),UR(n,n.prototype)}function AK(n){n.registerAddon(dR),n.registerAddon(PR)}const TK=()=>{if(typeof window._setupDone<"u"){console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import");return}if(!window.mocha){const n=new Event("p5Ready");window.dispatchEvent(n),(window.setup&&typeof window.setup=="function"||window.draw&&typeof window.draw=="function")&&!jt.instance&&new jt}},IK=()=>new Promise((n,t)=>{document.readyState==="complete"?n():window.addEventListener("load",n,!1)}),DK=typeof IS_MINIFIED>"u"?iq():Promise.resolve();bz(jt);wz(jt);Ez(jt);SH(jt);CH(jt);AH(jt);IH(jt);DH(jt);RH(jt);FH(jt);PH(jt);CK(jt);AK(jt);Promise.all([IK(),DK]).then(TK);const kK={class:"dashboard"},NK={class:"mood-overview"},RK={class:"charts"},FK={key:0,class:"chart-container"},PK={key:1,class:"chart-container"},MK={key:2,class:"average-container"},LK={key:3,class:"loading-message"},OK={key:4,class:"loading-message"},VK={class:"mottos-overview"},BK={key:0,class:"mottos-list"},UK={key:1,class:"loading-message"},$K={key:2,class:"loading-message"},jK={key:3,class:"pagination"},GK=["disabled"],zK=["disabled"],qK={class:"last-seven-days"},HK={key:0},WK={key:1},KK={key:1,class:"loading-message"},YK={key:2,class:"loading-message"},A0=10,XK={__name:"Dashboard",setup(n){const t=Ht(1),r=Ht([]),i=Ht(!0),s=Ht(""),o=async()=>{let T=wn.currentUser;return T||await new Promise(_=>{const C=wn.onAuthStateChanged(E=>{T=E,C(),_()})}),wn.currentUser},a=async()=>{i.value=!0,s.value="";try{const T=await o();if(T){const _=ol(ys(bn,"diaryEntries"),ro("userId","==",T.uid)),C=await al(_);r.value=C.docs.map(E=>({id:E.id,...E.data()}))}else r.value=[],s.value="Niet ingelogd."}catch(T){console.error("Fout bij het laden van dagboekvermeldingen:",T),r.value=[],s.value="Fout bij het laden van dagboekvermeldingen."}finally{i.value=!1}},u=()=>{var C,E;if(i.value||s.value)return;(C=document.getElementById("weekMoodChart"))==null||C.replaceChildren(),(E=document.getElementById("monthMoodChart"))==null||E.replaceChildren();const T=l("week");new jt(S=>{S.setup=()=>{S.createCanvas(300,200).parent("weekMoodChart"),S.noLoop()},S.draw=()=>{S.background(220),S.stroke(0),S.noFill();const R=5,w=300/(T.length||1);T.forEach((x,b)=>{const A=x/R*180;S.rect(b*w,200-A,w-5,A)})}},"weekMoodChart");const _=l("month");new jt(S=>{S.setup=()=>{S.createCanvas(300,200).parent("monthMoodChart"),S.noLoop()},S.draw=()=>{S.background(220),S.stroke(0),S.noFill();const R=5,w=300/(_.length||1);_.forEach((x,b)=>{const A=x/R*180;S.rect(b*w,200-A,w-5,A)})}},"monthMoodChart")};Ki(async()=>{await a(),u()}),co(r,()=>{u()});const l=T=>{const _=new Date,C=[];return r.value.forEach(E=>{const S=new Date(E.date),R=Math.floor((_-S)/(1e3*60*60*24));(T==="week"&&R<=7&&R>0||T==="month"&&R<=30&&R>0)&&C.push(parseInt(E.mood)||0)}),C},c=gr(()=>{const T=r.value.map(_=>parseInt(_.mood)||0).filter(_=>!isNaN(_));return T.length?T.reduce((_,C)=>_+C,0)/T.length:0}),h=gr(()=>[...new Set(r.value.flatMap(T=>T.neverForget||[]))].filter(T=>T)),f=gr(()=>{const T=(t.value-1)*A0,_=T+A0;return h.value.slice(T,_)}),d=gr(()=>Math.ceil(h.value.length/A0)),p=()=>{t.value>1&&t.value--},g=()=>{t.value<d.value&&t.value++},y=gr(()=>{const T=new Date,_=[];for(let C=1;C<=7;C++){const E=new Date(T);E.setDate(T.getDate()-C);const S=E.toISOString().split("T")[0],R=r.value.find(w=>w.date===S);_.push({date:S,entry:R})}return _.reverse()}),v=T=>new Date(T).toLocaleDateString("nl-NL",{day:"numeric",month:"long",year:"numeric"});return(T,_)=>(Ge(),We("div",kK,[_[9]||(_[9]=pe("h1",null,"Dagboek Dashboard",-1)),pe("div",NK,[_[3]||(_[3]=pe("h2",null,"Stemming Overzicht",-1)),pe("div",RK,[!i.value&&!s.value?(Ge(),We("div",FK,_[0]||(_[0]=[pe("h3",null,"Laatste Week",-1),pe("div",{id:"weekMoodChart"},null,-1)]))):pr("",!0),!i.value&&!s.value?(Ge(),We("div",PK,_[1]||(_[1]=[pe("h3",null,"Laatste Maand",-1),pe("div",{id:"monthMoodChart"},null,-1)]))):pr("",!0),!i.value&&!s.value?(Ge(),We("div",MK,[_[2]||(_[2]=pe("h3",null,"Gemiddeld Overall",-1)),pe("p",null,At(c.value.toFixed(1)),1)])):pr("",!0),i.value?(Ge(),We("div",LK,"Laden...")):pr("",!0),s.value?(Ge(),We("div",OK,At(s.value),1)):pr("",!0)])]),pe("div",VK,[_[4]||(_[4]=pe("h2",null,"Lijfspreuken",-1)),!i.value&&!s.value?(Ge(),We("ul",BK,[(Ge(!0),We(Or,null,ji(f.value,(C,E)=>(Ge(),We("li",{key:E},At(C),1))),128))])):pr("",!0),i.value?(Ge(),We("div",UK,"Laden...")):pr("",!0),s.value?(Ge(),We("div",$K,At(s.value),1)):pr("",!0),!i.value&&!s.value?(Ge(),We("div",jK,[pe("button",{onClick:p,disabled:t.value===1},"Vorige",8,GK),pe("span",null,"Pagina "+At(t.value)+" van "+At(d.value),1),pe("button",{onClick:g,disabled:t.value===d.value},"Volgende",8,zK)])):pr("",!0)]),pe("div",qK,[_[8]||(_[8]=pe("h2",null,"Afgelopen 7 Dagen",-1)),!i.value&&!s.value?(Ge(!0),We(Or,{key:0},ji(y.value,C=>(Ge(),We("div",{key:C.date,class:"day-entry"},[pe("h3",null,At(v(C.date)),1),C.entry?(Ge(),We("div",HK,[pe("p",null,[_[5]||(_[5]=pe("strong",null,"Inhoud:",-1)),Eu(" "+At(C.entry.content||"Geen inhoud"),1)]),pe("p",null,[_[6]||(_[6]=pe("strong",null,"Beperkende gedachten:",-1)),Eu(" "+At(C.entry.limitingThoughts||"Geen beperkende gedachten"),1)]),pe("p",null,[_[7]||(_[7]=pe("strong",null,"Gedachten om op te focussen:",-1)),Eu(" "+At(C.entry.focusThoughts||"Geen gedachten om op te focussen"),1)])])):(Ge(),We("p",WK,"Geen gegevens voor deze dag"))]))),128)):pr("",!0),i.value?(Ge(),We("div",KK,"Laden...")):pr("",!0),s.value?(Ge(),We("div",YK,At(s.value),1)):pr("",!0)])]))}},ZK=Mn(XK,[["__scopeId","data-v-ea8c4d3a"]]),QK={class:"goals-overview"},JK={class:"action-bar"},eY={key:0,class:"loading"},tY={key:1,class:"error"},rY={key:2,class:"no-goals"},nY={key:3,class:"goals-list"},iY={class:"goal-content"},sY={class:"created-at"},oY={key:0,class:"deadline"},aY={key:1,class:"deadline"},uY={class:"goal-actions"},lY=["onClick","title"],cY=["onClick"],hY=["onClick"],fY={__name:"GoalsOverview",setup(n){const t=uf();Ki(()=>{t.loadGoals()});function r(o){return o?new Date(o).toLocaleDateString("nl-NL",{day:"numeric",month:"long",year:"numeric"}):"Geen datum"}async function i(o){await t.toggleGoalCompletion(o)}async function s(o){confirm("Weet je zeker dat je dit doel wilt verwijderen?")&&await t.deleteGoal(o)}return(o,a)=>(Ge(),We("div",QK,[a[4]||(a[4]=pe("h1",null,"Doelen Overzicht",-1)),pe("div",JK,[pe("button",{class:"action-button add-goal",onClick:a[0]||(a[0]=u=>o.$router.push("/add-goal")),title:"Doel toevoegen"},a[1]||(a[1]=[pe("span",null,"",-1)]))]),Er(t).isLoading?(Ge(),We("div",eY,"Laden...")):Er(t).error?(Ge(),We("div",tY,At(Er(t).error),1)):Er(t).goals.length===0?(Ge(),We("div",rY," Geen doelen beschikbaar. Voeg een nieuw doel toe! ")):(Ge(),We("div",nY,[(Ge(!0),We(Or,null,ji(Er(t).goals,u=>(Ge(),We("div",{key:u.id,class:$h(["goal-item",{completed:u.completed}])},[pe("div",iY,[pe("h3",null,At(u.title),1),pe("p",null,At(u.description),1),pe("p",sY,"Aangemaakt op: "+At(r(u.createdAt)),1),u.deadline?(Ge(),We("p",oY,"Deadline: "+At(r(u.deadline)),1)):(Ge(),We("p",aY,"Geen deadline"))]),pe("div",uY,[pe("button",{class:"action-button",onClick:l=>i(u.id),title:u.completed?"Markeer als onvoltooid":"Markeer als voltooid"},[pe("span",null,At(u.completed?"":""),1)],8,lY),pe("button",{class:"action-button",onClick:l=>o.$router.push(`/edit-goal/${u.id}`),title:"Doel bewerken"},a[2]||(a[2]=[pe("span",null,"",-1)]),8,cY),pe("button",{class:"action-button delete",onClick:l=>s(u.id),title:"Doel verwijderen"},a[3]||(a[3]=[pe("span",null,"",-1)]),8,hY)])],2))),128))]))]))}},dY=Mn(fY,[["__scopeId","data-v-d02b15b8"]]),pY={class:"add-goal"},gY={key:0,class:"loading"},mY={key:1,class:"error"},yY={class:"form-group"},vY={class:"form-group"},_Y={class:"form-group"},bY={class:"form-actions"},xY={__name:"AddGoal",setup(n){const t=uf(),r=ks(),i=Ht({title:"",description:"",deadline:""});async function s(){if(!i.value.title.trim()||i.value.title.includes("<!--")){t.error="Titel is verplicht en mag geen ongeldige HTML bevatten (bijv. <!--).";return}const o={title:i.value.title.trim(),description:i.value.description.trim(),deadline:i.value.deadline,completed:!1};await t.addGoal(o),t.error||r.push("/goals")}return(o,a)=>(Ge(),We("div",pY,[a[8]||(a[8]=pe("h1",null,"Doel Toevoegen",-1)),Er(t).isLoading?(Ge(),We("div",gY,"Laden...")):Er(t).error?(Ge(),We("div",mY,At(Er(t).error),1)):pr("",!0),pe("form",{onSubmit:qh(s,["prevent"]),class:"goal-form"},[pe("div",yY,[a[4]||(a[4]=pe("label",{for:"title"},"Titel",-1)),cr(pe("input",{"onUpdate:modelValue":a[0]||(a[0]=u=>i.value.title=u),id:"title",type:"text",placeholder:"Voer de titel van het doel in",required:""},null,512),[[xr,i.value.title]])]),pe("div",vY,[a[5]||(a[5]=pe("label",{for:"description"},"Beschrijving",-1)),cr(pe("textarea",{"onUpdate:modelValue":a[1]||(a[1]=u=>i.value.description=u),id:"description",placeholder:"Voer een beschrijving in",rows:"5"},null,512),[[xr,i.value.description]])]),pe("div",_Y,[a[6]||(a[6]=pe("label",{for:"deadline"},"Deadline",-1)),cr(pe("input",{"onUpdate:modelValue":a[2]||(a[2]=u=>i.value.deadline=u),id:"deadline",type:"date"},null,512),[[xr,i.value.deadline]])]),pe("div",bY,[a[7]||(a[7]=pe("button",{type:"submit",title:"Doel toevoegen"},"Opslaan",-1)),pe("button",{type:"button",onClick:a[3]||(a[3]=u=>o.$router.push("/goals")),title:"Annuleren"},"Annuleren")])],32)]))}},wY=Mn(xY,[["__scopeId","data-v-9af378ac"]]),EY={class:"edit-goal"},SY={key:0,class:"loading"},CY={key:1,class:"error"},AY={key:2,class:"error"},TY={key:3,class:"goal-form"},IY={class:"form-group"},DY={class:"form-group"},kY={class:"form-actions"},NY={__name:"EditGoal",setup(n){const t=uf(),r=ks(),i=j1(),s=Ht(null);Ki(async()=>{await t.loadGoals();const a=i.params.id,u=t.goals.find(l=>l.id===a);u?s.value={...u}:t.error="Doel niet gevonden"});async function o(){if(!s.value.title){t.error="Titel is verplicht";return}await t.updateGoal(i.params.id,s.value),t.error||r.push("/goals")}return(a,u)=>(Ge(),We("div",EY,[u[7]||(u[7]=pe("h1",null,"Doel Bewerken",-1)),Er(t).isLoading?(Ge(),We("div",SY,"Laden...")):Er(t).error?(Ge(),We("div",CY,At(Er(t).error),1)):s.value?(Ge(),We("div",TY,[pe("div",IY,[u[3]||(u[3]=pe("label",{for:"title"},"Titel",-1)),cr(pe("input",{"onUpdate:modelValue":u[0]||(u[0]=l=>s.value.title=l),id:"title",type:"text",placeholder:"Voer de titel van het doel in",required:""},null,512),[[xr,s.value.title]])]),pe("div",DY,[u[4]||(u[4]=pe("label",{for:"description"},"Beschrijving",-1)),cr(pe("textarea",{"onUpdate:modelValue":u[1]||(u[1]=l=>s.value.description=l),id:"description",placeholder:"Voer een beschrijving in",rows:"5"},null,512),[[xr,s.value.description]])]),pe("div",kY,[pe("button",{class:"action-button",onClick:o,title:"Doel opslaan"},u[5]||(u[5]=[pe("span",null,"",-1)])),pe("button",{class:"action-button cancel",onClick:u[2]||(u[2]=l=>a.$router.push("/goals")),title:"Annuleren"},u[6]||(u[6]=[pe("span",null,"",-1)]))])])):(Ge(),We("div",AY,"Doel niet gevonden"))]))}},RY=Mn(NY,[["__scopeId","data-v-ad65aefa"]]),FY=[{path:"/",component:d7},{path:"/unplanned-tasks",component:C7},{path:"/add-task",component:j7},{path:"/edit-task/:id",component:J7},{path:"/diary/:date?",component:p$},{path:"/dashboard",component:ZK},{path:"/goals",component:dY},{path:"/add-goal",component:wY},{path:"/edit-goal/:id",component:RY}],PY=FU({history:uU(),routes:FY}),MY="modulepreload",LY=function(n){return"/"+n},WC={},OY=function(t,r,i){let s=Promise.resolve();if(r&&r.length>0){let a=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),l=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));s=a(r.map(c=>{if(c=LY(c),c in WC)return;WC[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":MY,h||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),h)return new Promise((p,g)=>{d.addEventListener("load",p),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return s.then(a=>{for(const u of a||[])u.status==="rejected"&&o(u.reason);return t().catch(o)})};function VY(n={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:i,onRegistered:s,onRegisteredSW:o,onRegisterError:a}=n;let u,l;const c=async(f=!0)=>{await l};async function h(){if("serviceWorker"in navigator){if(u=await OY(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/sw.js",{scope:"/",type:"classic"})).catch(f=>{a==null||a(f)}),!u)return;u.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),u.addEventListener("installed",f=>{f.isUpdate||i==null||i()}),u.register({immediate:t}).then(f=>{o?o("/sw.js",f):s==null||s(f)}).catch(f=>{a==null||a(f)})}}return l=h(),c}console.log("main.js: Start applicatie laden");const O_=RM(WU),$R=MM();console.log("main.js: Pinia genitialiseerd:",$R);O_.use($R);O_.use(PY);O_.mount("#app");VY({onNeedRefresh(){console.log("New content is available; please refresh."),confirm("Nieuwe inhoud is beschikbaar. Wil je vernieuwen?")&&window.location.reload()},onOfflineReady(){console.log("App is ready to work offline.")},onRegistered(n){console.log("Service worker registered:",n)},onRegisterError(n){console.error("Service worker registration failed:",n)}});console.log("main.js: Applicatie gemount met Firebase en Pinia");
